[0m14:42:42.782586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADA7A7F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADA7F36B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADA90E3A10>]}


============================== 14:42:42.782586 | de7e4856-a1f5-47b6-97d8-bc1ec25e78e3 ==============================
[0m14:42:42.782586 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:42:42.782586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:42.799672 [info ] [MainThread]: dbt version: 1.8.3
[0m14:42:42.799672 [info ] [MainThread]: python version: 3.12.3
[0m14:42:42.799672 [info ] [MainThread]: python path: C:\Users\javier.flores\Desktop\Portfolio\NFIRS Data Pipeline and Analysis\myenv\Scripts\python.exe
[0m14:42:42.799672 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m14:42:42.872198 [info ] [MainThread]: Using profiles dir at C:\Users\javier.flores\.dbt
[0m14:42:42.872198 [info ] [MainThread]: Using profiles.yml file at C:\Users\javier.flores\.dbt\profiles.yml
[0m14:42:42.872198 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\javier.flores\Desktop\Portfolio\NFIRS Data Pipeline and Analysis\nfirs_dbt_2\dbt_project.yml
[0m14:42:42.882562 [info ] [MainThread]: adapter type: duckdb
[0m14:42:42.882562 [info ] [MainThread]: adapter version: 1.8.1
[0m14:42:42.950558 [info ] [MainThread]: Configuration:
[0m14:42:42.950558 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:42:42.952296 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:42:42.953331 [info ] [MainThread]: Required dependencies:
[0m14:42:42.953412 [debug] [MainThread]: Executing "git --help"
[0m14:42:42.957895 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:42:42.958910 [info ] [MainThread]: Connection:
[0m14:42:42.959960 [info ] [MainThread]:   database: nfirs
[0m14:42:42.960029 [info ] [MainThread]:   schema: main
[0m14:42:42.961040 [info ] [MainThread]:   path: C:\Users\javier.flores\Desktop\Portfolio\NFIRS Data Pipeline and Analysis\nfirs_database\nfirs.duckdb
[0m14:42:42.961040 [info ] [MainThread]:   config_options: None
[0m14:42:42.962238 [info ] [MainThread]:   extensions: None
[0m14:42:42.962238 [info ] [MainThread]:   settings: None
[0m14:42:42.963478 [info ] [MainThread]:   external_root: .
[0m14:42:42.963478 [info ] [MainThread]:   use_credential_provider: None
[0m14:42:42.964656 [info ] [MainThread]:   attach: None
[0m14:42:42.964656 [info ] [MainThread]:   filesystems: None
[0m14:42:42.965806 [info ] [MainThread]:   remote: None
[0m14:42:42.965806 [info ] [MainThread]:   plugins: None
[0m14:42:42.966857 [info ] [MainThread]:   disable_transactions: False
[0m14:42:42.967879 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:42:42.967879 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m14:42:43.192026 [debug] [MainThread]: Using duckdb connection "debug"
[0m14:42:43.192026 [debug] [MainThread]: On debug: select 1 as id
[0m14:42:43.192026 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:43.222302 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:42:43.222302 [debug] [MainThread]: On debug: Close
[0m14:42:43.222302 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:42:43.222302 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:42:43.231751 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m14:42:43.231751 [debug] [MainThread]: Command `dbt debug` failed at 14:42:43.231751 after 0.62 seconds
[0m14:42:43.231751 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:42:43.231751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADA9058D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADA9022CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADAA5363F0>]}
[0m14:42:43.231751 [debug] [MainThread]: Flushing usage events
[0m14:44:04.299939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4694F5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46A8F3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46A8F3200>]}


============================== 14:44:04.299939 | d81d96da-a3ea-4d93-aa0f-2d8fd67ee143 ==============================
[0m14:44:04.299939 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:44:04.308934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:44:04.459653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd81d96da-a3ea-4d93-aa0f-2d8fd67ee143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46AC17920>]}
[0m14:44:04.500413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd81d96da-a3ea-4d93-aa0f-2d8fd67ee143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46AB543E0>]}
[0m14:44:04.500413 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m14:44:04.509781 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m14:44:04.604745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:44:04.604745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:44:04.629857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd81d96da-a3ea-4d93-aa0f-2d8fd67ee143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46A9C06E0>]}
[0m14:44:05.069542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd81d96da-a3ea-4d93-aa0f-2d8fd67ee143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46AF39CD0>]}
[0m14:44:05.069542 [info ] [MainThread]: Found 2 models, 4 data tests, 408 macros
[0m14:44:05.069542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd81d96da-a3ea-4d93-aa0f-2d8fd67ee143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46AB9DD30>]}
[0m14:44:05.069542 [info ] [MainThread]: 
[0m14:44:05.069542 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:44:05.078949 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m14:44:05.138820 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m14:44:05.146822 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m14:44:05.146822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:05.159949 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:44:05.169810 [debug] [ThreadPool]: On list_nfirs: Close
[0m14:44:05.169810 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_main)
[0m14:44:05.169810 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "main"
"
[0m14:44:05.181873 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m14:44:05.181873 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m14:44:05.181873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:05.199722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:44:05.199722 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m14:44:05.199722 [debug] [ThreadPool]: On create_nfirs_main: BEGIN
[0m14:44:05.199722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:44:05.199722 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m14:44:05.199722 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
    
        create schema if not exists "nfirs"."main"
    
[0m14:44:05.199722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:44:05.199722 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m14:44:05.199722 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m14:44:05.199722 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m14:44:05.199722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:44:05.199722 [debug] [ThreadPool]: On create_nfirs_main: Close
[0m14:44:05.208927 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main'
[0m14:44:05.216968 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m14:44:05.216968 [debug] [ThreadPool]: On list_nfirs_main: BEGIN
[0m14:44:05.216968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:05.239000 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:44:05.239000 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m14:44:05.239000 [debug] [ThreadPool]: On list_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'nfirs'
  
[0m14:44:05.259506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m14:44:05.269507 [debug] [ThreadPool]: On list_nfirs_main: ROLLBACK
[0m14:44:05.319015 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main'
[0m14:44:05.319015 [debug] [ThreadPool]: On list_nfirs_main: Close
[0m14:44:05.329850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd81d96da-a3ea-4d93-aa0f-2d8fd67ee143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46AB9DA60>]}
[0m14:44:05.329850 [debug] [MainThread]: Using duckdb connection "master"
[0m14:44:05.329850 [debug] [MainThread]: On master: BEGIN
[0m14:44:05.329850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:05.349353 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:44:05.349999 [debug] [MainThread]: On master: COMMIT
[0m14:44:05.349999 [debug] [MainThread]: Using duckdb connection "master"
[0m14:44:05.349999 [debug] [MainThread]: On master: COMMIT
[0m14:44:05.349999 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:44:05.349999 [debug] [MainThread]: On master: Close
[0m14:44:05.349999 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m14:44:05.349999 [info ] [MainThread]: 
[0m14:44:05.359661 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project.my_first_dbt_model
[0m14:44:05.359661 [info ] [Thread-1 (]: 1 of 2 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:44:05.359661 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project.my_first_dbt_model'
[0m14:44:05.359661 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project.my_first_dbt_model
[0m14:44:05.370371 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project.my_first_dbt_model"
[0m14:44:05.370371 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project.my_first_dbt_model
[0m14:44:05.391228 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project.my_first_dbt_model"
[0m14:44:05.420333 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project.my_first_dbt_model"
[0m14:44:05.420415 [debug] [Thread-1 (]: On model.nfirs_dbt_project.my_first_dbt_model: BEGIN
[0m14:44:05.420415 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:44:05.433137 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:44:05.439673 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project.my_first_dbt_model"
[0m14:44:05.439673 [debug] [Thread-1 (]: On model.nfirs_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project.my_first_dbt_model"} */

  
    
    

    create  table
      "nfirs"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:44:05.441230 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:44:05.443424 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project.my_first_dbt_model"
[0m14:44:05.443424 [debug] [Thread-1 (]: On model.nfirs_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project.my_first_dbt_model"} */
alter table "nfirs"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:44:05.443424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:44:05.459699 [debug] [Thread-1 (]: On model.nfirs_dbt_project.my_first_dbt_model: COMMIT
[0m14:44:05.459699 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project.my_first_dbt_model"
[0m14:44:05.459699 [debug] [Thread-1 (]: On model.nfirs_dbt_project.my_first_dbt_model: COMMIT
[0m14:44:05.589546 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:44:05.589546 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project.my_first_dbt_model"
[0m14:44:05.589546 [debug] [Thread-1 (]: On model.nfirs_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project.my_first_dbt_model"} */
drop table if exists "nfirs"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:44:05.599767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m14:44:05.599767 [debug] [Thread-1 (]: On model.nfirs_dbt_project.my_first_dbt_model: Close
[0m14:44:06.764912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd81d96da-a3ea-4d93-aa0f-2d8fd67ee143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A468FF3410>]}
[0m14:44:06.764912 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 1.40s]
[0m14:44:06.764912 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project.my_first_dbt_model
[0m14:44:06.764912 [debug] [Thread-3 (]: Began running node model.nfirs_dbt_project.my_second_dbt_model
[0m14:44:06.764912 [info ] [Thread-3 (]: 2 of 2 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:44:06.769605 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project.my_second_dbt_model'
[0m14:44:06.769605 [debug] [Thread-3 (]: Began compiling node model.nfirs_dbt_project.my_second_dbt_model
[0m14:44:06.769605 [debug] [Thread-3 (]: Writing injected SQL for node "model.nfirs_dbt_project.my_second_dbt_model"
[0m14:44:06.769605 [debug] [Thread-3 (]: Began executing node model.nfirs_dbt_project.my_second_dbt_model
[0m14:44:06.779837 [debug] [Thread-3 (]: Writing runtime sql for node "model.nfirs_dbt_project.my_second_dbt_model"
[0m14:44:06.789232 [debug] [Thread-3 (]: Using duckdb connection "model.nfirs_dbt_project.my_second_dbt_model"
[0m14:44:06.789232 [debug] [Thread-3 (]: On model.nfirs_dbt_project.my_second_dbt_model: BEGIN
[0m14:44:06.789232 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:44:06.809744 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:06.809744 [debug] [Thread-3 (]: Using duckdb connection "model.nfirs_dbt_project.my_second_dbt_model"
[0m14:44:06.809744 [debug] [Thread-3 (]: On model.nfirs_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project.my_second_dbt_model"} */

  
  create view "nfirs"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "nfirs"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:44:06.809744 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:06.809744 [debug] [Thread-3 (]: Using duckdb connection "model.nfirs_dbt_project.my_second_dbt_model"
[0m14:44:06.809744 [debug] [Thread-3 (]: On model.nfirs_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project.my_second_dbt_model"} */
alter view "nfirs"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:44:06.809744 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:06.809744 [debug] [Thread-3 (]: On model.nfirs_dbt_project.my_second_dbt_model: COMMIT
[0m14:44:06.818788 [debug] [Thread-3 (]: Using duckdb connection "model.nfirs_dbt_project.my_second_dbt_model"
[0m14:44:06.818788 [debug] [Thread-3 (]: On model.nfirs_dbt_project.my_second_dbt_model: COMMIT
[0m14:44:06.834798 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:06.834798 [debug] [Thread-3 (]: Using duckdb connection "model.nfirs_dbt_project.my_second_dbt_model"
[0m14:44:06.834798 [debug] [Thread-3 (]: On model.nfirs_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project.my_second_dbt_model"} */
drop view if exists "nfirs"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:44:06.834798 [debug] [Thread-3 (]: SQL status: OK in 0.0 seconds
[0m14:44:06.834798 [debug] [Thread-3 (]: On model.nfirs_dbt_project.my_second_dbt_model: Close
[0m14:44:08.159814 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd81d96da-a3ea-4d93-aa0f-2d8fd67ee143', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46B202BA0>]}
[0m14:44:08.164896 [info ] [Thread-3 (]: 2 of 2 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 1.39s]
[0m14:44:08.164896 [debug] [Thread-3 (]: Finished running node model.nfirs_dbt_project.my_second_dbt_model
[0m14:44:08.164896 [debug] [MainThread]: Using duckdb connection "master"
[0m14:44:08.164896 [debug] [MainThread]: On master: BEGIN
[0m14:44:08.164896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:08.184881 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:44:08.184881 [debug] [MainThread]: On master: COMMIT
[0m14:44:08.184881 [debug] [MainThread]: Using duckdb connection "master"
[0m14:44:08.184881 [debug] [MainThread]: On master: COMMIT
[0m14:44:08.184881 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m14:44:08.184881 [debug] [MainThread]: On master: Close
[0m14:44:08.189936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:08.189936 [debug] [MainThread]: Connection 'create_nfirs_main' was properly closed.
[0m14:44:08.189936 [debug] [MainThread]: Connection 'list_nfirs_main' was properly closed.
[0m14:44:08.195050 [debug] [MainThread]: Connection 'model.nfirs_dbt_project.my_first_dbt_model' was properly closed.
[0m14:44:08.195050 [debug] [MainThread]: Connection 'model.nfirs_dbt_project.my_second_dbt_model' was properly closed.
[0m14:44:08.195050 [info ] [MainThread]: 
[0m14:44:08.195050 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m14:44:08.195050 [debug] [MainThread]: Command end result
[0m14:44:08.209903 [info ] [MainThread]: 
[0m14:44:08.209903 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:08.209903 [info ] [MainThread]: 
[0m14:44:08.219525 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:44:08.219525 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:08.219525 after 4.03 seconds
[0m14:44:08.219525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46AAC15E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46C3F0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A468363260>]}
[0m14:44:08.219525 [debug] [MainThread]: Flushing usage events
[0m15:21:39.694091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA156DC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA156C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA153BDD0>]}


============================== 15:21:39.703919 | 56c3fc1a-d434-4787-acfb-b3f76679ac28 ==============================
[0m15:21:39.703919 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:21:39.704961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:21:39.859845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56c3fc1a-d434-4787-acfb-b3f76679ac28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA17B9550>]}
[0m15:21:39.899530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56c3fc1a-d434-4787-acfb-b3f76679ac28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA173F020>]}
[0m15:21:39.900531 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:21:39.904145 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:21:40.016285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:40.016285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:40.046694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56c3fc1a-d434-4787-acfb-b3f76679ac28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA1974050>]}
[0m15:21:40.119112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56c3fc1a-d434-4787-acfb-b3f76679ac28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA19C6D80>]}
[0m15:21:40.119112 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m15:21:40.120111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56c3fc1a-d434-4787-acfb-b3f76679ac28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA1704B30>]}
[0m15:21:40.121144 [info ] [MainThread]: 
[0m15:21:40.121144 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:21:40.123142 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:21:40.307129 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:21:40.307129 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:21:40.308145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:40.405826 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:21:40.405826 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m15:21:40.414132 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:40.415189 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m15:21:40.415189 [info ] [MainThread]: 
[0m15:21:40.415189 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m15:21:40.416166 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 25924)
[0m15:21:40.417131 [debug] [MainThread]: Command `cli run` failed at 15:21:40.416166 after 0.82 seconds
[0m15:21:40.417131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA169CEF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA15AF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025CA1B82C60>]}
[0m15:21:40.417131 [debug] [MainThread]: Flushing usage events
[0m15:21:55.768625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025277ACCB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252761C9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025275F66DB0>]}


============================== 15:21:55.768625 | a907977e-69fd-46a0-ad7c-ef933a91bd4b ==============================
[0m15:21:55.768625 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:21:55.768625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:21:55.917731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a907977e-69fd-46a0-ad7c-ef933a91bd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025277D49BE0>]}
[0m15:21:55.960370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a907977e-69fd-46a0-ad7c-ef933a91bd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025277DE2E10>]}
[0m15:21:55.960370 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:21:55.968740 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:21:56.068765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:56.076863 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:56.105291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a907977e-69fd-46a0-ad7c-ef933a91bd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025277E1F680>]}
[0m15:21:56.169604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a907977e-69fd-46a0-ad7c-ef933a91bd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025277E94980>]}
[0m15:21:56.169604 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m15:21:56.169604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a907977e-69fd-46a0-ad7c-ef933a91bd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025278044F80>]}
[0m15:21:56.177708 [info ] [MainThread]: 
[0m15:21:56.177708 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:21:56.177708 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:21:56.229536 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:21:56.229536 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:21:56.229536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:56.253635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:56.253635 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:21:56.261851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_main)
[0m15:21:56.261851 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "main"
"
[0m15:21:56.261851 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:21:56.261851 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:21:56.270082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:56.286212 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:56.286212 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:21:56.286212 [debug] [ThreadPool]: On create_nfirs_main: BEGIN
[0m15:21:56.286212 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:56.286212 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:21:56.286212 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
    
        create schema if not exists "nfirs"."main"
    
[0m15:21:56.286212 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:56.286212 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:21:56.286212 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:21:56.286212 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:21:56.286212 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:56.286212 [debug] [ThreadPool]: On create_nfirs_main: Close
[0m15:21:56.294407 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main'
[0m15:21:56.302477 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:21:56.302477 [debug] [ThreadPool]: On list_nfirs_main: BEGIN
[0m15:21:56.302477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:56.318478 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:56.318478 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:21:56.318478 [debug] [ThreadPool]: On list_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'nfirs'
  
[0m15:21:56.345474 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:56.353516 [debug] [ThreadPool]: On list_nfirs_main: ROLLBACK
[0m15:21:56.353516 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main'
[0m15:21:56.353516 [debug] [ThreadPool]: On list_nfirs_main: Close
[0m15:21:56.361592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a907977e-69fd-46a0-ad7c-ef933a91bd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252781021E0>]}
[0m15:21:56.361592 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:56.361592 [debug] [MainThread]: On master: BEGIN
[0m15:21:56.361592 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:56.377911 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:56.377911 [debug] [MainThread]: On master: COMMIT
[0m15:21:56.377911 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:56.377911 [debug] [MainThread]: On master: COMMIT
[0m15:21:56.377911 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:56.377911 [debug] [MainThread]: On master: Close
[0m15:21:56.385879 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:21:56.385879 [info ] [MainThread]: 
[0m15:21:56.385879 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader
[0m15:21:56.385879 [info ] [Thread-1 (]: 1 of 1 START sql view model main.nfirs_transformed_test_model__fdheader ........ [RUN]
[0m15:21:56.385879 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader'
[0m15:21:56.385879 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader
[0m15:21:56.394215 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"
[0m15:21:56.394215 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader
[0m15:21:56.426008 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"
[0m15:21:56.428373 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"
[0m15:21:56.429412 [debug] [Thread-1 (]: On model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader: BEGIN
[0m15:21:56.429506 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:21:56.448580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:56.448580 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"
[0m15:21:56.449696 [debug] [Thread-1 (]: On model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"} */

  
  create view "nfirs"."main"."nfirs_transformed_test_model__fdheader__dbt_tmp" as (
    WITH source_fdheader AS (
    SELECT
        COUNT(*)
    FROM "nfirs"."nfirs_transformed"."fdheader"
)

final AS (
    SELECT
        *
    FROM source_fdheader
)

SELECT * FROM final
  );

[0m15:21:56.450709 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"} */

  
  create view "nfirs"."main"."nfirs_transformed_test_model__fdheader__dbt_tmp" as (
    WITH source_fdheader AS (
    SELECT
        COUNT(*)
    FROM "nfirs"."nfirs_transformed"."fdheader"
)

final AS (
    SELECT
        *
    FROM source_fdheader
)

SELECT * FROM final
  );

[0m15:21:56.450709 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:21:56.450709 [debug] [Thread-1 (]: On model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader: ROLLBACK
[0m15:21:56.475129 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader'
[0m15:21:56.475129 [debug] [Thread-1 (]: On model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader: Close
[0m15:21:56.483125 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed_test_model__fdheader (models\nfirs_transformed\nfirs_transformed_test_model__fdheader.sql)
  Parser Error: syntax error at or near "final"
[0m15:21:56.483125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a907977e-69fd-46a0-ad7c-ef933a91bd4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025277D29E50>]}
[0m15:21:56.483125 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.nfirs_transformed_test_model__fdheader  [[31mERROR[0m in 0.10s]
[0m15:21:56.483125 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader
[0m15:21:56.493124 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:56.493124 [debug] [MainThread]: On master: BEGIN
[0m15:21:56.494698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:56.515853 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:56.515853 [debug] [MainThread]: On master: COMMIT
[0m15:21:56.517654 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:56.517654 [debug] [MainThread]: On master: COMMIT
[0m15:21:56.518166 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:56.518577 [debug] [MainThread]: On master: Close
[0m15:21:56.520290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:56.520290 [debug] [MainThread]: Connection 'create_nfirs_main' was properly closed.
[0m15:21:56.520290 [debug] [MainThread]: Connection 'list_nfirs_main' was properly closed.
[0m15:21:56.520290 [debug] [MainThread]: Connection 'model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader' was properly closed.
[0m15:21:56.520290 [info ] [MainThread]: 
[0m15:21:56.520290 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m15:21:56.525730 [debug] [MainThread]: Command end result
[0m15:21:56.543586 [info ] [MainThread]: 
[0m15:21:56.543724 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:21:56.543724 [info ] [MainThread]: 
[0m15:21:56.543724 [error] [MainThread]:   Runtime Error in model nfirs_transformed_test_model__fdheader (models\nfirs_transformed\nfirs_transformed_test_model__fdheader.sql)
  Parser Error: syntax error at or near "final"
[0m15:21:56.543724 [info ] [MainThread]: 
[0m15:21:56.545824 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:21:56.545824 [debug] [MainThread]: Command `cli run` failed at 15:21:56.545824 after 0.89 seconds
[0m15:21:56.545824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252761C9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025277AFBE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025277AF9370>]}
[0m15:21:56.545824 [debug] [MainThread]: Flushing usage events
[0m15:22:22.454385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F60F23710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F60F20AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F60F23230>]}


============================== 15:22:22.454385 | 74959611-d1a7-44be-87d9-c2d49fe6220a ==============================
[0m15:22:22.454385 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:22:22.454385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:22:22.595211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74959611-d1a7-44be-87d9-c2d49fe6220a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F62BDF620>]}
[0m15:22:22.634779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74959611-d1a7-44be-87d9-c2d49fe6220a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F62A31610>]}
[0m15:22:22.643015 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:22:22.646117 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:22:22.751146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:22.751146 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:22.779586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74959611-d1a7-44be-87d9-c2d49fe6220a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F62C61D30>]}
[0m15:22:22.846573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74959611-d1a7-44be-87d9-c2d49fe6220a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F62C98E60>]}
[0m15:22:22.846573 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m15:22:22.846573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74959611-d1a7-44be-87d9-c2d49fe6220a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F62C469F0>]}
[0m15:22:22.846573 [info ] [MainThread]: 
[0m15:22:22.846573 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:22:22.846573 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:22:22.904020 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:22:22.912080 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:22:22.912381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:22.928942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:22:22.928942 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:22:22.937109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_main)
[0m15:22:22.937109 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "main"
"
[0m15:22:22.937109 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:22:22.945386 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:22:22.945386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:22.963188 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:22:22.963188 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:22:22.963188 [debug] [ThreadPool]: On create_nfirs_main: BEGIN
[0m15:22:22.963188 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:22:22.963188 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:22:22.963188 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
    
        create schema if not exists "nfirs"."main"
    
[0m15:22:22.963188 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:22:22.963188 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:22:22.963188 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:22:22.963188 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:22:22.963188 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:22:22.963188 [debug] [ThreadPool]: On create_nfirs_main: Close
[0m15:22:22.971433 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main'
[0m15:22:22.979507 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:22:22.979507 [debug] [ThreadPool]: On list_nfirs_main: BEGIN
[0m15:22:22.979507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:22.996237 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:22:22.996237 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:22:22.996237 [debug] [ThreadPool]: On list_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'nfirs'
  
[0m15:22:23.020907 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:22:23.028939 [debug] [ThreadPool]: On list_nfirs_main: ROLLBACK
[0m15:22:23.028939 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main'
[0m15:22:23.028939 [debug] [ThreadPool]: On list_nfirs_main: Close
[0m15:22:23.037060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74959611-d1a7-44be-87d9-c2d49fe6220a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F62CDF0B0>]}
[0m15:22:23.037060 [debug] [MainThread]: Using duckdb connection "master"
[0m15:22:23.037060 [debug] [MainThread]: On master: BEGIN
[0m15:22:23.037060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:23.055215 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:22:23.055215 [debug] [MainThread]: On master: COMMIT
[0m15:22:23.055215 [debug] [MainThread]: Using duckdb connection "master"
[0m15:22:23.055215 [debug] [MainThread]: On master: COMMIT
[0m15:22:23.055215 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:22:23.055215 [debug] [MainThread]: On master: Close
[0m15:22:23.063456 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:22:23.063456 [info ] [MainThread]: 
[0m15:22:23.063456 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader
[0m15:22:23.063456 [info ] [Thread-1 (]: 1 of 1 START sql view model main.nfirs_transformed_test_model__fdheader ........ [RUN]
[0m15:22:23.063456 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader'
[0m15:22:23.063456 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader
[0m15:22:23.071625 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"
[0m15:22:23.071625 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader
[0m15:22:23.095977 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"
[0m15:22:23.095977 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"
[0m15:22:23.095977 [debug] [Thread-1 (]: On model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader: BEGIN
[0m15:22:23.095977 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:22:23.112327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:22:23.120513 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"
[0m15:22:23.120736 [debug] [Thread-1 (]: On model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"} */

  
  create view "nfirs"."main"."nfirs_transformed_test_model__fdheader__dbt_tmp" as (
    WITH source_fdheader AS (
    SELECT
        COUNT(*)
    FROM "nfirs"."nfirs_transformed"."fdheader"
),

final AS (
    SELECT
        *
    FROM source_fdheader
)

SELECT * FROM final
  );

[0m15:22:23.140056 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"} */

  
  create view "nfirs"."main"."nfirs_transformed_test_model__fdheader__dbt_tmp" as (
    WITH source_fdheader AS (
    SELECT
        COUNT(*)
    FROM "nfirs"."nfirs_transformed"."fdheader"
),

final AS (
    SELECT
        *
    FROM source_fdheader
)

SELECT * FROM final
  );

[0m15:22:23.140056 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:22:23.140056 [debug] [Thread-1 (]: On model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader: ROLLBACK
[0m15:22:23.140056 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader'
[0m15:22:23.140056 [debug] [Thread-1 (]: On model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader: Close
[0m15:22:23.147535 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed_test_model__fdheader (models\nfirs_transformed\nfirs_transformed_test_model__fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 8:     FROM "nfirs"."nfirs_transformed"."fdheader"
                   ^
[0m15:22:23.147535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74959611-d1a7-44be-87d9-c2d49fe6220a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F60F23740>]}
[0m15:22:23.155635 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.nfirs_transformed_test_model__fdheader  [[31mERROR[0m in 0.08s]
[0m15:22:23.155635 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader
[0m15:22:23.155635 [debug] [MainThread]: Using duckdb connection "master"
[0m15:22:23.155635 [debug] [MainThread]: On master: BEGIN
[0m15:22:23.155635 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:23.171969 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:22:23.171969 [debug] [MainThread]: On master: COMMIT
[0m15:22:23.171969 [debug] [MainThread]: Using duckdb connection "master"
[0m15:22:23.171969 [debug] [MainThread]: On master: COMMIT
[0m15:22:23.171969 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:22:23.171969 [debug] [MainThread]: On master: Close
[0m15:22:23.179997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:23.179997 [debug] [MainThread]: Connection 'create_nfirs_main' was properly closed.
[0m15:22:23.179997 [debug] [MainThread]: Connection 'list_nfirs_main' was properly closed.
[0m15:22:23.179997 [debug] [MainThread]: Connection 'model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader' was properly closed.
[0m15:22:23.179997 [info ] [MainThread]: 
[0m15:22:23.179997 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m15:22:23.179997 [debug] [MainThread]: Command end result
[0m15:22:23.196350 [info ] [MainThread]: 
[0m15:22:23.196350 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:22:23.196350 [info ] [MainThread]: 
[0m15:22:23.204358 [error] [MainThread]:   Runtime Error in model nfirs_transformed_test_model__fdheader (models\nfirs_transformed\nfirs_transformed_test_model__fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 8:     FROM "nfirs"."nfirs_transformed"."fdheader"
                   ^
[0m15:22:23.204358 [info ] [MainThread]: 
[0m15:22:23.204358 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:22:23.204358 [debug] [MainThread]: Command `cli run` failed at 15:22:23.204358 after 0.85 seconds
[0m15:22:23.204358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F6141DC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F62A81EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017F63193800>]}
[0m15:22:23.204358 [debug] [MainThread]: Flushing usage events
[0m15:25:09.899070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD63EF920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD900C9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD900CBC0>]}


============================== 15:25:09.899070 | 7da23d50-408a-4d82-9846-3bd9685d2e0e ==============================
[0m15:25:09.899070 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:25:09.899070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:25:10.056002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7da23d50-408a-4d82-9846-3bd9685d2e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD900CEC0>]}
[0m15:25:10.096331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7da23d50-408a-4d82-9846-3bd9685d2e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD68FF4D0>]}
[0m15:25:10.096331 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:25:10.104332 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:25:10.212831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:25:10.212831 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:25:10.245424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7da23d50-408a-4d82-9846-3bd9685d2e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD9290AD0>]}
[0m15:25:10.318836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7da23d50-408a-4d82-9846-3bd9685d2e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD9346000>]}
[0m15:25:10.318836 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m15:25:10.318836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7da23d50-408a-4d82-9846-3bd9685d2e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD9465730>]}
[0m15:25:10.326837 [info ] [MainThread]: 
[0m15:25:10.326837 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:25:10.326837 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:25:10.386371 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:25:10.386371 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:25:10.387383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:10.408295 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:25:10.409364 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:25:10.414693 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_main)
[0m15:25:10.414793 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "main"
"
[0m15:25:10.419982 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:25:10.419982 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:25:10.419982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:25:10.435991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:25:10.435991 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:25:10.435991 [debug] [ThreadPool]: On create_nfirs_main: BEGIN
[0m15:25:10.435991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:25:10.435991 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:25:10.435991 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
    
        create schema if not exists "nfirs"."main"
    
[0m15:25:10.435991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:25:10.435991 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:25:10.435991 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:25:10.435991 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:25:10.435991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:25:10.444221 [debug] [ThreadPool]: On create_nfirs_main: Close
[0m15:25:10.445574 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main'
[0m15:25:10.453613 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:25:10.453613 [debug] [ThreadPool]: On list_nfirs_main: BEGIN
[0m15:25:10.453613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:10.470493 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:25:10.470493 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:25:10.470493 [debug] [ThreadPool]: On list_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'nfirs'
  
[0m15:25:10.494812 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:25:10.502819 [debug] [ThreadPool]: On list_nfirs_main: ROLLBACK
[0m15:25:10.502819 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main'
[0m15:25:10.502819 [debug] [ThreadPool]: On list_nfirs_main: Close
[0m15:25:10.510813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7da23d50-408a-4d82-9846-3bd9685d2e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD93463C0>]}
[0m15:25:10.510813 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:10.510813 [debug] [MainThread]: On master: BEGIN
[0m15:25:10.510813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:10.527079 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:25:10.527079 [debug] [MainThread]: On master: COMMIT
[0m15:25:10.527079 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:10.527079 [debug] [MainThread]: On master: COMMIT
[0m15:25:10.527079 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:25:10.527079 [debug] [MainThread]: On master: Close
[0m15:25:10.535074 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:25:10.535074 [info ] [MainThread]: 
[0m15:25:10.535074 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader
[0m15:25:10.535074 [info ] [Thread-1 (]: 1 of 1 START sql view model main.nfirs_transformed_test_model__fdheader ........ [RUN]
[0m15:25:10.535074 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader'
[0m15:25:10.535074 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader
[0m15:25:10.543083 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"
[0m15:25:10.543083 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader
[0m15:25:10.567207 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"
[0m15:25:10.567207 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"
[0m15:25:10.567207 [debug] [Thread-1 (]: On model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader: BEGIN
[0m15:25:10.567207 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:25:10.583215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:25:10.583215 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"
[0m15:25:10.591208 [debug] [Thread-1 (]: On model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"} */

  
  create view "nfirs"."main"."nfirs_transformed_test_model__fdheader__dbt_tmp" as (
    WITH source_fdheader AS (
    SELECT
        *
    FROM "nfirs"."nfirs_transformed"."fdheader"
),

final AS (
    SELECT
        *
    FROM source_fdheader
)

SELECT * FROM final
  );

[0m15:25:10.607414 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader"} */

  
  create view "nfirs"."main"."nfirs_transformed_test_model__fdheader__dbt_tmp" as (
    WITH source_fdheader AS (
    SELECT
        *
    FROM "nfirs"."nfirs_transformed"."fdheader"
),

final AS (
    SELECT
        *
    FROM source_fdheader
)

SELECT * FROM final
  );

[0m15:25:10.607414 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:25:10.607414 [debug] [Thread-1 (]: On model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader: ROLLBACK
[0m15:25:10.615554 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader'
[0m15:25:10.615554 [debug] [Thread-1 (]: On model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader: Close
[0m15:25:10.623555 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed_test_model__fdheader (models\nfirs_transformed\nfirs_transformed_test_model__fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 8:     FROM "nfirs"."nfirs_transformed"."fdheader"
                   ^
[0m15:25:10.623555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7da23d50-408a-4d82-9846-3bd9685d2e0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD7563680>]}
[0m15:25:10.623555 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.nfirs_transformed_test_model__fdheader  [[31mERROR[0m in 0.09s]
[0m15:25:10.623555 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader
[0m15:25:10.623555 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:10.623555 [debug] [MainThread]: On master: BEGIN
[0m15:25:10.623555 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:25:10.639845 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:25:10.647846 [debug] [MainThread]: On master: COMMIT
[0m15:25:10.647846 [debug] [MainThread]: Using duckdb connection "master"
[0m15:25:10.647846 [debug] [MainThread]: On master: COMMIT
[0m15:25:10.647846 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:25:10.647846 [debug] [MainThread]: On master: Close
[0m15:25:10.647846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:10.647846 [debug] [MainThread]: Connection 'create_nfirs_main' was properly closed.
[0m15:25:10.647846 [debug] [MainThread]: Connection 'list_nfirs_main' was properly closed.
[0m15:25:10.647846 [debug] [MainThread]: Connection 'model.nfirs_dbt_project.nfirs_transformed_test_model__fdheader' was properly closed.
[0m15:25:10.647846 [info ] [MainThread]: 
[0m15:25:10.655926 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m15:25:10.655926 [debug] [MainThread]: Command end result
[0m15:25:10.671978 [info ] [MainThread]: 
[0m15:25:10.671978 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:25:10.671978 [info ] [MainThread]: 
[0m15:25:10.671978 [error] [MainThread]:   Runtime Error in model nfirs_transformed_test_model__fdheader (models\nfirs_transformed\nfirs_transformed_test_model__fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 8:     FROM "nfirs"."nfirs_transformed"."fdheader"
                   ^
[0m15:25:10.671978 [info ] [MainThread]: 
[0m15:25:10.671978 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:25:10.671978 [debug] [MainThread]: Command `cli run` failed at 15:25:10.671978 after 0.89 seconds
[0m15:25:10.671978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD900CB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD900C770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DD900D040>]}
[0m15:25:10.671978 [debug] [MainThread]: Flushing usage events
[0m15:30:24.636842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3226C2F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B37FBED0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3220FBCB0>]}


============================== 15:30:24.644963 | e420d4a1-6e0e-476b-b62c-81b01f8f78b2 ==============================
[0m15:30:24.644963 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:30:24.644963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:30:24.796192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e420d4a1-6e0e-476b-b62c-81b01f8f78b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B323BC7A70>]}
[0m15:30:24.837062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e420d4a1-6e0e-476b-b62c-81b01f8f78b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B323D201D0>]}
[0m15:30:24.837062 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:30:24.845140 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:30:24.945280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:30:24.945280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:30:24.985694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e420d4a1-6e0e-476b-b62c-81b01f8f78b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B323A6CD40>]}
[0m15:30:25.050835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e420d4a1-6e0e-476b-b62c-81b01f8f78b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B323E36930>]}
[0m15:30:25.050835 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m15:30:25.050835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e420d4a1-6e0e-476b-b62c-81b01f8f78b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B323FCE090>]}
[0m15:30:25.050835 [info ] [MainThread]: 
[0m15:30:25.050835 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:30:25.050835 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:30:25.107522 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:30:25.107522 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:30:25.115530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:25.131936 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:30:25.131936 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:30:25.140168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_main)
[0m15:30:25.140168 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "main"
"
[0m15:30:25.140168 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:30:25.140168 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:30:25.148208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:25.164434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:30:25.164434 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:30:25.164434 [debug] [ThreadPool]: On create_nfirs_main: BEGIN
[0m15:30:25.164434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:30:25.164434 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:30:25.164434 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
    
        create schema if not exists "nfirs"."main"
    
[0m15:30:25.164434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:30:25.164434 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:30:25.164434 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:30:25.164434 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:30:25.172505 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:30:25.172505 [debug] [ThreadPool]: On create_nfirs_main: Close
[0m15:30:25.180504 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main'
[0m15:30:25.180504 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:30:25.180504 [debug] [ThreadPool]: On list_nfirs_main: BEGIN
[0m15:30:25.180504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:25.205035 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:30:25.205035 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:30:25.205035 [debug] [ThreadPool]: On list_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'nfirs'
  
[0m15:30:25.230202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:30:25.230202 [debug] [ThreadPool]: On list_nfirs_main: ROLLBACK
[0m15:30:25.230202 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main'
[0m15:30:25.230202 [debug] [ThreadPool]: On list_nfirs_main: Close
[0m15:30:25.238529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e420d4a1-6e0e-476b-b62c-81b01f8f78b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B323C7AA50>]}
[0m15:30:25.238529 [debug] [MainThread]: Using duckdb connection "master"
[0m15:30:25.238529 [debug] [MainThread]: On master: BEGIN
[0m15:30:25.238529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:25.264512 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:30:25.265011 [debug] [MainThread]: On master: COMMIT
[0m15:30:25.265011 [debug] [MainThread]: Using duckdb connection "master"
[0m15:30:25.265011 [debug] [MainThread]: On master: COMMIT
[0m15:30:25.265011 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:30:25.265011 [debug] [MainThread]: On master: Close
[0m15:30:25.267749 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:30:25.267749 [info ] [MainThread]: 
[0m15:30:25.275765 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader
[0m15:30:25.275765 [info ] [Thread-1 (]: 1 of 1 START sql table model main.nfirs_transformed_test_model__fdheader ....... [RUN]
[0m15:30:25.275765 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader'
[0m15:30:25.275765 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader
[0m15:30:25.283843 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader"
[0m15:30:25.283843 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader
[0m15:30:25.309971 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader"
[0m15:30:25.313532 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader"
[0m15:30:25.313532 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader: BEGIN
[0m15:30:25.313532 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:30:25.329893 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:30:25.329893 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader"
[0m15:30:25.329893 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader"} */

  
    
    

    create  table
      "nfirs"."main"."nfirs_transformed_test_model__fdheader__dbt_tmp"
  
    as (
      

WITH source_fdheader AS (
    SELECT
        *
    FROM "nfirs"."nfirs_transformed"."fdheader"
),

final AS (
    SELECT
        *
    FROM source_fdheader
)

SELECT * FROM final
    );
  
  
[0m15:30:25.354433 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader"} */

  
    
    

    create  table
      "nfirs"."main"."nfirs_transformed_test_model__fdheader__dbt_tmp"
  
    as (
      

WITH source_fdheader AS (
    SELECT
        *
    FROM "nfirs"."nfirs_transformed"."fdheader"
),

final AS (
    SELECT
        *
    FROM source_fdheader
)

SELECT * FROM final
    );
  
  
[0m15:30:25.354433 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:30:25.354433 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader: ROLLBACK
[0m15:30:25.363569 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader'
[0m15:30:25.363569 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader: Close
[0m15:30:25.363569 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed_test_model__fdheader (models\nfirs_transformed\nfirs_transformed_test_model__fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 16:     FROM "nfirs"."nfirs_transformed"."fdheader"
                    ^
[0m15:30:25.372610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e420d4a1-6e0e-476b-b62c-81b01f8f78b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3220C3830>]}
[0m15:30:25.625718 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.nfirs_transformed_test_model__fdheader  [[31mERROR[0m in 0.09s]
[0m15:30:25.625718 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader
[0m15:30:25.633748 [debug] [MainThread]: Using duckdb connection "master"
[0m15:30:25.633748 [debug] [MainThread]: On master: BEGIN
[0m15:30:25.633748 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:25.670380 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:30:25.670380 [debug] [MainThread]: On master: COMMIT
[0m15:30:25.670380 [debug] [MainThread]: Using duckdb connection "master"
[0m15:30:25.670380 [debug] [MainThread]: On master: COMMIT
[0m15:30:25.670380 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:30:25.670380 [debug] [MainThread]: On master: Close
[0m15:30:25.673121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:25.673121 [debug] [MainThread]: Connection 'create_nfirs_main' was properly closed.
[0m15:30:25.673121 [debug] [MainThread]: Connection 'list_nfirs_main' was properly closed.
[0m15:30:25.673121 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed_test_model__fdheader' was properly closed.
[0m15:30:25.673121 [info ] [MainThread]: 
[0m15:30:25.673121 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m15:30:25.673121 [debug] [MainThread]: Command end result
[0m15:30:25.697807 [info ] [MainThread]: 
[0m15:30:25.697807 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:30:25.697807 [info ] [MainThread]: 
[0m15:30:25.697807 [error] [MainThread]:   Runtime Error in model nfirs_transformed_test_model__fdheader (models\nfirs_transformed\nfirs_transformed_test_model__fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 16:     FROM "nfirs"."nfirs_transformed"."fdheader"
                    ^
[0m15:30:25.697807 [info ] [MainThread]: 
[0m15:30:25.697807 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:30:25.697807 [debug] [MainThread]: Command `cli run` failed at 15:30:25.697807 after 1.17 seconds
[0m15:30:25.697807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B32278F080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B323B5E420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3226F3200>]}
[0m15:30:25.697807 [debug] [MainThread]: Flushing usage events
[0m15:32:22.292243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212C9A423F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212CC4A7D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212CC4A6DB0>]}


============================== 15:32:22.292243 | 530cbb2e-943a-452c-8f7d-7d90a5ffd0ab ==============================
[0m15:32:22.292243 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:32:22.292243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:32:22.443968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '530cbb2e-943a-452c-8f7d-7d90a5ffd0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212CDB24620>]}
[0m15:32:22.484654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '530cbb2e-943a-452c-8f7d-7d90a5ffd0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212CDB842C0>]}
[0m15:32:22.484654 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:32:22.484654 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:32:22.592610 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m15:32:22.592610 [debug] [MainThread]: Partial parsing: deleted file: nfirs_dbt_project_new://models\nfirs_transformed\nfirs_transformed_test_model__fdheader.sql
[0m15:32:22.666252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '530cbb2e-943a-452c-8f7d-7d90a5ffd0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212CDD3DAF0>]}
[0m15:32:22.736065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '530cbb2e-943a-452c-8f7d-7d90a5ffd0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212CDF0BB60>]}
[0m15:32:22.736065 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m15:32:22.736065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '530cbb2e-943a-452c-8f7d-7d90a5ffd0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212CDC80980>]}
[0m15:32:22.736065 [info ] [MainThread]: 
[0m15:32:22.736065 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:32:22.736065 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:32:22.793550 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:32:22.793550 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:32:22.793550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:22.817803 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:22.817803 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:32:22.820380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_main)
[0m15:32:22.820380 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "main"
"
[0m15:32:22.828494 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:32:22.828494 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:32:22.828494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:32:22.844976 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:22.853052 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:32:22.853052 [debug] [ThreadPool]: On create_nfirs_main: BEGIN
[0m15:32:22.853052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:22.853052 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:32:22.853052 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
    
        create schema if not exists "nfirs"."main"
    
[0m15:32:22.853052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:22.853052 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:32:22.853052 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:32:22.853052 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:32:22.853052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:22.853052 [debug] [ThreadPool]: On create_nfirs_main: Close
[0m15:32:22.861056 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main'
[0m15:32:22.869238 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:32:22.869238 [debug] [ThreadPool]: On list_nfirs_main: BEGIN
[0m15:32:22.869238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:32:22.885308 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:22.885308 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:32:22.885308 [debug] [ThreadPool]: On list_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'nfirs'
  
[0m15:32:22.920516 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:32:22.928628 [debug] [ThreadPool]: On list_nfirs_main: ROLLBACK
[0m15:32:22.929745 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main'
[0m15:32:22.930358 [debug] [ThreadPool]: On list_nfirs_main: Close
[0m15:32:22.932096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '530cbb2e-943a-452c-8f7d-7d90a5ffd0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212CDF0F560>]}
[0m15:32:22.932096 [debug] [MainThread]: Using duckdb connection "master"
[0m15:32:22.932096 [debug] [MainThread]: On master: BEGIN
[0m15:32:22.932096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:32:22.948507 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:32:22.948507 [debug] [MainThread]: On master: COMMIT
[0m15:32:22.948507 [debug] [MainThread]: Using duckdb connection "master"
[0m15:32:22.956443 [debug] [MainThread]: On master: COMMIT
[0m15:32:22.956443 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:32:22.956443 [debug] [MainThread]: On master: Close
[0m15:32:22.956443 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:32:22.956443 [info ] [MainThread]: 
[0m15:32:22.964649 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:32:22.964649 [info ] [Thread-1 (]: 1 of 1 START sql view model main.base_nfirs_transformed_fdheader ............... [RUN]
[0m15:32:22.964649 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader'
[0m15:32:22.964649 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:32:22.964649 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:32:22.972727 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:32:22.988728 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:32:22.996683 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:32:22.996683 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: BEGIN
[0m15:32:22.996683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:32:23.012887 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:32:23.012887 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:32:23.012887 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"} */

  
  create view "nfirs"."main"."base_nfirs_transformed_fdheader__dbt_tmp" as (
    with source as (
      select * from "nfirs"."nfirs_transformed"."fdheader"
),
renamed as (
    select
        count(*)
    from source
)
select * from renamed
  );

[0m15:32:23.036910 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"} */

  
  create view "nfirs"."main"."base_nfirs_transformed_fdheader__dbt_tmp" as (
    with source as (
      select * from "nfirs"."nfirs_transformed"."fdheader"
),
renamed as (
    select
        count(*)
    from source
)
select * from renamed
  );

[0m15:32:23.036910 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:32:23.036910 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: ROLLBACK
[0m15:32:23.045149 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader'
[0m15:32:23.045149 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: Close
[0m15:32:23.053250 [debug] [Thread-1 (]: Runtime Error in model base_nfirs_transformed_fdheader (models\nfirs_transformed\base_nfirs_transformed_fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 6:       select * from "nfirs"."nfirs_transformed"."fdheader"
                              ^
[0m15:32:23.053250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '530cbb2e-943a-452c-8f7d-7d90a5ffd0ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212CC01B7A0>]}
[0m15:32:23.053250 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.base_nfirs_transformed_fdheader ...... [[31mERROR[0m in 0.09s]
[0m15:32:23.053250 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:32:23.053250 [debug] [MainThread]: Using duckdb connection "master"
[0m15:32:23.053250 [debug] [MainThread]: On master: BEGIN
[0m15:32:23.053250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:32:23.076590 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:32:23.076590 [debug] [MainThread]: On master: COMMIT
[0m15:32:23.076590 [debug] [MainThread]: Using duckdb connection "master"
[0m15:32:23.076590 [debug] [MainThread]: On master: COMMIT
[0m15:32:23.076590 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:32:23.076590 [debug] [MainThread]: On master: Close
[0m15:32:23.076590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:32:23.076590 [debug] [MainThread]: Connection 'create_nfirs_main' was properly closed.
[0m15:32:23.084846 [debug] [MainThread]: Connection 'list_nfirs_main' was properly closed.
[0m15:32:23.084846 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader' was properly closed.
[0m15:32:23.084846 [info ] [MainThread]: 
[0m15:32:23.084846 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:32:23.084846 [debug] [MainThread]: Command end result
[0m15:32:23.100848 [info ] [MainThread]: 
[0m15:32:23.100848 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:32:23.100848 [info ] [MainThread]: 
[0m15:32:23.100848 [error] [MainThread]:   Runtime Error in model base_nfirs_transformed_fdheader (models\nfirs_transformed\base_nfirs_transformed_fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 6:       select * from "nfirs"."nfirs_transformed"."fdheader"
                              ^
[0m15:32:23.100848 [info ] [MainThread]: 
[0m15:32:23.100848 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:32:23.100848 [debug] [MainThread]: Command `cli run` failed at 15:32:23.100848 after 0.92 seconds
[0m15:32:23.100848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212C9A423F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212CBFAE480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212CBFAED20>]}
[0m15:32:23.100848 [debug] [MainThread]: Flushing usage events
[0m15:36:39.065885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C8268BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C5D078C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C826B530>]}


============================== 15:36:39.065885 | 6809cd16-8f86-4b82-b14f-0f7c8ff194ab ==============================
[0m15:36:39.065885 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:36:39.081552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:36:39.230799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6809cd16-8f86-4b82-b14f-0f7c8ff194ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C6DB6D80>]}
[0m15:36:39.281187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6809cd16-8f86-4b82-b14f-0f7c8ff194ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C84726C0>]}
[0m15:36:39.282291 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:36:39.282291 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:36:39.382895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:36:39.382895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:36:39.416968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6809cd16-8f86-4b82-b14f-0f7c8ff194ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C862D8E0>]}
[0m15:36:39.482066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6809cd16-8f86-4b82-b14f-0f7c8ff194ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C86E6F60>]}
[0m15:36:39.482066 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m15:36:39.482066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6809cd16-8f86-4b82-b14f-0f7c8ff194ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C862FFB0>]}
[0m15:36:39.482066 [info ] [MainThread]: 
[0m15:36:39.497816 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:36:39.498955 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:36:39.550466 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:36:39.550466 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:36:39.550466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:39.581757 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:36:39.582968 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:36:39.582968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_main)
[0m15:36:39.582968 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "main"
"
[0m15:36:39.582968 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:36:39.582968 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:36:39.582968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:39.615020 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:36:39.616076 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:36:39.616885 [debug] [ThreadPool]: On create_nfirs_main: BEGIN
[0m15:36:39.617465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:36:39.617465 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:36:39.617465 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
    
        create schema if not exists "nfirs"."main"
    
[0m15:36:39.617465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:36:39.617465 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:36:39.617465 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:36:39.617465 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:36:39.617465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:36:39.617465 [debug] [ThreadPool]: On create_nfirs_main: Close
[0m15:36:39.617465 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main'
[0m15:36:39.632607 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:36:39.632607 [debug] [ThreadPool]: On list_nfirs_main: BEGIN
[0m15:36:39.632607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:39.651310 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:36:39.651310 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:36:39.651310 [debug] [ThreadPool]: On list_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'nfirs'
  
[0m15:36:39.667273 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:36:39.681410 [debug] [ThreadPool]: On list_nfirs_main: ROLLBACK
[0m15:36:39.681410 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main'
[0m15:36:39.681410 [debug] [ThreadPool]: On list_nfirs_main: Close
[0m15:36:39.681410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6809cd16-8f86-4b82-b14f-0f7c8ff194ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C8713320>]}
[0m15:36:39.681410 [debug] [MainThread]: Using duckdb connection "master"
[0m15:36:39.681410 [debug] [MainThread]: On master: BEGIN
[0m15:36:39.681410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:36:39.703586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:36:39.703586 [debug] [MainThread]: On master: COMMIT
[0m15:36:39.703586 [debug] [MainThread]: Using duckdb connection "master"
[0m15:36:39.703586 [debug] [MainThread]: On master: COMMIT
[0m15:36:39.703586 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:36:39.703586 [debug] [MainThread]: On master: Close
[0m15:36:39.717209 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:36:39.717209 [info ] [MainThread]: 
[0m15:36:39.719313 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:36:39.719313 [info ] [Thread-1 (]: 1 of 1 START sql view model main.base_nfirs_transformed_fdheader ............... [RUN]
[0m15:36:39.719313 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader'
[0m15:36:39.719313 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:36:39.723764 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:36:39.723764 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:36:39.749511 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:36:39.749511 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:36:39.749511 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: BEGIN
[0m15:36:39.749511 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:36:39.767484 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:36:39.767484 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:36:39.767484 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"} */

  
  create view "nfirs"."main"."base_nfirs_transformed_fdheader__dbt_tmp" as (
    with source as (
      select * from "nfirs"."nfirs_transformed"."fdheader"
),
renamed as (
    select
        count(*)
    from source
)
select * from renamed
  );

[0m15:36:39.798599 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"} */

  
  create view "nfirs"."main"."base_nfirs_transformed_fdheader__dbt_tmp" as (
    with source as (
      select * from "nfirs"."nfirs_transformed"."fdheader"
),
renamed as (
    select
        count(*)
    from source
)
select * from renamed
  );

[0m15:36:39.798599 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:36:39.799672 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: ROLLBACK
[0m15:36:39.799672 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader'
[0m15:36:39.799672 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: Close
[0m15:36:39.799672 [debug] [Thread-1 (]: Runtime Error in model base_nfirs_transformed_fdheader (models\nfirs_transformed\base_nfirs_transformed_fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 6:       select * from "nfirs"."nfirs_transformed"."fdheader"
                              ^
[0m15:36:39.799672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6809cd16-8f86-4b82-b14f-0f7c8ff194ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C6913770>]}
[0m15:36:39.799672 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.base_nfirs_transformed_fdheader ...... [[31mERROR[0m in 0.08s]
[0m15:36:39.799672 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:36:39.815960 [debug] [MainThread]: Using duckdb connection "master"
[0m15:36:39.815960 [debug] [MainThread]: On master: BEGIN
[0m15:36:39.815960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:36:39.833670 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:36:39.834724 [debug] [MainThread]: On master: COMMIT
[0m15:36:39.834724 [debug] [MainThread]: Using duckdb connection "master"
[0m15:36:39.834724 [debug] [MainThread]: On master: COMMIT
[0m15:36:39.835820 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:36:39.835820 [debug] [MainThread]: On master: Close
[0m15:36:39.837520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:39.837520 [debug] [MainThread]: Connection 'create_nfirs_main' was properly closed.
[0m15:36:39.837520 [debug] [MainThread]: Connection 'list_nfirs_main' was properly closed.
[0m15:36:39.837520 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader' was properly closed.
[0m15:36:39.837520 [info ] [MainThread]: 
[0m15:36:39.837520 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m15:36:39.837520 [debug] [MainThread]: Command end result
[0m15:36:39.859831 [info ] [MainThread]: 
[0m15:36:39.859831 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:36:39.859831 [info ] [MainThread]: 
[0m15:36:39.859831 [error] [MainThread]:   Runtime Error in model base_nfirs_transformed_fdheader (models\nfirs_transformed\base_nfirs_transformed_fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 6:       select * from "nfirs"."nfirs_transformed"."fdheader"
                              ^
[0m15:36:39.859831 [info ] [MainThread]: 
[0m15:36:39.859831 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:36:39.859831 [debug] [MainThread]: Command `cli run` failed at 15:36:39.859831 after 0.90 seconds
[0m15:36:39.859831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C5D078C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C8298500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C6EF8A40>]}
[0m15:36:39.859831 [debug] [MainThread]: Flushing usage events
[0m15:37:40.941170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022466E47290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022466E46330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022466E46EA0>]}


============================== 15:37:40.949178 | fc0128e2-ee1a-426b-90bd-d01362f34aee ==============================
[0m15:37:40.949178 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:37:40.950537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:37:41.101095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc0128e2-ee1a-426b-90bd-d01362f34aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224661947A0>]}
[0m15:37:41.134346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc0128e2-ee1a-426b-90bd-d01362f34aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224689B41D0>]}
[0m15:37:41.134346 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:37:41.151070 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:37:41.251292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:37:41.251292 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:37:41.284377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc0128e2-ee1a-426b-90bd-d01362f34aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224689E6F90>]}
[0m15:37:41.367383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc0128e2-ee1a-426b-90bd-d01362f34aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022468C5E600>]}
[0m15:37:41.367383 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m15:37:41.367383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc0128e2-ee1a-426b-90bd-d01362f34aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022468DD27B0>]}
[0m15:37:41.367383 [info ] [MainThread]: 
[0m15:37:41.367383 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:37:41.367383 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:37:41.435936 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:37:41.435936 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:37:41.435936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:41.452087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:37:41.452087 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:37:41.452087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_main)
[0m15:37:41.452087 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "main"
"
[0m15:37:41.467645 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:37:41.467645 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:37:41.467645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:41.484202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:37:41.484202 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:37:41.484202 [debug] [ThreadPool]: On create_nfirs_main: BEGIN
[0m15:37:41.484202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:37:41.484202 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:37:41.484202 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
    
        create schema if not exists "nfirs"."main"
    
[0m15:37:41.484202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:37:41.484202 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:37:41.484202 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:37:41.484202 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:37:41.484202 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:37:41.484202 [debug] [ThreadPool]: On create_nfirs_main: Close
[0m15:37:41.500931 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main'
[0m15:37:41.500931 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:37:41.500931 [debug] [ThreadPool]: On list_nfirs_main: BEGIN
[0m15:37:41.500931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:41.517547 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:37:41.517547 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:37:41.533948 [debug] [ThreadPool]: On list_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'nfirs'
  
[0m15:37:41.555024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:37:41.555024 [debug] [ThreadPool]: On list_nfirs_main: ROLLBACK
[0m15:37:41.555024 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main'
[0m15:37:41.555024 [debug] [ThreadPool]: On list_nfirs_main: Close
[0m15:37:41.567421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc0128e2-ee1a-426b-90bd-d01362f34aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002246898C8F0>]}
[0m15:37:41.567421 [debug] [MainThread]: Using duckdb connection "master"
[0m15:37:41.567421 [debug] [MainThread]: On master: BEGIN
[0m15:37:41.567421 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:41.584282 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:37:41.584282 [debug] [MainThread]: On master: COMMIT
[0m15:37:41.584282 [debug] [MainThread]: Using duckdb connection "master"
[0m15:37:41.584282 [debug] [MainThread]: On master: COMMIT
[0m15:37:41.584282 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:37:41.584282 [debug] [MainThread]: On master: Close
[0m15:37:41.584282 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:37:41.584282 [info ] [MainThread]: 
[0m15:37:41.601006 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:37:41.601006 [info ] [Thread-1 (]: 1 of 1 START sql view model main.base_nfirs_transformed_fdheader ............... [RUN]
[0m15:37:41.601006 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader'
[0m15:37:41.601006 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:37:41.604223 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:37:41.604223 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:37:41.621636 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:37:41.633594 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:37:41.633594 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: BEGIN
[0m15:37:41.633594 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:37:41.650322 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:37:41.650322 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:37:41.650322 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"} */

  
  create view "nfirs"."main"."base_nfirs_transformed_fdheader__dbt_tmp" as (
    with source as (
      select * from "nfirs"."nfirs_transformed"."fdheader"
),
renamed as (
    select
        count(*)
    from source
)
select * from renamed
  );

[0m15:37:41.667519 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"} */

  
  create view "nfirs"."main"."base_nfirs_transformed_fdheader__dbt_tmp" as (
    with source as (
      select * from "nfirs"."nfirs_transformed"."fdheader"
),
renamed as (
    select
        count(*)
    from source
)
select * from renamed
  );

[0m15:37:41.667519 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:37:41.667519 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: ROLLBACK
[0m15:37:41.684098 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader'
[0m15:37:41.684098 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: Close
[0m15:37:41.684098 [debug] [Thread-1 (]: Runtime Error in model base_nfirs_transformed_fdheader (models\nfirs_transformed\base_nfirs_transformed_fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 6:       select * from "nfirs"."nfirs_transformed"."fdheader"
                              ^
[0m15:37:41.684098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc0128e2-ee1a-426b-90bd-d01362f34aee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022466E47710>]}
[0m15:37:41.684098 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.base_nfirs_transformed_fdheader ...... [[31mERROR[0m in 0.08s]
[0m15:37:41.684098 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:37:41.684098 [debug] [MainThread]: Using duckdb connection "master"
[0m15:37:41.684098 [debug] [MainThread]: On master: BEGIN
[0m15:37:41.684098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:37:41.708211 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:37:41.708211 [debug] [MainThread]: On master: COMMIT
[0m15:37:41.708211 [debug] [MainThread]: Using duckdb connection "master"
[0m15:37:41.708211 [debug] [MainThread]: On master: COMMIT
[0m15:37:41.708211 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:37:41.708211 [debug] [MainThread]: On master: Close
[0m15:37:41.716923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:41.716923 [debug] [MainThread]: Connection 'create_nfirs_main' was properly closed.
[0m15:37:41.721161 [debug] [MainThread]: Connection 'list_nfirs_main' was properly closed.
[0m15:37:41.721161 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader' was properly closed.
[0m15:37:41.721161 [info ] [MainThread]: 
[0m15:37:41.721161 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:37:41.721161 [debug] [MainThread]: Command end result
[0m15:37:41.736233 [info ] [MainThread]: 
[0m15:37:41.736233 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:37:41.742058 [info ] [MainThread]: 
[0m15:37:41.742058 [error] [MainThread]:   Runtime Error in model base_nfirs_transformed_fdheader (models\nfirs_transformed\base_nfirs_transformed_fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 6:       select * from "nfirs"."nfirs_transformed"."fdheader"
                              ^
[0m15:37:41.742058 [info ] [MainThread]: 
[0m15:37:41.742058 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:37:41.742058 [debug] [MainThread]: Command `cli run` failed at 15:37:41.742058 after 0.91 seconds
[0m15:37:41.742058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022466C26480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022466E7BB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022469113650>]}
[0m15:37:41.742058 [debug] [MainThread]: Flushing usage events
[0m15:37:59.803998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225AFDCBE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225B1868830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225B1868740>]}


============================== 15:37:59.819657 | 1796bae0-97ef-440c-9864-747f8530e9ea ==============================
[0m15:37:59.819657 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:37:59.819657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:37:59.958072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1796bae0-97ef-440c-9864-747f8530e9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225B1A6F980>]}
[0m15:38:00.004938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1796bae0-97ef-440c-9864-747f8530e9ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225B1A94140>]}
[0m15:38:00.004938 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:38:00.004938 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:38:00.107446 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:38:00.107446 [debug] [MainThread]: Partial parsing: updated file: nfirs_dbt_project_new://models\nfirs_transformed\base_nfirs_transformed_fdheader.sql
[0m15:38:00.234761 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader' (models\nfirs_transformed\base_nfirs_transformed_fdheader.sql) depends on a source named 'nfirs_raw.fdheader' which was not found
[0m15:38:00.234761 [debug] [MainThread]: Command `cli run` failed at 15:38:00.234761 after 0.53 seconds
[0m15:38:00.234761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225B0319580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225B1DD9D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225B1EDF740>]}
[0m15:38:00.242368 [debug] [MainThread]: Flushing usage events
[0m15:38:12.037727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947783F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294782CECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294782CF740>]}


============================== 15:38:12.037727 | c8677078-768c-4986-a262-a9feb2c78882 ==============================
[0m15:38:12.037727 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:38:12.037727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:38:12.187533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8677078-768c-4986-a262-a9feb2c78882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947A610AA0>]}
[0m15:38:12.237442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8677078-768c-4986-a262-a9feb2c78882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947A4E4560>]}
[0m15:38:12.237442 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:38:12.237442 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:38:12.337466 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:38:12.337466 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:38:12.370790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8677078-768c-4986-a262-a9feb2c78882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947A6E2B70>]}
[0m15:38:12.437514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8677078-768c-4986-a262-a9feb2c78882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947A92CC20>]}
[0m15:38:12.437514 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m15:38:12.437514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8677078-768c-4986-a262-a9feb2c78882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294789E25A0>]}
[0m15:38:12.437514 [info ] [MainThread]: 
[0m15:38:12.437514 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:38:12.437514 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:38:12.505885 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:38:12.505885 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:38:12.505885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:12.520933 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:38:12.520933 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:38:12.537405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_main)
[0m15:38:12.537405 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "main"
"
[0m15:38:12.537405 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:38:12.537405 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:38:12.537405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:12.554144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:38:12.554144 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:38:12.554144 [debug] [ThreadPool]: On create_nfirs_main: BEGIN
[0m15:38:12.554144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:38:12.554144 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:38:12.554144 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
    
        create schema if not exists "nfirs"."main"
    
[0m15:38:12.554144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:38:12.554144 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:38:12.554144 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:38:12.554144 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:38:12.554144 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:38:12.554144 [debug] [ThreadPool]: On create_nfirs_main: Close
[0m15:38:12.570708 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main'
[0m15:38:12.570708 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:38:12.570708 [debug] [ThreadPool]: On list_nfirs_main: BEGIN
[0m15:38:12.570708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:12.587412 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:38:12.587412 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:38:12.587412 [debug] [ThreadPool]: On list_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'nfirs'
  
[0m15:38:12.620864 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:38:12.620864 [debug] [ThreadPool]: On list_nfirs_main: ROLLBACK
[0m15:38:12.620864 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main'
[0m15:38:12.620864 [debug] [ThreadPool]: On list_nfirs_main: Close
[0m15:38:12.620864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8677078-768c-4986-a262-a9feb2c78882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029477EA8A10>]}
[0m15:38:12.636862 [debug] [MainThread]: Using duckdb connection "master"
[0m15:38:12.636862 [debug] [MainThread]: On master: BEGIN
[0m15:38:12.637549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:38:12.653936 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:38:12.653936 [debug] [MainThread]: On master: COMMIT
[0m15:38:12.653936 [debug] [MainThread]: Using duckdb connection "master"
[0m15:38:12.653936 [debug] [MainThread]: On master: COMMIT
[0m15:38:12.653936 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:38:12.653936 [debug] [MainThread]: On master: Close
[0m15:38:12.653936 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:38:12.653936 [info ] [MainThread]: 
[0m15:38:12.653936 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:38:12.653936 [info ] [Thread-1 (]: 1 of 1 START sql view model main.base_nfirs_transformed_fdheader ............... [RUN]
[0m15:38:12.653936 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader'
[0m15:38:12.653936 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:38:12.670604 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:38:12.670604 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:38:12.689899 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:38:12.689899 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:38:12.689899 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: BEGIN
[0m15:38:12.689899 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:38:12.705794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:38:12.705794 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:38:12.705794 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"} */

  
  create view "nfirs"."main"."base_nfirs_transformed_fdheader__dbt_tmp" as (
    with source as (
      select * from "nfirs"."nfirs_transformed"."fdheader"
),
renamed as (
    select
        count(*)
    from source
)
select * from renamed
  );

[0m15:38:12.738521 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"} */

  
  create view "nfirs"."main"."base_nfirs_transformed_fdheader__dbt_tmp" as (
    with source as (
      select * from "nfirs"."nfirs_transformed"."fdheader"
),
renamed as (
    select
        count(*)
    from source
)
select * from renamed
  );

[0m15:38:12.738521 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:38:12.738521 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: ROLLBACK
[0m15:38:12.738521 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader'
[0m15:38:12.738521 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: Close
[0m15:38:12.754101 [debug] [Thread-1 (]: Runtime Error in model base_nfirs_transformed_fdheader (models\nfirs_transformed\base_nfirs_transformed_fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 6:       select * from "nfirs"."nfirs_transformed"."fdheader"
                              ^
[0m15:38:12.754101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8677078-768c-4986-a262-a9feb2c78882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947BD2A780>]}
[0m15:38:12.754101 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.base_nfirs_transformed_fdheader ...... [[31mERROR[0m in 0.10s]
[0m15:38:12.754101 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:38:12.754101 [debug] [MainThread]: Using duckdb connection "master"
[0m15:38:12.754101 [debug] [MainThread]: On master: BEGIN
[0m15:38:12.754101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:38:12.770697 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:38:12.770697 [debug] [MainThread]: On master: COMMIT
[0m15:38:12.778859 [debug] [MainThread]: Using duckdb connection "master"
[0m15:38:12.778859 [debug] [MainThread]: On master: COMMIT
[0m15:38:12.778859 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:38:12.778859 [debug] [MainThread]: On master: Close
[0m15:38:12.778859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:12.778859 [debug] [MainThread]: Connection 'create_nfirs_main' was properly closed.
[0m15:38:12.778859 [debug] [MainThread]: Connection 'list_nfirs_main' was properly closed.
[0m15:38:12.778859 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader' was properly closed.
[0m15:38:12.778859 [info ] [MainThread]: 
[0m15:38:12.778859 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m15:38:12.778859 [debug] [MainThread]: Command end result
[0m15:38:12.800328 [info ] [MainThread]: 
[0m15:38:12.803448 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:38:12.803448 [info ] [MainThread]: 
[0m15:38:12.803448 [error] [MainThread]:   Runtime Error in model base_nfirs_transformed_fdheader (models\nfirs_transformed\base_nfirs_transformed_fdheader.sql)
  Catalog Error: Table with name fdheader does not exist!
  Did you mean "nfirs_raw.fdheader"?
  LINE 6:       select * from "nfirs"."nfirs_transformed"."fdheader"
                              ^
[0m15:38:12.803448 [info ] [MainThread]: 
[0m15:38:12.803448 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:38:12.803448 [debug] [MainThread]: Command `cli run` failed at 15:38:12.803448 after 0.87 seconds
[0m15:38:12.803448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947783F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294790A7B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294790A6DE0>]}
[0m15:38:12.803448 [debug] [MainThread]: Flushing usage events
[0m15:39:18.658745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4303AF770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A432E8F590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A432E8CAD0>]}


============================== 15:39:18.674411 | dab1d4db-bb31-4f76-a09d-0092df9e7db0 ==============================
[0m15:39:18.674411 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:39:18.675589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:39:18.825470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dab1d4db-bb31-4f76-a09d-0092df9e7db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A432EB9E20>]}
[0m15:39:18.858971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dab1d4db-bb31-4f76-a09d-0092df9e7db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A43309FF80>]}
[0m15:39:18.858971 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:39:18.875411 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:39:18.975430 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:39:18.975430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:39:19.009039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dab1d4db-bb31-4f76-a09d-0092df9e7db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A43310F680>]}
[0m15:39:19.075573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dab1d4db-bb31-4f76-a09d-0092df9e7db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4335025A0>]}
[0m15:39:19.075573 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m15:39:19.075573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab1d4db-bb31-4f76-a09d-0092df9e7db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A432E37710>]}
[0m15:39:19.075573 [info ] [MainThread]: 
[0m15:39:19.075573 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:39:19.075573 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:39:19.144017 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:39:19.144017 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:39:19.144017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:19.158845 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:39:19.158845 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:39:19.175341 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_main)
[0m15:39:19.175341 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "main"
"
[0m15:39:19.175341 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:39:19.175341 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:39:19.175341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:19.192294 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:39:19.192294 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:39:19.192294 [debug] [ThreadPool]: On create_nfirs_main: BEGIN
[0m15:39:19.192294 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:39:19.192294 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:39:19.192294 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
    
        create schema if not exists "nfirs"."main"
    
[0m15:39:19.192294 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:39:19.192294 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:39:19.192294 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:39:19.208294 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:39:19.208749 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:39:19.208749 [debug] [ThreadPool]: On create_nfirs_main: Close
[0m15:39:19.208749 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main'
[0m15:39:19.225481 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:39:19.225481 [debug] [ThreadPool]: On list_nfirs_main: BEGIN
[0m15:39:19.225481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:19.242376 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:39:19.242376 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:39:19.242376 [debug] [ThreadPool]: On list_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'nfirs'
  
[0m15:39:19.258723 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:39:19.275262 [debug] [ThreadPool]: On list_nfirs_main: ROLLBACK
[0m15:39:19.275262 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main'
[0m15:39:19.275262 [debug] [ThreadPool]: On list_nfirs_main: Close
[0m15:39:19.275262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab1d4db-bb31-4f76-a09d-0092df9e7db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4334445C0>]}
[0m15:39:19.275262 [debug] [MainThread]: Using duckdb connection "master"
[0m15:39:19.275262 [debug] [MainThread]: On master: BEGIN
[0m15:39:19.275262 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:19.292120 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:39:19.292120 [debug] [MainThread]: On master: COMMIT
[0m15:39:19.292120 [debug] [MainThread]: Using duckdb connection "master"
[0m15:39:19.292120 [debug] [MainThread]: On master: COMMIT
[0m15:39:19.292120 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:39:19.292120 [debug] [MainThread]: On master: Close
[0m15:39:19.308617 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:39:19.308617 [info ] [MainThread]: 
[0m15:39:19.308617 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:39:19.308617 [info ] [Thread-1 (]: 1 of 1 START sql view model main.base_nfirs_transformed_fdheader ............... [RUN]
[0m15:39:19.324275 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader'
[0m15:39:19.324778 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:39:19.334075 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:39:19.334075 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:39:19.360825 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:39:19.360825 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:39:19.360825 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: BEGIN
[0m15:39:19.360825 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:39:19.375801 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:39:19.375801 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"
[0m15:39:19.375801 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"} */

  
  create view "nfirs"."main"."base_nfirs_transformed_fdheader__dbt_tmp" as (
    with source as (
      select * from "nfirs.duckdb"."nfirs_transformed"."fdheader"
),
renamed as (
    select
        count(*)
    from source
)
select * from renamed
  );

[0m15:39:19.375801 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader"} */

  
  create view "nfirs"."main"."base_nfirs_transformed_fdheader__dbt_tmp" as (
    with source as (
      select * from "nfirs.duckdb"."nfirs_transformed"."fdheader"
),
renamed as (
    select
        count(*)
    from source
)
select * from renamed
  );

[0m15:39:19.375801 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:39:19.375801 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: ROLLBACK
[0m15:39:19.391626 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader'
[0m15:39:19.391626 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader: Close
[0m15:39:19.399702 [debug] [Thread-1 (]: Runtime Error in model base_nfirs_transformed_fdheader (models\nfirs_transformed\base_nfirs_transformed_fdheader.sql)
  Binder Error: Catalog "nfirs.duckdb" does not exist!
[0m15:39:19.399702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab1d4db-bb31-4f76-a09d-0092df9e7db0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A431547800>]}
[0m15:39:19.399702 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.base_nfirs_transformed_fdheader ...... [[31mERROR[0m in 0.09s]
[0m15:39:19.399702 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader
[0m15:39:19.399702 [debug] [MainThread]: Using duckdb connection "master"
[0m15:39:19.399702 [debug] [MainThread]: On master: BEGIN
[0m15:39:19.399702 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:19.416253 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:39:19.424610 [debug] [MainThread]: On master: COMMIT
[0m15:39:19.424738 [debug] [MainThread]: Using duckdb connection "master"
[0m15:39:19.424738 [debug] [MainThread]: On master: COMMIT
[0m15:39:19.424738 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:39:19.424738 [debug] [MainThread]: On master: Close
[0m15:39:19.429054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:19.429054 [debug] [MainThread]: Connection 'create_nfirs_main' was properly closed.
[0m15:39:19.429054 [debug] [MainThread]: Connection 'list_nfirs_main' was properly closed.
[0m15:39:19.429054 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader' was properly closed.
[0m15:39:19.429054 [info ] [MainThread]: 
[0m15:39:19.429054 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:39:19.429054 [debug] [MainThread]: Command end result
[0m15:39:19.444940 [info ] [MainThread]: 
[0m15:39:19.452973 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:39:19.453124 [info ] [MainThread]: 
[0m15:39:19.453124 [error] [MainThread]:   Runtime Error in model base_nfirs_transformed_fdheader (models\nfirs_transformed\base_nfirs_transformed_fdheader.sql)
  Binder Error: Catalog "nfirs.duckdb" does not exist!
[0m15:39:19.453124 [info ] [MainThread]: 
[0m15:39:19.453124 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:39:19.453124 [debug] [MainThread]: Command `cli run` failed at 15:39:19.453124 after 0.89 seconds
[0m15:39:19.453124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4334F7DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A43337BAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A43386D1F0>]}
[0m15:39:19.453124 [debug] [MainThread]: Flushing usage events
[0m15:41:22.740351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028319B0BA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283187A74A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028317EED400>]}


============================== 15:41:22.740351 | 11f4c30a-9952-4fe3-8284-5ecacc776aa1 ==============================
[0m15:41:22.740351 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:41:22.740351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:41:22.905354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11f4c30a-9952-4fe3-8284-5ecacc776aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028319EDFAD0>]}
[0m15:41:22.938526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11f4c30a-9952-4fe3-8284-5ecacc776aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028317540890>]}
[0m15:41:22.938526 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:41:22.938526 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:41:23.055486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:41:23.055486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:41:23.073044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11f4c30a-9952-4fe3-8284-5ecacc776aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028319B0BF50>]}
[0m15:41:23.155069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11f4c30a-9952-4fe3-8284-5ecacc776aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028319F96750>]}
[0m15:41:23.155069 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m15:41:23.155069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11f4c30a-9952-4fe3-8284-5ecacc776aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002831A049850>]}
[0m15:41:23.155069 [info ] [MainThread]: 
[0m15:41:23.155069 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:41:23.155069 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:41:23.209309 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:41:23.209309 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:41:23.238982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:23.271668 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:41:23.271668 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:41:23.271668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_main)
[0m15:41:23.271668 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "main"
"
[0m15:41:23.271668 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:41:23.271668 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:41:23.271668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:23.288499 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:41:23.288499 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:41:23.288499 [debug] [ThreadPool]: On create_nfirs_main: BEGIN
[0m15:41:23.304694 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:41:23.305048 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:41:23.305048 [debug] [ThreadPool]: On create_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main"} */

    
    
        create schema if not exists "nfirs"."main"
    
[0m15:41:23.305048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:41:23.305048 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:41:23.305048 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main"
[0m15:41:23.305048 [debug] [ThreadPool]: On create_nfirs_main: COMMIT
[0m15:41:23.305048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:41:23.305048 [debug] [ThreadPool]: On create_nfirs_main: Close
[0m15:41:23.309562 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main'
[0m15:41:23.321166 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:41:23.321166 [debug] [ThreadPool]: On list_nfirs_main: BEGIN
[0m15:41:23.321166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:23.337265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:41:23.337265 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:41:23.337265 [debug] [ThreadPool]: On list_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'nfirs'
  
[0m15:41:23.355158 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:41:23.371376 [debug] [ThreadPool]: On list_nfirs_main: ROLLBACK
[0m15:41:23.371376 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main'
[0m15:41:23.371376 [debug] [ThreadPool]: On list_nfirs_main: Close
[0m15:41:23.371376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11f4c30a-9952-4fe3-8284-5ecacc776aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028319FDE720>]}
[0m15:41:23.371376 [debug] [MainThread]: Using duckdb connection "master"
[0m15:41:23.371376 [debug] [MainThread]: On master: BEGIN
[0m15:41:23.371376 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:23.388688 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:41:23.388688 [debug] [MainThread]: On master: COMMIT
[0m15:41:23.388688 [debug] [MainThread]: Using duckdb connection "master"
[0m15:41:23.388688 [debug] [MainThread]: On master: COMMIT
[0m15:41:23.388688 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:41:23.388688 [debug] [MainThread]: On master: Close
[0m15:41:23.405160 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:41:23.405160 [info ] [MainThread]: 
[0m15:41:23.409707 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m15:41:23.409707 [info ] [Thread-1 (]: 1 of 1 START sql view model main.base_nfirs_transformed_fdheader_transformed ... [RUN]
[0m15:41:23.409707 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed'
[0m15:41:23.409707 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m15:41:23.412648 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:41:23.421605 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m15:41:23.440036 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:41:23.489628 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:41:23.489628 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: BEGIN
[0m15:41:23.489628 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:41:23.509855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:41:23.509855 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:41:23.509855 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */

  
  create view "nfirs"."main"."base_nfirs_transformed_fdheader_transformed__dbt_tmp" as (
    with source as (
      select * from "nfirs"."nfirs_transformed"."fdheader_transformed"
),
renamed as (
    select
        count(*)

    from source
)
select * from renamed
  );

[0m15:41:23.509855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:41:23.509855 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:41:23.509855 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */
alter view "nfirs"."main"."base_nfirs_transformed_fdheader_transformed__dbt_tmp" rename to "base_nfirs_transformed_fdheader_transformed"
[0m15:41:23.509855 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:41:23.521765 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: COMMIT
[0m15:41:23.521765 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:41:23.521765 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: COMMIT
[0m15:41:23.538110 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:41:23.555213 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:41:23.555213 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */
drop view if exists "nfirs"."main"."base_nfirs_transformed_fdheader_transformed__dbt_backup" cascade
[0m15:41:23.555213 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:41:23.555213 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: Close
[0m15:41:24.804659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f4c30a-9952-4fe3-8284-5ecacc776aa1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002831750B860>]}
[0m15:41:24.804659 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.base_nfirs_transformed_fdheader_transformed  [[32mOK[0m in 1.39s]
[0m15:41:24.804659 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m15:41:24.812212 [debug] [MainThread]: Using duckdb connection "master"
[0m15:41:24.812212 [debug] [MainThread]: On master: BEGIN
[0m15:41:24.812212 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:41:24.830627 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:41:24.830627 [debug] [MainThread]: On master: COMMIT
[0m15:41:24.830627 [debug] [MainThread]: Using duckdb connection "master"
[0m15:41:24.830627 [debug] [MainThread]: On master: COMMIT
[0m15:41:24.830627 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:41:24.830627 [debug] [MainThread]: On master: Close
[0m15:41:24.837332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:24.837332 [debug] [MainThread]: Connection 'create_nfirs_main' was properly closed.
[0m15:41:24.837332 [debug] [MainThread]: Connection 'list_nfirs_main' was properly closed.
[0m15:41:24.837332 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed' was properly closed.
[0m15:41:24.837332 [info ] [MainThread]: 
[0m15:41:24.837332 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m15:41:24.841921 [debug] [MainThread]: Command end result
[0m15:41:24.856644 [info ] [MainThread]: 
[0m15:41:24.856644 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:41:24.860463 [info ] [MainThread]: 
[0m15:41:24.860463 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:41:24.860463 [debug] [MainThread]: Command `cli run` succeeded at 15:41:24.860463 after 2.23 seconds
[0m15:41:24.860463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283180C3800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002831793EBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028319CBDDC0>]}
[0m15:41:24.860463 [debug] [MainThread]: Flushing usage events
[0m15:56:21.869864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A9B75EFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A9CD6B2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A9D10C9E0>]}


============================== 15:56:21.869864 | 8a66afcb-5164-40d8-851d-1637edc2842d ==============================
[0m15:56:21.869864 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:56:21.869864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:56:22.029702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a66afcb-5164-40d8-851d-1637edc2842d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A9D423230>]}
[0m15:56:22.068959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a66afcb-5164-40d8-851d-1637edc2842d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A9D423F50>]}
[0m15:56:22.069915 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:56:22.074963 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:56:22.174950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:56:22.174950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:56:22.204914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a66afcb-5164-40d8-851d-1637edc2842d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A9D4E6330>]}
[0m15:56:22.283919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a66afcb-5164-40d8-851d-1637edc2842d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A9D30CE90>]}
[0m15:56:22.284911 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m15:56:22.284911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a66afcb-5164-40d8-851d-1637edc2842d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A9D4FE9F0>]}
[0m15:56:22.286911 [info ] [MainThread]: 
[0m15:56:22.286911 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:56:22.287921 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:56:22.347190 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:56:22.347190 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:56:22.348191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:22.442981 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:56:22.442981 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m15:56:22.443981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:22.444981 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m15:56:22.444981 [info ] [MainThread]: 
[0m15:56:22.444981 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m15:56:22.445981 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 24228)
[0m15:56:22.446981 [debug] [MainThread]: Command `cli run` failed at 15:56:22.445981 after 0.68 seconds
[0m15:56:22.446981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A9B382D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A9D6D6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A9D4E7F50>]}
[0m15:56:22.446981 [debug] [MainThread]: Flushing usage events
[0m15:56:44.559634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3FB10BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3FB11D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3FB13230>]}


============================== 15:56:44.559634 | 4566e775-928f-4c46-95fc-a7ed3943a9c1 ==============================
[0m15:56:44.559634 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:56:44.559634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:56:44.711600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4566e775-928f-4c46-95fc-a7ed3943a9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3F686180>]}
[0m15:56:44.745520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4566e775-928f-4c46-95fc-a7ed3943a9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3FBA3B30>]}
[0m15:56:44.745520 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:56:44.755941 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:56:44.857167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:56:44.857167 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:56:44.880837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4566e775-928f-4c46-95fc-a7ed3943a9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3FB10BF0>]}
[0m15:56:44.952495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4566e775-928f-4c46-95fc-a7ed3943a9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E418882C0>]}
[0m15:56:44.958990 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m15:56:44.958990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4566e775-928f-4c46-95fc-a7ed3943a9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E4180C980>]}
[0m15:56:44.960618 [info ] [MainThread]: 
[0m15:56:44.960618 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:56:44.961581 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:56:45.015113 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:56:45.015113 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:56:45.015113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:45.035935 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:56:45.042287 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:56:45.044289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_main_nfirs_transformed)
[0m15:56:45.044289 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "main_nfirs_transformed"
"
[0m15:56:45.044289 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main_nfirs_transformed"
[0m15:56:45.044289 [debug] [ThreadPool]: On create_nfirs_main_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:56:45.044289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:45.060750 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:56:45.060750 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main_nfirs_transformed"
[0m15:56:45.060750 [debug] [ThreadPool]: On create_nfirs_main_nfirs_transformed: BEGIN
[0m15:56:45.060750 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:56:45.060750 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main_nfirs_transformed"
[0m15:56:45.060750 [debug] [ThreadPool]: On create_nfirs_main_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."main_nfirs_transformed"
    
[0m15:56:45.060750 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:56:45.075701 [debug] [ThreadPool]: On create_nfirs_main_nfirs_transformed: COMMIT
[0m15:56:45.075701 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main_nfirs_transformed"
[0m15:56:45.076286 [debug] [ThreadPool]: On create_nfirs_main_nfirs_transformed: COMMIT
[0m15:56:45.076286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:56:45.076286 [debug] [ThreadPool]: On create_nfirs_main_nfirs_transformed: Close
[0m15:56:45.076286 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main'
[0m15:56:45.076286 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main_nfirs_transformed'
[0m15:56:45.076286 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:56:45.076286 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main_nfirs_transformed"
[0m15:56:45.076286 [debug] [ThreadPool]: On list_nfirs_main: BEGIN
[0m15:56:45.076286 [debug] [ThreadPool]: On list_nfirs_main_nfirs_transformed: BEGIN
[0m15:56:45.076286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:45.076286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:45.109571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:56:45.109571 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m15:56:45.109571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:56:45.109571 [debug] [ThreadPool]: On list_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'nfirs'
  
[0m15:56:45.109571 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main_nfirs_transformed"
[0m15:56:45.109571 [debug] [ThreadPool]: On list_nfirs_main_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:56:45.126331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:56:45.126331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:56:45.143687 [debug] [ThreadPool]: On list_nfirs_main_nfirs_transformed: ROLLBACK
[0m15:56:45.143687 [debug] [ThreadPool]: On list_nfirs_main: ROLLBACK
[0m15:56:45.143687 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main'
[0m15:56:45.143687 [debug] [ThreadPool]: On list_nfirs_main: Close
[0m15:56:45.143687 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main_nfirs_transformed'
[0m15:56:45.143687 [debug] [ThreadPool]: On list_nfirs_main_nfirs_transformed: Close
[0m15:56:45.154297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4566e775-928f-4c46-95fc-a7ed3943a9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E4165D760>]}
[0m15:56:45.154297 [debug] [MainThread]: Using duckdb connection "master"
[0m15:56:45.154297 [debug] [MainThread]: On master: BEGIN
[0m15:56:45.154297 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:45.175689 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:56:45.175689 [debug] [MainThread]: On master: COMMIT
[0m15:56:45.176329 [debug] [MainThread]: Using duckdb connection "master"
[0m15:56:45.176329 [debug] [MainThread]: On master: COMMIT
[0m15:56:45.176329 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:56:45.176329 [debug] [MainThread]: On master: Close
[0m15:56:45.176329 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:56:45.176329 [info ] [MainThread]: 
[0m15:56:45.176329 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m15:56:45.176329 [info ] [Thread-1 (]: 1 of 1 START sql table model main_nfirs_transformed.base_nfirs_transformed_fdheader_transformed  [RUN]
[0m15:56:45.176329 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed'
[0m15:56:45.176329 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m15:56:45.176329 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:56:45.192220 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m15:56:45.213636 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:56:45.213636 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:56:45.213636 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: BEGIN
[0m15:56:45.213636 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:56:45.229282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:56:45.229282 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:56:45.229282 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */

  
    
    

    create  table
      "nfirs"."main_nfirs_transformed"."base_nfirs_transformed_fdheader_transformed__dbt_tmp"
  
    as (
      

with source as (
      select * from "nfirs"."nfirs_transformed"."fdheader_transformed"
),
renamed as (
    select
        COUNT(*)
    from source
)
select * from renamed
    );
  
  
[0m15:56:45.229282 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:56:45.244407 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:56:45.244924 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */
alter table "nfirs"."main_nfirs_transformed"."base_nfirs_transformed_fdheader_transformed__dbt_tmp" rename to "base_nfirs_transformed_fdheader_transformed"
[0m15:56:45.244924 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:56:45.254546 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: COMMIT
[0m15:56:45.254546 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:56:45.258996 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: COMMIT
[0m15:56:45.259752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:56:45.259752 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m15:56:45.259752 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */
drop table if exists "nfirs"."main_nfirs_transformed"."base_nfirs_transformed_fdheader_transformed__dbt_backup" cascade
[0m15:56:45.259752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:56:45.259752 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: Close
[0m15:56:45.559217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4566e775-928f-4c46-95fc-a7ed3943a9c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3EE1B6E0>]}
[0m15:56:45.559217 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_nfirs_transformed.base_nfirs_transformed_fdheader_transformed  [[32mOK[0m in 0.38s]
[0m15:56:45.559217 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m15:56:45.559217 [debug] [MainThread]: Using duckdb connection "master"
[0m15:56:45.559217 [debug] [MainThread]: On master: BEGIN
[0m15:56:45.559217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:45.581273 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:56:45.581273 [debug] [MainThread]: On master: COMMIT
[0m15:56:45.581273 [debug] [MainThread]: Using duckdb connection "master"
[0m15:56:45.581273 [debug] [MainThread]: On master: COMMIT
[0m15:56:45.581273 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:56:45.591994 [debug] [MainThread]: On master: Close
[0m15:56:45.596387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:45.596387 [debug] [MainThread]: Connection 'create_nfirs_main_nfirs_transformed' was properly closed.
[0m15:56:45.596387 [debug] [MainThread]: Connection 'list_nfirs_main' was properly closed.
[0m15:56:45.596387 [debug] [MainThread]: Connection 'list_nfirs_main_nfirs_transformed' was properly closed.
[0m15:56:45.596387 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed' was properly closed.
[0m15:56:45.596387 [info ] [MainThread]: 
[0m15:56:45.596387 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m15:56:45.596387 [debug] [MainThread]: Command end result
[0m15:56:45.617466 [info ] [MainThread]: 
[0m15:56:45.617466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:56:45.617466 [info ] [MainThread]: 
[0m15:56:45.617466 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:56:45.617466 [debug] [MainThread]: Command `cli run` succeeded at 15:56:45.617466 after 1.17 seconds
[0m15:56:45.617466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E40096060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E40096270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E4145BE00>]}
[0m15:56:45.617466 [debug] [MainThread]: Flushing usage events
[0m16:05:21.531567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F975F3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F948BB6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F96D0E2A0>]}


============================== 16:05:21.548364 | e90c5c8e-abed-43cb-91fb-7880f85a4c3d ==============================
[0m16:05:21.548364 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:05:21.548364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:05:21.699101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e90c5c8e-abed-43cb-91fb-7880f85a4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F963444A0>]}
[0m16:05:21.731627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e90c5c8e-abed-43cb-91fb-7880f85a4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F98C27F20>]}
[0m16:05:21.731627 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:05:21.731627 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:05:21.848417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:05:21.849472 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:05:21.864871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e90c5c8e-abed-43cb-91fb-7880f85a4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F98B0E6F0>]}
[0m16:05:21.948268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e90c5c8e-abed-43cb-91fb-7880f85a4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F98D3AA20>]}
[0m16:05:21.948268 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m16:05:21.948268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e90c5c8e-abed-43cb-91fb-7880f85a4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F98CF4A70>]}
[0m16:05:21.948268 [info ] [MainThread]: 
[0m16:05:21.948268 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:05:21.948268 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:05:22.016957 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:05:22.016957 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:05:22.016957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:22.031605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:05:22.031605 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:05:22.047557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_main_nfirs_analysis)
[0m16:05:22.048160 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "main_nfirs_analysis"
"
[0m16:05:22.048160 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main_nfirs_analysis"
[0m16:05:22.048160 [debug] [ThreadPool]: On create_nfirs_main_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:05:22.048160 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:05:22.064775 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:05:22.064775 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main_nfirs_analysis"
[0m16:05:22.064775 [debug] [ThreadPool]: On create_nfirs_main_nfirs_analysis: BEGIN
[0m16:05:22.064775 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:05:22.064775 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main_nfirs_analysis"
[0m16:05:22.064775 [debug] [ThreadPool]: On create_nfirs_main_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_main_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."main_nfirs_analysis"
    
[0m16:05:22.064775 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:05:22.064775 [debug] [ThreadPool]: On create_nfirs_main_nfirs_analysis: COMMIT
[0m16:05:22.064775 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_main_nfirs_analysis"
[0m16:05:22.064775 [debug] [ThreadPool]: On create_nfirs_main_nfirs_analysis: COMMIT
[0m16:05:22.084268 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:05:22.084268 [debug] [ThreadPool]: On create_nfirs_main_nfirs_analysis: Close
[0m16:05:22.398875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main'
[0m16:05:22.398875 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m16:05:22.398875 [debug] [ThreadPool]: On list_nfirs_main: BEGIN
[0m16:05:22.398875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_main_nfirs_analysis'
[0m16:05:22.414226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:22.414766 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main_nfirs_analysis"
[0m16:05:22.431410 [debug] [ThreadPool]: On list_nfirs_main_nfirs_analysis: BEGIN
[0m16:05:22.431410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:05:22.431410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:22.431410 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main"
[0m16:05:22.431410 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:05:22.431410 [debug] [ThreadPool]: On list_nfirs_main: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'nfirs'
  
[0m16:05:22.431410 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_main_nfirs_analysis"
[0m16:05:22.431410 [debug] [ThreadPool]: On list_nfirs_main_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_main_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main_nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m16:05:22.448108 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:05:22.464691 [debug] [ThreadPool]: On list_nfirs_main: ROLLBACK
[0m16:05:22.464691 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main'
[0m16:05:22.464691 [debug] [ThreadPool]: On list_nfirs_main: Close
[0m16:05:22.464691 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:05:22.464691 [debug] [ThreadPool]: On list_nfirs_main_nfirs_analysis: ROLLBACK
[0m16:05:22.464691 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_main_nfirs_analysis'
[0m16:05:22.464691 [debug] [ThreadPool]: On list_nfirs_main_nfirs_analysis: Close
[0m16:05:22.481362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e90c5c8e-abed-43cb-91fb-7880f85a4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F9928A510>]}
[0m16:05:22.481362 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:22.481362 [debug] [MainThread]: On master: BEGIN
[0m16:05:22.481362 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:05:22.498068 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:05:22.498068 [debug] [MainThread]: On master: COMMIT
[0m16:05:22.498068 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:22.498068 [debug] [MainThread]: On master: COMMIT
[0m16:05:22.498068 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:05:22.498068 [debug] [MainThread]: On master: Close
[0m16:05:22.508967 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:05:22.509495 [info ] [MainThread]: 
[0m16:05:22.514030 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m16:05:22.514594 [info ] [Thread-1 (]: 1 of 1 START sql table model main_nfirs_analysis.base_nfirs_transformed_fdheader_transformed  [RUN]
[0m16:05:22.515662 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed'
[0m16:05:22.515662 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m16:05:22.521357 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:05:22.521503 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m16:05:22.535369 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:05:22.535369 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:05:22.535369 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: BEGIN
[0m16:05:22.535369 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:05:22.566846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:05:22.566846 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:05:22.566846 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */

  
    
    

    create  table
      "nfirs"."main_nfirs_analysis"."base_nfirs_transformed_fdheader_transformed__dbt_tmp"
  
    as (
      

with source as (
      select * from "nfirs"."nfirs_transformed"."fdheader_transformed"
),
renamed as (
    select
        COUNT(*)
    from source
)
select * from renamed
    );
  
  
[0m16:05:22.566846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:05:22.566846 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:05:22.566846 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */
alter table "nfirs"."main_nfirs_analysis"."base_nfirs_transformed_fdheader_transformed__dbt_tmp" rename to "base_nfirs_transformed_fdheader_transformed"
[0m16:05:22.566846 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:05:22.581580 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: COMMIT
[0m16:05:22.581580 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:05:22.581580 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: COMMIT
[0m16:05:22.598043 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:05:22.598043 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:05:22.598043 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */
drop table if exists "nfirs"."main_nfirs_analysis"."base_nfirs_transformed_fdheader_transformed__dbt_backup" cascade
[0m16:05:22.598043 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:05:22.598043 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: Close
[0m16:05:22.915442 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e90c5c8e-abed-43cb-91fb-7880f85a4c3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F9630F590>]}
[0m16:05:22.915442 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_nfirs_analysis.base_nfirs_transformed_fdheader_transformed  [[32mOK[0m in 0.40s]
[0m16:05:22.915442 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m16:05:22.915442 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:22.915442 [debug] [MainThread]: On master: BEGIN
[0m16:05:22.915442 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:05:22.936864 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:05:22.936864 [debug] [MainThread]: On master: COMMIT
[0m16:05:22.936864 [debug] [MainThread]: Using duckdb connection "master"
[0m16:05:22.936864 [debug] [MainThread]: On master: COMMIT
[0m16:05:22.936864 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:05:22.936864 [debug] [MainThread]: On master: Close
[0m16:05:22.947293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:22.948330 [debug] [MainThread]: Connection 'create_nfirs_main_nfirs_analysis' was properly closed.
[0m16:05:22.948330 [debug] [MainThread]: Connection 'list_nfirs_main' was properly closed.
[0m16:05:22.949330 [debug] [MainThread]: Connection 'list_nfirs_main_nfirs_analysis' was properly closed.
[0m16:05:22.949330 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed' was properly closed.
[0m16:05:22.950327 [info ] [MainThread]: 
[0m16:05:22.950327 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.00 seconds (1.00s).
[0m16:05:22.951294 [debug] [MainThread]: Command end result
[0m16:05:22.970507 [info ] [MainThread]: 
[0m16:05:22.970507 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:22.971714 [info ] [MainThread]: 
[0m16:05:22.971714 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:05:22.971714 [debug] [MainThread]: Command `cli run` succeeded at 16:05:22.971714 after 1.54 seconds
[0m16:05:22.971714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F975F3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F98A916D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F9890C980>]}
[0m16:05:22.971714 [debug] [MainThread]: Flushing usage events
[0m16:08:14.661167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD82A38B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD816714F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD809ED460>]}


============================== 16:08:14.665202 | 57935f54-5724-435e-9787-538497ad6380 ==============================
[0m16:08:14.665202 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:08:14.665202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:08:14.804479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57935f54-5724-435e-9787-538497ad6380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD82C3F470>]}
[0m16:08:14.851430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57935f54-5724-435e-9787-538497ad6380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD82C07E60>]}
[0m16:08:14.851430 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:08:14.851430 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:08:14.957478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:14.957478 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:14.987478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57935f54-5724-435e-9787-538497ad6380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD82EBF4D0>]}
[0m16:08:15.058603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57935f54-5724-435e-9787-538497ad6380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD82EAB110>]}
[0m16:08:15.059602 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m16:08:15.059602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57935f54-5724-435e-9787-538497ad6380', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD82C3C650>]}
[0m16:08:15.060602 [info ] [MainThread]: 
[0m16:08:15.061602 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:08:15.062815 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:08:15.117815 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:08:15.118815 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:08:15.118815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:15.215318 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:08:15.215318 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:08:15.217581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:15.218257 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m16:08:15.218257 [info ] [MainThread]: 
[0m16:08:15.218854 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m16:08:15.219608 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 21828)
[0m16:08:15.220855 [debug] [MainThread]: Command `cli run` failed at 16:08:15.220855 after 0.67 seconds
[0m16:08:15.221382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD80C06480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD8305EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD832BD640>]}
[0m16:08:15.221493 [debug] [MainThread]: Flushing usage events
[0m16:08:26.828549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3DC1B9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3DFD82FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3DFCB7D40>]}


============================== 16:08:26.828549 | 793fe1cc-0544-465f-b4ff-98b3aa2d5c4d ==============================
[0m16:08:26.828549 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:08:26.828549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:08:26.978668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '793fe1cc-0544-465f-b4ff-98b3aa2d5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3DEB9E030>]}
[0m16:08:27.012235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '793fe1cc-0544-465f-b4ff-98b3aa2d5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E01B77D0>]}
[0m16:08:27.012235 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:08:27.028740 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:08:27.128795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:08:27.128795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:08:27.161048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '793fe1cc-0544-465f-b4ff-98b3aa2d5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E03C3260>]}
[0m16:08:27.228624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '793fe1cc-0544-465f-b4ff-98b3aa2d5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3DEB9E000>]}
[0m16:08:27.228624 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m16:08:27.228624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793fe1cc-0544-465f-b4ff-98b3aa2d5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E0645CA0>]}
[0m16:08:27.231706 [info ] [MainThread]: 
[0m16:08:27.231706 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:08:27.231706 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:08:27.281060 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:08:27.281060 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:08:27.281060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:27.311137 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:08:27.311802 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:08:27.311802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_nfirs_analysis)
[0m16:08:27.311802 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_nfirs_analysis"
"
[0m16:08:27.311802 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_nfirs_analysis"
[0m16:08:27.311802 [debug] [ThreadPool]: On create_nfirs_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:08:27.311802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:08:27.341974 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:08:27.341974 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_nfirs_analysis"
[0m16:08:27.344540 [debug] [ThreadPool]: On create_nfirs_nfirs_nfirs_analysis: BEGIN
[0m16:08:27.344540 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:08:27.345194 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_nfirs_analysis"
[0m16:08:27.345194 [debug] [ThreadPool]: On create_nfirs_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."nfirs_nfirs_analysis"
    
[0m16:08:27.345194 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:08:27.345194 [debug] [ThreadPool]: On create_nfirs_nfirs_nfirs_analysis: COMMIT
[0m16:08:27.345194 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_nfirs_analysis"
[0m16:08:27.345194 [debug] [ThreadPool]: On create_nfirs_nfirs_nfirs_analysis: COMMIT
[0m16:08:27.355289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:08:27.355289 [debug] [ThreadPool]: On create_nfirs_nfirs_nfirs_analysis: Close
[0m16:08:27.628214 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_nfirs_analysis'
[0m16:08:27.644898 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:08:27.644898 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:08:27.644898 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_nfirs_analysis"
[0m16:08:27.644898 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:08:27.644898 [debug] [ThreadPool]: On list_nfirs_nfirs_nfirs_analysis: BEGIN
[0m16:08:27.644898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:27.644898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:27.661667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:08:27.661667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:08:27.661667 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:08:27.661667 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_nfirs_analysis"
[0m16:08:27.661667 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:08:27.661667 [debug] [ThreadPool]: On list_nfirs_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m16:08:27.695060 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:08:27.695060 [debug] [ThreadPool]: On list_nfirs_nfirs_nfirs_analysis: ROLLBACK
[0m16:08:27.695060 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:08:27.695060 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_nfirs_analysis'
[0m16:08:27.695060 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:08:27.695060 [debug] [ThreadPool]: On list_nfirs_nfirs_nfirs_analysis: Close
[0m16:08:27.695060 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:08:27.695060 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:08:27.711813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '793fe1cc-0544-465f-b4ff-98b3aa2d5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E06464B0>]}
[0m16:08:27.711813 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:27.711813 [debug] [MainThread]: On master: BEGIN
[0m16:08:27.711813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:08:27.728509 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:08:27.728509 [debug] [MainThread]: On master: COMMIT
[0m16:08:27.728509 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:27.728509 [debug] [MainThread]: On master: COMMIT
[0m16:08:27.728509 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:08:27.728509 [debug] [MainThread]: On master: Close
[0m16:08:27.728509 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:08:27.728509 [info ] [MainThread]: 
[0m16:08:27.747110 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m16:08:27.747110 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_nfirs_analysis.base_nfirs_transformed_fdheader_transformed  [RUN]
[0m16:08:27.748111 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed'
[0m16:08:27.748630 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m16:08:27.752909 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:08:27.752909 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m16:08:27.779094 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:08:27.780060 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:08:27.781060 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: BEGIN
[0m16:08:27.782900 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:08:27.797385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:08:27.797385 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:08:27.797385 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */

  
    
    

    create  table
      "nfirs"."nfirs_nfirs_analysis"."base_nfirs_transformed_fdheader_transformed__dbt_tmp"
  
    as (
      

with source as (
      select * from "nfirs"."nfirs_transformed"."fdheader_transformed"
),
renamed as (
    select
        COUNT(*)
    from source
)
select * from renamed
    );
  
  
[0m16:08:27.797385 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:08:27.797385 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:08:27.797385 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */
alter table "nfirs"."nfirs_nfirs_analysis"."base_nfirs_transformed_fdheader_transformed__dbt_tmp" rename to "base_nfirs_transformed_fdheader_transformed"
[0m16:08:27.811391 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:08:27.813086 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: COMMIT
[0m16:08:27.813086 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:08:27.813086 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: COMMIT
[0m16:08:27.828257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:08:27.828257 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:08:27.828257 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */
drop table if exists "nfirs"."nfirs_nfirs_analysis"."base_nfirs_transformed_fdheader_transformed__dbt_backup" cascade
[0m16:08:27.828257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:08:27.828257 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: Close
[0m16:08:28.113351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '793fe1cc-0544-465f-b4ff-98b3aa2d5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E09FD490>]}
[0m16:08:28.113351 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_nfirs_analysis.base_nfirs_transformed_fdheader_transformed  [[32mOK[0m in 0.37s]
[0m16:08:28.113351 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m16:08:28.113351 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:28.113351 [debug] [MainThread]: On master: BEGIN
[0m16:08:28.113351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:08:28.134503 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:08:28.134503 [debug] [MainThread]: On master: COMMIT
[0m16:08:28.134503 [debug] [MainThread]: Using duckdb connection "master"
[0m16:08:28.134503 [debug] [MainThread]: On master: COMMIT
[0m16:08:28.144299 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:08:28.144299 [debug] [MainThread]: On master: Close
[0m16:08:28.148265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:28.148265 [debug] [MainThread]: Connection 'create_nfirs_nfirs_nfirs_analysis' was properly closed.
[0m16:08:28.148265 [debug] [MainThread]: Connection 'list_nfirs_nfirs_nfirs_analysis' was properly closed.
[0m16:08:28.148265 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:08:28.148265 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed' was properly closed.
[0m16:08:28.148265 [info ] [MainThread]: 
[0m16:08:28.148265 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m16:08:28.148265 [debug] [MainThread]: Command end result
[0m16:08:28.168346 [info ] [MainThread]: 
[0m16:08:28.168346 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:28.168346 [info ] [MainThread]: 
[0m16:08:28.168346 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:08:28.168346 [debug] [MainThread]: Command `cli run` succeeded at 16:08:28.168346 after 1.44 seconds
[0m16:08:28.168346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E0144D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E01453D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3DDF98E00>]}
[0m16:08:28.168346 [debug] [MainThread]: Flushing usage events
[0m16:09:39.993026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261277BB6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026129FFABD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026129FF98B0>]}


============================== 16:09:39.993026 | 3ca8359f-3c11-4d76-92d8-cec08104a852 ==============================
[0m16:09:39.993026 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:09:39.993026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:09:40.141230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ca8359f-3c11-4d76-92d8-cec08104a852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002612BBB3080>]}
[0m16:09:40.176307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ca8359f-3c11-4d76-92d8-cec08104a852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002612BBB01D0>]}
[0m16:09:40.180359 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:09:40.182477 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:09:40.285808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:09:40.285808 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:09:40.317078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ca8359f-3c11-4d76-92d8-cec08104a852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002612BD93F80>]}
[0m16:09:40.388081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ca8359f-3c11-4d76-92d8-cec08104a852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002612BCC6AE0>]}
[0m16:09:40.390244 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 408 macros
[0m16:09:40.390244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ca8359f-3c11-4d76-92d8-cec08104a852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002612BC6AF00>]}
[0m16:09:40.390244 [info ] [MainThread]: 
[0m16:09:40.390244 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:09:40.393751 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:09:40.452697 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:09:40.452697 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:09:40.452697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:40.476140 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:09:40.476140 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:09:40.481868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_analysis)
[0m16:09:40.481868 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_analysis"
"
[0m16:09:40.481868 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m16:09:40.481868 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:09:40.481868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:40.492827 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:09:40.492827 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m16:09:40.492827 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: BEGIN
[0m16:09:40.508893 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:09:40.509501 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m16:09:40.509501 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."nfirs_analysis"
    
[0m16:09:40.509501 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:09:40.509501 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m16:09:40.509501 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m16:09:40.509501 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m16:09:40.520007 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:09:40.520007 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: Close
[0m16:09:40.942979 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m16:09:40.958602 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:09:40.959187 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:09:40.959187 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:09:40.959187 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m16:09:40.959187 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:09:40.959187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:40.959187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:40.975906 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:09:40.975906 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:09:40.975906 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:09:40.975906 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:09:40.975906 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m16:09:40.975906 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:09:41.009137 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:09:41.009137 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:09:41.009137 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:09:41.009137 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m16:09:41.009137 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m16:09:41.024864 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m16:09:41.025354 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:09:41.025910 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:09:41.025910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ca8359f-3c11-4d76-92d8-cec08104a852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002612BE66240>]}
[0m16:09:41.025910 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:41.025910 [debug] [MainThread]: On master: BEGIN
[0m16:09:41.025910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:09:41.042741 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:09:41.042741 [debug] [MainThread]: On master: COMMIT
[0m16:09:41.042741 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:41.042741 [debug] [MainThread]: On master: COMMIT
[0m16:09:41.042741 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:09:41.042741 [debug] [MainThread]: On master: Close
[0m16:09:41.059268 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:09:41.059268 [info ] [MainThread]: 
[0m16:09:41.059268 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m16:09:41.059268 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_analysis.base_nfirs_transformed_fdheader_transformed  [RUN]
[0m16:09:41.059268 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed'
[0m16:09:41.059268 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m16:09:41.072533 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:09:41.072533 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m16:09:41.094638 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:09:41.094638 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:09:41.094638 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: BEGIN
[0m16:09:41.094638 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:09:41.111052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:09:41.111052 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:09:41.111052 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */

  
    
    

    create  table
      "nfirs"."nfirs_analysis"."base_nfirs_transformed_fdheader_transformed__dbt_tmp"
  
    as (
      

with source as (
      select * from "nfirs"."nfirs_transformed"."fdheader_transformed"
),
renamed as (
    select
        COUNT(*)
    from source
)
select * from renamed
    );
  
  
[0m16:09:41.111052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:09:41.125326 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:09:41.125326 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */
alter table "nfirs"."nfirs_analysis"."base_nfirs_transformed_fdheader_transformed__dbt_tmp" rename to "base_nfirs_transformed_fdheader_transformed"
[0m16:09:41.125894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:09:41.125894 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: COMMIT
[0m16:09:41.125894 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:09:41.125894 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: COMMIT
[0m16:09:41.147698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:09:41.147698 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"
[0m16:09:41.147698 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed"} */
drop table if exists "nfirs"."nfirs_analysis"."base_nfirs_transformed_fdheader_transformed__dbt_backup" cascade
[0m16:09:41.147698 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:09:41.147698 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed: Close
[0m16:09:41.561183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ca8359f-3c11-4d76-92d8-cec08104a852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002612C1D6BA0>]}
[0m16:09:41.561183 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_analysis.base_nfirs_transformed_fdheader_transformed  [[32mOK[0m in 0.50s]
[0m16:09:41.561183 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed
[0m16:09:41.561183 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:41.561183 [debug] [MainThread]: On master: BEGIN
[0m16:09:41.561183 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:09:41.587643 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:09:41.588143 [debug] [MainThread]: On master: COMMIT
[0m16:09:41.588643 [debug] [MainThread]: Using duckdb connection "master"
[0m16:09:41.589270 [debug] [MainThread]: On master: COMMIT
[0m16:09:41.589850 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:09:41.589850 [debug] [MainThread]: On master: Close
[0m16:09:41.595189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:41.595189 [debug] [MainThread]: Connection 'create_nfirs_nfirs_analysis' was properly closed.
[0m16:09:41.595189 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m16:09:41.596386 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:09:41.596386 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.base_nfirs_transformed_fdheader_transformed' was properly closed.
[0m16:09:41.596386 [info ] [MainThread]: 
[0m16:09:41.596386 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m16:09:41.596386 [debug] [MainThread]: Command end result
[0m16:09:41.617091 [info ] [MainThread]: 
[0m16:09:41.617091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:41.617091 [info ] [MainThread]: 
[0m16:09:41.617091 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:09:41.617091 [debug] [MainThread]: Command `cli run` succeeded at 16:09:41.617091 after 1.74 seconds
[0m16:09:41.617091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261277BB6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002612A3132C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002612A582870>]}
[0m16:09:41.617091 [debug] [MainThread]: Flushing usage events
[0m16:33:51.497616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1E35F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1FAD2FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1F4F62A0>]}


============================== 16:33:51.497616 | 3e000163-a2bf-4a57-b2c4-12928d47cf7d ==============================
[0m16:33:51.497616 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:33:51.497616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:33:51.653442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e000163-a2bf-4a57-b2c4-12928d47cf7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D20FC1550>]}
[0m16:33:51.693442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e000163-a2bf-4a57-b2c4-12928d47cf7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D21150470>]}
[0m16:33:51.694416 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:33:51.700438 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:33:51.800086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:51.801085 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:51.830977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e000163-a2bf-4a57-b2c4-12928d47cf7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D20F787D0>]}
[0m16:33:51.897594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e000163-a2bf-4a57-b2c4-12928d47cf7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D21214E90>]}
[0m16:33:51.897594 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 408 macros
[0m16:33:51.897594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e000163-a2bf-4a57-b2c4-12928d47cf7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D212202F0>]}
[0m16:33:51.897594 [info ] [MainThread]: 
[0m16:33:51.897594 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:33:51.897594 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:33:51.961505 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:33:51.961505 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:33:51.961505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:52.054714 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:33:52.055782 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:33:52.056710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:52.056710 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m16:33:52.056710 [info ] [MainThread]: 
[0m16:33:52.057709 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m16:33:52.057709 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 26232)
[0m16:33:52.058710 [debug] [MainThread]: Command `cli run` failed at 16:33:52.058710 after 0.67 seconds
[0m16:33:52.058710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D1E35F4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D2122E5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026D21422A80>]}
[0m16:33:52.059740 [debug] [MainThread]: Flushing usage events
[0m16:34:01.143320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0D570A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0D0E6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0D573B00>]}


============================== 16:34:01.160066 | 365b56b4-0bdb-4874-b6b5-97bc4ded5645 ==============================
[0m16:34:01.160066 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:34:01.160066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:01.309278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '365b56b4-0bdb-4874-b6b5-97bc4ded5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0CFFCE60>]}
[0m16:34:01.343589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '365b56b4-0bdb-4874-b6b5-97bc4ded5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0F1E3CE0>]}
[0m16:34:01.343589 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:34:01.343589 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:34:01.443424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:01.443424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:01.476898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '365b56b4-0bdb-4874-b6b5-97bc4ded5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0F29F440>]}
[0m16:34:01.543285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '365b56b4-0bdb-4874-b6b5-97bc4ded5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0F4B4E30>]}
[0m16:34:01.543285 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 408 macros
[0m16:34:01.543285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '365b56b4-0bdb-4874-b6b5-97bc4ded5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0F486360>]}
[0m16:34:01.543285 [info ] [MainThread]: 
[0m16:34:01.543285 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:34:01.559901 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:34:01.611881 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:34:01.611881 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:34:01.611881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:01.628266 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:34:01.643198 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:34:01.643198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:34:01.643198 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:34:01.643198 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:34:01.643198 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:34:01.643198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:01.659942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:34:01.659942 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:34:01.659942 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:34:01.675928 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:34:01.675928 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:34:01.676576 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:34:01.676576 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:34:01.676576 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:34:01.676576 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:34:01.676576 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:34:01.676576 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:34:01.676576 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:34:01.676576 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:34:01.676576 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:34:01.692523 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:34:01.692294 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:34:01.693060 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m16:34:01.693060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:01.693060 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:34:01.693060 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:34:01.709861 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:34:01.709861 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:34:01.709861 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m16:34:01.709861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:01.709861 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:34:01.709861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:01.709861 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:34:01.709861 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:34:01.709861 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:34:01.709861 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:34:01.709861 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:34:01.709861 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:34:01.709861 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m16:34:01.743368 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:34:01.743368 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m16:34:01.743368 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m16:34:01.743368 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m16:34:01.743368 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:34:01.759170 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:34:01.759957 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:34:01.759957 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:34:01.759957 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:34:01.759957 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:34:01.759957 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:34:01.759957 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:34:01.759957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '365b56b4-0bdb-4874-b6b5-97bc4ded5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0C8E3620>]}
[0m16:34:01.759957 [debug] [MainThread]: Using duckdb connection "master"
[0m16:34:01.759957 [debug] [MainThread]: On master: BEGIN
[0m16:34:01.759957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:01.792971 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:34:01.792971 [debug] [MainThread]: On master: COMMIT
[0m16:34:01.792971 [debug] [MainThread]: Using duckdb connection "master"
[0m16:34:01.792971 [debug] [MainThread]: On master: COMMIT
[0m16:34:01.792971 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:34:01.792971 [debug] [MainThread]: On master: Close
[0m16:34:01.792971 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:34:01.792971 [info ] [MainThread]: 
[0m16:34:01.792971 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:34:01.792971 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__fdheader_update_inc_date  [RUN]
[0m16:34:01.792971 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date'
[0m16:34:01.792971 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:34:01.814115 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:34:01.814115 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:34:01.828237 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:34:01.828237 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:34:01.828237 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: BEGIN
[0m16:34:01.828237 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:34:01.859722 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:34:01.859722 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:34:01.859722 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader_update_inc_date__dbt_tmp"
  
    as (
      

with fdheader_transformed_source as (
      select * from "nfirs"."nfirs_transformed"."fdheader_transformed"
),

WITH fdheader_transformed_no_station_cast_float as (
    select
        *,
        CAST(NO_STATION as float) AS no_station_float
    FROM fdheader_transformed_source
),

WITH final as (
    select
        STATE,
        FDID,
        FD_NAME,
        FD_STR_NO,
        FD_STR_PRE,
        FD_STREET,
        FD_STR_TYP,
        FD_STR_SUF,
        FD_CITY,
        FD_ZIP,
        FD_PHONE,
        FD_FAX,
        FD_EMAIL,
        FD_FIP_CITY,
        no_station_float AS NO_STATION,
        NO_PD_FF,
        NO_VOL_FF,
        NO_VOL_PDC
    FROM fdheader_transformed_no_station_cast_float
)

select * FROM final
    );
  
  
[0m16:34:01.859722 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader_update_inc_date__dbt_tmp"
  
    as (
      

with fdheader_transformed_source as (
      select * from "nfirs"."nfirs_transformed"."fdheader_transformed"
),

WITH fdheader_transformed_no_station_cast_float as (
    select
        *,
        CAST(NO_STATION as float) AS no_station_float
    FROM fdheader_transformed_source
),

WITH final as (
    select
        STATE,
        FDID,
        FD_NAME,
        FD_STR_NO,
        FD_STR_PRE,
        FD_STREET,
        FD_STR_TYP,
        FD_STR_SUF,
        FD_CITY,
        FD_ZIP,
        FD_PHONE,
        FD_FAX,
        FD_EMAIL,
        FD_FIP_CITY,
        no_station_float AS NO_STATION,
        NO_PD_FF,
        NO_VOL_FF,
        NO_VOL_PDC
    FROM fdheader_transformed_no_station_cast_float
)

select * FROM final
    );
  
  
[0m16:34:01.859722 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:34:01.859722 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: ROLLBACK
[0m16:34:01.859722 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date'
[0m16:34:01.859722 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: Close
[0m16:34:01.859722 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__fdheader_update_inc_date (models\nfirs_transformed\nfirs_transformed__fdheader_update_inc_date.sql)
  Parser Error: syntax error at or near "WITH"
[0m16:34:01.875417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '365b56b4-0bdb-4874-b6b5-97bc4ded5645', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0F8B4710>]}
[0m16:34:01.875753 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__fdheader_update_inc_date  [[31mERROR[0m in 0.07s]
[0m16:34:01.876448 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:34:01.876448 [debug] [MainThread]: Using duckdb connection "master"
[0m16:34:01.876448 [debug] [MainThread]: On master: BEGIN
[0m16:34:01.876448 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:01.897625 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:34:01.898624 [debug] [MainThread]: On master: COMMIT
[0m16:34:01.898624 [debug] [MainThread]: Using duckdb connection "master"
[0m16:34:01.898624 [debug] [MainThread]: On master: COMMIT
[0m16:34:01.899790 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:34:01.899790 [debug] [MainThread]: On master: Close
[0m16:34:01.899790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:01.899790 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:34:01.899790 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:34:01.899790 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:34:01.899790 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m16:34:01.899790 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date' was properly closed.
[0m16:34:01.899790 [info ] [MainThread]: 
[0m16:34:01.899790 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m16:34:01.899790 [debug] [MainThread]: Command end result
[0m16:34:01.913671 [info ] [MainThread]: 
[0m16:34:01.913671 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:34:01.925991 [info ] [MainThread]: 
[0m16:34:01.926189 [error] [MainThread]:   Runtime Error in model nfirs_transformed__fdheader_update_inc_date (models\nfirs_transformed\nfirs_transformed__fdheader_update_inc_date.sql)
  Parser Error: syntax error at or near "WITH"
[0m16:34:01.926189 [info ] [MainThread]: 
[0m16:34:01.927232 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:34:01.928205 [debug] [MainThread]: Command `cli run` failed at 16:34:01.927232 after 0.88 seconds
[0m16:34:01.928205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0D0E6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0C8B7D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F0F23F1A0>]}
[0m16:34:01.928205 [debug] [MainThread]: Flushing usage events
[0m16:35:01.467016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB05EC4AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB05EC6FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB05EC5CA0>]}


============================== 16:35:01.467016 | a9ece591-eb21-49c1-b5a4-2f95eddc36e5 ==============================
[0m16:35:01.467016 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:35:01.467016 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:35:01.616951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9ece591-eb21-49c1-b5a4-2f95eddc36e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB07A89820>]}
[0m16:35:01.650149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9ece591-eb21-49c1-b5a4-2f95eddc36e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB07A342F0>]}
[0m16:35:01.650149 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:35:01.667060 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:35:01.767147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:35:01.767147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:35:01.783462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9ece591-eb21-49c1-b5a4-2f95eddc36e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB07BF4230>]}
[0m16:35:01.867066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9ece591-eb21-49c1-b5a4-2f95eddc36e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB07C37590>]}
[0m16:35:01.867066 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 408 macros
[0m16:35:01.867066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9ece591-eb21-49c1-b5a4-2f95eddc36e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB07BFE9F0>]}
[0m16:35:01.869277 [info ] [MainThread]: 
[0m16:35:01.869818 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:35:01.870935 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:35:01.918428 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:35:01.918428 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:35:01.918428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:01.949887 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:35:01.949887 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:35:01.949887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:35:01.949887 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:35:01.949887 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:35:01.949887 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:35:01.949887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:01.983048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:35:01.983048 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:35:01.983048 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:35:01.983048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:35:01.983048 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:35:01.983048 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:35:01.983048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:35:01.983048 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:35:01.983048 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:35:01.983048 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:35:01.983048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:35:01.983048 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:35:01.983048 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:35:01.998712 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m16:35:01.999898 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:35:01.999898 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:35:01.999898 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:35:01.999898 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:35:01.999898 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:35:01.999898 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m16:35:01.999898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:01.999898 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:35:01.999898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:02.016586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:02.016586 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:35:02.016586 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:35:02.016586 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:35:02.016586 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:35:02.016586 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:35:02.016586 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:35:02.016586 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:35:02.016586 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m16:35:02.016586 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:35:02.050158 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:35:02.050158 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:35:02.050158 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:35:02.065900 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:35:02.066506 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m16:35:02.066506 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:35:02.066506 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m16:35:02.066506 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:35:02.066506 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m16:35:02.066506 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:35:02.066506 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:35:02.066506 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:35:02.066506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9ece591-eb21-49c1-b5a4-2f95eddc36e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB07DF31A0>]}
[0m16:35:02.066506 [debug] [MainThread]: Using duckdb connection "master"
[0m16:35:02.066506 [debug] [MainThread]: On master: BEGIN
[0m16:35:02.082209 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:02.099998 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:35:02.099998 [debug] [MainThread]: On master: COMMIT
[0m16:35:02.099998 [debug] [MainThread]: Using duckdb connection "master"
[0m16:35:02.099998 [debug] [MainThread]: On master: COMMIT
[0m16:35:02.099998 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:35:02.099998 [debug] [MainThread]: On master: Close
[0m16:35:02.099998 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:35:02.099998 [info ] [MainThread]: 
[0m16:35:02.099998 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:35:02.099998 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__fdheader_update_inc_date  [RUN]
[0m16:35:02.099998 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date'
[0m16:35:02.099998 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:35:02.118037 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:35:02.119037 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:35:02.137516 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:35:02.137516 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:35:02.137516 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: BEGIN
[0m16:35:02.137516 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:35:02.151756 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:35:02.151756 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:35:02.151756 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader_update_inc_date__dbt_tmp"
  
    as (
      

with fdheader_transformed_source as (
      select * from "nfirs"."nfirs_transformed"."fdheader_transformed"
),

WITH fdheader_transformed_no_station_cast_float as (
    select
        *,
        CAST(NO_STATION as float) AS no_station_float
    FROM fdheader_transformed_source
),

WITH final as (
    select
        STATE,
        FDID,
        FD_NAME,
        FD_STR_NO,
        FD_STR_PRE,
        FD_STREET,
        FD_STR_TYP,
        FD_STR_SUF,
        FD_CITY,
        FD_ZIP,
        FD_PHONE,
        FD_FAX,
        FD_EMAIL,
        FD_FIP_CITY,
        no_station_float AS NO_STATION,
        NO_PD_FF,
        NO_VOL_FF,
        NO_VOL_PDC
    FROM fdheader_transformed_no_station_cast_float
)

select * FROM final
    );
  
  
[0m16:35:02.151756 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader_update_inc_date__dbt_tmp"
  
    as (
      

with fdheader_transformed_source as (
      select * from "nfirs"."nfirs_transformed"."fdheader_transformed"
),

WITH fdheader_transformed_no_station_cast_float as (
    select
        *,
        CAST(NO_STATION as float) AS no_station_float
    FROM fdheader_transformed_source
),

WITH final as (
    select
        STATE,
        FDID,
        FD_NAME,
        FD_STR_NO,
        FD_STR_PRE,
        FD_STREET,
        FD_STR_TYP,
        FD_STR_SUF,
        FD_CITY,
        FD_ZIP,
        FD_PHONE,
        FD_FAX,
        FD_EMAIL,
        FD_FIP_CITY,
        no_station_float AS NO_STATION,
        NO_PD_FF,
        NO_VOL_FF,
        NO_VOL_PDC
    FROM fdheader_transformed_no_station_cast_float
)

select * FROM final
    );
  
  
[0m16:35:02.151756 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:35:02.151756 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: ROLLBACK
[0m16:35:02.168107 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date'
[0m16:35:02.168107 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: Close
[0m16:35:02.168107 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__fdheader_update_inc_date (models\nfirs_transformed\nfirs_transformed__fdheader_update_inc_date.sql)
  Parser Error: syntax error at or near "WITH"
[0m16:35:02.168107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9ece591-eb21-49c1-b5a4-2f95eddc36e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB05EC77A0>]}
[0m16:35:02.168107 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__fdheader_update_inc_date  [[31mERROR[0m in 0.07s]
[0m16:35:02.168107 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:35:02.168107 [debug] [MainThread]: Using duckdb connection "master"
[0m16:35:02.168107 [debug] [MainThread]: On master: BEGIN
[0m16:35:02.168107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:35:02.203231 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:35:02.204144 [debug] [MainThread]: On master: COMMIT
[0m16:35:02.204144 [debug] [MainThread]: Using duckdb connection "master"
[0m16:35:02.204144 [debug] [MainThread]: On master: COMMIT
[0m16:35:02.204144 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:35:02.204144 [debug] [MainThread]: On master: Close
[0m16:35:02.204144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:02.204144 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:35:02.204144 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:35:02.204144 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m16:35:02.204144 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:35:02.204144 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date' was properly closed.
[0m16:35:02.204144 [info ] [MainThread]: 
[0m16:35:02.204144 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m16:35:02.204144 [debug] [MainThread]: Command end result
[0m16:35:02.224407 [info ] [MainThread]: 
[0m16:35:02.224407 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:35:02.224407 [info ] [MainThread]: 
[0m16:35:02.224407 [error] [MainThread]:   Runtime Error in model nfirs_transformed__fdheader_update_inc_date (models\nfirs_transformed\nfirs_transformed__fdheader_update_inc_date.sql)
  Parser Error: syntax error at or near "WITH"
[0m16:35:02.224407 [info ] [MainThread]: 
[0m16:35:02.224407 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:35:02.224407 [debug] [MainThread]: Command `cli run` failed at 16:35:02.224407 after 0.87 seconds
[0m16:35:02.224407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB07808B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0780B3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB07521700>]}
[0m16:35:02.232602 [debug] [MainThread]: Flushing usage events
[0m16:36:06.938112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A2D1A660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A2D1AC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A416C980>]}


============================== 16:36:06.954832 | 9c781ee8-6bda-4013-a775-6f7efe836c27 ==============================
[0m16:36:06.954832 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:36:06.954832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:36:07.104738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c781ee8-6bda-4013-a775-6f7efe836c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A4219130>]}
[0m16:36:07.138192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c781ee8-6bda-4013-a775-6f7efe836c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A1A445C0>]}
[0m16:36:07.138192 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:36:07.138192 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:36:07.238075 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:07.238075 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:07.271349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c781ee8-6bda-4013-a775-6f7efe836c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A416E330>]}
[0m16:36:07.354581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c781ee8-6bda-4013-a775-6f7efe836c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A44C7380>]}
[0m16:36:07.354581 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 408 macros
[0m16:36:07.354581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c781ee8-6bda-4013-a775-6f7efe836c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A416FCB0>]}
[0m16:36:07.354581 [info ] [MainThread]: 
[0m16:36:07.354581 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:36:07.354581 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:36:07.420600 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:36:07.421649 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:36:07.421649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:07.437929 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:07.437929 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:36:07.437929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:36:07.437929 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:36:07.454646 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:36:07.454646 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:36:07.454646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:07.471333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:07.471333 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:36:07.471333 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:36:07.471333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:07.471333 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:36:07.471333 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:36:07.471333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:07.471333 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:36:07.471333 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:36:07.471333 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:36:07.471333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:07.471333 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:36:07.487934 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:36:07.487934 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:36:07.487934 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:36:07.487934 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:36:07.487934 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m16:36:07.487934 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:36:07.487934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:07.487934 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:36:07.487934 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:36:07.504628 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:07.504628 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m16:36:07.504628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:07.504628 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:36:07.504628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:07.504628 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:07.504628 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:36:07.520256 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:36:07.520641 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:07.521211 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:36:07.521211 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:36:07.521211 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m16:36:07.538245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:07.538245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:07.553853 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m16:36:07.554487 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:36:07.554487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:07.554487 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m16:36:07.554487 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:36:07.554487 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:36:07.554487 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m16:36:07.554487 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:36:07.554487 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:36:07.554487 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:36:07.554487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c781ee8-6bda-4013-a775-6f7efe836c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A43D2240>]}
[0m16:36:07.554487 [debug] [MainThread]: Using duckdb connection "master"
[0m16:36:07.554487 [debug] [MainThread]: On master: BEGIN
[0m16:36:07.570223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:07.587850 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:36:07.587850 [debug] [MainThread]: On master: COMMIT
[0m16:36:07.587850 [debug] [MainThread]: Using duckdb connection "master"
[0m16:36:07.587850 [debug] [MainThread]: On master: COMMIT
[0m16:36:07.587850 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:36:07.587850 [debug] [MainThread]: On master: Close
[0m16:36:07.587850 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:36:07.587850 [info ] [MainThread]: 
[0m16:36:07.587850 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:36:07.587850 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__fdheader_update_inc_date  [RUN]
[0m16:36:07.587850 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date'
[0m16:36:07.587850 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:36:07.607262 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:36:07.608552 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:36:07.622923 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:36:07.622923 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:36:07.622923 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: BEGIN
[0m16:36:07.622923 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:36:07.639306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:07.639306 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:36:07.639306 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader_update_inc_date__dbt_tmp"
  
    as (
      

with fdheader_transformed_source as (
      select * from "nfirs"."nfirs_transformed"."fdheader_transformed"
),

fdheader_transformed_no_station_cast_float as (
    select
        *,
        CAST(NO_STATION as float) AS no_station_float
    FROM fdheader_transformed_source
),

final as (
    select
        STATE,
        FDID,
        FD_NAME,
        FD_STR_NO,
        FD_STR_PRE,
        FD_STREET,
        FD_STR_TYP,
        FD_STR_SUF,
        FD_CITY,
        FD_ZIP,
        FD_PHONE,
        FD_FAX,
        FD_EMAIL,
        FD_FIP_CITY,
        no_station_float AS NO_STATION,
        NO_PD_FF,
        NO_VOL_FF,
        NO_VOL_PDC
    FROM fdheader_transformed_no_station_cast_float
)

select * from final
    );
  
  
[0m16:36:07.654471 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader_update_inc_date__dbt_tmp"
  
    as (
      

with fdheader_transformed_source as (
      select * from "nfirs"."nfirs_transformed"."fdheader_transformed"
),

fdheader_transformed_no_station_cast_float as (
    select
        *,
        CAST(NO_STATION as float) AS no_station_float
    FROM fdheader_transformed_source
),

final as (
    select
        STATE,
        FDID,
        FD_NAME,
        FD_STR_NO,
        FD_STR_PRE,
        FD_STREET,
        FD_STR_TYP,
        FD_STR_SUF,
        FD_CITY,
        FD_ZIP,
        FD_PHONE,
        FD_FAX,
        FD_EMAIL,
        FD_FIP_CITY,
        no_station_float AS NO_STATION,
        NO_PD_FF,
        NO_VOL_FF,
        NO_VOL_PDC
    FROM fdheader_transformed_no_station_cast_float
)

select * from final
    );
  
  
[0m16:36:07.654471 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:36:07.654471 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: ROLLBACK
[0m16:36:07.654471 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date'
[0m16:36:07.654471 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: Close
[0m16:36:07.654471 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__fdheader_update_inc_date (models\nfirs_transformed\nfirs_transformed__fdheader_update_inc_date.sql)
  Binder Error: Referenced column "FD_FIP_CITY" not found in FROM clause!
  Candidate bindings: "fdheader_transformed_no_station_cast_float.FD_FIP_CTY", "fdheader_transformed_no_station_cast_float.FD_CITY"
  LINE 39:         FD_FIP_CITY,
                   ^
[0m16:36:07.654471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c781ee8-6bda-4013-a775-6f7efe836c27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A26C38C0>]}
[0m16:36:07.654471 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__fdheader_update_inc_date  [[31mERROR[0m in 0.07s]
[0m16:36:07.654471 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:36:07.671033 [debug] [MainThread]: Using duckdb connection "master"
[0m16:36:07.671033 [debug] [MainThread]: On master: BEGIN
[0m16:36:07.671033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:07.690977 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:36:07.690977 [debug] [MainThread]: On master: COMMIT
[0m16:36:07.691976 [debug] [MainThread]: Using duckdb connection "master"
[0m16:36:07.691976 [debug] [MainThread]: On master: COMMIT
[0m16:36:07.693049 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:36:07.693049 [debug] [MainThread]: On master: Close
[0m16:36:07.693049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:07.693049 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:36:07.693049 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:36:07.693049 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:36:07.693049 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m16:36:07.693049 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date' was properly closed.
[0m16:36:07.693049 [info ] [MainThread]: 
[0m16:36:07.693049 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m16:36:07.693049 [debug] [MainThread]: Command end result
[0m16:36:07.720541 [info ] [MainThread]: 
[0m16:36:07.720541 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:36:07.721540 [info ] [MainThread]: 
[0m16:36:07.721540 [error] [MainThread]:   Runtime Error in model nfirs_transformed__fdheader_update_inc_date (models\nfirs_transformed\nfirs_transformed__fdheader_update_inc_date.sql)
  Binder Error: Referenced column "FD_FIP_CITY" not found in FROM clause!
  Candidate bindings: "fdheader_transformed_no_station_cast_float.FD_FIP_CTY", "fdheader_transformed_no_station_cast_float.FD_CITY"
  LINE 39:         FD_FIP_CITY,
                   ^
[0m16:36:07.722540 [info ] [MainThread]: 
[0m16:36:07.722540 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:36:07.723540 [debug] [MainThread]: Command `cli run` failed at 16:36:07.723540 after 0.88 seconds
[0m16:36:07.723540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A1FA37A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A1FCC980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A44EFC50>]}
[0m16:36:07.724540 [debug] [MainThread]: Flushing usage events
[0m16:36:49.935998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC719D3B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC719A1F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC719D0710>]}


============================== 16:36:49.935998 | 122ec23d-4dfd-406b-aacd-4900f5bc5754 ==============================
[0m16:36:49.935998 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:36:49.935998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:36:50.085860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '122ec23d-4dfd-406b-aacd-4900f5bc5754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC71C4A000>]}
[0m16:36:50.119175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '122ec23d-4dfd-406b-aacd-4900f5bc5754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC71C4BB00>]}
[0m16:36:50.119175 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:36:50.135978 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:36:50.235975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:50.235975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:50.268466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '122ec23d-4dfd-406b-aacd-4900f5bc5754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC71B946E0>]}
[0m16:36:50.335849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '122ec23d-4dfd-406b-aacd-4900f5bc5754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC71E76CC0>]}
[0m16:36:50.335849 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 408 macros
[0m16:36:50.335849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '122ec23d-4dfd-406b-aacd-4900f5bc5754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC71D9E3F0>]}
[0m16:36:50.335849 [info ] [MainThread]: 
[0m16:36:50.335849 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:36:50.335849 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:36:50.387609 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:36:50.387609 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:36:50.402319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:50.419032 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:50.419032 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:36:50.419032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:36:50.419032 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:36:50.434731 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:36:50.435631 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:36:50.435819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:50.452386 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:50.452386 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:36:50.452386 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:36:50.452386 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:50.452386 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:36:50.452386 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:36:50.452386 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:50.452386 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:36:50.452386 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:36:50.452386 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:36:50.452386 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:50.452386 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:36:50.469034 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:36:50.469034 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:36:50.469034 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:36:50.469034 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m16:36:50.469034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:50.469034 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:36:50.469034 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:36:50.485789 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:36:50.485789 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:50.485789 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m16:36:50.485789 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:36:50.485789 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:36:50.485789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:50.485789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:50.485789 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:36:50.485789 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:50.501457 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:50.501457 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:36:50.502423 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:36:50.502423 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m16:36:50.502423 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:36:50.519483 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:50.519483 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:36:50.519483 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:36:50.519483 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:36:50.519483 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:50.535676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:36:50.535676 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:36:50.535676 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m16:36:50.535676 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:36:50.535676 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m16:36:50.535676 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:36:50.535676 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m16:36:50.535676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '122ec23d-4dfd-406b-aacd-4900f5bc5754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC71E77080>]}
[0m16:36:50.535676 [debug] [MainThread]: Using duckdb connection "master"
[0m16:36:50.535676 [debug] [MainThread]: On master: BEGIN
[0m16:36:50.535676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:50.569087 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:36:50.569087 [debug] [MainThread]: On master: COMMIT
[0m16:36:50.569087 [debug] [MainThread]: Using duckdb connection "master"
[0m16:36:50.569087 [debug] [MainThread]: On master: COMMIT
[0m16:36:50.569087 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:36:50.569087 [debug] [MainThread]: On master: Close
[0m16:36:50.569087 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:36:50.569087 [info ] [MainThread]: 
[0m16:36:50.569087 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:36:50.569087 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__fdheader_update_inc_date  [RUN]
[0m16:36:50.569087 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date'
[0m16:36:50.569087 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:36:50.590175 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:36:50.591165 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:36:50.603862 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:36:50.603862 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:36:50.603862 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: BEGIN
[0m16:36:50.603862 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:36:50.620480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:50.634909 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:36:50.634909 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader_update_inc_date__dbt_tmp"
  
    as (
      

with fdheader_transformed_source as (
      select * from "nfirs"."nfirs_transformed"."fdheader_transformed"
),

fdheader_transformed_no_station_cast_float as (
    select
        *,
        CAST(NO_STATION as float) AS no_station_float
    FROM fdheader_transformed_source
),

final as (
    select
        STATE,
        FDID,
        FD_NAME,
        FD_STR_NO,
        FD_STR_PRE,
        FD_STREET,
        FD_STR_TYP,
        FD_STR_SUF,
        FD_CITY,
        FD_ZIP,
        FD_PHONE,
        FD_FAX,
        FD_EMAIL,
        FD_FIP_CTY,
        no_station_float AS NO_STATION,
        NO_PD_FF,
        NO_VOL_FF,
        NO_VOL_PDC
    FROM fdheader_transformed_no_station_cast_float
)

select * from final
    );
  
  
[0m16:36:50.684537 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:50.685821 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:36:50.685821 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader_update_inc_date__dbt_tmp" rename to "nfirs_transformed__fdheader_update_inc_date"
[0m16:36:50.685821 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:50.702715 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: COMMIT
[0m16:36:50.703194 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:36:50.703194 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: COMMIT
[0m16:36:50.735301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:50.735301 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"
[0m16:36:50.735301 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader_update_inc_date__dbt_backup" cascade
[0m16:36:50.735301 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:36:50.735301 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date: Close
[0m16:36:51.285306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '122ec23d-4dfd-406b-aacd-4900f5bc5754', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC73424980>]}
[0m16:36:51.285306 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__fdheader_update_inc_date  [[32mOK[0m in 0.72s]
[0m16:36:51.285306 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date
[0m16:36:51.285306 [debug] [MainThread]: Using duckdb connection "master"
[0m16:36:51.285306 [debug] [MainThread]: On master: BEGIN
[0m16:36:51.285306 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:51.307234 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:36:51.318050 [debug] [MainThread]: On master: COMMIT
[0m16:36:51.318050 [debug] [MainThread]: Using duckdb connection "master"
[0m16:36:51.319163 [debug] [MainThread]: On master: COMMIT
[0m16:36:51.321156 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:36:51.321156 [debug] [MainThread]: On master: Close
[0m16:36:51.322890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:51.322890 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:36:51.322890 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:36:51.322890 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m16:36:51.322890 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:36:51.322890 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_inc_date' was properly closed.
[0m16:36:51.322890 [info ] [MainThread]: 
[0m16:36:51.322890 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m16:36:51.322890 [debug] [MainThread]: Command end result
[0m16:36:51.344830 [info ] [MainThread]: 
[0m16:36:51.351356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:51.351356 [info ] [MainThread]: 
[0m16:36:51.352356 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:36:51.353356 [debug] [MainThread]: Command `cli run` succeeded at 16:36:51.352356 after 1.53 seconds
[0m16:36:51.353356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC6FD8C6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC71B2CE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC71B2E0F0>]}
[0m16:36:51.353356 [debug] [MainThread]: Flushing usage events
[0m16:43:28.629840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C152FD970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C17756810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C17757740>]}


============================== 16:43:28.633864 | f11a8e26-cf53-4d93-9c51-524a77e1e3b1 ==============================
[0m16:43:28.633864 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:43:28.633864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:28.789002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f11a8e26-cf53-4d93-9c51-524a77e1e3b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C16A746B0>]}
[0m16:43:28.829025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f11a8e26-cf53-4d93-9c51-524a77e1e3b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C19245D30>]}
[0m16:43:28.829847 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:43:28.835082 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:43:28.938073 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:43:28.938822 [debug] [MainThread]: Partial parsing: added file: nfirs_dbt_project_new://models\nfirs_transformed\nfirs_transformed__fdheader_update_no_station.sql
[0m16:43:28.938822 [debug] [MainThread]: Partial parsing: deleted file: nfirs_dbt_project_new://models\nfirs_transformed\nfirs_transformed__fdheader_update_inc_date.sql
[0m16:43:29.059847 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station' (models\nfirs_transformed\nfirs_transformed__fdheader_update_no_station.sql) depends on a node named 'fdheader_transformed' which was not found
[0m16:43:29.060806 [debug] [MainThread]: Command `cli run` failed at 16:43:29.060806 after 0.55 seconds
[0m16:43:29.060806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C152FD970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C191D6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C1927F5C0>]}
[0m16:43:29.061864 [debug] [MainThread]: Flushing usage events
[0m16:44:18.746870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024532C88D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245330824B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024533083CB0>]}


============================== 16:44:18.746870 | ee79562b-cdba-43bb-96fd-83fcd5af0b36 ==============================
[0m16:44:18.746870 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:44:18.746870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:44:18.897072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee79562b-cdba-43bb-96fd-83fcd5af0b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024531F94590>]}
[0m16:44:18.930641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee79562b-cdba-43bb-96fd-83fcd5af0b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024531FBF530>]}
[0m16:44:18.930641 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:44:18.946857 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:44:19.047152 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:44:19.047152 [debug] [MainThread]: Partial parsing: added file: nfirs_dbt_project_new://models\nfirs_transformed\nfirs_transformed__fdheader_update_no_station.sql
[0m16:44:19.047152 [debug] [MainThread]: Partial parsing: deleted file: nfirs_dbt_project_new://models\nfirs_transformed\nfirs_transformed__fdheader_update_inc_date.sql
[0m16:44:19.163511 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station' (models\nfirs_transformed\nfirs_transformed__fdheader_update_no_station.sql) depends on a node named 'fdheader_transformed' which was not found
[0m16:44:19.163511 [debug] [MainThread]: Command `cli run` failed at 16:44:19.163511 after 0.53 seconds
[0m16:44:19.163511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024533083CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024534BA7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024532539AF0>]}
[0m16:44:19.163511 [debug] [MainThread]: Flushing usage events
[0m16:46:02.280969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5E9736E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5E9717F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5FEFBDD0>]}


============================== 16:46:02.280969 | 4c438dc8-ab63-49ba-98ec-0d1817818908 ==============================
[0m16:46:02.280969 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:46:02.280969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:46:02.430966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c438dc8-ab63-49ba-98ec-0d1817818908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5D8F45F0>]}
[0m16:46:02.464587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c438dc8-ab63-49ba-98ec-0d1817818908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5E21CBF0>]}
[0m16:46:02.464587 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:46:02.464587 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:46:02.581382 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:46:02.581382 [debug] [MainThread]: Partial parsing: added file: nfirs_dbt_project_new://models\nfirs_transformed\nfirs_transformed__fdheader_update_no_station.sql
[0m16:46:02.581382 [debug] [MainThread]: Partial parsing: deleted file: nfirs_dbt_project_new://models\nfirs_transformed\nfirs_transformed__fdheader_update_inc_date.sql
[0m16:46:02.747446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c438dc8-ab63-49ba-98ec-0d1817818908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A60350440>]}
[0m16:46:02.813936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c438dc8-ab63-49ba-98ec-0d1817818908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6066F5C0>]}
[0m16:46:02.813936 [info ] [MainThread]: Found 4 models, 4 data tests, 1 source, 408 macros
[0m16:46:02.813936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c438dc8-ab63-49ba-98ec-0d1817818908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A60347200>]}
[0m16:46:02.813936 [info ] [MainThread]: 
[0m16:46:02.813936 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:46:02.813936 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:46:02.882260 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:46:02.882260 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:46:02.882260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:02.897354 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:46:02.897354 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:46:02.914623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:46:02.914623 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:46:02.914623 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:46:02.914623 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:46:02.914623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:02.930806 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:46:02.930806 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:46:02.930806 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:46:02.930806 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:46:02.930806 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:46:02.930806 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:46:02.930806 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:46:02.930806 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:46:02.946513 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:46:02.947393 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:46:02.947393 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:46:02.947393 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:46:02.947393 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:46:02.947393 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:46:02.947393 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m16:46:02.947393 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:46:02.947393 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:46:02.963845 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:46:02.963845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:02.963845 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:46:02.963845 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m16:46:02.980575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:46:02.980575 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:46:02.980575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:02.980575 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:46:02.980575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:02.980575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:46:02.980575 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:46:02.980575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:46:02.980575 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:46:02.980575 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:46:02.980575 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m16:46:02.980575 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:46:03.014282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:46:03.014282 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:46:03.014282 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:46:03.014282 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:46:03.014282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:46:03.031060 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:46:03.014282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:46:03.032008 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:46:03.033070 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m16:46:03.034104 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:46:03.035043 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m16:46:03.035512 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m16:46:03.035512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c438dc8-ab63-49ba-98ec-0d1817818908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A6064AC30>]}
[0m16:46:03.035512 [debug] [MainThread]: Using duckdb connection "master"
[0m16:46:03.035512 [debug] [MainThread]: On master: BEGIN
[0m16:46:03.035512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:03.064419 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:46:03.065457 [debug] [MainThread]: On master: COMMIT
[0m16:46:03.065457 [debug] [MainThread]: Using duckdb connection "master"
[0m16:46:03.065457 [debug] [MainThread]: On master: COMMIT
[0m16:46:03.066447 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:46:03.066447 [debug] [MainThread]: On master: Close
[0m16:46:03.069294 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:46:03.069294 [info ] [MainThread]: 
[0m16:46:03.069294 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station
[0m16:46:03.069294 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__fdheader_update_no_station  [RUN]
[0m16:46:03.069294 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station'
[0m16:46:03.079974 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station
[0m16:46:03.085325 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station"
[0m16:46:03.085325 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station
[0m16:46:03.100561 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station"
[0m16:46:03.113345 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station"
[0m16:46:03.114345 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station: BEGIN
[0m16:46:03.114345 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:46:03.131692 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:46:03.131692 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station"
[0m16:46:03.131692 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader_update_no_station__dbt_tmp"
  
    as (
      

with fdheader_transformed_source as (
      select * from "nfirs"."nfirs_transformed"."fdheader_transformed"
),

fdheader_transformed_no_station_cast_float as (
    select
        *,
        CAST(NO_STATION as float) AS no_station_float
    FROM fdheader_transformed_source
),

final as (
    select
        STATE,
        FDID,
        FD_NAME,
        FD_STR_NO,
        FD_STR_PRE,
        FD_STREET,
        FD_STR_TYP,
        FD_STR_SUF,
        FD_CITY,
        FD_ZIP,
        FD_PHONE,
        FD_FAX,
        FD_EMAIL,
        FD_FIP_CTY,
        no_station_float AS NO_STATION,
        NO_PD_FF,
        NO_VOL_FF,
        NO_VOL_PDC
    FROM fdheader_transformed_no_station_cast_float
)

select * from final
    );
  
  
[0m16:46:03.181452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:46:03.181452 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station"
[0m16:46:03.181452 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader_update_no_station__dbt_tmp" rename to "nfirs_transformed__fdheader_update_no_station"
[0m16:46:03.181452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:46:03.197978 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station: COMMIT
[0m16:46:03.197978 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station"
[0m16:46:03.197978 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station: COMMIT
[0m16:46:03.231621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:46:03.231621 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station"
[0m16:46:03.231621 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader_update_no_station__dbt_backup" cascade
[0m16:46:03.231621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:46:03.231621 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station: Close
[0m16:46:03.634006 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c438dc8-ab63-49ba-98ec-0d1817818908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5D8BB590>]}
[0m16:46:03.635009 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__fdheader_update_no_station  [[32mOK[0m in 0.56s]
[0m16:46:03.636003 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station
[0m16:46:03.637984 [debug] [MainThread]: Using duckdb connection "master"
[0m16:46:03.638962 [debug] [MainThread]: On master: BEGIN
[0m16:46:03.638962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:46:03.651567 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:46:03.651567 [debug] [MainThread]: On master: COMMIT
[0m16:46:03.651567 [debug] [MainThread]: Using duckdb connection "master"
[0m16:46:03.651567 [debug] [MainThread]: On master: COMMIT
[0m16:46:03.651567 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:46:03.651567 [debug] [MainThread]: On master: Close
[0m16:46:03.665693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:03.665693 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:46:03.665693 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:46:03.665693 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m16:46:03.665693 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:46:03.665693 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader_update_no_station' was properly closed.
[0m16:46:03.665693 [info ] [MainThread]: 
[0m16:46:03.665693 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m16:46:03.665693 [debug] [MainThread]: Command end result
[0m16:46:03.687717 [info ] [MainThread]: 
[0m16:46:03.687717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:46:03.687717 [info ] [MainThread]: 
[0m16:46:03.687717 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:46:03.687717 [debug] [MainThread]: Command `cli run` succeeded at 16:46:03.687717 after 1.53 seconds
[0m16:46:03.687717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5E0CD100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5BCEC290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A5E36CC20>]}
[0m16:46:03.687717 [debug] [MainThread]: Flushing usage events
[0m15:01:34.956427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A90DDB23F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A90DDB0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A90EF462A0>]}


============================== 15:01:34.956427 | c980dea4-1c6a-4f24-9539-fba741d6092c ==============================
[0m15:01:34.956427 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:01:34.972466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:01:35.122956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c980dea4-1c6a-4f24-9539-fba741d6092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A90F78B230>]}
[0m15:01:35.157534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c980dea4-1c6a-4f24-9539-fba741d6092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A90F5AE090>]}
[0m15:01:35.157534 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:01:35.173091 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:01:35.278744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:35.278744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:35.306144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c980dea4-1c6a-4f24-9539-fba741d6092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A910C7FBF0>]}
[0m15:01:35.389982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c980dea4-1c6a-4f24-9539-fba741d6092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A910DF31D0>]}
[0m15:01:35.389982 [info ] [MainThread]: Found 3 models, 4 data tests, 19 sources, 408 macros
[0m15:01:35.389982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c980dea4-1c6a-4f24-9539-fba741d6092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A910E2E240>]}
[0m15:01:35.389982 [info ] [MainThread]: 
[0m15:01:35.389982 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:01:35.389982 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:01:35.622995 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:01:35.638695 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:01:35.638995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:35.656040 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:35.656040 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:01:35.656040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:01:35.656040 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:01:35.656040 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:01:35.656040 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:01:35.656040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:35.672792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:35.672792 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:01:35.672792 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:01:35.672792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:35.672792 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:01:35.672792 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:01:35.672792 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:35.672792 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:01:35.672792 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:01:35.688491 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:01:35.689920 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:35.689920 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:01:35.839546 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:01:35.839546 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:01:35.839546 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:01:35.839546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:35.839546 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:01:35.856131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:35.872199 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:01:35.872811 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:01:35.872811 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:01:35.872811 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:01:35.872811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:35.872811 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:35.872811 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:01:35.872811 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:01:35.889634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:35.889634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:01:35.889634 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:01:35.889634 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:01:35.906027 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:01:35.906027 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:01:35.906027 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:01:35.906027 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:01:35.906027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c980dea4-1c6a-4f24-9539-fba741d6092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A910BFF110>]}
[0m15:01:35.906027 [debug] [MainThread]: Using duckdb connection "master"
[0m15:01:35.906027 [debug] [MainThread]: On master: BEGIN
[0m15:01:35.906027 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:35.922709 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:01:35.922709 [debug] [MainThread]: On master: COMMIT
[0m15:01:35.922709 [debug] [MainThread]: Using duckdb connection "master"
[0m15:01:35.922709 [debug] [MainThread]: On master: COMMIT
[0m15:01:35.922709 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:01:35.922709 [debug] [MainThread]: On master: Close
[0m15:01:35.922709 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:01:35.922709 [info ] [MainThread]: 
[0m15:01:35.939408 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test
[0m15:01:35.939408 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update_test  [RUN]
[0m15:01:35.939408 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test'
[0m15:01:35.939408 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test
[0m15:01:35.948180 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"
[0m15:01:35.948180 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test
[0m15:01:35.973789 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"
[0m15:01:35.981161 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"
[0m15:01:35.981161 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test: BEGIN
[0m15:01:35.981161 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:01:35.990481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:01:35.990481 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"
[0m15:01:35.990481 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arson_inc_date_update_test__dbt_tmp"
  
    as (
      

with arson_transformed_source as (
      select * from "nfirs"."nfirs_raw"."arson"
),

arson_transformed_inc_date_update as (
    select
        *,
        cast(INC_DATE as date) as INC_DATE_DATE
    FROM arson_transformed_source
),

final as (
    select
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_DATE as INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        CASE_STAT,
        AVAIL_MFI,
        MOT_FACTS1,
        MOT_FACTS2,
        MOT_FACTS3,
        GRP_INVOL1,
        GRP_INVOL2,
        GRP_INVOL3,
        ENTRY_METH,
        EXT_FIRE,
        DEVI_CONT,
        DEVI_IGNIT,
        DEVI_FUEL,
        INV_INFO1,
        INV_INFO2,
        INV_INFO3,
        INV_INFO4,
        INV_INFO5,
        INV_INFO6,
        INV_INFO7,
        INV_INFO8,
        PROP_OWNER,
        INIT_OB1,
        INIT_OB2,
        INIT_OB3,
        INIT_OB4,
        INIT_OB5,
        INIT_OB6,
        INIT_OB7,
        INIT_OB8,
        LAB_USED1,
        LAB_USED2,
        LAB_USED3,
        LAB_USED4,
        LAB_USED5,
        LAB_USED6
    FROM arson_transformed_inc_date_update
)

select * from final
    );
  
  
[0m15:01:36.005896 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arson_inc_date_update_test__dbt_tmp"
  
    as (
      

with arson_transformed_source as (
      select * from "nfirs"."nfirs_raw"."arson"
),

arson_transformed_inc_date_update as (
    select
        *,
        cast(INC_DATE as date) as INC_DATE_DATE
    FROM arson_transformed_source
),

final as (
    select
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_DATE as INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        CASE_STAT,
        AVAIL_MFI,
        MOT_FACTS1,
        MOT_FACTS2,
        MOT_FACTS3,
        GRP_INVOL1,
        GRP_INVOL2,
        GRP_INVOL3,
        ENTRY_METH,
        EXT_FIRE,
        DEVI_CONT,
        DEVI_IGNIT,
        DEVI_FUEL,
        INV_INFO1,
        INV_INFO2,
        INV_INFO3,
        INV_INFO4,
        INV_INFO5,
        INV_INFO6,
        INV_INFO7,
        INV_INFO8,
        PROP_OWNER,
        INIT_OB1,
        INIT_OB2,
        INIT_OB3,
        INIT_OB4,
        INIT_OB5,
        INIT_OB6,
        INIT_OB7,
        INIT_OB8,
        LAB_USED1,
        LAB_USED2,
        LAB_USED3,
        LAB_USED4,
        LAB_USED5,
        LAB_USED6
    FROM arson_transformed_inc_date_update
)

select * from final
    );
  
  
[0m15:01:36.005896 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:01:36.005896 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test: ROLLBACK
[0m15:01:36.005896 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test'
[0m15:01:36.005896 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test: Close
[0m15:01:36.022575 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__arson_inc_date_update_test (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update_test.sql)
  Conversion Error: date field value out of range: "05302022", expected format is (YYYY-MM-DD)
  LINE 20:         cast(INC_DATE as date) as INC_DATE_DATE
                   ^
[0m15:01:36.022575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c980dea4-1c6a-4f24-9539-fba741d6092c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A90F0C7B60>]}
[0m15:01:36.022575 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update_test  [[31mERROR[0m in 0.08s]
[0m15:01:36.022575 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test
[0m15:01:36.022575 [debug] [MainThread]: Using duckdb connection "master"
[0m15:01:36.022575 [debug] [MainThread]: On master: BEGIN
[0m15:01:36.022575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:01:36.039417 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:01:36.039417 [debug] [MainThread]: On master: COMMIT
[0m15:01:36.047660 [debug] [MainThread]: Using duckdb connection "master"
[0m15:01:36.047660 [debug] [MainThread]: On master: COMMIT
[0m15:01:36.047660 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:01:36.047660 [debug] [MainThread]: On master: Close
[0m15:01:36.047660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:36.047660 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:01:36.047660 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:01:36.047660 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:01:36.047660 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test' was properly closed.
[0m15:01:36.047660 [info ] [MainThread]: 
[0m15:01:36.047660 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m15:01:36.047660 [debug] [MainThread]: Command end result
[0m15:01:36.073627 [info ] [MainThread]: 
[0m15:01:36.073627 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:01:36.078694 [info ] [MainThread]: 
[0m15:01:36.078694 [error] [MainThread]:   Runtime Error in model nfirs_transformed__arson_inc_date_update_test (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update_test.sql)
  Conversion Error: date field value out of range: "05302022", expected format is (YYYY-MM-DD)
  LINE 20:         cast(INC_DATE as date) as INC_DATE_DATE
                   ^
[0m15:01:36.078694 [info ] [MainThread]: 
[0m15:01:36.078694 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:01:36.078694 [debug] [MainThread]: Command `cli run` failed at 15:01:36.078694 after 1.28 seconds
[0m15:01:36.078694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A90E673140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A90EF462A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A90ED19760>]}
[0m15:01:36.078694 [debug] [MainThread]: Flushing usage events
[0m15:21:38.081418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BF52BC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BF528920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BF5289B0>]}


============================== 15:21:38.084416 | 1066edee-548d-44f4-aa1b-fbb272e31f1d ==============================
[0m15:21:38.084416 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:21:38.085423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:38.228229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1066edee-548d-44f4-aa1b-fbb272e31f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BF73D3A0>]}
[0m15:21:38.262055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1066edee-548d-44f4-aa1b-fbb272e31f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BF758050>]}
[0m15:21:38.262055 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:21:38.280319 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:21:38.384580 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:38.384580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:38.415572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1066edee-548d-44f4-aa1b-fbb272e31f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BFA40590>]}
[0m15:21:38.489531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1066edee-548d-44f4-aa1b-fbb272e31f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BFC6EBA0>]}
[0m15:21:38.490530 [info ] [MainThread]: Found 3 models, 4 data tests, 19 sources, 408 macros
[0m15:21:38.490530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1066edee-548d-44f4-aa1b-fbb272e31f1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BF9D33B0>]}
[0m15:21:38.491535 [info ] [MainThread]: 
[0m15:21:38.492586 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:21:38.493496 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:21:38.558572 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:21:38.558572 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:21:38.559532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:38.692488 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:21:38.693447 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m15:21:38.694459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:38.694459 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m15:21:38.695496 [info ] [MainThread]: 
[0m15:21:38.695496 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m15:21:38.696419 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 4888)
[0m15:21:38.697451 [debug] [MainThread]: Command `cli run` failed at 15:21:38.697451 after 0.72 seconds
[0m15:21:38.697451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BD4B8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BFC526C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210BFFC49E0>]}
[0m15:21:38.698418 [debug] [MainThread]: Flushing usage events
[0m15:21:49.522445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEAF48EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFE98598B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEC3472C0>]}


============================== 15:21:49.539260 | 28d39dd8-b3b0-4382-a77a-7e0d96366eb0 ==============================
[0m15:21:49.539260 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:21:49.539260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:21:49.688884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28d39dd8-b3b0-4382-a77a-7e0d96366eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEB680860>]}
[0m15:21:49.725941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28d39dd8-b3b0-4382-a77a-7e0d96366eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEDEA43B0>]}
[0m15:21:49.725941 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:21:49.725941 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:21:49.844128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:49.844128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:49.875557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28d39dd8-b3b0-4382-a77a-7e0d96366eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEE0B0590>]}
[0m15:21:49.938951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28d39dd8-b3b0-4382-a77a-7e0d96366eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEE2DAB40>]}
[0m15:21:49.938951 [info ] [MainThread]: Found 3 models, 4 data tests, 19 sources, 408 macros
[0m15:21:49.938951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28d39dd8-b3b0-4382-a77a-7e0d96366eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEDDDCD70>]}
[0m15:21:49.938951 [info ] [MainThread]: 
[0m15:21:49.938951 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:21:49.938951 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:21:50.007601 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:21:50.007601 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:21:50.007601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:50.023742 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:50.023742 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:21:50.023742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:21:50.023742 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:21:50.039100 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:21:50.039100 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:21:50.039100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:50.054766 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:50.055671 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:21:50.055671 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:21:50.055671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:50.055671 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:21:50.055671 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:21:50.055671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:50.055671 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:21:50.055671 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:21:50.055671 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:21:50.055671 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:50.055671 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:21:50.055671 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:21:50.055671 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:21:50.072306 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:21:50.072306 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:21:50.072306 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:21:50.072306 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:21:50.072306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:50.072306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:50.088901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:50.088901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:50.088901 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:21:50.088901 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:21:50.088901 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:21:50.088901 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:21:50.121668 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:50.122319 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:50.122319 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:21:50.122319 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:21:50.122319 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:21:50.122319 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:21:50.122319 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:21:50.122319 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:21:50.122319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28d39dd8-b3b0-4382-a77a-7e0d96366eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEB6AB9E0>]}
[0m15:21:50.122319 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:50.122319 [debug] [MainThread]: On master: BEGIN
[0m15:21:50.122319 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:50.138858 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:50.138858 [debug] [MainThread]: On master: COMMIT
[0m15:21:50.138858 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:50.138858 [debug] [MainThread]: On master: COMMIT
[0m15:21:50.138858 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:50.138858 [debug] [MainThread]: On master: Close
[0m15:21:50.154728 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:21:50.155391 [info ] [MainThread]: 
[0m15:21:50.159465 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test
[0m15:21:50.160643 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update_test  [RUN]
[0m15:21:50.160643 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test'
[0m15:21:50.161739 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test
[0m15:21:50.167569 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"
[0m15:21:50.168700 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test
[0m15:21:50.190894 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"
[0m15:21:50.192077 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"
[0m15:21:50.192077 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test: BEGIN
[0m15:21:50.193227 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:21:50.206815 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:50.206815 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"
[0m15:21:50.206815 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arson_inc_date_update_test__dbt_tmp"
  
    as (
      

with arson_transformed_source as (
      select * from "nfirs"."nfirs_raw"."arson"
),

arson_transformed_inc_date_update as (
    select
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM arson_transformed_source
),

final as (
    select
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE as INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        CASE_STAT,
        AVAIL_MFI,
        MOT_FACTS1,
        MOT_FACTS2,
        MOT_FACTS3,
        GRP_INVOL1,
        GRP_INVOL2,
        GRP_INVOL3,
        ENTRY_METH,
        EXT_FIRE,
        DEVI_CONT,
        DEVI_IGNIT,
        DEVI_FUEL,
        INV_INFO1,
        INV_INFO2,
        INV_INFO3,
        INV_INFO4,
        INV_INFO5,
        INV_INFO6,
        INV_INFO7,
        INV_INFO8,
        PROP_OWNER,
        INIT_OB1,
        INIT_OB2,
        INIT_OB3,
        INIT_OB4,
        INIT_OB5,
        INIT_OB6,
        INIT_OB7,
        INIT_OB8,
        LAB_USED1,
        LAB_USED2,
        LAB_USED3,
        LAB_USED4,
        LAB_USED5,
        LAB_USED6
    FROM arson_transformed_inc_date_update
)

select * from final
    );
  
  
[0m15:21:50.372177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:50.389409 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"
[0m15:21:50.389409 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__arson_inc_date_update_test__dbt_tmp" rename to "nfirs_transformed__arson_inc_date_update_test"
[0m15:21:50.389409 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:50.405135 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test: COMMIT
[0m15:21:50.405717 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"
[0m15:21:50.405717 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test: COMMIT
[0m15:21:51.396417 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m15:21:51.405602 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"
[0m15:21:51.405602 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__arson_inc_date_update_test__dbt_backup" cascade
[0m15:21:51.405602 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:51.405602 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test: Close
[0m15:21:51.438467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28d39dd8-b3b0-4382-a77a-7e0d96366eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEE043290>]}
[0m15:21:51.438467 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update_test  [[32mOK[0m in 1.28s]
[0m15:21:51.438467 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test
[0m15:21:51.438467 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:51.438467 [debug] [MainThread]: On master: BEGIN
[0m15:21:51.438467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:51.459648 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:51.459648 [debug] [MainThread]: On master: COMMIT
[0m15:21:51.459648 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:51.459648 [debug] [MainThread]: On master: COMMIT
[0m15:21:51.459648 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:51.459648 [debug] [MainThread]: On master: Close
[0m15:21:51.471234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:51.471234 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:21:51.471234 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:21:51.471234 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:21:51.474048 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update_test' was properly closed.
[0m15:21:51.474792 [info ] [MainThread]: 
[0m15:21:51.474792 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m15:21:51.474792 [debug] [MainThread]: Command end result
[0m15:21:51.490497 [info ] [MainThread]: 
[0m15:21:51.490497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:51.490497 [info ] [MainThread]: 
[0m15:21:51.496723 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:21:51.496723 [debug] [MainThread]: Command `cli run` succeeded at 15:21:51.496723 after 2.07 seconds
[0m15:21:51.496723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEAF48EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEDE014F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFEE28FDD0>]}
[0m15:21:51.496723 [debug] [MainThread]: Flushing usage events
[0m16:00:54.945648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFBF13980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF94D6CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFBF12F30>]}


============================== 16:00:54.948648 | 4c7c8794-759a-47b2-bf8f-264ddd86db92 ==============================
[0m16:00:54.948648 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:00:54.949603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:00:55.033101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c7c8794-759a-47b2-bf8f-264ddd86db92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFC577920>]}
[0m16:00:55.066028 [debug] [MainThread]: Set downloads directory='C:\Users\JAVIER~1.FLO\AppData\Local\Temp\dbt-downloads-d565uds_'
[0m16:00:55.066028 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:00:55.364774 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:00:55.365786 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:00:55.680545 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:00:55.702407 [info ] [MainThread]: Updating lock file in file path: C:\Users\javier.flores\Desktop\Portfolio\NFIRS Data Pipeline and Analysis\nfirs_dbt_2/package-lock.yml
[0m16:00:55.706976 [debug] [MainThread]: Set downloads directory='C:\Users\JAVIER~1.FLO\AppData\Local\Temp\dbt-downloads-7oss3ikl'
[0m16:00:55.713021 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:00:56.843322 [info ] [MainThread]: Installed from version 1.2.0
[0m16:00:56.844308 [info ] [MainThread]: Up to date!
[0m16:00:56.844308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4c7c8794-759a-47b2-bf8f-264ddd86db92', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFB783EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFDBCC620>]}
[0m16:00:56.846308 [debug] [MainThread]: Command `dbt deps` succeeded at 16:00:56.846308 after 2.01 seconds
[0m16:00:56.846308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAF94D6CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFC401970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAFB8545C0>]}
[0m16:00:56.847310 [debug] [MainThread]: Flushing usage events
[0m16:03:15.640636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD5F593350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD5EE691C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD5EE6AED0>]}


============================== 16:03:15.643718 | ecd7b64b-b540-4082-8f79-87df1bcdbe96 ==============================
[0m16:03:15.643718 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:03:15.643718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:15.792713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecd7b64b-b540-4082-8f79-87df1bcdbe96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD610A7740>]}
[0m16:03:15.833048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecd7b64b-b540-4082-8f79-87df1bcdbe96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD60EDBE30>]}
[0m16:03:15.834042 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:03:15.843920 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:03:15.961498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:15.962498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:15.992494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecd7b64b-b540-4082-8f79-87df1bcdbe96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD613979E0>]}
[0m16:03:16.065404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecd7b64b-b540-4082-8f79-87df1bcdbe96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD6144BF50>]}
[0m16:03:16.065404 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m16:03:16.066408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecd7b64b-b540-4082-8f79-87df1bcdbe96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD61395D00>]}
[0m16:03:16.067403 [info ] [MainThread]: 
[0m16:03:16.068379 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:03:16.069390 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:03:16.134210 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:03:16.134210 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:03:16.134210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:16.152605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:16.153579 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:03:16.158254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs)
[0m16:03:16.159265 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs"
"
[0m16:03:16.164260 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m16:03:16.164260 [debug] [ThreadPool]: On create_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:03:16.164260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:16.179976 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:16.181017 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m16:03:16.182017 [debug] [ThreadPool]: On create_nfirs_nfirs: BEGIN
[0m16:03:16.182017 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:16.182017 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m16:03:16.183051 [debug] [ThreadPool]: On create_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs"} */

    
    
        create schema if not exists "nfirs"."nfirs"
    
[0m16:03:16.183051 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:16.184024 [debug] [ThreadPool]: On create_nfirs_nfirs: COMMIT
[0m16:03:16.184024 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m16:03:16.184024 [debug] [ThreadPool]: On create_nfirs_nfirs: COMMIT
[0m16:03:16.194621 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:16.194621 [debug] [ThreadPool]: On create_nfirs_nfirs: Close
[0m16:03:16.398421 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:03:16.402497 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:03:16.403491 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:03:16.403491 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:03:16.405060 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:03:16.405060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:16.406093 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:03:16.421307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:16.421307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:16.422310 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:03:16.423280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:16.423280 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:03:16.423820 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:03:16.424831 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:03:16.455946 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:16.456986 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:03:16.457993 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:03:16.458994 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:03:16.458994 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:03:16.459944 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:03:16.460991 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:03:16.460991 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:03:16.466950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecd7b64b-b540-4082-8f79-87df1bcdbe96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD61139E50>]}
[0m16:03:16.467951 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:16.467951 [debug] [MainThread]: On master: BEGIN
[0m16:03:16.467951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:16.482707 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:03:16.483707 [debug] [MainThread]: On master: COMMIT
[0m16:03:16.483707 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:16.484712 [debug] [MainThread]: On master: COMMIT
[0m16:03:16.484712 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:03:16.484712 [debug] [MainThread]: On master: Close
[0m16:03:16.489356 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:03:16.489356 [info ] [MainThread]: 
[0m16:03:16.493333 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.convert_inc_date
[0m16:03:16.493333 [info ] [Thread-1 (]: 1 of 1 START sql view model nfirs.convert_inc_date ............................. [RUN]
[0m16:03:16.494375 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.convert_inc_date'
[0m16:03:16.494375 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.convert_inc_date
[0m16:03:16.514354 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:03:16.515353 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: BEGIN
[0m16:03:16.515353 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:03:16.529614 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:16.530654 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:03:16.530654 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */


      

    

        select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from nfirs.information_schema.tables
        where table_schema ilike 'nfirs_raw'
        and table_name ilike '%'
        and table_name not ilike ''


    

[0m16:03:16.559289 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:16.565321 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:03:16.566326 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'arsonjuvsub'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:03:16.582689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:16.585720 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:03:16.585720 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
        CREATE TABLE nfirs_transformed__arsonjuvsub AS
        SELECT
            *,
            STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
        FROM "nfirs"."nfirs_raw"."arsonjuvsub";
        
  
[0m16:03:16.598089 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:16.600087 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:03:16.601014 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'basicaid'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:03:16.613012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:16.614008 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:03:16.615014 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
        CREATE TABLE nfirs_transformed__basicaid AS
        SELECT
            *,
            STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
        FROM "nfirs"."nfirs_raw"."basicaid";
        
  
[0m16:03:16.936777 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:16.938936 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:03:16.938936 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'incidentaddress'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:03:16.951934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:16.953968 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:03:16.954406 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
        CREATE TABLE nfirs_transformed__incidentaddress AS
        SELECT
            *,
            STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
        FROM "nfirs"."nfirs_raw"."incidentaddress";
        
  
[0m16:03:26.972611 [debug] [Thread-1 (]: SQL status: OK in 10.0 seconds
[0m16:03:26.978623 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:03:26.979608 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'codelookup'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:03:27.012200 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:27.016203 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:03:27.016978 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fireincident'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:03:27.049957 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:27.054038 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:03:27.055042 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
        CREATE TABLE nfirs_transformed__fireincident AS
        SELECT
            *,
            STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
        FROM "nfirs"."nfirs_raw"."fireincident";
        
  
[0m16:03:29.802646 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m16:03:29.805643 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:03:29.806608 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'structurefirecauses'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:03:29.838179 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:03:29.840214 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:03:29.841167 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
        CREATE TABLE nfirs_transformed__structurefirecauses AS
        SELECT
            *,
            STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
        FROM "nfirs"."nfirs_raw"."structurefirecauses";
        
  
[0m16:03:29.867242 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
        CREATE TABLE nfirs_transformed__structurefirecauses AS
        SELECT
            *,
            STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
        FROM "nfirs"."nfirs_raw"."structurefirecauses";
        
  
[0m16:03:29.868241 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:03:29.870247 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: ROLLBACK
[0m16:03:29.881953 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.convert_inc_date'
[0m16:03:29.882953 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: Close
[0m16:03:30.880596 [debug] [Thread-1 (]: Runtime Error in model convert_inc_date (models\nfirs_transformed\convert_inc_date.sql)
  Invalid Input Error: Could not parse string "2102022" according to format specifier "%m%d%Y"
  2102022
  ^
  Error: Month out of range, expected a value between 1 and 12
[0m16:03:30.883092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecd7b64b-b540-4082-8f79-87df1bcdbe96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD61A657F0>]}
[0m16:03:30.885092 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model nfirs.convert_inc_date .................... [[31mERROR[0m in 14.39s]
[0m16:03:30.886092 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.convert_inc_date
[0m16:03:30.891091 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:30.892091 [debug] [MainThread]: On master: BEGIN
[0m16:03:30.893091 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:31.303304 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:03:31.304341 [debug] [MainThread]: On master: COMMIT
[0m16:03:31.304341 [debug] [MainThread]: Using duckdb connection "master"
[0m16:03:31.305360 [debug] [MainThread]: On master: COMMIT
[0m16:03:31.306344 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:03:31.306344 [debug] [MainThread]: On master: Close
[0m16:03:31.316082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:31.317150 [debug] [MainThread]: Connection 'create_nfirs_nfirs' was properly closed.
[0m16:03:31.317150 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:03:31.318159 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:03:31.318159 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.convert_inc_date' was properly closed.
[0m16:03:31.319422 [info ] [MainThread]: 
[0m16:03:31.320493 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 15.25 seconds (15.25s).
[0m16:03:31.321449 [debug] [MainThread]: Command end result
[0m16:03:31.359621 [info ] [MainThread]: 
[0m16:03:31.361546 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:03:31.362546 [info ] [MainThread]: 
[0m16:03:31.362546 [error] [MainThread]:   Runtime Error in model convert_inc_date (models\nfirs_transformed\convert_inc_date.sql)
  Invalid Input Error: Could not parse string "2102022" according to format specifier "%m%d%Y"
  2102022
  ^
  Error: Month out of range, expected a value between 1 and 12
[0m16:03:31.363588 [info ] [MainThread]: 
[0m16:03:31.364572 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:03:31.366546 [debug] [MainThread]: Command `cli run` failed at 16:03:31.366546 after 15.83 seconds
[0m16:03:31.367546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD61654E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD61654B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD61655580>]}
[0m16:03:31.367546 [debug] [MainThread]: Flushing usage events
[0m16:24:03.962419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819B5F8AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819B5FB380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819B5FB3B0>]}


============================== 16:24:03.965460 | 0d00a433-3d06-4791-b7e8-fd55a59e88b2 ==============================
[0m16:24:03.965460 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:24:03.966470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:24:04.118767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d00a433-3d06-4791-b7e8-fd55a59e88b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819B9E1790>]}
[0m16:24:04.160045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d00a433-3d06-4791-b7e8-fd55a59e88b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819906F650>]}
[0m16:24:04.161052 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:24:04.170044 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:24:04.289638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:04.289638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:04.319638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d00a433-3d06-4791-b7e8-fd55a59e88b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819BA9F950>]}
[0m16:24:04.393581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d00a433-3d06-4791-b7e8-fd55a59e88b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819BD1EBD0>]}
[0m16:24:04.393581 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m16:24:04.394553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d00a433-3d06-4791-b7e8-fd55a59e88b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819BA9C140>]}
[0m16:24:04.395580 [info ] [MainThread]: 
[0m16:24:04.395580 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:24:04.396594 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:24:04.454730 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:24:04.454730 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:24:04.455789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:04.533221 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:24:04.534221 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:24:04.535221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:04.536255 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m16:24:04.536255 [info ] [MainThread]: 
[0m16:24:04.537221 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m16:24:04.538221 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 28392)
[0m16:24:04.539253 [debug] [MainThread]: Command `cli run` failed at 16:24:04.539253 after 0.69 seconds
[0m16:24:04.540258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819A31AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819A2F36E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001819BD16ED0>]}
[0m16:24:04.540258 [debug] [MainThread]: Flushing usage events
[0m16:24:17.552026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDEA43530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDE8754F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDE73E900>]}


============================== 16:24:17.556060 | 015f5c55-e26b-47bf-bcd2-855f62d2af87 ==============================
[0m16:24:17.556060 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:24:17.556060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:24:17.709575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '015f5c55-e26b-47bf-bcd2-855f62d2af87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE057FC20>]}
[0m16:24:17.751773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '015f5c55-e26b-47bf-bcd2-855f62d2af87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE058A150>]}
[0m16:24:17.752768 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:24:17.761769 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:24:17.882660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:24:17.882660 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:24:17.914615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '015f5c55-e26b-47bf-bcd2-855f62d2af87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE07A4230>]}
[0m16:24:17.990512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '015f5c55-e26b-47bf-bcd2-855f62d2af87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE0A3E7E0>]}
[0m16:24:17.990512 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m16:24:17.991512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '015f5c55-e26b-47bf-bcd2-855f62d2af87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE08A3530>]}
[0m16:24:17.992691 [info ] [MainThread]: 
[0m16:24:17.992691 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:24:17.993762 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:24:18.051896 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:24:18.052886 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:24:18.053341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:18.071917 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:18.073917 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:24:18.078916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs)
[0m16:24:18.078916 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs"
"
[0m16:24:18.085639 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m16:24:18.085639 [debug] [ThreadPool]: On create_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:24:18.085639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:18.103336 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:18.105337 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m16:24:18.105337 [debug] [ThreadPool]: On create_nfirs_nfirs: BEGIN
[0m16:24:18.105337 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:18.106337 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m16:24:18.106337 [debug] [ThreadPool]: On create_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs"} */

    
    
        create schema if not exists "nfirs"."nfirs"
    
[0m16:24:18.106337 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:18.107337 [debug] [ThreadPool]: On create_nfirs_nfirs: COMMIT
[0m16:24:18.107337 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m16:24:18.108337 [debug] [ThreadPool]: On create_nfirs_nfirs: COMMIT
[0m16:24:18.108337 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:18.108337 [debug] [ThreadPool]: On create_nfirs_nfirs: Close
[0m16:24:18.116839 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:24:18.116839 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:24:18.120890 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:24:18.123107 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:24:18.123107 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:24:18.123107 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:24:18.124106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:18.124106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:18.139510 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:18.140510 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:24:18.140510 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:18.141510 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:24:18.141510 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:24:18.142510 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:24:18.172860 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:18.172860 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:24:18.173861 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:24:18.174861 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:24:18.175861 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:24:18.176920 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:24:18.176920 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:24:18.177861 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:24:18.183770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '015f5c55-e26b-47bf-bcd2-855f62d2af87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE0DB2360>]}
[0m16:24:18.184689 [debug] [MainThread]: Using duckdb connection "master"
[0m16:24:18.184689 [debug] [MainThread]: On master: BEGIN
[0m16:24:18.184689 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:18.200946 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:24:18.204559 [debug] [MainThread]: On master: COMMIT
[0m16:24:18.204559 [debug] [MainThread]: Using duckdb connection "master"
[0m16:24:18.204559 [debug] [MainThread]: On master: COMMIT
[0m16:24:18.205560 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:24:18.205560 [debug] [MainThread]: On master: Close
[0m16:24:18.209568 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:24:18.209568 [info ] [MainThread]: 
[0m16:24:18.212863 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.convert_inc_date
[0m16:24:18.212863 [info ] [Thread-1 (]: 1 of 1 START sql view model nfirs.convert_inc_date ............................. [RUN]
[0m16:24:18.213933 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.convert_inc_date'
[0m16:24:18.213933 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.convert_inc_date
[0m16:24:18.233888 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:18.234857 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: BEGIN
[0m16:24:18.234857 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:24:18.249857 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:18.250857 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:18.250857 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */


      

    

        select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from nfirs.information_schema.tables
        where table_schema ilike 'nfirs_raw'
        and table_name ilike '%'
        and table_name not ilike ''


    

[0m16:24:18.277935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:18.284941 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:18.285933 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'codelookup'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:18.298344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:18.301636 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:18.301636 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fireincident'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:18.313637 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:18.316338 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:18.317340 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__fireincident AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."fireincident";
            
  
[0m16:24:19.252923 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m16:24:19.254930 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:19.254930 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'basicaid'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:19.267623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:19.269631 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:19.269631 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__basicaid AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."basicaid";
            
  
[0m16:24:19.581694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:19.584692 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:19.585692 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'incidentaddress'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:19.599581 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:19.600585 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:19.601585 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__incidentaddress AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."incidentaddress";
            
  
[0m16:24:29.507457 [debug] [Thread-1 (]: SQL status: OK in 10.0 seconds
[0m16:24:29.513653 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:29.513653 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'ffequipfail'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:29.561953 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:29.565955 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:29.565955 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__ffequipfail AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."ffequipfail";
            
  
[0m16:24:29.576976 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:29.582966 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:29.584962 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'hazchem'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:29.636258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:29.640261 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:29.641257 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__hazchem AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."hazchem";
            
  
[0m16:24:29.690898 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:29.697962 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:29.699005 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'hazmobprop'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:29.743386 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:29.750386 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:29.752386 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__hazmobprop AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."hazmobprop";
            
  
[0m16:24:29.796341 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:29.800339 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:29.801339 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'hazmat'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:29.841176 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:29.845450 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:29.846361 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__hazmat AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."hazmat";
            
  
[0m16:24:29.918058 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:29.923053 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:29.924059 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'arson'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:29.966107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:29.970134 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:29.971156 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__arson AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."arson";
            
  
[0m16:24:30.368645 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:30.375646 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:30.376647 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'ems'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:30.418646 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:30.426645 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:30.428658 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__ems AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."ems";
            
  
[0m16:24:33.517974 [debug] [Thread-1 (]: SQL status: OK in 3.0 seconds
[0m16:24:33.521992 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:33.522940 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fdheader'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:33.565258 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:33.569263 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:33.570276 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'arsonjuvsub'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:33.611163 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:33.613144 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:33.614135 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__arsonjuvsub AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."arsonjuvsub";
            
  
[0m16:24:33.622140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:33.625147 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:33.626527 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'wildlands'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:33.667142 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:33.672143 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:33.673728 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__wildlands AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."wildlands";
            
  
[0m16:24:34.601758 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m16:24:34.614760 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:34.616759 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'arsonagencyreferal'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:34.744734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:34.751733 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:34.752732 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__arsonagencyreferal AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."arsonagencyreferal";
            
  
[0m16:24:34.986056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:34.996045 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:34.998044 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'basicincident'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:24:35.119788 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:35.130783 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:24:35.131778 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__basicincident AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."basicincident";
            
  
[0m16:26:05.819867 [debug] [Thread-1 (]: SQL status: OK in 91.0 seconds
[0m16:26:05.823900 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:26:05.824906 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'civiliancasualty'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:26:06.053363 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:06.058380 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:26:06.059378 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__civiliancasualty AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."civiliancasualty";
            
  
[0m16:26:06.130689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:06.135707 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:26:06.136614 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'ffcasualty'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:26:06.285094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:06.288220 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:26:06.289220 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__ffcasualty AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."ffcasualty";
            
  
[0m16:26:06.413056 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:06.416056 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:26:06.417063 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'hazmatequipinvolved'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:26:06.518054 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:06.521054 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:26:06.522055 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__hazmatequipinvolved AS
            SELECT
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."hazmatequipinvolved";
            
  
[0m16:26:06.558281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:26:06.559277 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:26:06.560283 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.convert_inc_date
[0m16:26:06.597198 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:26:06.602198 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:26:06.603200 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

  
  create view "nfirs"."nfirs"."convert_inc_date__dbt_tmp" as (
    
  );

[0m16:26:06.609612 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

  
  create view "nfirs"."nfirs"."convert_inc_date__dbt_tmp" as (
    
  );

[0m16:26:06.610533 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:26:06.611533 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: ROLLBACK
[0m16:26:06.619532 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.convert_inc_date'
[0m16:26:06.620533 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: Close
[0m16:26:12.737390 [debug] [Thread-1 (]: Runtime Error in model convert_inc_date (models\nfirs_transformed\convert_inc_date.sql)
  Parser Error: syntax error at or near ")"
[0m16:26:12.738390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '015f5c55-e26b-47bf-bcd2-855f62d2af87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDEA43830>]}
[0m16:26:12.739474 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model nfirs.convert_inc_date .................... [[31mERROR[0m in 114.52s]
[0m16:26:12.739974 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.convert_inc_date
[0m16:26:12.743981 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:12.744981 [debug] [MainThread]: On master: BEGIN
[0m16:26:12.744981 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:12.766982 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:26:12.767981 [debug] [MainThread]: On master: COMMIT
[0m16:26:12.767981 [debug] [MainThread]: Using duckdb connection "master"
[0m16:26:12.768982 [debug] [MainThread]: On master: COMMIT
[0m16:26:12.768982 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:26:12.768982 [debug] [MainThread]: On master: Close
[0m16:26:12.780169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:12.781170 [debug] [MainThread]: Connection 'create_nfirs_nfirs' was properly closed.
[0m16:26:12.781170 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:26:12.781170 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:26:12.782169 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.convert_inc_date' was properly closed.
[0m16:26:12.785169 [info ] [MainThread]: 
[0m16:26:12.786169 [info ] [MainThread]: Finished running 1 view model in 0 hours 1 minutes and 54.79 seconds (114.79s).
[0m16:26:12.786169 [debug] [MainThread]: Command end result
[0m16:26:12.813169 [info ] [MainThread]: 
[0m16:26:12.814169 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:26:12.815169 [info ] [MainThread]: 
[0m16:26:12.815169 [error] [MainThread]:   Runtime Error in model convert_inc_date (models\nfirs_transformed\convert_inc_date.sql)
  Parser Error: syntax error at or near ")"
[0m16:26:12.816169 [info ] [MainThread]: 
[0m16:26:12.816169 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:26:12.817169 [debug] [MainThread]: Command `cli run` failed at 16:26:12.817169 after 115.37 seconds
[0m16:26:12.817169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDEA43530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDEA7BB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFDEB1B2C0>]}
[0m16:26:12.818172 [debug] [MainThread]: Flushing usage events
[0m16:29:40.305052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A359F8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148FFE7C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A608A450>]}


============================== 16:29:40.308275 | f5ac47c8-f242-47e5-9cce-276da69bac9d ==============================
[0m16:29:40.308275 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:29:40.308275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:40.464874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5ac47c8-f242-47e5-9cce-276da69bac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A61E9100>]}
[0m16:29:40.507218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5ac47c8-f242-47e5-9cce-276da69bac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A630B4D0>]}
[0m16:29:40.508259 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:29:40.518258 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:29:40.637550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:40.637988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:40.668708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5ac47c8-f242-47e5-9cce-276da69bac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A6598F50>]}
[0m16:29:40.744195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5ac47c8-f242-47e5-9cce-276da69bac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A67E68D0>]}
[0m16:29:40.745138 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m16:29:40.745138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5ac47c8-f242-47e5-9cce-276da69bac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A664BAD0>]}
[0m16:29:40.747170 [info ] [MainThread]: 
[0m16:29:40.747170 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:29:40.748138 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:29:40.931320 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:29:40.931320 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:29:40.931320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:40.948931 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:40.949932 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:29:40.955555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs)
[0m16:29:40.955555 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs"
"
[0m16:29:40.960624 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m16:29:40.960624 [debug] [ThreadPool]: On create_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:29:40.961627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:40.977307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:40.978354 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m16:29:40.978354 [debug] [ThreadPool]: On create_nfirs_nfirs: BEGIN
[0m16:29:40.979351 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:40.979351 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m16:29:40.979351 [debug] [ThreadPool]: On create_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs"} */

    
    
        create schema if not exists "nfirs"."nfirs"
    
[0m16:29:40.980354 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:40.980354 [debug] [ThreadPool]: On create_nfirs_nfirs: COMMIT
[0m16:29:40.981348 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m16:29:40.981348 [debug] [ThreadPool]: On create_nfirs_nfirs: COMMIT
[0m16:29:40.981348 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:40.982317 [debug] [ThreadPool]: On create_nfirs_nfirs: Close
[0m16:29:40.990088 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:29:40.991041 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:29:40.995083 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:29:40.997093 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:29:40.997392 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:29:40.997392 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:29:40.998449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:40.998449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:41.014805 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:41.014805 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:41.015813 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:29:41.015813 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:29:41.015813 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:29:41.016805 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:29:41.047886 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:41.048887 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:29:41.048887 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:41.049886 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:29:41.050877 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:29:41.051889 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:29:41.051889 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:29:41.052889 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:29:41.058831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5ac47c8-f242-47e5-9cce-276da69bac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A6B5E330>]}
[0m16:29:41.059846 [debug] [MainThread]: Using duckdb connection "master"
[0m16:29:41.059846 [debug] [MainThread]: On master: BEGIN
[0m16:29:41.059846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:41.075243 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:41.075243 [debug] [MainThread]: On master: COMMIT
[0m16:29:41.076211 [debug] [MainThread]: Using duckdb connection "master"
[0m16:29:41.076211 [debug] [MainThread]: On master: COMMIT
[0m16:29:41.076211 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:41.077237 [debug] [MainThread]: On master: Close
[0m16:29:41.080237 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:29:41.081203 [info ] [MainThread]: 
[0m16:29:41.085214 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.convert_inc_date
[0m16:29:41.085214 [info ] [Thread-1 (]: 1 of 1 START sql view model nfirs.convert_inc_date ............................. [RUN]
[0m16:29:41.086194 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.convert_inc_date'
[0m16:29:41.086194 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.convert_inc_date
[0m16:29:41.106341 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:41.107385 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: BEGIN
[0m16:29:41.107385 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:29:41.123344 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:41.123344 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:41.124364 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */


      

    

        select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from nfirs.information_schema.tables
        where table_schema ilike 'nfirs_raw'
        and table_name ilike '%'
        and table_name not ilike ''


    

[0m16:29:41.151890 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:41.159920 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:41.159920 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'codelookup'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:29:41.173219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:41.176219 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:41.177231 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fireincident'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:29:41.188997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:41.191989 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:41.191989 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__fireincident AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."fireincident";
            
  
[0m16:29:42.121668 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m16:29:42.123668 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:42.124667 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'arsonjuvsub'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:29:42.138668 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:42.139669 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:42.139669 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__arsonjuvsub AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."arsonjuvsub";
            
  
[0m16:29:42.144657 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:42.146659 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:42.147664 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'arson'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:29:42.160465 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:42.162462 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:42.162462 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__arson AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."arson";
            
  
[0m16:29:42.330643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:42.332715 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:42.332715 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'ems'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:29:42.346723 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:42.348643 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:42.349724 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__ems AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."ems";
            
  
[0m16:29:43.361454 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m16:29:43.363458 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:43.364459 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'fdheader'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:29:43.378392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:43.380396 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:43.380396 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'basicaid'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:29:43.394044 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:43.396044 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:43.396044 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__basicaid AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."basicaid";
            
  
[0m16:29:43.700714 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:43.703625 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:43.703625 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'incidentaddress'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:29:43.718625 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:43.720970 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:43.720970 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__incidentaddress AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."incidentaddress";
            
  
[0m16:29:56.233198 [debug] [Thread-1 (]: SQL status: OK in 13.0 seconds
[0m16:29:56.237200 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:56.238176 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'arsonagencyreferal'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:29:56.284466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:56.287388 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:56.288457 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__arsonagencyreferal AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."arsonagencyreferal";
            
  
[0m16:29:56.398052 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:56.402093 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:56.403052 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'basicincident'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:29:56.452822 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:56.457867 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:29:56.458863 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__basicincident AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."basicincident";
            
  
[0m16:31:00.743605 [debug] [Thread-1 (]: SQL status: OK in 64.0 seconds
[0m16:31:00.745605 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:00.746605 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'civiliancasualty'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:31:00.830683 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:00.833679 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:00.834646 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__civiliancasualty AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."civiliancasualty";
            
  
[0m16:31:00.870404 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:00.872429 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:00.872429 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'ffcasualty'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:31:00.960466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:00.963533 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:00.963533 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__ffcasualty AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."ffcasualty";
            
  
[0m16:31:01.040302 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:01.042298 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:01.043301 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'hazmatequipinvolved'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:31:01.132440 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:01.135440 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:01.135440 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__hazmatequipinvolved AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."hazmatequipinvolved";
            
  
[0m16:31:01.152515 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:01.155600 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:01.156594 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'wildlands'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:31:01.250062 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:01.254241 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:01.254241 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__wildlands AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."wildlands";
            
  
[0m16:31:01.594111 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:01.597108 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:01.597108 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'hazmat'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:31:01.690925 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:01.693966 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:01.693966 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__hazmat AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."hazmat";
            
  
[0m16:31:01.732944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:01.737819 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:01.737819 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'ffequipfail'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:31:01.837081 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:01.839077 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:01.839077 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__ffequipfail AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."ffequipfail";
            
  
[0m16:31:01.843082 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:01.846075 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:01.846075 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'hazchem'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:31:01.938620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:01.940612 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:01.940612 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__hazchem AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."hazchem";
            
  
[0m16:31:01.971911 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:01.974909 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:01.974909 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from system.information_schema.columns
      where table_name = 'hazmobprop'
      
      and table_schema = 'nfirs_raw'
      
      
      and table_catalog = 'nfirs'
      
      order by ordinal_position

  
[0m16:31:02.070785 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:02.073776 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:02.073776 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

    
            CREATE TABLE nfirs_transformed__hazmobprop AS
            SELECT 
                *,
                STRPTIME(INC_DATE, '%m%d%Y') AS INC_DATE
            FROM "nfirs"."nfirs_raw"."hazmobprop";
            
  
[0m16:31:02.094864 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:31:02.095865 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:02.095865 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.convert_inc_date
[0m16:31:02.118661 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:02.119695 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.convert_inc_date"
[0m16:31:02.119695 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

  
  create view "nfirs"."nfirs"."convert_inc_date__dbt_tmp" as (
    
  );

[0m16:31:02.120703 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.convert_inc_date"} */

  
  create view "nfirs"."nfirs"."convert_inc_date__dbt_tmp" as (
    
  );

[0m16:31:02.120703 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:31:02.121690 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: ROLLBACK
[0m16:31:02.124733 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.convert_inc_date'
[0m16:31:02.125731 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.convert_inc_date: Close
[0m16:31:06.735393 [debug] [Thread-1 (]: Runtime Error in model convert_inc_date (models\nfirs_transformed\convert_inc_date.sql)
  Parser Error: syntax error at or near ")"
[0m16:31:06.736393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5ac47c8-f242-47e5-9cce-276da69bac9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A6814920>]}
[0m16:31:06.737480 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model nfirs.convert_inc_date .................... [[31mERROR[0m in 85.65s]
[0m16:31:06.738392 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.convert_inc_date
[0m16:31:06.741432 [debug] [MainThread]: Using duckdb connection "master"
[0m16:31:06.741432 [debug] [MainThread]: On master: BEGIN
[0m16:31:06.742475 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:06.758250 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:31:06.759250 [debug] [MainThread]: On master: COMMIT
[0m16:31:06.759250 [debug] [MainThread]: Using duckdb connection "master"
[0m16:31:06.760250 [debug] [MainThread]: On master: COMMIT
[0m16:31:06.760250 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:31:06.761337 [debug] [MainThread]: On master: Close
[0m16:31:06.769076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:06.770080 [debug] [MainThread]: Connection 'create_nfirs_nfirs' was properly closed.
[0m16:31:06.770080 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:31:06.771080 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:31:06.771080 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.convert_inc_date' was properly closed.
[0m16:31:06.772116 [info ] [MainThread]: 
[0m16:31:06.773081 [info ] [MainThread]: Finished running 1 view model in 0 hours 1 minutes and 26.02 seconds (86.02s).
[0m16:31:06.774080 [debug] [MainThread]: Command end result
[0m16:31:06.797685 [info ] [MainThread]: 
[0m16:31:06.798624 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:31:06.798624 [info ] [MainThread]: 
[0m16:31:06.798624 [error] [MainThread]:   Runtime Error in model convert_inc_date (models\nfirs_transformed\convert_inc_date.sql)
  Parser Error: syntax error at or near ")"
[0m16:31:06.799591 [info ] [MainThread]: 
[0m16:31:06.799591 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:31:06.800591 [debug] [MainThread]: Command `cli run` failed at 16:31:06.800591 after 86.61 seconds
[0m16:31:06.800591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A419A9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A61E8BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A460FD70>]}
[0m16:31:06.801607 [debug] [MainThread]: Flushing usage events
[0m16:54:17.727350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AAAF8EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2A967C050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2ABEE3950>]}


============================== 16:54:17.730428 | d7c5dc5e-c4ff-42ea-aad4-b9e08fce7208 ==============================
[0m16:54:17.730428 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:54:17.731435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:54:17.886771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7c5dc5e-c4ff-42ea-aad4-b9e08fce7208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2ADB807D0>]}
[0m16:54:17.928465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7c5dc5e-c4ff-42ea-aad4-b9e08fce7208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AD9E4A40>]}
[0m16:54:17.929493 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:54:17.938465 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:54:18.057116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:18.057116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:18.088181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7c5dc5e-c4ff-42ea-aad4-b9e08fce7208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2ADC897F0>]}
[0m16:54:18.164441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7c5dc5e-c4ff-42ea-aad4-b9e08fce7208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2ADEC3E00>]}
[0m16:54:18.164441 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m16:54:18.164441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7c5dc5e-c4ff-42ea-aad4-b9e08fce7208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2ABFBBFE0>]}
[0m16:54:18.166516 [info ] [MainThread]: 
[0m16:54:18.166516 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:54:18.167471 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:54:18.232980 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:54:18.232980 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:54:18.232980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:18.251573 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:54:18.252576 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:54:18.257180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:54:18.258151 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:54:18.263276 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:54:18.263276 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:54:18.264277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:18.280595 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:54:18.281632 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:54:18.281632 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:54:18.282635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:54:18.282635 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:54:18.282635 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:54:18.283637 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:54:18.283637 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:54:18.284629 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:54:18.284629 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:54:18.296158 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:54:18.296158 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:54:18.577996 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:54:18.582107 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:54:18.582107 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:54:18.582998 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:54:18.582998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:18.585031 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:54:18.601507 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:54:18.601507 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:54:18.602495 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:54:18.603537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:18.603537 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:54:18.604541 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:54:18.605473 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:54:18.605473 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:54:18.633707 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:54:18.633707 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:54:18.635793 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:54:18.636793 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:54:18.637793 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:54:18.637793 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:54:18.638877 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:54:18.639434 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:54:18.646654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7c5dc5e-c4ff-42ea-aad4-b9e08fce7208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2ADA1D940>]}
[0m16:54:18.646654 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:18.647728 [debug] [MainThread]: On master: BEGIN
[0m16:54:18.647728 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:18.664066 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:54:18.665072 [debug] [MainThread]: On master: COMMIT
[0m16:54:18.665072 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:18.665072 [debug] [MainThread]: On master: COMMIT
[0m16:54:18.666068 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:54:18.666068 [debug] [MainThread]: On master: Close
[0m16:54:18.670072 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:54:18.670072 [info ] [MainThread]: 
[0m16:54:18.674874 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:54:18.675953 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [RUN]
[0m16:54:18.676964 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update'
[0m16:54:18.676964 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:54:18.684950 [debug] [Thread-1 (]: Compilation Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  'convert_inc_date_to_date_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:54:18.685947 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7c5dc5e-c4ff-42ea-aad4-b9e08fce7208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2ADC89220>]}
[0m16:54:18.686948 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [[31mERROR[0m in 0.01s]
[0m16:54:18.686948 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:54:18.690152 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:18.690572 [debug] [MainThread]: On master: BEGIN
[0m16:54:18.690572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:18.706872 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:54:18.707372 [debug] [MainThread]: On master: COMMIT
[0m16:54:18.707372 [debug] [MainThread]: Using duckdb connection "master"
[0m16:54:18.707932 [debug] [MainThread]: On master: COMMIT
[0m16:54:18.708434 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:54:18.708434 [debug] [MainThread]: On master: Close
[0m16:54:18.713553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:18.714515 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:54:18.714515 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:54:18.715516 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:54:18.715516 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update' was properly closed.
[0m16:54:18.715516 [info ] [MainThread]: 
[0m16:54:18.716515 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m16:54:18.716515 [debug] [MainThread]: Command end result
[0m16:54:18.741589 [info ] [MainThread]: 
[0m16:54:18.742606 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:54:18.742606 [info ] [MainThread]: 
[0m16:54:18.742606 [error] [MainThread]:   Compilation Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  'convert_inc_date_to_date_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:54:18.743529 [info ] [MainThread]: 
[0m16:54:18.743529 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:54:18.744562 [debug] [MainThread]: Command `cli run` failed at 16:54:18.744562 after 1.13 seconds
[0m16:54:18.744562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AD84FF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AC4663C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AC5AB200>]}
[0m16:54:18.745599 [debug] [MainThread]: Flushing usage events
[0m16:55:01.519577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FE3CBE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FFC77680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FFC77380>]}


============================== 16:55:01.523550 | afbbda96-a398-487f-bc1a-0ff8a7554362 ==============================
[0m16:55:01.523550 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:55:01.524501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:55:01.676457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afbbda96-a398-487f-bc1a-0ff8a7554362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FDFA9E20>]}
[0m16:55:01.717775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afbbda96-a398-487f-bc1a-0ff8a7554362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FFE7EDE0>]}
[0m16:55:01.718772 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:55:01.729003 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:55:01.846082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:01.847083 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:01.878462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afbbda96-a398-487f-bc1a-0ff8a7554362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021880264A70>]}
[0m16:55:01.954008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afbbda96-a398-487f-bc1a-0ff8a7554362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021880266F00>]}
[0m16:55:01.954008 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m16:55:01.955009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afbbda96-a398-487f-bc1a-0ff8a7554362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218804E1E80>]}
[0m16:55:01.956044 [info ] [MainThread]: 
[0m16:55:01.957040 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:55:01.958050 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:55:02.015085 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:55:02.015085 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:55:02.015085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:02.033301 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:02.034344 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:55:02.040037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:55:02.040037 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:55:02.045050 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:55:02.045050 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:55:02.046000 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:02.060724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:02.062703 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:55:02.062703 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:55:02.063723 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:02.063723 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:55:02.063723 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:55:02.064717 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:02.064717 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:55:02.065765 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:55:02.065765 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:55:02.065765 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:02.066710 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:55:02.074438 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:55:02.075430 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:55:02.079430 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:55:02.080428 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:55:02.081494 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:55:02.081494 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:55:02.081494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:02.082506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:02.096974 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:02.097904 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:02.097904 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:55:02.097904 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:55:02.098899 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:55:02.098899 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:55:02.130914 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:02.130914 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:02.131914 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:55:02.133001 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:55:02.133914 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:55:02.135001 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:55:02.135001 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:55:02.135915 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:55:02.142265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afbbda96-a398-487f-bc1a-0ff8a7554362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FD6FF9E0>]}
[0m16:55:02.142265 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:02.143378 [debug] [MainThread]: On master: BEGIN
[0m16:55:02.143378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:02.158669 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:55:02.158669 [debug] [MainThread]: On master: COMMIT
[0m16:55:02.158669 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:02.159680 [debug] [MainThread]: On master: COMMIT
[0m16:55:02.159680 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:55:02.159680 [debug] [MainThread]: On master: Close
[0m16:55:02.163676 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:55:02.164673 [info ] [MainThread]: 
[0m16:55:02.168002 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:55:02.169083 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [RUN]
[0m16:55:02.169083 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update'
[0m16:55:02.169083 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:55:02.178079 [debug] [Thread-1 (]: Compilation Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  'convert_inc_date_to_date_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:55:02.179084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afbbda96-a398-487f-bc1a-0ff8a7554362', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FE393740>]}
[0m16:55:02.180076 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [[31mERROR[0m in 0.01s]
[0m16:55:02.181005 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:55:02.183063 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:02.183063 [debug] [MainThread]: On master: BEGIN
[0m16:55:02.184074 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:02.198202 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:55:02.198202 [debug] [MainThread]: On master: COMMIT
[0m16:55:02.199561 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:02.199561 [debug] [MainThread]: On master: COMMIT
[0m16:55:02.199561 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:55:02.199561 [debug] [MainThread]: On master: Close
[0m16:55:02.204560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:02.205608 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:55:02.205608 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:55:02.205608 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:55:02.206593 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update' was properly closed.
[0m16:55:02.206593 [info ] [MainThread]: 
[0m16:55:02.207560 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m16:55:02.207560 [debug] [MainThread]: Command end result
[0m16:55:02.229632 [info ] [MainThread]: 
[0m16:55:02.230560 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:55:02.230560 [info ] [MainThread]: 
[0m16:55:02.230560 [error] [MainThread]:   Compilation Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  'convert_inc_date_to_date_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:55:02.231597 [info ] [MainThread]: 
[0m16:55:02.231597 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:55:02.232591 [debug] [MainThread]: Command `cli run` failed at 16:55:02.232591 after 0.83 seconds
[0m16:55:02.232591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021880272E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FFCFD400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218FFCFDB20>]}
[0m16:55:02.232591 [debug] [MainThread]: Flushing usage events
[0m16:55:33.549020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8C08F590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8E826450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8E7CB2C0>]}


============================== 16:55:33.552069 | 7de5e842-9042-4a5d-a385-763983982808 ==============================
[0m16:55:33.552069 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:55:33.553018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:55:33.704066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7de5e842-9042-4a5d-a385-763983982808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8EEE1850>]}
[0m16:55:33.745920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7de5e842-9042-4a5d-a385-763983982808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8ED6CBC0>]}
[0m16:55:33.746927 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:55:33.755918 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:55:33.875241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:33.875241 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:33.907010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7de5e842-9042-4a5d-a385-763983982808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8EEC13A0>]}
[0m16:55:33.981058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7de5e842-9042-4a5d-a385-763983982808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8F21EDB0>]}
[0m16:55:33.982088 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m16:55:33.982088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7de5e842-9042-4a5d-a385-763983982808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8F1E0230>]}
[0m16:55:33.983055 [info ] [MainThread]: 
[0m16:55:33.984112 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:55:33.985063 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:55:34.042985 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:55:34.043979 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:55:34.043979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:34.061508 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:34.062508 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:55:34.067516 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:55:34.067516 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:55:34.072505 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:55:34.072505 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:55:34.073635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:34.089635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:34.090560 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:55:34.091560 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:55:34.091691 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:34.092216 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:55:34.092216 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:55:34.092216 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:34.093248 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:55:34.093248 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:55:34.094286 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:55:34.094286 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:34.094286 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:55:34.102369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:55:34.106819 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:55:34.107503 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:55:34.107503 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:55:34.109504 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:55:34.109504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:34.110504 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:55:34.123855 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:34.124856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:34.124856 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:55:34.125855 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:34.125855 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:55:34.126855 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:55:34.127855 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:55:34.157274 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:34.157274 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:34.158275 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:55:34.160274 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:55:34.161274 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:55:34.162274 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:55:34.162274 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:55:34.162274 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:55:34.168384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7de5e842-9042-4a5d-a385-763983982808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8EEC3740>]}
[0m16:55:34.168384 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:34.168384 [debug] [MainThread]: On master: BEGIN
[0m16:55:34.169411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:34.184120 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:55:34.184120 [debug] [MainThread]: On master: COMMIT
[0m16:55:34.184120 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:34.185108 [debug] [MainThread]: On master: COMMIT
[0m16:55:34.185108 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:55:34.186070 [debug] [MainThread]: On master: Close
[0m16:55:34.189931 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:55:34.190584 [info ] [MainThread]: 
[0m16:55:34.194433 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:55:34.194433 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [RUN]
[0m16:55:34.195400 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update'
[0m16:55:34.195400 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:55:34.203473 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m16:55:34.203473 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

    
        SELECT count(*)
        FROM information_schema.columns
        WHERE table_schema = 'nfirs_raw'
          AND table_name = 'arson'
          AND column_name = 'INC_DATE'
    
  
[0m16:55:34.204477 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:34.261564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:34.263570 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: Close
[0m16:55:34.271378 [debug] [Thread-1 (]: Compilation Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  'agate.table.Table object' has no attribute 'data'
[0m16:55:34.273315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de5e842-9042-4a5d-a385-763983982808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8D213890>]}
[0m16:55:34.273917 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [[31mERROR[0m in 0.08s]
[0m16:55:34.273917 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:55:34.276949 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:34.276949 [debug] [MainThread]: On master: BEGIN
[0m16:55:34.276949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:34.291682 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:55:34.292683 [debug] [MainThread]: On master: COMMIT
[0m16:55:34.292683 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:34.293727 [debug] [MainThread]: On master: COMMIT
[0m16:55:34.293727 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:55:34.293727 [debug] [MainThread]: On master: Close
[0m16:55:34.297720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:34.297720 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:55:34.297720 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:55:34.298736 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:55:34.299000 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update' was properly closed.
[0m16:55:34.299000 [info ] [MainThread]: 
[0m16:55:34.299000 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m16:55:34.300086 [debug] [MainThread]: Command end result
[0m16:55:34.322076 [info ] [MainThread]: 
[0m16:55:34.323252 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:55:34.323252 [info ] [MainThread]: 
[0m16:55:34.324282 [error] [MainThread]:   Compilation Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  'agate.table.Table object' has no attribute 'data'
[0m16:55:34.324282 [info ] [MainThread]: 
[0m16:55:34.324282 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:55:34.325274 [debug] [MainThread]: Command `cli run` failed at 16:55:34.325274 after 0.88 seconds
[0m16:55:34.326314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8C08F590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8ECBD160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A8D619B80>]}
[0m16:55:34.326314 [debug] [MainThread]: Flushing usage events
[0m16:57:07.079575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C107E2B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C11BB1CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C11BB1C10>]}


============================== 16:57:07.082600 | 9a0882c6-4dce-46ea-8345-c4a509a419c0 ==============================
[0m16:57:07.082600 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:57:07.083557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:57:07.235602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a0882c6-4dce-46ea-8345-c4a509a419c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C10EF4500>]}
[0m16:57:07.277440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a0882c6-4dce-46ea-8345-c4a509a419c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C121337A0>]}
[0m16:57:07.278441 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:57:07.288420 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:57:07.406459 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:57:07.407459 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:57:07.439374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a0882c6-4dce-46ea-8345-c4a509a419c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C139597F0>]}
[0m16:57:07.517657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a0882c6-4dce-46ea-8345-c4a509a419c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C13BAEF60>]}
[0m16:57:07.517657 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m16:57:07.518657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a0882c6-4dce-46ea-8345-c4a509a419c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C138731D0>]}
[0m16:57:07.519657 [info ] [MainThread]: 
[0m16:57:07.520657 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:57:07.521658 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:57:07.589547 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:57:07.590546 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:57:07.590546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:07.608385 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:57:07.609390 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:57:07.614002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:57:07.615092 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:57:07.620036 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:57:07.620036 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:57:07.621039 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:07.636743 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:57:07.637743 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:57:07.638746 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:57:07.638746 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:57:07.638746 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:57:07.639750 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:57:07.639750 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:57:07.640758 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:57:07.640758 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:57:07.641749 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:57:07.641749 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:57:07.641749 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:57:07.649958 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:57:07.654033 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:57:07.655034 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:57:07.655034 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:57:07.657044 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:57:07.657044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:07.657993 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:57:07.672771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:57:07.672771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:07.673765 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:57:07.674795 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:57:07.674795 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:57:07.675767 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:57:07.676766 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:57:07.705145 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:57:07.706154 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:57:07.707153 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:57:07.708148 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:57:07.709148 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:57:07.709148 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:57:07.710122 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:57:07.711070 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:57:07.715465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a0882c6-4dce-46ea-8345-c4a509a419c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C13741FA0>]}
[0m16:57:07.716700 [debug] [MainThread]: Using duckdb connection "master"
[0m16:57:07.716700 [debug] [MainThread]: On master: BEGIN
[0m16:57:07.717754 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:07.732700 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:57:07.733156 [debug] [MainThread]: On master: COMMIT
[0m16:57:07.733156 [debug] [MainThread]: Using duckdb connection "master"
[0m16:57:07.733156 [debug] [MainThread]: On master: COMMIT
[0m16:57:07.734157 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:57:07.734157 [debug] [MainThread]: On master: Close
[0m16:57:07.738554 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:57:07.738554 [info ] [MainThread]: 
[0m16:57:07.742534 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:57:07.742534 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [RUN]
[0m16:57:07.743561 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update'
[0m16:57:07.743561 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:57:07.751566 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m16:57:07.752519 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

    
        SELECT count(*)
        FROM information_schema.columns
        WHERE table_schema = 'nfirs_raw'
          AND table_name = 'arson'
          AND column_name = 'INC_DATE'
    
  
[0m16:57:07.752519 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:57:07.812468 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:57:07.814478 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: Close
[0m16:57:07.823474 [debug] [Thread-1 (]: Compilation Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  'run_sql' is undefined
[0m16:57:07.824474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a0882c6-4dce-46ea-8345-c4a509a419c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C11BB36B0>]}
[0m16:57:07.825474 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [[31mERROR[0m in 0.08s]
[0m16:57:07.825474 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:57:07.828429 [debug] [MainThread]: Using duckdb connection "master"
[0m16:57:07.828429 [debug] [MainThread]: On master: BEGIN
[0m16:57:07.828429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:57:07.843243 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:57:07.843243 [debug] [MainThread]: On master: COMMIT
[0m16:57:07.844254 [debug] [MainThread]: Using duckdb connection "master"
[0m16:57:07.844254 [debug] [MainThread]: On master: COMMIT
[0m16:57:07.844254 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:57:07.845220 [debug] [MainThread]: On master: Close
[0m16:57:07.849216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:07.850216 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:57:07.850216 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:57:07.850216 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:57:07.850216 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update' was properly closed.
[0m16:57:07.851215 [info ] [MainThread]: 
[0m16:57:07.851215 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m16:57:07.852262 [debug] [MainThread]: Command end result
[0m16:57:07.874215 [info ] [MainThread]: 
[0m16:57:07.875215 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:57:07.875215 [info ] [MainThread]: 
[0m16:57:07.875215 [error] [MainThread]:   Compilation Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  'run_sql' is undefined
[0m16:57:07.876267 [info ] [MainThread]: 
[0m16:57:07.876267 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:57:07.877216 [debug] [MainThread]: Command `cli run` failed at 16:57:07.877216 after 0.92 seconds
[0m16:57:07.877216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C107E2B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C13497680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024C134E8A10>]}
[0m16:57:07.878303 [debug] [MainThread]: Flushing usage events
[0m16:58:18.298712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274253461B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002742480EB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002742480F410>]}


============================== 16:58:18.301711 | 4d56df8f-b434-4840-880a-172139141c21 ==============================
[0m16:58:18.301711 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:58:18.302573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:58:18.453457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d56df8f-b434-4840-880a-172139141c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027424AD1FA0>]}
[0m16:58:18.495931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d56df8f-b434-4840-880a-172139141c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274253F1730>]}
[0m16:58:18.496938 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:58:18.506549 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:58:18.623279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:58:18.624283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:58:18.656008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d56df8f-b434-4840-880a-172139141c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027426CBC050>]}
[0m16:58:18.731294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d56df8f-b434-4840-880a-172139141c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027426AD7710>]}
[0m16:58:18.731294 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m16:58:18.732299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d56df8f-b434-4840-880a-172139141c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027426EFB980>]}
[0m16:58:18.733247 [info ] [MainThread]: 
[0m16:58:18.734278 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:58:18.735719 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:58:18.793213 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:58:18.793213 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:58:18.794215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:18.811575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:58:18.812575 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:58:18.816575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:58:18.817575 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:58:18.822905 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:58:18.822905 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:58:18.822905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:18.838080 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:58:18.840113 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:58:18.840113 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:58:18.841091 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:58:18.841091 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:58:18.841091 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:58:18.842112 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:58:18.842112 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:58:18.843122 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:58:18.843122 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:58:18.843122 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:58:18.844086 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:58:18.851107 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:58:18.852448 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:58:18.856516 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:58:18.857479 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:58:18.857479 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:58:18.858546 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:58:18.858546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:18.859468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:18.873094 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:58:18.874096 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:58:18.874096 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:58:18.874096 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:58:18.875104 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:58:18.875104 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:58:18.902338 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:58:18.903374 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:58:18.904407 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:58:18.905370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:58:18.905370 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:58:18.906372 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:58:18.907128 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:58:18.908225 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:58:18.913171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d56df8f-b434-4840-880a-172139141c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274243DC470>]}
[0m16:58:18.913171 [debug] [MainThread]: Using duckdb connection "master"
[0m16:58:18.914207 [debug] [MainThread]: On master: BEGIN
[0m16:58:18.914207 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:58:18.929937 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:58:18.929937 [debug] [MainThread]: On master: COMMIT
[0m16:58:18.930945 [debug] [MainThread]: Using duckdb connection "master"
[0m16:58:18.930945 [debug] [MainThread]: On master: COMMIT
[0m16:58:18.930945 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:58:18.931937 [debug] [MainThread]: On master: Close
[0m16:58:18.935693 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:58:18.936694 [info ] [MainThread]: 
[0m16:58:18.940689 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:58:18.941774 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [RUN]
[0m16:58:18.941774 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update'
[0m16:58:18.942728 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:58:18.950764 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m16:58:18.950764 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

    
        SELECT count(*)
        FROM information_schema.columns
        WHERE table_schema = 'nfirs_raw'
          AND table_name = 'arson'
          AND column_name = 'INC_DATE'
    
  
[0m16:58:18.950764 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:58:18.998356 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:58:19.000430 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: Close
[0m16:58:19.007801 [debug] [Thread-1 (]: Compilation Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  'run_sql' is undefined
[0m16:58:19.008799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d56df8f-b434-4840-880a-172139141c21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027424F3F440>]}
[0m16:58:19.009800 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [[31mERROR[0m in 0.07s]
[0m16:58:19.010725 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m16:58:19.012778 [debug] [MainThread]: Using duckdb connection "master"
[0m16:58:19.012778 [debug] [MainThread]: On master: BEGIN
[0m16:58:19.012778 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:58:19.028101 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:58:19.028101 [debug] [MainThread]: On master: COMMIT
[0m16:58:19.029130 [debug] [MainThread]: Using duckdb connection "master"
[0m16:58:19.029130 [debug] [MainThread]: On master: COMMIT
[0m16:58:19.030056 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:58:19.030056 [debug] [MainThread]: On master: Close
[0m16:58:19.034130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:19.034130 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:58:19.035075 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:58:19.035075 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:58:19.035075 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update' was properly closed.
[0m16:58:19.036076 [info ] [MainThread]: 
[0m16:58:19.037055 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m16:58:19.037055 [debug] [MainThread]: Command end result
[0m16:58:19.059131 [info ] [MainThread]: 
[0m16:58:19.060068 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:58:19.060068 [info ] [MainThread]: 
[0m16:58:19.061102 [error] [MainThread]:   Compilation Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  'run_sql' is undefined
[0m16:58:19.061102 [info ] [MainThread]: 
[0m16:58:19.061102 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:58:19.062104 [debug] [MainThread]: Command `cli run` failed at 16:58:19.062104 after 0.87 seconds
[0m16:58:19.063128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002742687C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002742687FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002742687C7D0>]}
[0m16:58:19.063128 [debug] [MainThread]: Flushing usage events
[0m17:09:16.941694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A3D30A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A3FC82FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A3E65A6C0>]}


============================== 17:09:16.945725 | 53ceee0f-d683-4547-bbba-7c788afd56ba ==============================
[0m17:09:16.945725 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:09:16.945725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:17.097802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53ceee0f-d683-4547-bbba-7c788afd56ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A41383B90>]}
[0m17:09:17.138421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53ceee0f-d683-4547-bbba-7c788afd56ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A3EA04470>]}
[0m17:09:17.139528 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:09:17.148499 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:09:17.267128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:17.267128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:17.297772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53ceee0f-d683-4547-bbba-7c788afd56ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A413DCC20>]}
[0m17:09:17.372820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53ceee0f-d683-4547-bbba-7c788afd56ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A416DEC30>]}
[0m17:09:17.373878 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m17:09:17.373878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53ceee0f-d683-4547-bbba-7c788afd56ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A411CCE30>]}
[0m17:09:17.375853 [info ] [MainThread]: 
[0m17:09:17.375853 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:09:17.376848 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:09:17.435899 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:09:17.435899 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:09:17.436893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:17.454973 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:17.456023 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:09:17.461008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:09:17.461973 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:09:17.466047 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:09:17.467052 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:09:17.467052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:17.482616 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:17.483583 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:09:17.483583 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:09:17.484669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:17.484883 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:09:17.484883 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:09:17.485883 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:17.485883 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:09:17.486952 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:09:17.486952 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:09:17.487883 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:17.488375 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:09:17.499453 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:09:17.505991 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:09:17.506957 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:09:17.506957 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:09:17.509026 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:09:17.509026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:17.510028 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:09:17.525720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:17.525720 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:17.526770 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:17.527794 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:09:17.527794 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:09:17.528809 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:09:17.528809 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:09:17.558316 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:17.559287 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:09:17.560398 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:09:17.560398 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:17.561293 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:09:17.562365 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:09:17.563321 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:09:17.564364 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:09:17.568368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53ceee0f-d683-4547-bbba-7c788afd56ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A415CEA50>]}
[0m17:09:17.569369 [debug] [MainThread]: Using duckdb connection "master"
[0m17:09:17.569369 [debug] [MainThread]: On master: BEGIN
[0m17:09:17.570322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:17.584992 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:09:17.584992 [debug] [MainThread]: On master: COMMIT
[0m17:09:17.586035 [debug] [MainThread]: Using duckdb connection "master"
[0m17:09:17.586035 [debug] [MainThread]: On master: COMMIT
[0m17:09:17.587030 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:09:17.587992 [debug] [MainThread]: On master: Close
[0m17:09:17.592693 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:09:17.593689 [info ] [MainThread]: 
[0m17:09:17.599654 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:09:17.599654 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [RUN]
[0m17:09:17.600653 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update'
[0m17:09:17.600653 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:09:17.609696 [debug] [Thread-1 (]: Compilation Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  'convert_inc_date_to_date_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:09:17.610698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53ceee0f-d683-4547-bbba-7c788afd56ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A3F6839E0>]}
[0m17:09:17.611694 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [[31mERROR[0m in 0.01s]
[0m17:09:17.612695 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:09:17.614676 [debug] [MainThread]: Using duckdb connection "master"
[0m17:09:17.614676 [debug] [MainThread]: On master: BEGIN
[0m17:09:17.615694 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:17.629684 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:09:17.630692 [debug] [MainThread]: On master: COMMIT
[0m17:09:17.630692 [debug] [MainThread]: Using duckdb connection "master"
[0m17:09:17.630692 [debug] [MainThread]: On master: COMMIT
[0m17:09:17.631694 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:09:17.631694 [debug] [MainThread]: On master: Close
[0m17:09:17.635649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:17.635649 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:09:17.635649 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:09:17.636714 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:09:17.636714 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update' was properly closed.
[0m17:09:17.636714 [info ] [MainThread]: 
[0m17:09:17.637647 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m17:09:17.637647 [debug] [MainThread]: Command end result
[0m17:09:17.659611 [info ] [MainThread]: 
[0m17:09:17.659611 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:09:17.660640 [info ] [MainThread]: 
[0m17:09:17.660640 [error] [MainThread]:   Compilation Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  'convert_inc_date_to_date_type' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m17:09:17.660640 [info ] [MainThread]: 
[0m17:09:17.661646 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:09:17.661646 [debug] [MainThread]: Command `cli run` failed at 17:09:17.661646 after 0.83 seconds
[0m17:09:17.662688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A3FD47860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A3FA436B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A3FD7F980>]}
[0m17:09:17.662688 [debug] [MainThread]: Flushing usage events
[0m17:09:43.576825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194702238C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019470677D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000194702227B0>]}


============================== 17:09:43.580838 | 2c9d409b-5625-49bb-aa04-276a45526aea ==============================
[0m17:09:43.580838 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:09:43.580838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:43.733704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c9d409b-5625-49bb-aa04-276a45526aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001947082C7D0>]}
[0m17:09:43.775908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c9d409b-5625-49bb-aa04-276a45526aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001946E653E00>]}
[0m17:09:43.776826 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:09:43.785209 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:09:43.903574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:43.903574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:43.935637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c9d409b-5625-49bb-aa04-276a45526aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001947082F440>]}
[0m17:09:44.009675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c9d409b-5625-49bb-aa04-276a45526aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019470DD5BE0>]}
[0m17:09:44.009675 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m17:09:44.010639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c9d409b-5625-49bb-aa04-276a45526aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019470CCF620>]}
[0m17:09:44.011681 [info ] [MainThread]: 
[0m17:09:44.012672 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:09:44.013672 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:09:44.070666 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:09:44.071633 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:09:44.071633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:44.088688 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:44.090658 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:09:44.095343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:09:44.096300 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:09:44.101344 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:09:44.101344 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:09:44.101344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:44.117701 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:44.118698 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:09:44.118698 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:09:44.119684 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:44.119684 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:09:44.119684 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:09:44.120689 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:44.120689 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:09:44.121729 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:09:44.121729 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:09:44.121729 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:44.122684 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:09:44.130760 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:09:44.134846 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:09:44.134846 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:09:44.135793 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:09:44.137382 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:09:44.137382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:44.138305 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:09:44.152048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:44.153080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:44.153080 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:09:44.154080 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:44.155077 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:09:44.155077 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:09:44.156091 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:09:44.190736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:44.190972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:09:44.192056 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:09:44.193126 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:09:44.195132 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:09:44.195132 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:09:44.196124 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:09:44.196124 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:09:44.202310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c9d409b-5625-49bb-aa04-276a45526aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019470DD6BA0>]}
[0m17:09:44.202310 [debug] [MainThread]: Using duckdb connection "master"
[0m17:09:44.202310 [debug] [MainThread]: On master: BEGIN
[0m17:09:44.203409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:44.218118 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:09:44.218118 [debug] [MainThread]: On master: COMMIT
[0m17:09:44.218118 [debug] [MainThread]: Using duckdb connection "master"
[0m17:09:44.219115 [debug] [MainThread]: On master: COMMIT
[0m17:09:44.219115 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:09:44.219115 [debug] [MainThread]: On master: Close
[0m17:09:44.223002 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:09:44.223927 [info ] [MainThread]: 
[0m17:09:44.227777 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:09:44.227777 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [RUN]
[0m17:09:44.228777 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update'
[0m17:09:44.228777 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:09:44.235869 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:09:44.235869 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

    
        ALTER TABLE "nfirs"."nfirs_raw"."arson"
        ALTER COLUMN INC_DATE TYPE DATE
        USING TO_DATE(INC_DATE, 'MMDDYYYY');
    
  
[0m17:09:44.236812 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:09:44.264600 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

    
        ALTER TABLE "nfirs"."nfirs_raw"."arson"
        ALTER COLUMN INC_DATE TYPE DATE
        USING TO_DATE(INC_DATE, 'MMDDYYYY');
    
  
[0m17:09:44.264600 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:09:44.266657 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: Close
[0m17:09:44.275344 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 6:         USING TO_DATE(INC_DATE, 'MMDDYYYY');
                        ^
[0m17:09:44.276344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c9d409b-5625-49bb-aa04-276a45526aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019470B5F1A0>]}
[0m17:09:44.277426 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [[31mERROR[0m in 0.05s]
[0m17:09:44.277426 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:09:44.280391 [debug] [MainThread]: Using duckdb connection "master"
[0m17:09:44.280391 [debug] [MainThread]: On master: BEGIN
[0m17:09:44.280391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:44.295697 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:09:44.295697 [debug] [MainThread]: On master: COMMIT
[0m17:09:44.296697 [debug] [MainThread]: Using duckdb connection "master"
[0m17:09:44.296697 [debug] [MainThread]: On master: COMMIT
[0m17:09:44.296697 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:09:44.297696 [debug] [MainThread]: On master: Close
[0m17:09:44.301428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:44.301428 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:09:44.302428 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:09:44.302428 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:09:44.302428 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update' was properly closed.
[0m17:09:44.302428 [info ] [MainThread]: 
[0m17:09:44.303428 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m17:09:44.303428 [debug] [MainThread]: Command end result
[0m17:09:44.328616 [info ] [MainThread]: 
[0m17:09:44.328616 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:09:44.329617 [info ] [MainThread]: 
[0m17:09:44.329617 [error] [MainThread]:   Runtime Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  Catalog Error: Scalar Function with name to_date does not exist!
  Did you mean "today"?
  LINE 6:         USING TO_DATE(INC_DATE, 'MMDDYYYY');
                        ^
[0m17:09:44.329617 [info ] [MainThread]: 
[0m17:09:44.330617 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:09:44.331617 [debug] [MainThread]: Command `cli run` failed at 17:09:44.330617 after 0.86 seconds
[0m17:09:44.331617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019470FE37D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001946ED87710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019470B47A40>]}
[0m17:09:44.332617 [debug] [MainThread]: Flushing usage events
[0m17:10:54.819241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936C4EBFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936C4E8B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936C4EB4D0>]}


============================== 17:10:54.821978 | 0d4b26c2-523b-4988-8c7d-901bebe872eb ==============================
[0m17:10:54.821978 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:10:54.822926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:10:54.973800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d4b26c2-523b-4988-8c7d-901bebe872eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936C6EE480>]}
[0m17:10:55.014496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d4b26c2-523b-4988-8c7d-901bebe872eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936C6FC2C0>]}
[0m17:10:55.015497 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:10:55.025358 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:10:55.144350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:10:55.145350 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:10:55.179627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d4b26c2-523b-4988-8c7d-901bebe872eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936C862D50>]}
[0m17:10:55.261918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d4b26c2-523b-4988-8c7d-901bebe872eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936CBEEC60>]}
[0m17:10:55.261918 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m17:10:55.262961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d4b26c2-523b-4988-8c7d-901bebe872eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936C844FE0>]}
[0m17:10:55.263954 [info ] [MainThread]: 
[0m17:10:55.263954 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:10:55.264959 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:10:55.322795 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:10:55.323899 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:10:55.323899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:55.341828 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:55.342825 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:10:55.347537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:10:55.348549 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:10:55.353348 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:10:55.354100 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:10:55.354630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:55.370802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:55.371627 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:10:55.371627 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:10:55.372618 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:55.372618 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:10:55.372618 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:10:55.373618 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:55.374626 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:10:55.374626 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:10:55.374626 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:10:55.375618 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:55.375618 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:10:55.382897 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:10:55.387712 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:10:55.387927 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:10:55.387927 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:10:55.389927 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:10:55.390328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:55.390763 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:10:55.404946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:55.405945 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:55.405945 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:55.406944 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:10:55.406944 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:10:55.407944 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:10:55.407944 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:10:55.438181 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:55.439176 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:10:55.440176 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:10:55.441175 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:10:55.441175 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:10:55.442571 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:10:55.443681 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:10:55.443681 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:10:55.448650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d4b26c2-523b-4988-8c7d-901bebe872eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936C749D90>]}
[0m17:10:55.449606 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:55.449606 [debug] [MainThread]: On master: BEGIN
[0m17:10:55.449606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:55.465415 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:10:55.465415 [debug] [MainThread]: On master: COMMIT
[0m17:10:55.465415 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:55.466441 [debug] [MainThread]: On master: COMMIT
[0m17:10:55.466441 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:10:55.466441 [debug] [MainThread]: On master: Close
[0m17:10:55.470807 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:10:55.471078 [info ] [MainThread]: 
[0m17:10:55.474116 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:10:55.474116 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [RUN]
[0m17:10:55.475116 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update'
[0m17:10:55.475116 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:10:55.482477 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:10:55.482477 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

    
        ALTER TABLE "nfirs"."nfirs_raw"."arson"
        ALTER COLUMN INC_DATE TYPE DATE
        USING DATE_FROM_STR(INC_DATE, 'MMDDYYYY');
    
  
[0m17:10:55.482477 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:10:55.501485 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

    
        ALTER TABLE "nfirs"."nfirs_raw"."arson"
        ALTER COLUMN INC_DATE TYPE DATE
        USING DATE_FROM_STR(INC_DATE, 'MMDDYYYY');
    
  
[0m17:10:55.502471 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:10:55.503877 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: Close
[0m17:10:55.512470 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  Catalog Error: Scalar Function with name date_from_str does not exist!
  Did you mean "date_part"?
  LINE 6:         USING DATE_FROM_STR(INC_DATE, 'MMDDYYYY');
                        ^
[0m17:10:55.513468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d4b26c2-523b-4988-8c7d-901bebe872eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936C999490>]}
[0m17:10:55.514470 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [[31mERROR[0m in 0.04s]
[0m17:10:55.515430 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:10:55.517440 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:55.517440 [debug] [MainThread]: On master: BEGIN
[0m17:10:55.517440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:55.533769 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:10:55.533769 [debug] [MainThread]: On master: COMMIT
[0m17:10:55.534767 [debug] [MainThread]: Using duckdb connection "master"
[0m17:10:55.534767 [debug] [MainThread]: On master: COMMIT
[0m17:10:55.534767 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:10:55.535777 [debug] [MainThread]: On master: Close
[0m17:10:55.540629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:55.540629 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:10:55.540629 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:10:55.541685 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:10:55.541685 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update' was properly closed.
[0m17:10:55.542639 [info ] [MainThread]: 
[0m17:10:55.542639 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m17:10:55.543603 [debug] [MainThread]: Command end result
[0m17:10:55.565195 [info ] [MainThread]: 
[0m17:10:55.565195 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:10:55.565195 [info ] [MainThread]: 
[0m17:10:55.566229 [error] [MainThread]:   Runtime Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  Catalog Error: Scalar Function with name date_from_str does not exist!
  Did you mean "date_part"?
  LINE 6:         USING DATE_FROM_STR(INC_DATE, 'MMDDYYYY');
                        ^
[0m17:10:55.566229 [info ] [MainThread]: 
[0m17:10:55.567231 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:10:55.567231 [debug] [MainThread]: Command `cli run` failed at 17:10:55.567231 after 0.85 seconds
[0m17:10:55.568229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936C54C140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936C649430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936C4C0AD0>]}
[0m17:10:55.568229 [debug] [MainThread]: Flushing usage events
[0m17:15:53.969171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271497C0CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714822F860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002711DA61DC0>]}


============================== 17:15:53.973174 | c0f0174e-6bc9-4af5-baa8-2c853e4fcb06 ==============================
[0m17:15:53.973174 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:15:53.973174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:15:54.131190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0f0174e-6bc9-4af5-baa8-2c853e4fcb06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714B0BFD40>]}
[0m17:15:54.173259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0f0174e-6bc9-4af5-baa8-2c853e4fcb06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714AEF8FE0>]}
[0m17:15:54.174267 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:15:54.185266 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:15:54.304423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:15:54.305418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:15:54.336684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0f0174e-6bc9-4af5-baa8-2c853e4fcb06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714B168BF0>]}
[0m17:15:54.414795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0f0174e-6bc9-4af5-baa8-2c853e4fcb06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714B3BEE70>]}
[0m17:15:54.415831 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m17:15:54.415831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0f0174e-6bc9-4af5-baa8-2c853e4fcb06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714B2AF830>]}
[0m17:15:54.416835 [info ] [MainThread]: 
[0m17:15:54.417821 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:15:54.419143 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:15:54.478144 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:15:54.479144 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:15:54.479144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:54.581844 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:15:54.582891 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:15:54.583838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:54.583838 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m17:15:54.584877 [info ] [MainThread]: 
[0m17:15:54.584877 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m17:15:54.585808 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 7656)
[0m17:15:54.585808 [debug] [MainThread]: Command `cli run` failed at 17:15:54.585808 after 0.74 seconds
[0m17:15:54.586885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271497C0CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714A990830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002714B082E40>]}
[0m17:15:54.586885 [debug] [MainThread]: Flushing usage events
[0m17:17:13.444963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BC184C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BC186840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BC74A090>]}


============================== 17:17:13.460668 | 518554b9-c517-4972-8d71-cc77075c8e87 ==============================
[0m17:17:13.460668 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:17:13.460668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:17:13.612470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '518554b9-c517-4972-8d71-cc77075c8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BDE20080>]}
[0m17:17:13.644955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '518554b9-c517-4972-8d71-cc77075c8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BDE4D8E0>]}
[0m17:17:13.644955 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:17:13.661650 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:17:13.778285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:17:13.778285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:17:13.811347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '518554b9-c517-4972-8d71-cc77075c8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BBEF2A50>]}
[0m17:17:13.878091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '518554b9-c517-4972-8d71-cc77075c8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BE37A510>]}
[0m17:17:13.878091 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m17:17:13.878091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '518554b9-c517-4972-8d71-cc77075c8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BDC72E70>]}
[0m17:17:13.878091 [info ] [MainThread]: 
[0m17:17:13.878091 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:17:13.878091 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:17:13.946126 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:17:13.946126 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:17:13.946126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:13.961702 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:17:13.961702 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:17:13.961702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:17:13.961702 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:17:13.978255 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:17:13.978255 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:17:13.978255 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:13.994466 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:17:13.994466 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:17:13.994466 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:17:13.994466 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:17:13.994466 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:17:13.994466 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:17:13.994466 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:17:13.994466 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:17:13.994466 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:17:13.994466 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:17:13.994466 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:17:13.994466 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:17:13.994466 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:17:14.010199 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:17:14.011429 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:17:14.011429 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:17:14.011429 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:17:14.011429 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:17:14.011429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:14.011429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:14.027978 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:17:14.027978 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:17:14.027978 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:17:14.027978 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:17:14.027978 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:17:14.027978 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:17:14.061438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:17:14.061438 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:17:14.061438 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:17:14.061438 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:17:14.061438 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:17:14.061438 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:17:14.061438 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:17:14.061438 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:17:14.061438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '518554b9-c517-4972-8d71-cc77075c8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BE7238C0>]}
[0m17:17:14.061438 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:14.061438 [debug] [MainThread]: On master: BEGIN
[0m17:17:14.061438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:14.077995 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:17:14.077995 [debug] [MainThread]: On master: COMMIT
[0m17:17:14.077995 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:14.077995 [debug] [MainThread]: On master: COMMIT
[0m17:17:14.077995 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:17:14.077995 [debug] [MainThread]: On master: Close
[0m17:17:14.077995 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:17:14.093701 [info ] [MainThread]: 
[0m17:17:14.094502 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:17:14.094502 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [RUN]
[0m17:17:14.094502 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update'
[0m17:17:14.094502 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:17:14.104145 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:17:14.104145 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

    
        ALTER TABLE "nfirs"."nfirs_raw"."arson"
        ALTER COLUMN INC_DATE TYPE DATE
        USING STRPTIME(INC_DATE, '%m%d%Y');
    
  
[0m17:17:14.104145 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:17:14.129642 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:17:14.129642 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:17:14.129642 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:17:14.161428 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:17:14.161428 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:17:14.161428 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: BEGIN
[0m17:17:14.161428 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:17:14.161428 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:17:14.161428 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arson_inc_date_update__dbt_tmp"
  
    as (
      



    
    

    | column  | data_type |
| ------- | --------- |
| Success | Integer   |



    );
  
  
[0m17:17:14.161428 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arson_inc_date_update__dbt_tmp"
  
    as (
      



    
    

    | column  | data_type |
| ------- | --------- |
| Success | Integer   |



    );
  
  
[0m17:17:14.161428 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:17:14.161428 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: ROLLBACK
[0m17:17:14.161428 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update'
[0m17:17:14.161428 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: Close
[0m17:17:14.327818 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  Parser Error: syntax error at or near "|"
[0m17:17:14.327818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '518554b9-c517-4972-8d71-cc77075c8e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BC184C20>]}
[0m17:17:14.327818 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [[31mERROR[0m in 0.23s]
[0m17:17:14.327818 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:17:14.327818 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:14.327818 [debug] [MainThread]: On master: BEGIN
[0m17:17:14.327818 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:14.349626 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:17:14.349626 [debug] [MainThread]: On master: COMMIT
[0m17:17:14.349626 [debug] [MainThread]: Using duckdb connection "master"
[0m17:17:14.349626 [debug] [MainThread]: On master: COMMIT
[0m17:17:14.349626 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:17:14.349626 [debug] [MainThread]: On master: Close
[0m17:17:14.349626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:14.349626 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:17:14.349626 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:17:14.349626 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:17:14.349626 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update' was properly closed.
[0m17:17:14.349626 [info ] [MainThread]: 
[0m17:17:14.349626 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m17:17:14.349626 [debug] [MainThread]: Command end result
[0m17:17:14.379727 [info ] [MainThread]: 
[0m17:17:14.380732 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:17:14.381051 [info ] [MainThread]: 
[0m17:17:14.381484 [error] [MainThread]:   Runtime Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  Parser Error: syntax error at or near "|"
[0m17:17:14.381847 [info ] [MainThread]: 
[0m17:17:14.382134 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:17:14.383052 [debug] [MainThread]: Command `cli run` failed at 17:17:14.382836 after 1.04 seconds
[0m17:17:14.383052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BDDFCEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BDDFCB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5BE3DBCB0>]}
[0m17:17:14.383052 [debug] [MainThread]: Flushing usage events
[0m17:20:30.973338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D909C62A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D924E8AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D924EA960>]}


============================== 17:20:30.973338 | 58001fe5-7055-4a89-9526-753f550c3999 ==============================
[0m17:20:30.973338 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:20:30.973338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:20:31.123283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58001fe5-7055-4a89-9526-753f550c3999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D926EF3E0>]}
[0m17:20:31.173503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58001fe5-7055-4a89-9526-753f550c3999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D902FD8E0>]}
[0m17:20:31.173503 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:20:31.189599 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:20:31.306847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:20:31.306847 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:20:31.339958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58001fe5-7055-4a89-9526-753f550c3999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D9296F500>]}
[0m17:20:31.406451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58001fe5-7055-4a89-9526-753f550c3999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D92BEEF00>]}
[0m17:20:31.406451 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m17:20:31.406451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58001fe5-7055-4a89-9526-753f550c3999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D92A4C410>]}
[0m17:20:31.406451 [info ] [MainThread]: 
[0m17:20:31.422665 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:20:31.423211 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:20:31.474791 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:20:31.474791 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:20:31.474791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:31.491375 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:20:31.491375 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:20:31.506746 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:20:31.506746 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:20:31.506746 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:20:31.506746 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:20:31.506746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:31.523316 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:20:31.523316 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:20:31.523316 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:20:31.523316 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:20:31.523316 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:20:31.523316 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:20:31.523316 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:20:31.523316 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:20:31.523316 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:20:31.523316 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:20:31.523316 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:20:31.523316 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:20:31.540036 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:20:31.540036 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:20:31.540036 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:20:31.540036 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:20:31.540036 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:20:31.540036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:31.540036 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:20:31.556337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:31.556337 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:20:31.556337 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:20:31.556337 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:20:31.556337 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:20:31.556337 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:20:31.556337 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:20:31.589959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:20:31.589959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:20:31.589959 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:20:31.589959 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:20:31.589959 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:20:31.589959 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:20:31.589959 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:20:31.589959 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:20:31.606549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58001fe5-7055-4a89-9526-753f550c3999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D92745F10>]}
[0m17:20:31.606549 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:31.606549 [debug] [MainThread]: On master: BEGIN
[0m17:20:31.606549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:31.623197 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:20:31.623197 [debug] [MainThread]: On master: COMMIT
[0m17:20:31.623197 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:31.623197 [debug] [MainThread]: On master: COMMIT
[0m17:20:31.623197 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:20:31.623197 [debug] [MainThread]: On master: Close
[0m17:20:31.623197 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:20:31.623197 [info ] [MainThread]: 
[0m17:20:31.623197 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:20:31.638902 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [RUN]
[0m17:20:31.639648 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update'
[0m17:20:31.639648 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:20:31.645421 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:20:31.645421 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

    
        ALTER TABLE "nfirs"."nfirs_raw"."arson"
        ALTER COLUMN INC_DATE TYPE DATE
        USING STRPTIME(INC_DATE, '%m%d%Y');
    
  
[0m17:20:31.645421 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:20:31.659659 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

    
        ALTER TABLE "nfirs"."nfirs_raw"."arson"
        ALTER COLUMN INC_DATE TYPE DATE
        USING STRPTIME(INC_DATE, '%m%d%Y');
    
  
[0m17:20:31.662731 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:20:31.662731 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: Close
[0m17:20:31.662731 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  Binder Error: No function matches the given name and argument types 'strptime(DATE, STRING_LITERAL)'. You might need to add explicit type casts.
  	Candidate functions:
  	strptime(VARCHAR, VARCHAR) -> TIMESTAMP
  	strptime(VARCHAR, VARCHAR[]) -> TIMESTAMP
  
  LINE 6:         USING STRPTIME(INC_DATE, '%m%d%Y');
                        ^
[0m17:20:31.672744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58001fe5-7055-4a89-9526-753f550c3999', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D90B97800>]}
[0m17:20:31.673787 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [[31mERROR[0m in 0.02s]
[0m17:20:31.673787 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:20:31.675076 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:31.675076 [debug] [MainThread]: On master: BEGIN
[0m17:20:31.675076 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:20:31.693942 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:20:31.694934 [debug] [MainThread]: On master: COMMIT
[0m17:20:31.694934 [debug] [MainThread]: Using duckdb connection "master"
[0m17:20:31.694934 [debug] [MainThread]: On master: COMMIT
[0m17:20:31.696111 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:20:31.696111 [debug] [MainThread]: On master: Close
[0m17:20:31.696111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:31.696111 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:20:31.696111 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:20:31.696111 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:20:31.696111 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update' was properly closed.
[0m17:20:31.696111 [info ] [MainThread]: 
[0m17:20:31.696111 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m17:20:31.696111 [debug] [MainThread]: Command end result
[0m17:20:31.725593 [info ] [MainThread]: 
[0m17:20:31.725593 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:20:31.726579 [info ] [MainThread]: 
[0m17:20:31.726579 [error] [MainThread]:   Runtime Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  Binder Error: No function matches the given name and argument types 'strptime(DATE, STRING_LITERAL)'. You might need to add explicit type casts.
  	Candidate functions:
  	strptime(VARCHAR, VARCHAR) -> TIMESTAMP
  	strptime(VARCHAR, VARCHAR[]) -> TIMESTAMP
  
  LINE 6:         USING STRPTIME(INC_DATE, '%m%d%Y');
                        ^
[0m17:20:31.726579 [info ] [MainThread]: 
[0m17:20:31.726579 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:20:31.726579 [debug] [MainThread]: Command `cli run` failed at 17:20:31.726579 after 0.85 seconds
[0m17:20:31.726579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D9255CE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D9264A1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D92648D70>]}
[0m17:20:31.726579 [debug] [MainThread]: Flushing usage events
[0m17:24:25.229544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291691BB6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913FF31DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002916BFA8A40>]}


============================== 17:24:25.232485 | be65fcf1-db3e-4118-b9b4-e77ec5b6d655 ==============================
[0m17:24:25.232485 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:24:25.233503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:24:25.384309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be65fcf1-db3e-4118-b9b4-e77ec5b6d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002916D5E3500>]}
[0m17:24:25.425251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be65fcf1-db3e-4118-b9b4-e77ec5b6d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002913FF31DC0>]}
[0m17:24:25.426309 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:24:25.435270 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:24:25.553303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:25.554258 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:25.584709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be65fcf1-db3e-4118-b9b4-e77ec5b6d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002916D6A7950>]}
[0m17:24:25.659395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be65fcf1-db3e-4118-b9b4-e77ec5b6d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002916D912600>]}
[0m17:24:25.659395 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m17:24:25.660352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be65fcf1-db3e-4118-b9b4-e77ec5b6d655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002916D81A1B0>]}
[0m17:24:25.661353 [info ] [MainThread]: 
[0m17:24:25.662391 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:24:25.662391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:24:25.721639 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:24:25.721639 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:24:25.721639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:25.798789 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:24:25.799790 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:24:25.800790 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:25.801790 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m17:24:25.801790 [info ] [MainThread]: 
[0m17:24:25.801790 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m17:24:25.802790 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 22296)
[0m17:24:25.803790 [debug] [MainThread]: Command `cli run` failed at 17:24:25.803790 after 0.68 seconds
[0m17:24:25.803790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000291691BB6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002916D432750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002916DB72000>]}
[0m17:24:25.804790 [debug] [MainThread]: Flushing usage events
[0m17:24:44.210891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF514AFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF5CE7D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF5CE47A0>]}


============================== 17:24:44.227121 | 28679dd4-5908-4c59-b45e-3f40f22e34c4 ==============================
[0m17:24:44.227121 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:24:44.227779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:24:44.377722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28679dd4-5908-4c59-b45e-3f40f22e34c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF75D18E0>]}
[0m17:24:44.410862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28679dd4-5908-4c59-b45e-3f40f22e34c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF4BBF530>]}
[0m17:24:44.410862 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:24:44.427357 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:24:44.544476 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:24:44.544476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:24:44.577791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28679dd4-5908-4c59-b45e-3f40f22e34c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF768FA10>]}
[0m17:24:44.644089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28679dd4-5908-4c59-b45e-3f40f22e34c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF790E330>]}
[0m17:24:44.644089 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m17:24:44.644089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28679dd4-5908-4c59-b45e-3f40f22e34c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF760EA80>]}
[0m17:24:44.660143 [info ] [MainThread]: 
[0m17:24:44.660630 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:24:44.660630 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:24:44.714042 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:24:44.714042 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:24:44.714042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:44.728866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:24:44.728866 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:24:44.744082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:24:44.744082 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:24:44.744082 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:24:44.744082 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:24:44.744082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:24:44.760669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:24:44.760669 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:24:44.760669 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:24:44.760669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:24:44.760669 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:24:44.760669 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:24:44.760669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:24:44.760669 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:24:44.760669 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:24:44.760669 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:24:44.760669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:24:44.760669 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:24:44.777328 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:24:44.777328 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:24:44.777328 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:24:44.777328 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:24:44.777328 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:24:44.777328 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:24:44.777328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:44.777328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:44.794071 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:24:44.794071 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:24:44.794071 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:24:44.794071 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:24:44.794071 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:24:44.794071 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:24:44.827262 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:24:44.827262 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:24:44.827262 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:24:44.827262 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:24:44.827262 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:24:44.827262 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:24:44.827262 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:24:44.827262 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:24:44.843898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28679dd4-5908-4c59-b45e-3f40f22e34c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF73E5E80>]}
[0m17:24:44.843898 [debug] [MainThread]: Using duckdb connection "master"
[0m17:24:44.843898 [debug] [MainThread]: On master: BEGIN
[0m17:24:44.843898 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:44.860589 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:24:44.860589 [debug] [MainThread]: On master: COMMIT
[0m17:24:44.860589 [debug] [MainThread]: Using duckdb connection "master"
[0m17:24:44.860589 [debug] [MainThread]: On master: COMMIT
[0m17:24:44.860589 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:24:44.860589 [debug] [MainThread]: On master: Close
[0m17:24:44.860589 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:24:44.860589 [info ] [MainThread]: 
[0m17:24:44.860589 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:24:44.860589 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [RUN]
[0m17:24:44.860589 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update'
[0m17:24:44.860589 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:24:44.879292 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:24:44.879292 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

    
        ALTER TABLE "nfirs"."nfirs_raw"."arson"
        ALTER COLUMN INC_DATE TYPE DATE
        USING STRPTIME(CAST(INC_DATE AS VARCHAR), '%m%d%Y');
    
  
[0m17:24:44.879292 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:24:44.901906 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

    
        ALTER TABLE "nfirs"."nfirs_raw"."arson"
        ALTER COLUMN INC_DATE TYPE DATE
        USING STRPTIME(CAST(INC_DATE AS VARCHAR), '%m%d%Y');
    
  
[0m17:24:44.901906 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:24:44.901906 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: Close
[0m17:24:44.912199 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  Invalid Input Error: Could not parse string "2022-05-30" according to format specifier "%m%d%Y"
  2022-05-30
  ^
  Error: Month out of range, expected a value between 1 and 12
[0m17:24:44.914320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28679dd4-5908-4c59-b45e-3f40f22e34c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF58476B0>]}
[0m17:24:44.914320 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [[31mERROR[0m in 0.05s]
[0m17:24:44.914320 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:24:44.914320 [debug] [MainThread]: Using duckdb connection "master"
[0m17:24:44.914320 [debug] [MainThread]: On master: BEGIN
[0m17:24:44.914320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:24:44.933019 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:24:44.934021 [debug] [MainThread]: On master: COMMIT
[0m17:24:44.934021 [debug] [MainThread]: Using duckdb connection "master"
[0m17:24:44.934021 [debug] [MainThread]: On master: COMMIT
[0m17:24:44.935106 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:24:44.935106 [debug] [MainThread]: On master: Close
[0m17:24:44.935106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:44.935106 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:24:44.935106 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:24:44.935106 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:24:44.935106 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update' was properly closed.
[0m17:24:44.935106 [info ] [MainThread]: 
[0m17:24:44.935106 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m17:24:44.935106 [debug] [MainThread]: Command end result
[0m17:24:44.963155 [info ] [MainThread]: 
[0m17:24:44.963155 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:24:44.964089 [info ] [MainThread]: 
[0m17:24:44.964265 [error] [MainThread]:   Runtime Error in model nfirs_transformed__arson_inc_date_update (models\nfirs_transformed\nfirs_transformed__arson_inc_date_update.sql)
  Invalid Input Error: Could not parse string "2022-05-30" according to format specifier "%m%d%Y"
  2022-05-30
  ^
  Error: Month out of range, expected a value between 1 and 12
[0m17:24:44.964265 [info ] [MainThread]: 
[0m17:24:44.964265 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:24:44.964265 [debug] [MainThread]: Command `cli run` failed at 17:24:44.964265 after 0.85 seconds
[0m17:24:44.964265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF514AFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF71889E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022EF5127FB0>]}
[0m17:24:44.964265 [debug] [MainThread]: Flushing usage events
[0m17:49:32.847536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EC240B920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EC24098B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EC24427B0>]}


============================== 17:49:32.851638 | 05962238-2c3a-4971-a074-2bf511a22606 ==============================
[0m17:49:32.851638 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:49:32.851638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:49:33.009141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05962238-2c3a-4971-a074-2bf511a22606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EC3B75EE0>]}
[0m17:49:33.050138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05962238-2c3a-4971-a074-2bf511a22606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EC2591BE0>]}
[0m17:49:33.051172 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:49:33.061172 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:49:33.183177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:33.183177 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:33.214175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05962238-2c3a-4971-a074-2bf511a22606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EC3E58F50>]}
[0m17:49:33.287225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05962238-2c3a-4971-a074-2bf511a22606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EC40AEC90>]}
[0m17:49:33.287225 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m17:49:33.288229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05962238-2c3a-4971-a074-2bf511a22606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EC16631D0>]}
[0m17:49:33.289419 [info ] [MainThread]: 
[0m17:49:33.289419 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:49:33.291430 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:49:33.350488 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:49:33.351491 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:49:33.352140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:33.430313 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:49:33.430313 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:49:33.431309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:33.432283 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m17:49:33.432283 [info ] [MainThread]: 
[0m17:49:33.432283 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m17:49:33.433325 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 2696)
[0m17:49:33.434299 [debug] [MainThread]: Command `cli run` failed at 17:49:33.434299 after 0.70 seconds
[0m17:49:33.434299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EC3AA5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EC24D2F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012EC40A67E0>]}
[0m17:49:33.435348 [debug] [MainThread]: Flushing usage events
[0m17:49:58.790914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A85091E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A824F71DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8509E3020>]}


============================== 17:49:58.790914 | 67091cc9-edee-40a4-9981-d83b56b76ae7 ==============================
[0m17:49:58.790914 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:49:58.790914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:49:58.952023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67091cc9-edee-40a4-9981-d83b56b76ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8525759D0>]}
[0m17:49:58.993101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67091cc9-edee-40a4-9981-d83b56b76ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A850ECDD30>]}
[0m17:49:58.994099 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:49:59.004098 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:49:59.125508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:59.125508 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:59.156506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67091cc9-edee-40a4-9981-d83b56b76ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A85277D850>]}
[0m17:49:59.233223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67091cc9-edee-40a4-9981-d83b56b76ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8529FEA80>]}
[0m17:49:59.234235 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 525 macros
[0m17:49:59.234235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67091cc9-edee-40a4-9981-d83b56b76ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A852862E10>]}
[0m17:49:59.236221 [info ] [MainThread]: 
[0m17:49:59.236221 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:49:59.237244 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:49:59.295325 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:49:59.295325 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:49:59.296329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:59.314445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:49:59.315437 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:49:59.320419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:49:59.321418 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:49:59.326422 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:49:59.326422 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:49:59.326422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:49:59.342590 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:49:59.343587 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:49:59.344660 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:49:59.344660 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:49:59.345558 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:49:59.345558 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:49:59.345558 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:49:59.346552 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:49:59.346552 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:49:59.347589 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:49:59.347589 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:49:59.347589 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:49:59.355405 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:49:59.355405 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:49:59.359404 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:49:59.361361 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:49:59.361361 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:49:59.362366 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:49:59.362366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:59.362366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:59.377330 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:49:59.378391 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:49:59.378391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:49:59.379367 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:49:59.379367 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:49:59.380367 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:49:59.411307 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:49:59.412340 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:49:59.412340 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:49:59.413653 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:49:59.414734 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:49:59.414734 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:49:59.415728 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:49:59.416733 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:49:59.421734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67091cc9-edee-40a4-9981-d83b56b76ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8529C30E0>]}
[0m17:49:59.421734 [debug] [MainThread]: Using duckdb connection "master"
[0m17:49:59.422734 [debug] [MainThread]: On master: BEGIN
[0m17:49:59.422734 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:59.438415 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:49:59.439422 [debug] [MainThread]: On master: COMMIT
[0m17:49:59.439422 [debug] [MainThread]: Using duckdb connection "master"
[0m17:49:59.440402 [debug] [MainThread]: On master: COMMIT
[0m17:49:59.440402 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:49:59.440402 [debug] [MainThread]: On master: Close
[0m17:49:59.444331 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:49:59.445407 [info ] [MainThread]: 
[0m17:49:59.448396 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:49:59.449475 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [RUN]
[0m17:49:59.449475 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update'
[0m17:49:59.450396 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:49:59.456481 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:49:59.457432 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:49:59.480484 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:49:59.481467 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:49:59.481467 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: BEGIN
[0m17:49:59.482440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:49:59.497672 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:59.497672 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:49:59.497672 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arson_inc_date_update__dbt_tmp"
  
    as (
      



    WITH table_source AS (
        SELECT
            *
        FROM "nfirs"."nfirs_raw"."arson"
    ),

    final_table_source AS (
        SELECT
            *,
            CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
        FROM table_source
    )

SELECT * FROM final_table_source


    );
  
  
[0m17:49:59.749320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:59.754406 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:49:59.754406 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__arson_inc_date_update__dbt_tmp" rename to "nfirs_transformed__arson_inc_date_update"
[0m17:49:59.755332 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:49:59.767416 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: COMMIT
[0m17:49:59.768416 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:49:59.768416 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: COMMIT
[0m17:50:00.234684 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:00.240682 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"
[0m17:50:00.241682 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__arson_inc_date_update__dbt_backup" cascade
[0m17:50:00.241682 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:00.243659 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update: Close
[0m17:50:00.262986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67091cc9-edee-40a4-9981-d83b56b76ae7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A84FCEF440>]}
[0m17:50:00.263985 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__arson_inc_date_update  [[32mOK[0m in 0.81s]
[0m17:50:00.263985 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update
[0m17:50:00.265943 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:00.266987 [debug] [MainThread]: On master: BEGIN
[0m17:50:00.266987 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:00.281960 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:50:00.282941 [debug] [MainThread]: On master: COMMIT
[0m17:50:00.282941 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:00.283984 [debug] [MainThread]: On master: COMMIT
[0m17:50:00.283984 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:50:00.283984 [debug] [MainThread]: On master: Close
[0m17:50:00.288983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:00.288983 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:50:00.288983 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:50:00.289939 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:50:00.289939 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date_update' was properly closed.
[0m17:50:00.289939 [info ] [MainThread]: 
[0m17:50:00.290943 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m17:50:00.290943 [debug] [MainThread]: Command end result
[0m17:50:00.314795 [info ] [MainThread]: 
[0m17:50:00.314795 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:00.315795 [info ] [MainThread]: 
[0m17:50:00.315795 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:00.316795 [debug] [MainThread]: Command `cli run` succeeded at 17:50:00.316795 after 1.62 seconds
[0m17:50:00.316795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A85091E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8524A2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A850EA34D0>]}
[0m17:50:00.317864 [debug] [MainThread]: Flushing usage events
[0m18:01:01.802241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298798AFB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987B083F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987B080830>]}


============================== 18:01:01.805278 | 982b961d-bc51-445e-8508-d7582493f89a ==============================
[0m18:01:01.805278 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:01:01.806236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m18:01:01.956286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '982b961d-bc51-445e-8508-d7582493f89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029879D94590>]}
[0m18:01:01.998614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '982b961d-bc51-445e-8508-d7582493f89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987B14CBF0>]}
[0m18:01:01.999613 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m18:01:02.008619 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:01:02.128612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:02.129612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:02.159604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '982b961d-bc51-445e-8508-d7582493f89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987C8188F0>]}
[0m18:01:02.232101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '982b961d-bc51-445e-8508-d7582493f89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987CA66960>]}
[0m18:01:02.233153 [info ] [MainThread]: Found 5 models, 4 data tests, 19 sources, 526 macros
[0m18:01:02.233153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '982b961d-bc51-445e-8508-d7582493f89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987A396000>]}
[0m18:01:02.234138 [info ] [MainThread]: 
[0m18:01:02.235182 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:02.236101 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m18:01:02.294113 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m18:01:02.294113 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m18:01:02.295100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:02.376104 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m18:01:02.377115 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m18:01:02.378099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:02.378099 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m18:01:02.378099 [info ] [MainThread]: 
[0m18:01:02.379099 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m18:01:02.379099 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 16684)
[0m18:01:02.380099 [debug] [MainThread]: Command `cli run` failed at 18:01:02.380099 after 0.70 seconds
[0m18:01:02.380099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298798AFB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987CC92AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002987C7B2840>]}
[0m18:01:02.381131 [debug] [MainThread]: Flushing usage events
[0m18:01:13.117662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD055B3AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD07737860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD095891F0>]}


============================== 18:01:13.120921 | b72cd74b-8984-4fd6-b866-0fc0a5c94720 ==============================
[0m18:01:13.120921 [info ] [MainThread]: Running with dbt=1.8.3
[0m18:01:13.121959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m18:01:13.271996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b72cd74b-8984-4fd6-b866-0fc0a5c94720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD06E44680>]}
[0m18:01:13.314395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b72cd74b-8984-4fd6-b866-0fc0a5c94720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD052D4680>]}
[0m18:01:13.315379 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m18:01:13.324974 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m18:01:13.442032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:13.442032 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:13.471889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b72cd74b-8984-4fd6-b866-0fc0a5c94720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD096ADD60>]}
[0m18:01:13.551630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b72cd74b-8984-4fd6-b866-0fc0a5c94720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD09961250>]}
[0m18:01:13.552630 [info ] [MainThread]: Found 5 models, 4 data tests, 19 sources, 526 macros
[0m18:01:13.552630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b72cd74b-8984-4fd6-b866-0fc0a5c94720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD0949CE90>]}
[0m18:01:13.554630 [info ] [MainThread]: 
[0m18:01:13.554630 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:01:13.556198 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m18:01:13.613716 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m18:01:13.613716 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m18:01:13.614726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:13.633173 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:13.634173 [debug] [ThreadPool]: On list_nfirs: Close
[0m18:01:13.638529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs)
[0m18:01:13.639513 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs"
"
[0m18:01:13.643554 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m18:01:13.644797 [debug] [ThreadPool]: On create_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m18:01:13.644797 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:13.660126 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:13.661090 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m18:01:13.661090 [debug] [ThreadPool]: On create_nfirs_nfirs: BEGIN
[0m18:01:13.662131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:13.662131 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m18:01:13.662131 [debug] [ThreadPool]: On create_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs"} */

    
    
        create schema if not exists "nfirs"."nfirs"
    
[0m18:01:13.663097 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:13.663097 [debug] [ThreadPool]: On create_nfirs_nfirs: COMMIT
[0m18:01:13.664132 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs"
[0m18:01:13.664132 [debug] [ThreadPool]: On create_nfirs_nfirs: COMMIT
[0m18:01:13.665101 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:13.665101 [debug] [ThreadPool]: On create_nfirs_nfirs: Close
[0m18:01:13.671984 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m18:01:13.671984 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m18:01:13.671984 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m18:01:13.671984 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m18:01:13.671984 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m18:01:13.671984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:13.671984 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m18:01:13.696418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:13.696418 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:13.697462 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m18:01:13.697462 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:13.698498 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m18:01:13.698498 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m18:01:13.698498 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m18:01:13.724899 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:13.728967 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m18:01:13.728967 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m18:01:13.730501 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m18:01:13.731591 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m18:01:13.732503 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m18:01:13.732503 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m18:01:13.733503 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m18:01:13.740086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b72cd74b-8984-4fd6-b866-0fc0a5c94720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD0963D040>]}
[0m18:01:13.740086 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:13.741097 [debug] [MainThread]: On master: BEGIN
[0m18:01:13.741097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:13.756415 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:01:13.756415 [debug] [MainThread]: On master: COMMIT
[0m18:01:13.756415 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:13.757415 [debug] [MainThread]: On master: COMMIT
[0m18:01:13.757415 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:01:13.757415 [debug] [MainThread]: On master: Close
[0m18:01:13.761013 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m18:01:13.762008 [info ] [MainThread]: 
[0m18:01:13.766022 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date
[0m18:01:13.766022 [info ] [Thread-1 (]: 1 of 1 START sql view model nfirs.nfirs_transformed__arson_inc_date ............ [RUN]
[0m18:01:13.767020 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date'
[0m18:01:13.767020 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date
[0m18:01:13.779087 [debug] [Thread-1 (]: Compilation Error in model nfirs_transformed__arson_inc_date (models\nfirs_transformed\nfirs_transformed__arson_inc_date.sql)
  dbt was unable to infer all dependencies for the model "nfirs_transformed__arson_inc_date".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "nfirs_transformed__arson_inc_date":
  
  -- depends_on: {{ ref('nfirs_transformed__arson_inc_date_update') }}
  
  > in macro update_inc_date_column (macros\update_inc_date_to_date.sql)
  > called by model nfirs_transformed__arson_inc_date (models\nfirs_transformed\nfirs_transformed__arson_inc_date.sql)
[0m18:01:13.781098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b72cd74b-8984-4fd6-b866-0fc0a5c94720', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD0985EDB0>]}
[0m18:01:13.781098 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model nfirs.nfirs_transformed__arson_inc_date ... [[31mERROR[0m in 0.01s]
[0m18:01:13.782089 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date
[0m18:01:13.784089 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:13.785100 [debug] [MainThread]: On master: BEGIN
[0m18:01:13.785100 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:13.800089 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:01:13.800089 [debug] [MainThread]: On master: COMMIT
[0m18:01:13.801089 [debug] [MainThread]: Using duckdb connection "master"
[0m18:01:13.801089 [debug] [MainThread]: On master: COMMIT
[0m18:01:13.801089 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m18:01:13.802088 [debug] [MainThread]: On master: Close
[0m18:01:13.806092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:13.806092 [debug] [MainThread]: Connection 'create_nfirs_nfirs' was properly closed.
[0m18:01:13.807056 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m18:01:13.807056 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m18:01:13.807056 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson_inc_date' was properly closed.
[0m18:01:13.808077 [info ] [MainThread]: 
[0m18:01:13.808077 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m18:01:13.809027 [debug] [MainThread]: Command end result
[0m18:01:13.831588 [info ] [MainThread]: 
[0m18:01:13.831588 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:01:13.831588 [info ] [MainThread]: 
[0m18:01:13.832636 [error] [MainThread]:   Compilation Error in model nfirs_transformed__arson_inc_date (models\nfirs_transformed\nfirs_transformed__arson_inc_date.sql)
  dbt was unable to infer all dependencies for the model "nfirs_transformed__arson_inc_date".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "nfirs_transformed__arson_inc_date":
  
  -- depends_on: {{ ref('nfirs_transformed__arson_inc_date_update') }}
  
  > in macro update_inc_date_column (macros\update_inc_date_to_date.sql)
  > called by model nfirs_transformed__arson_inc_date (models\nfirs_transformed\nfirs_transformed__arson_inc_date.sql)
[0m18:01:13.832636 [info ] [MainThread]: 
[0m18:01:13.832636 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:01:13.833640 [debug] [MainThread]: Command `cli run` failed at 18:01:13.833640 after 0.82 seconds
[0m18:01:13.834623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD09864770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD09588E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD095891C0>]}
[0m18:01:13.834623 [debug] [MainThread]: Flushing usage events
[0m15:20:18.105466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023071258A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023071259160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023071258E90>]}


============================== 15:20:18.115921 | 834ba4d9-400d-414d-b661-ce402828bfd1 ==============================
[0m15:20:18.115921 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:20:18.117002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:20:18.276630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '834ba4d9-400d-414d-b661-ce402828bfd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023071308DD0>]}
[0m15:20:18.316600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '834ba4d9-400d-414d-b661-ce402828bfd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002306F104CE0>]}
[0m15:20:18.317597 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:20:18.327629 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:20:18.451863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:18.452855 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:18.484855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '834ba4d9-400d-414d-b661-ce402828bfd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230714CF560>]}
[0m15:20:18.623503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '834ba4d9-400d-414d-b661-ce402828bfd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023071760B90>]}
[0m15:20:18.624577 [info ] [MainThread]: Found 3 models, 4 data tests, 19 sources, 524 macros
[0m15:20:18.624577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '834ba4d9-400d-414d-b661-ce402828bfd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230714C5070>]}
[0m15:20:18.625584 [info ] [MainThread]: 
[0m15:20:18.626584 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:20:18.627590 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:20:18.870873 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:20:18.870873 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:20:18.871872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:19.211700 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:20:19.212769 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m15:20:19.213758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:19.213758 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m15:20:19.214771 [info ] [MainThread]: 
[0m15:20:19.214771 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m15:20:19.215736 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 26456)
[0m15:20:19.216747 [debug] [MainThread]: Command `cli run` failed at 15:20:19.216747 after 1.25 seconds
[0m15:20:19.216747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002307112FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002307198DA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023071ACC8C0>]}
[0m15:20:19.216747 [debug] [MainThread]: Flushing usage events
[0m15:20:31.470592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028451631EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028451632420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028451630D70>]}


============================== 15:20:31.478767 | a0863306-9127-40fb-9916-3a1d3be80810 ==============================
[0m15:20:31.478767 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:20:31.478767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:20:31.632845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0863306-9127-40fb-9916-3a1d3be80810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028453362EA0>]}
[0m15:20:31.673163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0863306-9127-40fb-9916-3a1d3be80810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028453189B80>]}
[0m15:20:31.673163 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:20:31.681164 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:20:31.803792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:31.803792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:31.836393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0863306-9127-40fb-9916-3a1d3be80810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002845312D580>]}
[0m15:20:31.909149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0863306-9127-40fb-9916-3a1d3be80810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028453690EF0>]}
[0m15:20:31.917108 [info ] [MainThread]: Found 3 models, 4 data tests, 19 sources, 524 macros
[0m15:20:31.917108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0863306-9127-40fb-9916-3a1d3be80810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002845344B140>]}
[0m15:20:31.917108 [info ] [MainThread]: 
[0m15:20:31.917108 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:20:31.917108 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:20:31.973906 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:20:31.973906 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:20:31.973906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:32.081095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:32.081095 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:20:32.089132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:20:32.089132 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:20:32.097386 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:20:32.097386 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:20:32.097386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:32.109460 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:32.117538 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:20:32.117538 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:20:32.117538 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:32.117538 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:20:32.117538 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:20:32.117538 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:32.117538 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:20:32.117538 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:20:32.117538 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:20:32.117538 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:32.117538 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:20:32.133883 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:20:32.133883 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:20:32.133883 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:20:32.133883 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:20:32.133883 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:32.133883 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:20:32.158283 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:20:32.158283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:32.158283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:32.158283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:32.158283 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:20:32.158283 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:20:32.158283 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:20:32.158283 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:20:32.190592 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:32.200959 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:20:32.200959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:32.200959 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:20:32.200959 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:20:32.200959 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:20:32.200959 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:20:32.200959 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:20:32.208995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0863306-9127-40fb-9916-3a1d3be80810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284509ABBC0>]}
[0m15:20:32.208995 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:32.208995 [debug] [MainThread]: On master: BEGIN
[0m15:20:32.208995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:32.225357 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:32.225357 [debug] [MainThread]: On master: COMMIT
[0m15:20:32.225357 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:32.225357 [debug] [MainThread]: On master: COMMIT
[0m15:20:32.233394 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:32.233394 [debug] [MainThread]: On master: Close
[0m15:20:32.233394 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:20:32.233394 [info ] [MainThread]: 
[0m15:20:32.241389 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:20:32.241389 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson ........ [RUN]
[0m15:20:32.241389 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson'
[0m15:20:32.241389 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:20:32.249436 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:20:32.249436 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:20:32.278576 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:20:32.278576 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:20:32.278576 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: BEGIN
[0m15:20:32.278576 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:20:32.294688 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:32.294688 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:20:32.294688 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arson__dbt_tmp"
  
    as (
      

WITH arson_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arson"
),

arson_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
),

arson_final AS (
    SELECT
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        CASE_STAT,
        AVAIL_MFI,
        MOT_FACTS1,
        MOT_FACTS2,
        MOT_FACTS3,
        GRP_INVOL1,
        GRP_INVOL2,
        GRP_INVOL3,
        ENTRY_METH,
        EXT_FIRE,
        DEVI_CONT,
        DEVI_IGNIT,
        DEVI_FUEL,
        INV_INFO_1,
        INV_INFO_2,
        INV_INFO_3,
        INV_INFO_4,
        INV_INFO_5,
        INV_INFO_6,
        INV_INFO_7,
        INV_INFO_8,
        PROP_OWNER,
        INIT_OB1,
        INIT_OB2,
        INIT_OB3,
        INIT_OB4,
        INIT_OB5,
        INIT_OB6,
        INIT_OB7,
        INIT_OB8,
        LAB_USED1,
        LAB_USED2,
        LAB_USED3,
        LAB_USED4,
        LAB_USED5,
        LAB_USED6
    FROM arson_col_data_type_update
)

SELECT * FROM arson_final
    );
  
  
[0m15:20:32.294688 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arson__dbt_tmp"
  
    as (
      

WITH arson_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arson"
),

arson_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
),

arson_final AS (
    SELECT
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        CASE_STAT,
        AVAIL_MFI,
        MOT_FACTS1,
        MOT_FACTS2,
        MOT_FACTS3,
        GRP_INVOL1,
        GRP_INVOL2,
        GRP_INVOL3,
        ENTRY_METH,
        EXT_FIRE,
        DEVI_CONT,
        DEVI_IGNIT,
        DEVI_FUEL,
        INV_INFO_1,
        INV_INFO_2,
        INV_INFO_3,
        INV_INFO_4,
        INV_INFO_5,
        INV_INFO_6,
        INV_INFO_7,
        INV_INFO_8,
        PROP_OWNER,
        INIT_OB1,
        INIT_OB2,
        INIT_OB3,
        INIT_OB4,
        INIT_OB5,
        INIT_OB6,
        INIT_OB7,
        INIT_OB8,
        LAB_USED1,
        LAB_USED2,
        LAB_USED3,
        LAB_USED4,
        LAB_USED5,
        LAB_USED6
    FROM arson_col_data_type_update
)

SELECT * FROM arson_final
    );
  
  
[0m15:20:32.302795 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:20:32.303107 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: ROLLBACK
[0m15:20:32.311143 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__arson'
[0m15:20:32.311143 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: Close
[0m15:20:32.319183 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__arson (models\nfirs_transformed\nfirs_transformed__arson.sql)
  Binder Error: * expression without FROM clause!
[0m15:20:32.319183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0863306-9127-40fb-9916-3a1d3be80810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028451633950>]}
[0m15:20:32.319183 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson  [[31mERROR[0m in 0.08s]
[0m15:20:32.319183 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:20:32.319183 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:32.319183 [debug] [MainThread]: On master: BEGIN
[0m15:20:32.319183 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:32.335450 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:32.335450 [debug] [MainThread]: On master: COMMIT
[0m15:20:32.335450 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:32.335450 [debug] [MainThread]: On master: COMMIT
[0m15:20:32.335450 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:32.335450 [debug] [MainThread]: On master: Close
[0m15:20:32.343460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:32.343460 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:20:32.343460 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:20:32.343460 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:20:32.343460 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson' was properly closed.
[0m15:20:32.343460 [info ] [MainThread]: 
[0m15:20:32.343460 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m15:20:32.343460 [debug] [MainThread]: Command end result
[0m15:20:32.367765 [info ] [MainThread]: 
[0m15:20:32.367765 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:20:32.367765 [info ] [MainThread]: 
[0m15:20:32.367765 [error] [MainThread]:   Runtime Error in model nfirs_transformed__arson (models\nfirs_transformed\nfirs_transformed__arson.sql)
  Binder Error: * expression without FROM clause!
[0m15:20:32.367765 [info ] [MainThread]: 
[0m15:20:32.367765 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:20:32.367765 [debug] [MainThread]: Command `cli run` failed at 15:20:32.367765 after 1.01 seconds
[0m15:20:32.367765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028451BC4800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002845365D0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028453182570>]}
[0m15:20:32.367765 [debug] [MainThread]: Flushing usage events
[0m15:20:53.717967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226FFC2C650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226FFB92F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226FE0BAFC0>]}


============================== 15:20:53.726172 | 25dd7295-4e9c-48b2-b82b-65e595ad9960 ==============================
[0m15:20:53.726172 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:20:53.726172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:53.878871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25dd7295-4e9c-48b2-b82b-65e595ad9960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022680083DA0>]}
[0m15:20:53.918977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25dd7295-4e9c-48b2-b82b-65e595ad9960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226FE76E000>]}
[0m15:20:53.918977 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:20:53.926949 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:20:54.054088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:20:54.054088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:20:54.086586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25dd7295-4e9c-48b2-b82b-65e595ad9960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226FE946DB0>]}
[0m15:20:54.159118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25dd7295-4e9c-48b2-b82b-65e595ad9960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002268016D550>]}
[0m15:20:54.159118 [info ] [MainThread]: Found 3 models, 4 data tests, 19 sources, 524 macros
[0m15:20:54.159118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25dd7295-4e9c-48b2-b82b-65e595ad9960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226FFDBF4D0>]}
[0m15:20:54.159118 [info ] [MainThread]: 
[0m15:20:54.159118 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:20:54.167067 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:20:54.223342 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:20:54.223342 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:20:54.223342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:54.238045 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.238045 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:20:54.253891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:20:54.253891 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:20:54.253891 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:20:54.253891 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:20:54.253891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:20:54.269990 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.278158 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:20:54.278158 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:20:54.278158 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.278158 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:20:54.278158 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:20:54.278158 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.278158 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:20:54.278158 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:20:54.278158 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:20:54.278158 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.278158 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:20:54.286228 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:20:54.286228 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:20:54.294232 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:20:54.294232 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:20:54.294232 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:20:54.294232 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:20:54.294232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:54.294232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:20:54.310225 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.310225 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.310225 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:20:54.310225 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:20:54.310225 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:20:54.310225 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:20:54.342193 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.342193 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:20:54.342193 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:20:54.342193 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:20:54.342193 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:20:54.350469 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:20:54.350469 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:20:54.350469 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:20:54.350469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25dd7295-4e9c-48b2-b82b-65e595ad9960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226803B17C0>]}
[0m15:20:54.350469 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:54.358509 [debug] [MainThread]: On master: BEGIN
[0m15:20:54.358509 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:20:54.374867 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:54.374867 [debug] [MainThread]: On master: COMMIT
[0m15:20:54.374867 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:54.374867 [debug] [MainThread]: On master: COMMIT
[0m15:20:54.374867 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:54.374867 [debug] [MainThread]: On master: Close
[0m15:20:54.374867 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:20:54.374867 [info ] [MainThread]: 
[0m15:20:54.382938 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:20:54.382938 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson ........ [RUN]
[0m15:20:54.382938 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson'
[0m15:20:54.382938 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:20:54.390938 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:20:54.390938 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:20:54.414868 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:20:54.414868 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:20:54.414868 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: BEGIN
[0m15:20:54.414868 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:20:54.430868 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:20:54.430868 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:20:54.430868 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arson__dbt_tmp"
  
    as (
      

WITH arson_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arson"
),

arson_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM arson_source
),

arson_final AS (
    SELECT
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        CASE_STAT,
        AVAIL_MFI,
        MOT_FACTS1,
        MOT_FACTS2,
        MOT_FACTS3,
        GRP_INVOL1,
        GRP_INVOL2,
        GRP_INVOL3,
        ENTRY_METH,
        EXT_FIRE,
        DEVI_CONT,
        DEVI_IGNIT,
        DEVI_FUEL,
        INV_INFO_1,
        INV_INFO_2,
        INV_INFO_3,
        INV_INFO_4,
        INV_INFO_5,
        INV_INFO_6,
        INV_INFO_7,
        INV_INFO_8,
        PROP_OWNER,
        INIT_OB1,
        INIT_OB2,
        INIT_OB3,
        INIT_OB4,
        INIT_OB5,
        INIT_OB6,
        INIT_OB7,
        INIT_OB8,
        LAB_USED1,
        LAB_USED2,
        LAB_USED3,
        LAB_USED4,
        LAB_USED5,
        LAB_USED6
    FROM arson_col_data_type_update
)

SELECT * FROM arson_final
    );
  
  
[0m15:20:54.488538 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arson__dbt_tmp"
  
    as (
      

WITH arson_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arson"
),

arson_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM arson_source
),

arson_final AS (
    SELECT
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        CASE_STAT,
        AVAIL_MFI,
        MOT_FACTS1,
        MOT_FACTS2,
        MOT_FACTS3,
        GRP_INVOL1,
        GRP_INVOL2,
        GRP_INVOL3,
        ENTRY_METH,
        EXT_FIRE,
        DEVI_CONT,
        DEVI_IGNIT,
        DEVI_FUEL,
        INV_INFO_1,
        INV_INFO_2,
        INV_INFO_3,
        INV_INFO_4,
        INV_INFO_5,
        INV_INFO_6,
        INV_INFO_7,
        INV_INFO_8,
        PROP_OWNER,
        INIT_OB1,
        INIT_OB2,
        INIT_OB3,
        INIT_OB4,
        INIT_OB5,
        INIT_OB6,
        INIT_OB7,
        INIT_OB8,
        LAB_USED1,
        LAB_USED2,
        LAB_USED3,
        LAB_USED4,
        LAB_USED5,
        LAB_USED6
    FROM arson_col_data_type_update
)

SELECT * FROM arson_final
    );
  
  
[0m15:20:54.488538 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:20:54.488538 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: ROLLBACK
[0m15:20:54.496568 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__arson'
[0m15:20:54.496568 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: Close
[0m15:20:54.504679 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__arson (models\nfirs_transformed\nfirs_transformed__arson.sql)
  Binder Error: Referenced column "INV_INFO_1" not found in FROM clause!
  Candidate bindings: "arson_col_data_type_update.INV_INFO1", "arson_col_data_type_update.INV_INFO8", "arson_col_data_type_update.INV_INFO7", "arson_col_data_type_update.INV_INFO6", "arson_col_data_type_update.INV_INFO5"
  LINE 45:         INV_INFO_1,
                   ^
[0m15:20:54.504679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25dd7295-4e9c-48b2-b82b-65e595ad9960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226807EB680>]}
[0m15:20:54.504679 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arson  [[31mERROR[0m in 0.12s]
[0m15:20:54.512789 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:20:54.512789 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:54.512789 [debug] [MainThread]: On master: BEGIN
[0m15:20:54.512789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:20:54.528754 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:54.528754 [debug] [MainThread]: On master: COMMIT
[0m15:20:54.528754 [debug] [MainThread]: Using duckdb connection "master"
[0m15:20:54.528754 [debug] [MainThread]: On master: COMMIT
[0m15:20:54.528754 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:20:54.528754 [debug] [MainThread]: On master: Close
[0m15:20:54.536708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:54.536708 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:20:54.536708 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:20:54.536708 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:20:54.536708 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson' was properly closed.
[0m15:20:54.536708 [info ] [MainThread]: 
[0m15:20:54.536708 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m15:20:54.536708 [debug] [MainThread]: Command end result
[0m15:20:54.562243 [info ] [MainThread]: 
[0m15:20:54.562243 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:20:54.562243 [info ] [MainThread]: 
[0m15:20:54.562243 [error] [MainThread]:   Runtime Error in model nfirs_transformed__arson (models\nfirs_transformed\nfirs_transformed__arson.sql)
  Binder Error: Referenced column "INV_INFO_1" not found in FROM clause!
  Candidate bindings: "arson_col_data_type_update.INV_INFO1", "arson_col_data_type_update.INV_INFO8", "arson_col_data_type_update.INV_INFO7", "arson_col_data_type_update.INV_INFO6", "arson_col_data_type_update.INV_INFO5"
  LINE 45:         INV_INFO_1,
                   ^
[0m15:20:54.562243 [info ] [MainThread]: 
[0m15:20:54.562243 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:20:54.562243 [debug] [MainThread]: Command `cli run` failed at 15:20:54.562243 after 0.95 seconds
[0m15:20:54.562243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226FD0DFB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226FE2BB3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226FE881220>]}
[0m15:20:54.562243 [debug] [MainThread]: Flushing usage events
[0m15:21:33.222106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53773B020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B537738B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53773AF00>]}


============================== 15:21:33.222106 | 7e85dac7-521a-4948-9a7d-7513424b8138 ==============================
[0m15:21:33.222106 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:21:33.222106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:33.379792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e85dac7-521a-4948-9a7d-7513424b8138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53921D5B0>]}
[0m15:21:33.415025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e85dac7-521a-4948-9a7d-7513424b8138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B536A742C0>]}
[0m15:21:33.423113 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:21:33.431222 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:21:33.555682 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:33.555682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:33.588593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e85dac7-521a-4948-9a7d-7513424b8138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B53943E210>]}
[0m15:21:33.662340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e85dac7-521a-4948-9a7d-7513424b8138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B539716540>]}
[0m15:21:33.662340 [info ] [MainThread]: Found 3 models, 4 data tests, 19 sources, 524 macros
[0m15:21:33.662340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e85dac7-521a-4948-9a7d-7513424b8138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5394C4E30>]}
[0m15:21:33.662340 [info ] [MainThread]: 
[0m15:21:33.662340 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:21:33.670400 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:21:33.727829 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:21:33.727829 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:21:33.735884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:33.752504 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:33.752504 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:21:33.760578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:21:33.760578 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:21:33.760578 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:21:33.760578 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:21:33.760578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:33.777151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:33.785223 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:21:33.785223 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:21:33.785223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:33.785223 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:21:33.785223 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:21:33.785223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:33.785223 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:21:33.785223 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:21:33.785223 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:21:33.785223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:33.785223 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:21:33.793231 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:21:33.801469 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:21:33.801469 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:21:33.801469 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:21:33.801469 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:21:33.801469 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:21:33.801469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:33.801469 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:33.817543 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:33.817543 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:33.817543 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:21:33.817543 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:21:33.825670 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:21:33.825670 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:21:33.849973 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:33.858077 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:21:33.858077 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:21:33.858077 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:21:33.858077 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:21:33.858077 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:21:33.858077 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:21:33.858077 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:21:33.866051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e85dac7-521a-4948-9a7d-7513424b8138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B536A9F530>]}
[0m15:21:33.866051 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:33.866051 [debug] [MainThread]: On master: BEGIN
[0m15:21:33.866051 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:33.882408 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:33.890443 [debug] [MainThread]: On master: COMMIT
[0m15:21:33.890443 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:33.890443 [debug] [MainThread]: On master: COMMIT
[0m15:21:33.890443 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:33.890443 [debug] [MainThread]: On master: Close
[0m15:21:33.890443 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:21:33.890443 [info ] [MainThread]: 
[0m15:21:33.898664 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:21:33.898664 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson ........ [RUN]
[0m15:21:33.898664 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson'
[0m15:21:33.898664 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:21:33.906792 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:21:33.906792 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:21:33.925639 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:21:33.933681 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:21:33.933681 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: BEGIN
[0m15:21:33.933681 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:21:33.949991 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:33.949991 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:21:33.949991 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arson__dbt_tmp"
  
    as (
      

WITH arson_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arson"
),

arson_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM arson_source
),

arson_final AS (
    SELECT
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        CASE_STAT,
        AVAIL_MFI,
        MOT_FACTS1,
        MOT_FACTS2,
        MOT_FACTS3,
        GRP_INVOL1,
        GRP_INVOL2,
        GRP_INVOL3,
        ENTRY_METH,
        EXT_FIRE,
        DEVI_CONT,
        DEVI_IGNIT,
        DEVI_FUEL,
        INV_INFO1,
        INV_INFO2,
        INV_INFO3,
        INV_INFO4,
        INV_INFO5,
        INV_INFO6,
        INV_INFO7,
        INV_INFO8,
        PROP_OWNER,
        INIT_OB1,
        INIT_OB2,
        INIT_OB3,
        INIT_OB4,
        INIT_OB5,
        INIT_OB6,
        INIT_OB7,
        INIT_OB8,
        LAB_USED1,
        LAB_USED2,
        LAB_USED3,
        LAB_USED4,
        LAB_USED5,
        LAB_USED6
    FROM arson_col_data_type_update
)

SELECT * FROM arson_final
    );
  
  
[0m15:21:34.263202 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:34.263202 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:21:34.271130 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__arson__dbt_tmp" rename to "nfirs_transformed__arson"
[0m15:21:34.271130 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:34.279323 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: COMMIT
[0m15:21:34.279323 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:21:34.279323 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: COMMIT
[0m15:21:35.292189 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m15:21:35.308423 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:21:35.308423 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__arson__dbt_backup" cascade
[0m15:21:35.308423 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:21:35.316378 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: Close
[0m15:21:35.342133 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e85dac7-521a-4948-9a7d-7513424b8138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B539B6DB50>]}
[0m15:21:35.350226 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__arson ... [[32mOK[0m in 1.44s]
[0m15:21:35.350226 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:21:35.353562 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:35.353562 [debug] [MainThread]: On master: BEGIN
[0m15:21:35.353562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:21:35.376183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:35.376183 [debug] [MainThread]: On master: COMMIT
[0m15:21:35.376183 [debug] [MainThread]: Using duckdb connection "master"
[0m15:21:35.376183 [debug] [MainThread]: On master: COMMIT
[0m15:21:35.376183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:21:35.376183 [debug] [MainThread]: On master: Close
[0m15:21:35.384224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:21:35.384224 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:21:35.384224 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:21:35.384224 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:21:35.384224 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson' was properly closed.
[0m15:21:35.384224 [info ] [MainThread]: 
[0m15:21:35.384224 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m15:21:35.384224 [debug] [MainThread]: Command end result
[0m15:21:35.408697 [info ] [MainThread]: 
[0m15:21:35.408697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:21:35.416599 [info ] [MainThread]: 
[0m15:21:35.416599 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:21:35.416599 [debug] [MainThread]: Command `cli run` succeeded at 15:21:35.416599 after 2.30 seconds
[0m15:21:35.416599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5391CCFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5391CCE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B537D63F20>]}
[0m15:21:35.416599 [debug] [MainThread]: Flushing usage events
[0m15:33:51.296017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160DBD75970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160DE2B4EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160DE4A7140>]}


============================== 15:33:51.299048 | d7767ad2-cfbf-4ce4-80bb-312f161bc149 ==============================
[0m15:33:51.299048 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:33:51.300042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:33:51.452040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7767ad2-cfbf-4ce4-80bb-312f161bc149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160E02FFEF0>]}
[0m15:33:51.492282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7767ad2-cfbf-4ce4-80bb-312f161bc149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160E02A1160>]}
[0m15:33:51.493358 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:33:51.503362 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:33:51.623506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:33:51.624427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:33:51.654507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7767ad2-cfbf-4ce4-80bb-312f161bc149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160E0448DA0>]}
[0m15:33:51.730520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7767ad2-cfbf-4ce4-80bb-312f161bc149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160E069A720>]}
[0m15:33:51.730520 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 524 macros
[0m15:33:51.730520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7767ad2-cfbf-4ce4-80bb-312f161bc149', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160DDB40B00>]}
[0m15:33:51.732513 [info ] [MainThread]: 
[0m15:33:51.732513 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:33:51.733535 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:33:51.792111 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:33:51.864258 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:33:51.865262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:51.965776 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:33:51.965776 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m15:33:51.965776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:51.965776 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m15:33:51.965776 [info ] [MainThread]: 
[0m15:33:51.965776 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m15:33:51.973818 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 24416)
[0m15:33:51.973818 [debug] [MainThread]: Command `cli run` failed at 15:33:51.973818 after 0.79 seconds
[0m15:33:51.973818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160DBD75970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160E0694B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160E09FC7A0>]}
[0m15:33:51.973818 [debug] [MainThread]: Flushing usage events
[0m15:34:11.727782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E239918980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23991BE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23991BE30>]}


============================== 15:34:11.727782 | f9b84dc8-1fe3-472d-b242-968a1eb08f9b ==============================
[0m15:34:11.727782 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:34:11.727782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:34:11.887607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9b84dc8-1fe3-472d-b242-968a1eb08f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E239B98080>]}
[0m15:34:11.929238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9b84dc8-1fe3-472d-b242-968a1eb08f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E239A7F290>]}
[0m15:34:11.929238 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:34:11.937571 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:34:12.053302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:34:12.053302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:34:12.087559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9b84dc8-1fe3-472d-b242-968a1eb08f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E239DC0950>]}
[0m15:34:12.162348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9b84dc8-1fe3-472d-b242-968a1eb08f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23A04AF30>]}
[0m15:34:12.162348 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 524 macros
[0m15:34:12.162348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9b84dc8-1fe3-472d-b242-968a1eb08f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2374785C0>]}
[0m15:34:12.162348 [info ] [MainThread]: 
[0m15:34:12.162348 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:34:12.162348 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:34:12.221224 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:34:12.221224 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:34:12.221224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:12.245935 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:34:12.245935 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:34:12.254281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:34:12.254281 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:34:12.254281 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:34:12.254281 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:34:12.254281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:12.271049 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:34:12.279103 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:34:12.279103 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:34:12.279103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:34:12.279103 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:34:12.279103 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:34:12.279103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:34:12.279103 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:34:12.279103 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:34:12.279103 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:34:12.279103 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:34:12.279103 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:34:12.287442 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:34:12.295653 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:34:12.295833 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:34:12.295833 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:34:12.295833 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:34:12.295833 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:34:12.295833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:12.295833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:12.312686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:34:12.312686 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:34:12.312686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:34:12.312686 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:34:12.312686 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:34:12.312686 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:34:12.337246 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:34:12.345640 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:34:12.345640 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:34:12.345640 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:34:12.345640 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:34:12.345640 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:34:12.345640 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:34:12.345640 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:34:12.353919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9b84dc8-1fe3-472d-b242-968a1eb08f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E239F3EA50>]}
[0m15:34:12.353919 [debug] [MainThread]: Using duckdb connection "master"
[0m15:34:12.353919 [debug] [MainThread]: On master: BEGIN
[0m15:34:12.362097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:34:12.370223 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:34:12.378331 [debug] [MainThread]: On master: COMMIT
[0m15:34:12.378459 [debug] [MainThread]: Using duckdb connection "master"
[0m15:34:12.378459 [debug] [MainThread]: On master: COMMIT
[0m15:34:12.378459 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:34:12.378459 [debug] [MainThread]: On master: Close
[0m15:34:12.378459 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:34:12.378459 [info ] [MainThread]: 
[0m15:34:12.387237 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:34:12.387237 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson ........ [RUN]
[0m15:34:12.387237 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson'
[0m15:34:12.387237 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:34:12.395311 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:34:12.395311 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:34:12.420127 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:34:12.420127 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:34:12.420127 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: BEGIN
[0m15:34:12.420127 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:34:12.440021 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:12.440021 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:34:12.440021 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arson__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Arson Table Creation *****/
/***
The below model will transform the 'INC_DATE' column to DATE data type.
***/



WITH arson_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arson"
),

arson_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM arson_source
),

arson_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        CASE_STAT,
        AVAIL_MFI,
        MOT_FACTS1,
        MOT_FACTS2,
        MOT_FACTS3,
        GRP_INVOL1,
        GRP_INVOL2,
        GRP_INVOL3,
        ENTRY_METH,
        EXT_FIRE,
        DEVI_CONT,
        DEVI_IGNIT,
        DEVI_FUEL,
        INV_INFO1,
        INV_INFO2,
        INV_INFO3,
        INV_INFO4,
        INV_INFO5,
        INV_INFO6,
        INV_INFO7,
        INV_INFO8,
        PROP_OWNER,
        INIT_OB1,
        INIT_OB2,
        INIT_OB3,
        INIT_OB4,
        INIT_OB5,
        INIT_OB6,
        INIT_OB7,
        INIT_OB8,
        LAB_USED1,
        LAB_USED2,
        LAB_USED3,
        LAB_USED4,
        LAB_USED5,
        LAB_USED6
    FROM arson_col_data_type_update
)

SELECT * FROM arson_final
    );
  
  
[0m15:34:12.730024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:12.730024 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:34:12.730024 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__arson" rename to "nfirs_transformed__arson__dbt_backup"
[0m15:34:12.730024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:12.738254 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:34:12.738254 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__arson__dbt_tmp" rename to "nfirs_transformed__arson"
[0m15:34:12.738254 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:12.754782 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: COMMIT
[0m15:34:12.754782 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:34:12.754782 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: COMMIT
[0m15:34:14.406195 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m15:34:14.414229 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m15:34:14.414229 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__arson__dbt_backup" cascade
[0m15:34:14.472571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:34:14.472571 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: Close
[0m15:34:14.738995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9b84dc8-1fe3-472d-b242-968a1eb08f9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2372DB830>]}
[0m15:34:14.738995 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__arson ... [[32mOK[0m in 2.35s]
[0m15:34:14.738995 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m15:34:14.746902 [debug] [MainThread]: Using duckdb connection "master"
[0m15:34:14.746902 [debug] [MainThread]: On master: BEGIN
[0m15:34:14.746902 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:34:14.763270 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:34:14.763270 [debug] [MainThread]: On master: COMMIT
[0m15:34:14.763270 [debug] [MainThread]: Using duckdb connection "master"
[0m15:34:14.763270 [debug] [MainThread]: On master: COMMIT
[0m15:34:14.763270 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:34:14.763270 [debug] [MainThread]: On master: Close
[0m15:34:14.771561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:14.771561 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:34:14.771561 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:34:14.771561 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:34:14.771561 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson' was properly closed.
[0m15:34:14.771561 [info ] [MainThread]: 
[0m15:34:14.771561 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m15:34:14.771561 [debug] [MainThread]: Command end result
[0m15:34:14.796047 [info ] [MainThread]: 
[0m15:34:14.796047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:34:14.796047 [info ] [MainThread]: 
[0m15:34:14.796047 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:34:14.796047 [debug] [MainThread]: Command `cli run` succeeded at 15:34:14.796047 after 3.18 seconds
[0m15:34:14.796047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2385D3EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2378CAFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23A013890>]}
[0m15:34:14.796047 [debug] [MainThread]: Flushing usage events
[0m15:53:58.334183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABADAF4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABADAF6D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAF927E00>]}


============================== 15:53:58.334183 | da12340c-7ca0-46c3-add2-5feec24cd0a1 ==============================
[0m15:53:58.334183 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:53:58.342521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:53:58.564010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da12340c-7ca0-46c3-add2-5feec24cd0a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAFB47F80>]}
[0m15:53:58.601878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da12340c-7ca0-46c3-add2-5feec24cd0a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAD4EA1B0>]}
[0m15:53:58.610184 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:53:58.618727 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:53:58.736871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:53:58.736871 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:53:58.773554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da12340c-7ca0-46c3-add2-5feec24cd0a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAFDA1CA0>]}
[0m15:53:58.843593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da12340c-7ca0-46c3-add2-5feec24cd0a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABB003ABA0>]}
[0m15:53:58.843593 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 524 macros
[0m15:53:58.843593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da12340c-7ca0-46c3-add2-5feec24cd0a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAFDB4140>]}
[0m15:53:58.843593 [info ] [MainThread]: 
[0m15:53:58.843593 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:53:58.851837 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:53:58.918315 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:53:58.918315 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:53:58.918315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:58.934839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:53:58.934839 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:53:58.945070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:53:58.945070 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:53:58.953562 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:53:58.953562 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:53:58.953562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:58.970253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:53:58.970253 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:53:58.970253 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:53:58.970253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:53:58.970253 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:53:58.970253 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:53:58.970253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:53:58.970253 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:53:58.970253 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:53:58.970253 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:53:58.970253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:53:58.970253 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:53:58.978685 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:53:58.978685 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:53:58.987168 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:53:58.987168 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:53:58.987168 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:53:58.987168 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:53:58.987168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:58.992704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:59.009069 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:53:59.009069 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:53:59.009069 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:53:59.009069 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:53:59.009069 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:53:59.009069 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:53:59.033795 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:53:59.033795 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:53:59.042018 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:53:59.042018 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:53:59.042018 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:53:59.042018 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:53:59.042018 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:53:59.042018 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:53:59.050543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da12340c-7ca0-46c3-add2-5feec24cd0a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAD3AF860>]}
[0m15:53:59.050543 [debug] [MainThread]: Using duckdb connection "master"
[0m15:53:59.050543 [debug] [MainThread]: On master: BEGIN
[0m15:53:59.050543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:53:59.067391 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:53:59.067391 [debug] [MainThread]: On master: COMMIT
[0m15:53:59.067391 [debug] [MainThread]: Using duckdb connection "master"
[0m15:53:59.067391 [debug] [MainThread]: On master: COMMIT
[0m15:53:59.067391 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:53:59.067391 [debug] [MainThread]: On master: Close
[0m15:53:59.075460 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:53:59.075460 [info ] [MainThread]: 
[0m15:53:59.075460 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal
[0m15:53:59.075460 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arsonagencyreferal  [RUN]
[0m15:53:59.075460 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal'
[0m15:53:59.075460 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal
[0m15:53:59.083774 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"
[0m15:53:59.083774 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal
[0m15:53:59.109077 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"
[0m15:53:59.109077 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"
[0m15:53:59.109077 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal: BEGIN
[0m15:53:59.109077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:53:59.125208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:53:59.125208 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"
[0m15:53:59.125208 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arsonagencyreferal__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Arson Agency Referal Table Creation *****/
/***
The below model will transform the 'INC_DATE' column to DATE data type.
***/



WITH arsonagencyreferal_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arsonagencyreferal"
),

arsonagencyreferal_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
    FROM arsonagencyreferal_source    
),

arsonagencyreferal_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        AGENCY_NAM,
        VERSION,
        AG_ST_NUM,
        AG_ST_PREF,
        AG_ST_STREET,
        AG_ST_TYPE,
        AG_ST_SUFF,
        AG_APT_NO,
        AG_CITY,
        AG_STATE,
        AG_ZIP5,
        AG_ZIP4,
        AG_PHONE,
        AG_CASE_NO,
        AG_ORI,
        AG_FID,
        AG_FDID
    FROM arsonagencyreferal_col_data_type_update
)

SELECT * FROM arsonagencyreferal_final
    );
  
  
[0m15:53:59.133310 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arsonagencyreferal__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Arson Agency Referal Table Creation *****/
/***
The below model will transform the 'INC_DATE' column to DATE data type.
***/



WITH arsonagencyreferal_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arsonagencyreferal"
),

arsonagencyreferal_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
    FROM arsonagencyreferal_source    
),

arsonagencyreferal_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        AGENCY_NAM,
        VERSION,
        AG_ST_NUM,
        AG_ST_PREF,
        AG_ST_STREET,
        AG_ST_TYPE,
        AG_ST_SUFF,
        AG_APT_NO,
        AG_CITY,
        AG_STATE,
        AG_ZIP5,
        AG_ZIP4,
        AG_PHONE,
        AG_CASE_NO,
        AG_ORI,
        AG_FID,
        AG_FDID
    FROM arsonagencyreferal_col_data_type_update
)

SELECT * FROM arsonagencyreferal_final
    );
  
  
[0m15:53:59.133632 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:53:59.133632 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal: ROLLBACK
[0m15:53:59.133632 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal'
[0m15:53:59.133632 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal: Close
[0m15:53:59.141920 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__arsonagencyreferal (models\nfirs_transformed\nfirs_transformed__arsonagencyreferal.sql)
  Binder Error: Referenced column "AG_ST_STREET" not found in FROM clause!
  Candidate bindings: "arsonagencyreferal_col_data_type_update.AG_STREET"
  LINE 41:         AG_ST_STREET,
                   ^
[0m15:53:59.141920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da12340c-7ca0-46c3-add2-5feec24cd0a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAE0476E0>]}
[0m15:53:59.141920 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arsonagencyreferal  [[31mERROR[0m in 0.07s]
[0m15:53:59.141920 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal
[0m15:53:59.150180 [debug] [MainThread]: Using duckdb connection "master"
[0m15:53:59.150180 [debug] [MainThread]: On master: BEGIN
[0m15:53:59.150180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:53:59.166686 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:53:59.166686 [debug] [MainThread]: On master: COMMIT
[0m15:53:59.166686 [debug] [MainThread]: Using duckdb connection "master"
[0m15:53:59.166686 [debug] [MainThread]: On master: COMMIT
[0m15:53:59.166686 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:53:59.166686 [debug] [MainThread]: On master: Close
[0m15:53:59.166686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:59.166686 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:53:59.166686 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:53:59.166686 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:53:59.166686 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal' was properly closed.
[0m15:53:59.174727 [info ] [MainThread]: 
[0m15:53:59.174727 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m15:53:59.174727 [debug] [MainThread]: Command end result
[0m15:53:59.191052 [info ] [MainThread]: 
[0m15:53:59.199302 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:53:59.199302 [info ] [MainThread]: 
[0m15:53:59.199302 [error] [MainThread]:   Runtime Error in model nfirs_transformed__arsonagencyreferal (models\nfirs_transformed\nfirs_transformed__arsonagencyreferal.sql)
  Binder Error: Referenced column "AG_ST_STREET" not found in FROM clause!
  Candidate bindings: "arsonagencyreferal_col_data_type_update.AG_STREET"
  LINE 41:         AG_ST_STREET,
                   ^
[0m15:53:59.199302 [info ] [MainThread]: 
[0m15:53:59.199302 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:53:59.199302 [debug] [MainThread]: Command `cli run` failed at 15:53:59.199302 after 0.98 seconds
[0m15:53:59.199302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAF952E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAF9EC5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABAF9EEA80>]}
[0m15:53:59.199302 [debug] [MainThread]: Flushing usage events
[0m15:54:45.073681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239A06AF950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002399EF67EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239A07E2B70>]}


============================== 15:54:45.073681 | 4784dea8-d0bf-4b9f-86fc-473e3e7a0fd5 ==============================
[0m15:54:45.073681 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:54:45.081740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:54:45.227700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4784dea8-d0bf-4b9f-86fc-473e3e7a0fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239A34A00E0>]}
[0m15:54:45.271177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4784dea8-d0bf-4b9f-86fc-473e3e7a0fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239A339C500>]}
[0m15:54:45.271177 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:54:45.279693 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:54:45.394674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:54:45.394674 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:54:45.429975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4784dea8-d0bf-4b9f-86fc-473e3e7a0fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239A3847F50>]}
[0m15:54:45.504626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4784dea8-d0bf-4b9f-86fc-473e3e7a0fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239A3879AC0>]}
[0m15:54:45.504626 [info ] [MainThread]: Found 4 models, 4 data tests, 19 sources, 524 macros
[0m15:54:45.504626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4784dea8-d0bf-4b9f-86fc-473e3e7a0fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239A318CA10>]}
[0m15:54:45.504626 [info ] [MainThread]: 
[0m15:54:45.504626 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:54:45.504626 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:54:45.562296 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:54:45.562296 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:54:45.562296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:45.587229 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:54:45.587229 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:54:45.595306 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:54:45.595306 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:54:45.595306 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:54:45.595306 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:54:45.595306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:45.613146 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:54:45.621480 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:54:45.621480 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:54:45.621480 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:54:45.621480 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:54:45.621480 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:54:45.621480 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:54:45.621480 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:54:45.621480 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:54:45.621480 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:54:45.621480 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:54:45.621480 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:54:45.629869 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:54:45.638258 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:54:45.638258 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:54:45.638258 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:54:45.638258 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:54:45.638258 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:54:45.638258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:45.638258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:45.654627 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:54:45.654627 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:54:45.654627 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:54:45.654627 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:54:45.654627 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:54:45.654627 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:54:45.688019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:54:45.688019 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:54:45.688019 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:54:45.688019 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:54:45.688019 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:54:45.688019 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:54:45.696401 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:54:45.696401 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:54:45.696401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4784dea8-d0bf-4b9f-86fc-473e3e7a0fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239A3BDC650>]}
[0m15:54:45.696401 [debug] [MainThread]: Using duckdb connection "master"
[0m15:54:45.696401 [debug] [MainThread]: On master: BEGIN
[0m15:54:45.696401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:54:45.712753 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:54:45.712753 [debug] [MainThread]: On master: COMMIT
[0m15:54:45.721028 [debug] [MainThread]: Using duckdb connection "master"
[0m15:54:45.721176 [debug] [MainThread]: On master: COMMIT
[0m15:54:45.721176 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:54:45.721176 [debug] [MainThread]: On master: Close
[0m15:54:45.721176 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:54:45.721176 [info ] [MainThread]: 
[0m15:54:45.729538 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal
[0m15:54:45.729538 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arsonagencyreferal  [RUN]
[0m15:54:45.729538 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal'
[0m15:54:45.729538 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal
[0m15:54:45.729538 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"
[0m15:54:45.737616 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal
[0m15:54:45.754029 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"
[0m15:54:45.762384 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"
[0m15:54:45.762384 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal: BEGIN
[0m15:54:45.762384 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:54:45.778737 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:54:45.778737 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"
[0m15:54:45.778737 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arsonagencyreferal__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Arson Agency Referal Table Creation *****/
/***
The below model will transform the 'INC_DATE' column to DATE data type.
***/



WITH arsonagencyreferal_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arsonagencyreferal"
),

arsonagencyreferal_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
    FROM arsonagencyreferal_source    
),

arsonagencyreferal_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        AGENCY_NAM,
        VERSION,
        AG_ST_NUM,
        AG_ST_PREF,
        AG_STREET,
        AG_ST_TYPE,
        AG_ST_SUFF,
        AG_APT_NO,
        AG_CITY,
        AG_STATE,
        AG_ZIP5,
        AG_ZIP4,
        AG_PHONE,
        AG_CASE_NO,
        AG_ORI,
        AG_FID,
        AG_FDID
    FROM arsonagencyreferal_col_data_type_update
)

SELECT * FROM arsonagencyreferal_final
    );
  
  
[0m15:54:45.897466 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:54:45.905834 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"
[0m15:54:45.905834 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__arsonagencyreferal__dbt_tmp" rename to "nfirs_transformed__arsonagencyreferal"
[0m15:54:45.905834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:54:45.920690 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal: COMMIT
[0m15:54:45.920690 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"
[0m15:54:45.920690 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal: COMMIT
[0m15:54:46.630412 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m15:54:46.638715 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"
[0m15:54:46.638715 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__arsonagencyreferal__dbt_backup" cascade
[0m15:54:46.646952 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:54:46.646952 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal: Close
[0m15:54:47.686675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4784dea8-d0bf-4b9f-86fc-473e3e7a0fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239A185B590>]}
[0m15:54:47.686675 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__arsonagencyreferal  [[32mOK[0m in 1.96s]
[0m15:54:47.686675 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal
[0m15:54:47.686675 [debug] [MainThread]: Using duckdb connection "master"
[0m15:54:47.686675 [debug] [MainThread]: On master: BEGIN
[0m15:54:47.694710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:54:47.711524 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:54:47.711524 [debug] [MainThread]: On master: COMMIT
[0m15:54:47.711524 [debug] [MainThread]: Using duckdb connection "master"
[0m15:54:47.711524 [debug] [MainThread]: On master: COMMIT
[0m15:54:47.711524 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:54:47.719560 [debug] [MainThread]: On master: Close
[0m15:54:47.719560 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:47.719560 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:54:47.719560 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:54:47.719560 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:54:47.719560 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arsonagencyreferal' was properly closed.
[0m15:54:47.719560 [info ] [MainThread]: 
[0m15:54:47.727843 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m15:54:47.727843 [debug] [MainThread]: Command end result
[0m15:54:47.751882 [info ] [MainThread]: 
[0m15:54:47.751882 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:54:47.751882 [info ] [MainThread]: 
[0m15:54:47.751882 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:54:47.751882 [debug] [MainThread]: Command `cli run` succeeded at 15:54:47.751882 after 2.80 seconds
[0m15:54:47.751882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239A1300200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239A318CB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239A318FF20>]}
[0m15:54:47.751882 [debug] [MainThread]: Flushing usage events
[0m16:06:06.334477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136CD993020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136CE0318E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136CDFD3EC0>]}


============================== 16:06:06.334477 | 6dc3f8cd-6423-480a-b3a0-7588b34588ef ==============================
[0m16:06:06.334477 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:06:06.342732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:06:06.502442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dc3f8cd-6423-480a-b3a0-7588b34588ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136CF4A4290>]}
[0m16:06:06.543476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dc3f8cd-6423-480a-b3a0-7588b34588ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136CF48D550>]}
[0m16:06:06.543476 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:06:06.551592 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:06:06.676894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:06.676894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:06.705101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dc3f8cd-6423-480a-b3a0-7588b34588ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136CF778590>]}
[0m16:06:06.779784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dc3f8cd-6423-480a-b3a0-7588b34588ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136CF6AF320>]}
[0m16:06:06.779784 [info ] [MainThread]: Found 5 models, 4 data tests, 19 sources, 524 macros
[0m16:06:06.779784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dc3f8cd-6423-480a-b3a0-7588b34588ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136CF7782F0>]}
[0m16:06:06.779784 [info ] [MainThread]: 
[0m16:06:06.787785 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:06:06.788043 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:06:06.852637 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:06:06.852637 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:06:06.852637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:06.869525 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:06.869525 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:06:06.878256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:06:06.878256 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:06:06.878256 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:06:06.886262 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:06:06.886520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:06.903425 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:06.903425 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:06:06.903425 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:06:06.903425 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:06.903425 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:06:06.903425 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:06:06.903425 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:06.903425 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:06:06.903425 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:06:06.903425 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:06:06.903425 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:06.903425 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:06:06.911678 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:06:06.919995 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:06:06.919995 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:06:06.919995 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:06:06.919995 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:06:06.919995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:06.919995 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:06:06.936518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:06.936518 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:06.936518 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:06.936518 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:06:06.936518 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:06:06.944520 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:06:06.944520 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:06:06.972205 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:06.975592 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:06.976717 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:06:06.977728 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:06:06.978856 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:06:06.979868 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:06:06.979868 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:06:06.979868 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:06:06.983360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dc3f8cd-6423-480a-b3a0-7588b34588ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136CCD0F980>]}
[0m16:06:06.983360 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:06.983360 [debug] [MainThread]: On master: BEGIN
[0m16:06:06.983360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:07.003491 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:06:07.003491 [debug] [MainThread]: On master: COMMIT
[0m16:06:07.003491 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:07.003491 [debug] [MainThread]: On master: COMMIT
[0m16:06:07.003491 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:06:07.003491 [debug] [MainThread]: On master: Close
[0m16:06:07.011492 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:06:07.011737 [info ] [MainThread]: 
[0m16:06:07.011737 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub
[0m16:06:07.011737 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arsonjuvsub .. [RUN]
[0m16:06:07.011737 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub'
[0m16:06:07.011737 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub
[0m16:06:07.019746 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:06:07.019746 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub
[0m16:06:07.044290 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:06:07.044290 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:06:07.052284 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: BEGIN
[0m16:06:07.052541 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:06:07.069069 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:06:07.069069 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:06:07.069069 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arsonjuvsub__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Arson Juvenile Subject Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - AGE --> INTEGER
***/



WITH arsonjuvsub_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arsonjuvsub"
)

arsonjuvsub_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE
    FROM arsonjuvsub_source
),

arsonjuvsub_final AS (
    SELECT
        INCIDENT_KEY,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SUB_SEQ_NO,
        VERSION,
        AGE,
        GENDER,
        RACE,
        ETHNICITY,
        FAM_TYPE,
        RISK_FACT1,
        RISK_FACT2,
        RISK_FACT3,
        RISK_FACT3,
        RISK_FACT4,
        RISK_FACT5,
        RISK_FACT6,
        RISK_FACT7,
        RISK_FACT8,
        JUV_DISPO
    FROM arsonjuvsub_col_data_type_update
)

SELECT * FROM arsonjuvsub_final
    );
  
  
[0m16:06:07.187219 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arsonjuvsub__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Arson Juvenile Subject Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - AGE --> INTEGER
***/



WITH arsonjuvsub_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arsonjuvsub"
)

arsonjuvsub_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE
    FROM arsonjuvsub_source
),

arsonjuvsub_final AS (
    SELECT
        INCIDENT_KEY,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SUB_SEQ_NO,
        VERSION,
        AGE,
        GENDER,
        RACE,
        ETHNICITY,
        FAM_TYPE,
        RISK_FACT1,
        RISK_FACT2,
        RISK_FACT3,
        RISK_FACT3,
        RISK_FACT4,
        RISK_FACT5,
        RISK_FACT6,
        RISK_FACT7,
        RISK_FACT8,
        JUV_DISPO
    FROM arsonjuvsub_col_data_type_update
)

SELECT * FROM arsonjuvsub_final
    );
  
  
[0m16:06:07.187219 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:06:07.187219 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: ROLLBACK
[0m16:06:07.195256 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub'
[0m16:06:07.195256 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: Close
[0m16:06:07.203485 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__arsonjuvsub (models\nfirs_transformed\nfirs_transformed__arsonjuvsub.sql)
  Parser Error: syntax error at or near "arsonjuvsub_col_data_type_update"
[0m16:06:07.203485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dc3f8cd-6423-480a-b3a0-7588b34588ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136CFDEE6F0>]}
[0m16:06:07.211738 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__arsonjuvsub  [[31mERROR[0m in 0.19s]
[0m16:06:07.211738 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub
[0m16:06:07.211738 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:07.211738 [debug] [MainThread]: On master: BEGIN
[0m16:06:07.211738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:07.236181 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:06:07.236181 [debug] [MainThread]: On master: COMMIT
[0m16:06:07.236181 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:07.236181 [debug] [MainThread]: On master: COMMIT
[0m16:06:07.236181 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:06:07.236181 [debug] [MainThread]: On master: Close
[0m16:06:07.244209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:07.244209 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:06:07.244209 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:06:07.244209 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:06:07.244209 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub' was properly closed.
[0m16:06:07.244209 [info ] [MainThread]: 
[0m16:06:07.244209 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m16:06:07.244209 [debug] [MainThread]: Command end result
[0m16:06:07.268963 [info ] [MainThread]: 
[0m16:06:07.268963 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:06:07.268963 [info ] [MainThread]: 
[0m16:06:07.268963 [error] [MainThread]:   Runtime Error in model nfirs_transformed__arsonjuvsub (models\nfirs_transformed\nfirs_transformed__arsonjuvsub.sql)
  Parser Error: syntax error at or near "arsonjuvsub_col_data_type_update"
[0m16:06:07.268963 [info ] [MainThread]: 
[0m16:06:07.268963 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:06:07.268963 [debug] [MainThread]: Command `cli run` failed at 16:06:07.268963 after 1.11 seconds
[0m16:06:07.268963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136CF43CB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136CF43CB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000136CAC74830>]}
[0m16:06:07.268963 [debug] [MainThread]: Flushing usage events
[0m16:06:30.764402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F5BCB290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F5BC8C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F68C3080>]}


============================== 16:06:30.767974 | 66e9512f-fb9a-4355-9433-f8307cf9d678 ==============================
[0m16:06:30.767974 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:06:30.767974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:06:30.916024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66e9512f-fb9a-4355-9433-f8307cf9d678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F62FEAB0>]}
[0m16:06:30.962307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66e9512f-fb9a-4355-9433-f8307cf9d678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F61A7890>]}
[0m16:06:30.962307 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:06:30.979063 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:06:31.099349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:06:31.099349 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:06:31.132603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66e9512f-fb9a-4355-9433-f8307cf9d678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F840F320>]}
[0m16:06:31.201484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66e9512f-fb9a-4355-9433-f8307cf9d678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F5D0D640>]}
[0m16:06:31.201484 [info ] [MainThread]: Found 5 models, 4 data tests, 19 sources, 524 macros
[0m16:06:31.209673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66e9512f-fb9a-4355-9433-f8307cf9d678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F81B6A80>]}
[0m16:06:31.209673 [info ] [MainThread]: 
[0m16:06:31.209673 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:06:31.209673 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:06:31.271267 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:06:31.271267 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:06:31.274703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:31.291353 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:31.291353 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:06:31.299575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:06:31.299575 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:06:31.299575 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:06:31.307640 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:06:31.307917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:06:31.324189 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:31.324189 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:06:31.324189 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:06:31.324189 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:31.324189 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:06:31.324189 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:06:31.324189 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:31.324189 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:06:31.324189 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:06:31.324189 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:06:31.324189 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:31.324189 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:06:31.332402 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:06:31.340803 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:06:31.340803 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:06:31.340803 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:06:31.340803 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:06:31.340803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:31.340803 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:06:31.357371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:06:31.363420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:31.363420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:31.363420 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:06:31.363420 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:06:31.363420 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:06:31.363420 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:06:31.387925 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:31.396246 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:06:31.396246 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:06:31.396246 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:06:31.396246 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:06:31.396246 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:06:31.404283 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:06:31.404283 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:06:31.404283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66e9512f-fb9a-4355-9433-f8307cf9d678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8C7E720>]}
[0m16:06:31.404283 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:31.404283 [debug] [MainThread]: On master: BEGIN
[0m16:06:31.412416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:06:31.420716 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:06:31.420716 [debug] [MainThread]: On master: COMMIT
[0m16:06:31.428959 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:31.428959 [debug] [MainThread]: On master: COMMIT
[0m16:06:31.428959 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:06:31.428959 [debug] [MainThread]: On master: Close
[0m16:06:31.428959 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:06:31.428959 [info ] [MainThread]: 
[0m16:06:31.437347 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub
[0m16:06:31.437347 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arsonjuvsub .. [RUN]
[0m16:06:31.437347 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub'
[0m16:06:31.437347 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub
[0m16:06:31.445423 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:06:31.445423 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub
[0m16:06:31.463792 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:06:31.471836 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:06:31.471836 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: BEGIN
[0m16:06:31.471836 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:06:31.488118 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:06:31.488118 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:06:31.488118 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arsonjuvsub__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Arson Juvenile Subject Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - AGE --> INTEGER
***/



WITH arsonjuvsub_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arsonjuvsub"
),

arsonjuvsub_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE
    FROM arsonjuvsub_source
),

arsonjuvsub_final AS (
    SELECT
        INCIDENT_KEY,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SUB_SEQ_NO,
        VERSION,
        AGE,
        GENDER,
        RACE,
        ETHNICITY,
        FAM_TYPE,
        RISK_FACT1,
        RISK_FACT2,
        RISK_FACT3,
        RISK_FACT3,
        RISK_FACT4,
        RISK_FACT5,
        RISK_FACT6,
        RISK_FACT7,
        RISK_FACT8,
        JUV_DISPO
    FROM arsonjuvsub_col_data_type_update
)

SELECT * FROM arsonjuvsub_final
    );
  
  
[0m16:06:31.496235 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:06:31.496402 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:06:31.496402 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__arsonjuvsub__dbt_tmp" rename to "nfirs_transformed__arsonjuvsub"
[0m16:06:31.496402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:06:31.512894 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: COMMIT
[0m16:06:31.512894 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:06:31.512894 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: COMMIT
[0m16:06:31.580963 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:06:31.597872 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:06:31.597872 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__arsonjuvsub__dbt_backup" cascade
[0m16:06:31.597872 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:06:31.597872 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: Close
[0m16:06:32.255107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66e9512f-fb9a-4355-9433-f8307cf9d678', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F68C3830>]}
[0m16:06:32.255107 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__arsonjuvsub  [[32mOK[0m in 0.81s]
[0m16:06:32.255107 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub
[0m16:06:32.255107 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:32.255107 [debug] [MainThread]: On master: BEGIN
[0m16:06:32.255107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:06:32.271365 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:06:32.279684 [debug] [MainThread]: On master: COMMIT
[0m16:06:32.279684 [debug] [MainThread]: Using duckdb connection "master"
[0m16:06:32.279684 [debug] [MainThread]: On master: COMMIT
[0m16:06:32.279684 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:06:32.279684 [debug] [MainThread]: On master: Close
[0m16:06:32.279684 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:06:32.279684 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:06:32.279684 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:06:32.279684 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:06:32.279684 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub' was properly closed.
[0m16:06:32.287774 [info ] [MainThread]: 
[0m16:06:32.287774 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m16:06:32.287774 [debug] [MainThread]: Command end result
[0m16:06:32.311763 [info ] [MainThread]: 
[0m16:06:32.312157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:06:32.312157 [info ] [MainThread]: 
[0m16:06:32.312157 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:06:32.314210 [debug] [MainThread]: Command `cli run` succeeded at 16:06:32.314210 after 1.66 seconds
[0m16:06:32.314210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F848B3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F836C650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F836CD40>]}
[0m16:06:32.314210 [debug] [MainThread]: Flushing usage events
[0m16:07:17.463814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCDE4CB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCDE4C7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCDE4D010>]}


============================== 16:07:17.468154 | 76bb7191-2d0c-46c8-aeb9-9d4cddf2ea31 ==============================
[0m16:07:17.468154 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:07:17.468154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:07:17.622719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76bb7191-2d0c-46c8-aeb9-9d4cddf2ea31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCDEF3080>]}
[0m16:07:17.664186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76bb7191-2d0c-46c8-aeb9-9d4cddf2ea31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCBA6E660>]}
[0m16:07:17.664186 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:07:17.672783 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:07:17.797918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:07:17.798909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:07:17.829241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76bb7191-2d0c-46c8-aeb9-9d4cddf2ea31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCE0AF9E0>]}
[0m16:07:17.905202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76bb7191-2d0c-46c8-aeb9-9d4cddf2ea31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCE1AF650>]}
[0m16:07:17.905202 [info ] [MainThread]: Found 5 models, 4 data tests, 19 sources, 524 macros
[0m16:07:17.906239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76bb7191-2d0c-46c8-aeb9-9d4cddf2ea31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCE0AC950>]}
[0m16:07:17.907208 [info ] [MainThread]: 
[0m16:07:17.908236 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:07:17.909193 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:07:17.969209 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:07:17.969209 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:07:17.970197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:18.077854 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:07:18.078855 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:07:18.079855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:18.079855 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m16:07:18.079855 [info ] [MainThread]: 
[0m16:07:18.080855 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m16:07:18.080855 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 25408)
[0m16:07:18.081855 [debug] [MainThread]: Command `cli run` failed at 16:07:18.081855 after 0.75 seconds
[0m16:07:18.081855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCDE4C9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCE5724E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DCE346C30>]}
[0m16:07:18.082855 [debug] [MainThread]: Flushing usage events
[0m16:07:25.089321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E9468B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E9468AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E9468BC0>]}


============================== 16:07:25.097596 | 090e93e1-b20e-4cb0-8acb-53a8f5c84618 ==============================
[0m16:07:25.097596 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:07:25.097596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:07:25.248114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '090e93e1-b20e-4cb0-8acb-53a8f5c84618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E9780620>]}
[0m16:07:25.290252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '090e93e1-b20e-4cb0-8acb-53a8f5c84618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E6E9B6B0>]}
[0m16:07:25.290252 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:07:25.298483 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:07:25.425327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:07:25.425327 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:07:25.458126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '090e93e1-b20e-4cb0-8acb-53a8f5c84618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E983EF30>]}
[0m16:07:25.533978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '090e93e1-b20e-4cb0-8acb-53a8f5c84618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E99C7530>]}
[0m16:07:25.533978 [info ] [MainThread]: Found 5 models, 4 data tests, 19 sources, 524 macros
[0m16:07:25.533978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '090e93e1-b20e-4cb0-8acb-53a8f5c84618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E983F980>]}
[0m16:07:25.533978 [info ] [MainThread]: 
[0m16:07:25.533978 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:07:25.542266 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:07:25.599194 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:07:25.599194 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:07:25.599194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:25.615912 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:07:25.615912 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:07:25.623194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:07:25.623194 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:07:25.636586 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:07:25.636586 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:07:25.637711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:25.655204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:07:25.656508 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:07:25.656508 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:07:25.657551 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:07:25.657551 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:07:25.658131 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:07:25.658689 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:07:25.658757 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:07:25.658757 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:07:25.659875 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:07:25.659875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:07:25.659875 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:07:25.669275 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:07:25.673996 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:07:25.673996 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:07:25.673996 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:07:25.673996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:25.673996 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:07:25.690573 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:07:25.690573 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:07:25.698779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:25.698779 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:07:25.698779 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:07:25.698779 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:07:25.698779 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:07:25.706900 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:07:25.731435 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:07:25.731435 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:07:25.731435 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:07:25.731435 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:07:25.739636 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:07:25.739636 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:07:25.739636 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:07:25.739636 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:07:25.747672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '090e93e1-b20e-4cb0-8acb-53a8f5c84618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E95C95B0>]}
[0m16:07:25.747672 [debug] [MainThread]: Using duckdb connection "master"
[0m16:07:25.747672 [debug] [MainThread]: On master: BEGIN
[0m16:07:25.747672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:25.758091 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:07:25.758091 [debug] [MainThread]: On master: COMMIT
[0m16:07:25.766311 [debug] [MainThread]: Using duckdb connection "master"
[0m16:07:25.766454 [debug] [MainThread]: On master: COMMIT
[0m16:07:25.766454 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:07:25.766454 [debug] [MainThread]: On master: Close
[0m16:07:25.766454 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:07:25.766454 [info ] [MainThread]: 
[0m16:07:25.774560 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub
[0m16:07:25.774560 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arsonjuvsub .. [RUN]
[0m16:07:25.774560 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub'
[0m16:07:25.774560 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub
[0m16:07:25.782488 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:07:25.782488 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub
[0m16:07:25.806944 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:07:25.806944 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:07:25.806944 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: BEGIN
[0m16:07:25.806944 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:07:25.823013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:07:25.839604 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:07:25.839604 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arsonjuvsub__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Arson Juvenile Subject Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - AGE --> INTEGER
***/



WITH arsonjuvsub_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arsonjuvsub"
),

arsonjuvsub_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE
    FROM arsonjuvsub_source
),

arsonjuvsub_final AS (
    SELECT
        INCIDENT_KEY,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SUB_SEQ_NO,
        VERSION,
        AGE_UPDATE AS AGE,
        GENDER,
        RACE,
        ETHNICITY,
        FAM_TYPE,
        RISK_FACT1,
        RISK_FACT2,
        RISK_FACT3,
        RISK_FACT3,
        RISK_FACT4,
        RISK_FACT5,
        RISK_FACT6,
        RISK_FACT7,
        RISK_FACT8,
        JUV_DISPO
    FROM arsonjuvsub_col_data_type_update
)

SELECT * FROM arsonjuvsub_final
    );
  
  
[0m16:07:25.866875 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:07:25.866875 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:07:25.866875 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__arsonjuvsub" rename to "nfirs_transformed__arsonjuvsub__dbt_backup"
[0m16:07:25.866875 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:07:25.875253 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:07:25.875253 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__arsonjuvsub__dbt_tmp" rename to "nfirs_transformed__arsonjuvsub"
[0m16:07:25.875253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:07:25.891635 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: COMMIT
[0m16:07:25.891635 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:07:25.891635 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: COMMIT
[0m16:07:25.908412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:07:25.908412 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"
[0m16:07:25.908412 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__arsonjuvsub__dbt_backup" cascade
[0m16:07:25.924998 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:07:25.924998 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub: Close
[0m16:07:26.547196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '090e93e1-b20e-4cb0-8acb-53a8f5c84618', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E6E3B860>]}
[0m16:07:26.547196 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__arsonjuvsub  [[32mOK[0m in 0.77s]
[0m16:07:26.547196 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub
[0m16:07:26.555365 [debug] [MainThread]: Using duckdb connection "master"
[0m16:07:26.555365 [debug] [MainThread]: On master: BEGIN
[0m16:07:26.555365 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:07:26.568108 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:07:26.568108 [debug] [MainThread]: On master: COMMIT
[0m16:07:26.568108 [debug] [MainThread]: Using duckdb connection "master"
[0m16:07:26.576144 [debug] [MainThread]: On master: COMMIT
[0m16:07:26.576321 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:07:26.576321 [debug] [MainThread]: On master: Close
[0m16:07:26.576321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:26.576321 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:07:26.576321 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:07:26.576321 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:07:26.576321 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arsonjuvsub' was properly closed.
[0m16:07:26.584368 [info ] [MainThread]: 
[0m16:07:26.584368 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m16:07:26.584368 [debug] [MainThread]: Command end result
[0m16:07:26.600936 [info ] [MainThread]: 
[0m16:07:26.608966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:26.609130 [info ] [MainThread]: 
[0m16:07:26.609130 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:07:26.609130 [debug] [MainThread]: Command `cli run` succeeded at 16:07:26.609130 after 1.63 seconds
[0m16:07:26.609130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E7B65B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E7B659D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9E99FFB00>]}
[0m16:07:26.609130 [debug] [MainThread]: Flushing usage events
[0m16:33:24.011482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016014BC2FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160160928D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160160924B0>]}


============================== 16:33:24.020788 | fb353b5f-ee6e-4252-9479-89a200bfc10c ==============================
[0m16:33:24.020788 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:33:24.021895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:33:24.182333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb353b5f-ee6e-4252-9479-89a200bfc10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160161896D0>]}
[0m16:33:24.222275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb353b5f-ee6e-4252-9479-89a200bfc10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160160B1B50>]}
[0m16:33:24.222275 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:33:24.232346 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:33:24.350590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:24.350590 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:24.380575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb353b5f-ee6e-4252-9479-89a200bfc10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160162FF560>]}
[0m16:33:24.458759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb353b5f-ee6e-4252-9479-89a200bfc10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160165627B0>]}
[0m16:33:24.458759 [info ] [MainThread]: Found 6 models, 4 data tests, 19 sources, 524 macros
[0m16:33:24.458759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb353b5f-ee6e-4252-9479-89a200bfc10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160145C2F30>]}
[0m16:33:24.466760 [info ] [MainThread]: 
[0m16:33:24.467805 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:33:24.467805 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:33:24.531994 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:33:24.531994 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:33:24.531994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:24.550566 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:24.550566 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:33:24.561539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:33:24.561539 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:33:24.561539 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:33:24.561539 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:33:24.569711 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:24.580274 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:24.588282 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:33:24.588282 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:33:24.588282 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:24.589350 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:33:24.589350 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:33:24.589350 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:24.590357 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:33:24.590357 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:33:24.591403 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:33:24.591403 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:24.591403 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:33:24.599377 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:33:24.599377 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:33:24.599377 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:33:24.599377 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:33:24.607378 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:33:24.607378 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:33:24.608406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:24.608406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:24.626591 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:24.626591 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:24.627559 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:33:24.627559 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:33:24.627559 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:33:24.627559 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:33:24.650333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:24.658333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:24.661594 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:33:24.662617 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:33:24.662617 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:33:24.662617 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:33:24.662617 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:33:24.662617 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:33:24.670341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb353b5f-ee6e-4252-9479-89a200bfc10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016016189E20>]}
[0m16:33:24.670341 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:24.670341 [debug] [MainThread]: On master: BEGIN
[0m16:33:24.670341 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:24.687768 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:33:24.687768 [debug] [MainThread]: On master: COMMIT
[0m16:33:24.687768 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:24.687768 [debug] [MainThread]: On master: COMMIT
[0m16:33:24.691216 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:33:24.691216 [debug] [MainThread]: On master: Close
[0m16:33:24.692071 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:33:24.692071 [info ] [MainThread]: 
[0m16:33:24.699469 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__basicaid
[0m16:33:24.699469 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__basicaid ..... [RUN]
[0m16:33:24.699469 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicaid'
[0m16:33:24.699469 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__basicaid
[0m16:33:24.707623 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:24.710558 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__basicaid
[0m16:33:24.731803 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:24.731803 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:24.731803 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: BEGIN
[0m16:33:24.738313 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:33:24.749892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:33:24.749892 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:24.749892 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Aid Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicaid"
),

basicaid_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM basicaid_source
),

SELECT basicaid_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        NFIR_VER,
        FDIDRECAID,
        FDIDSTREC,
        INC_NOFDID
    FROM basicaid_col_data_type_update
),

SELECT * FROM basicaid_final
    );
  
  
[0m16:33:24.749892 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Aid Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicaid"
),

basicaid_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM basicaid_source
),

SELECT basicaid_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        NFIR_VER,
        FDIDRECAID,
        FDIDSTREC,
        INC_NOFDID
    FROM basicaid_col_data_type_update
),

SELECT * FROM basicaid_final
    );
  
  
[0m16:33:24.749892 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:33:24.749892 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: ROLLBACK
[0m16:33:24.761841 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__basicaid'
[0m16:33:24.761841 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: Close
[0m16:33:24.761841 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__basicaid (models\nfirs_transformed\nfirs_transformed__basicaid.sql)
  Parser Error: syntax error at or near "SELECT"
[0m16:33:24.769838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb353b5f-ee6e-4252-9479-89a200bfc10c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160145C3830>]}
[0m16:33:24.769838 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__basicaid  [[31mERROR[0m in 0.06s]
[0m16:33:24.769838 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__basicaid
[0m16:33:24.769838 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:24.769838 [debug] [MainThread]: On master: BEGIN
[0m16:33:24.769838 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:33:24.790625 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:33:24.790625 [debug] [MainThread]: On master: COMMIT
[0m16:33:24.790625 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:24.791617 [debug] [MainThread]: On master: COMMIT
[0m16:33:24.791617 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:33:24.791617 [debug] [MainThread]: On master: Close
[0m16:33:24.791617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:24.791617 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:33:24.791617 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:33:24.791617 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:33:24.791617 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicaid' was properly closed.
[0m16:33:24.791617 [info ] [MainThread]: 
[0m16:33:24.791617 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m16:33:24.799722 [debug] [MainThread]: Command end result
[0m16:33:24.818160 [info ] [MainThread]: 
[0m16:33:24.824283 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:33:24.824283 [info ] [MainThread]: 
[0m16:33:24.825453 [error] [MainThread]:   Runtime Error in model nfirs_transformed__basicaid (models\nfirs_transformed\nfirs_transformed__basicaid.sql)
  Parser Error: syntax error at or near "SELECT"
[0m16:33:24.825453 [info ] [MainThread]: 
[0m16:33:24.825453 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:33:24.825453 [debug] [MainThread]: Command `cli run` failed at 16:33:24.825453 after 0.94 seconds
[0m16:33:24.825453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016015EE0C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016014B46120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001601406DDC0>]}
[0m16:33:24.825453 [debug] [MainThread]: Flushing usage events
[0m16:33:37.808132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C5452BFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C544D7D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C5452B350>]}


============================== 16:33:37.811797 | 7e4aa722-8b63-4583-b99d-30a16a2e7817 ==============================
[0m16:33:37.811797 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:33:37.811797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:33:37.971455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e4aa722-8b63-4583-b99d-30a16a2e7817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C546B3B30>]}
[0m16:33:38.027972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e4aa722-8b63-4583-b99d-30a16a2e7817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C51F88A70>]}
[0m16:33:38.031127 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:33:38.041461 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:33:38.159365 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:38.159365 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:38.196978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e4aa722-8b63-4583-b99d-30a16a2e7817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C547541D0>]}
[0m16:33:38.279167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e4aa722-8b63-4583-b99d-30a16a2e7817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C54AE1550>]}
[0m16:33:38.279167 [info ] [MainThread]: Found 6 models, 4 data tests, 19 sources, 524 macros
[0m16:33:38.279167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e4aa722-8b63-4583-b99d-30a16a2e7817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C54784320>]}
[0m16:33:38.287090 [info ] [MainThread]: 
[0m16:33:38.287090 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:33:38.287090 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:33:38.340775 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:33:38.340775 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:33:38.340775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:38.361845 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:38.361845 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:33:38.370735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:33:38.370735 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:33:38.378970 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:33:38.378970 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:33:38.378970 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:38.391692 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:38.398862 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:33:38.398862 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:33:38.398862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:38.398862 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:33:38.398862 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:33:38.398862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:38.398862 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:33:38.398862 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:33:38.398862 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:33:38.398862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:38.398862 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:33:38.411831 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:33:38.411831 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:33:38.411831 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:33:38.411831 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:33:38.411831 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:33:38.419827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:38.419827 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:33:38.438239 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:38.438239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:38.438239 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:33:38.438239 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:38.440314 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:33:38.440314 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:33:38.440314 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:33:38.461935 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:38.470727 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:38.471878 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:33:38.471878 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:33:38.471878 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:33:38.471878 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:33:38.471878 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:33:38.471878 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:33:38.479996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e4aa722-8b63-4583-b99d-30a16a2e7817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C51F8BA40>]}
[0m16:33:38.479996 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:38.479996 [debug] [MainThread]: On master: BEGIN
[0m16:33:38.479996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:38.491865 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:33:38.500648 [debug] [MainThread]: On master: COMMIT
[0m16:33:38.500648 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:38.500648 [debug] [MainThread]: On master: COMMIT
[0m16:33:38.500648 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:33:38.500648 [debug] [MainThread]: On master: Close
[0m16:33:38.500648 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:33:38.500648 [info ] [MainThread]: 
[0m16:33:38.508860 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__basicaid
[0m16:33:38.508860 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__basicaid ..... [RUN]
[0m16:33:38.508860 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicaid'
[0m16:33:38.508860 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__basicaid
[0m16:33:38.518139 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:38.518139 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__basicaid
[0m16:33:38.543537 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:38.543537 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:38.543537 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: BEGIN
[0m16:33:38.543537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:33:38.560580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:33:38.560580 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:38.560580 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Aid Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicaid"
),

basicaid_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM basicaid_source
),

basicaid_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        NFIR_VER,
        FDIDRECAID,
        FDIDSTREC,
        INC_NOFDID
    FROM basicaid_col_data_type_update
),

SELECT * FROM basicaid_final
    );
  
  
[0m16:33:38.560580 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Aid Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicaid"
),

basicaid_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM basicaid_source
),

basicaid_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        NFIR_VER,
        FDIDRECAID,
        FDIDSTREC,
        INC_NOFDID
    FROM basicaid_col_data_type_update
),

SELECT * FROM basicaid_final
    );
  
  
[0m16:33:38.560580 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m16:33:38.560580 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: ROLLBACK
[0m16:33:38.568782 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__basicaid'
[0m16:33:38.568782 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: Close
[0m16:33:38.576777 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__basicaid (models\nfirs_transformed\nfirs_transformed__basicaid.sql)
  Parser Error: syntax error at or near "SELECT"
[0m16:33:38.578013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e4aa722-8b63-4583-b99d-30a16a2e7817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C54B73770>]}
[0m16:33:38.578013 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__basicaid  [[31mERROR[0m in 0.07s]
[0m16:33:38.578013 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__basicaid
[0m16:33:38.581413 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:38.581413 [debug] [MainThread]: On master: BEGIN
[0m16:33:38.581413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:33:38.597774 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:33:38.597774 [debug] [MainThread]: On master: COMMIT
[0m16:33:38.597774 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:38.600316 [debug] [MainThread]: On master: COMMIT
[0m16:33:38.600316 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:33:38.600316 [debug] [MainThread]: On master: Close
[0m16:33:38.600316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:38.600316 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:33:38.600316 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:33:38.600316 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:33:38.600316 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicaid' was properly closed.
[0m16:33:38.600316 [info ] [MainThread]: 
[0m16:33:38.600316 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m16:33:38.600316 [debug] [MainThread]: Command end result
[0m16:33:38.630383 [info ] [MainThread]: 
[0m16:33:38.630383 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:33:38.630383 [info ] [MainThread]: 
[0m16:33:38.630383 [error] [MainThread]:   Runtime Error in model nfirs_transformed__basicaid (models\nfirs_transformed\nfirs_transformed__basicaid.sql)
  Parser Error: syntax error at or near "SELECT"
[0m16:33:38.633902 [info ] [MainThread]: 
[0m16:33:38.633902 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:33:38.634402 [debug] [MainThread]: Command `cli run` failed at 16:33:38.634402 after 0.93 seconds
[0m16:33:38.634402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C524FAF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C54B4E7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C5497C950>]}
[0m16:33:38.634402 [debug] [MainThread]: Flushing usage events
[0m16:33:56.911754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E18E2ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E18E2F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E18E1CD0>]}


============================== 16:33:56.921520 | a84117fc-830c-4374-8dbb-ee772f5237e7 ==============================
[0m16:33:56.921520 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:33:56.921520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:33:57.081296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a84117fc-830c-4374-8dbb-ee772f5237e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E3612000>]}
[0m16:33:57.120830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a84117fc-830c-4374-8dbb-ee772f5237e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E18E0A10>]}
[0m16:33:57.120830 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:33:57.128932 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:33:57.254018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:57.254018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:57.289563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a84117fc-830c-4374-8dbb-ee772f5237e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E349F620>]}
[0m16:33:57.367538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a84117fc-830c-4374-8dbb-ee772f5237e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E37ABA10>]}
[0m16:33:57.368645 [info ] [MainThread]: Found 6 models, 4 data tests, 19 sources, 524 macros
[0m16:33:57.368645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a84117fc-830c-4374-8dbb-ee772f5237e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190DF11AE70>]}
[0m16:33:57.370182 [info ] [MainThread]: 
[0m16:33:57.371137 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:33:57.371137 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:33:57.431064 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:33:57.431064 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:33:57.431064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:57.451729 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:57.451729 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:33:57.451729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:33:57.451729 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:33:57.461424 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:33:57.461424 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:33:57.461424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:57.480143 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:57.480143 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:33:57.480143 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:33:57.480143 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:57.480143 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:33:57.480143 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:33:57.480143 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:57.480143 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:33:57.480143 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:33:57.480143 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:33:57.480143 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:57.488409 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:33:57.491593 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:33:57.500579 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:33:57.501612 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:33:57.501612 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:33:57.501612 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:33:57.501612 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:33:57.501612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:57.501612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:57.518639 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:57.518639 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:33:57.518639 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:33:57.518639 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:57.518639 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:33:57.518639 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:33:57.549175 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:57.549175 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:33:57.549175 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:33:57.549175 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:33:57.549175 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:33:57.549175 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:33:57.557249 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:33:57.557249 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:33:57.561787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a84117fc-830c-4374-8dbb-ee772f5237e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E34760F0>]}
[0m16:33:57.561787 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:57.561787 [debug] [MainThread]: On master: BEGIN
[0m16:33:57.561787 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:57.581757 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:33:57.581757 [debug] [MainThread]: On master: COMMIT
[0m16:33:57.581757 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:57.581757 [debug] [MainThread]: On master: COMMIT
[0m16:33:57.581757 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:33:57.581757 [debug] [MainThread]: On master: Close
[0m16:33:57.581757 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:33:57.590279 [info ] [MainThread]: 
[0m16:33:57.591302 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__basicaid
[0m16:33:57.591302 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__basicaid ..... [RUN]
[0m16:33:57.591302 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicaid'
[0m16:33:57.591302 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__basicaid
[0m16:33:57.601241 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:57.601241 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__basicaid
[0m16:33:57.621384 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:57.621384 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:57.621384 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: BEGIN
[0m16:33:57.621384 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:33:57.646704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:33:57.646704 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:57.646704 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Aid Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicaid"
),

basicaid_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM basicaid_source
),

basicaid_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        NFIR_VER,
        FDIDRECAID,
        FDIDSTREC,
        INC_NOFDID
    FROM basicaid_col_data_type_update
)

SELECT * FROM basicaid_final
    );
  
  
[0m16:33:58.072745 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:33:58.082826 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:58.082826 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid__dbt_tmp" rename to "nfirs_transformed__basicaid"
[0m16:33:58.082826 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:33:58.091033 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: COMMIT
[0m16:33:58.091033 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:58.091033 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: COMMIT
[0m16:33:59.091794 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m16:33:59.101276 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"
[0m16:33:59.101276 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicaid"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid__dbt_backup" cascade
[0m16:33:59.101276 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:33:59.111349 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicaid: Close
[0m16:33:59.150441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a84117fc-830c-4374-8dbb-ee772f5237e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E18E3770>]}
[0m16:33:59.150441 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__basicaid  [[32mOK[0m in 1.55s]
[0m16:33:59.150441 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__basicaid
[0m16:33:59.150441 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:59.150441 [debug] [MainThread]: On master: BEGIN
[0m16:33:59.150441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:33:59.171472 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:33:59.171472 [debug] [MainThread]: On master: COMMIT
[0m16:33:59.171472 [debug] [MainThread]: Using duckdb connection "master"
[0m16:33:59.171472 [debug] [MainThread]: On master: COMMIT
[0m16:33:59.171472 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:33:59.171472 [debug] [MainThread]: On master: Close
[0m16:33:59.180282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:59.180282 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:33:59.180282 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:33:59.180282 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:33:59.180282 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicaid' was properly closed.
[0m16:33:59.180282 [info ] [MainThread]: 
[0m16:33:59.180282 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m16:33:59.180282 [debug] [MainThread]: Command end result
[0m16:33:59.201361 [info ] [MainThread]: 
[0m16:33:59.201361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:59.201361 [info ] [MainThread]: 
[0m16:33:59.201361 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:33:59.201361 [debug] [MainThread]: Command `cli run` succeeded at 16:33:59.201361 after 2.40 seconds
[0m16:33:59.201361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E324B320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E31C7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000190E3807A40>]}
[0m16:33:59.209514 [debug] [MainThread]: Flushing usage events
[0m17:01:14.017021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002517B2EF7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002517DA08200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002517C491DC0>]}


============================== 17:01:14.017021 | 01fb5287-a6cb-478c-a709-0e0801e5e476 ==============================
[0m17:01:14.017021 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:01:14.017021 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:01:14.183597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01fb5287-a6cb-478c-a709-0e0801e5e476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002517DFD1580>]}
[0m17:01:14.225075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01fb5287-a6cb-478c-a709-0e0801e5e476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002517E0D42F0>]}
[0m17:01:14.225075 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:01:14.235758 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:01:14.355247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:01:14.355247 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:01:14.387111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01fb5287-a6cb-478c-a709-0e0801e5e476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002517DDCBC50>]}
[0m17:01:14.466343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01fb5287-a6cb-478c-a709-0e0801e5e476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002517E286E40>]}
[0m17:01:14.466343 [info ] [MainThread]: Found 7 models, 4 data tests, 19 sources, 524 macros
[0m17:01:14.466343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01fb5287-a6cb-478c-a709-0e0801e5e476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002517E4274D0>]}
[0m17:01:14.466343 [info ] [MainThread]: 
[0m17:01:14.466343 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:01:14.474456 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:01:14.526681 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:01:14.526681 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:01:14.534756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:14.546473 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:14.554873 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:01:14.554873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:01:14.554873 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:01:14.567437 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:01:14.567437 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:01:14.567437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:14.583381 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:14.583381 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:01:14.583381 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:01:14.583381 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:14.583381 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:01:14.583381 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:01:14.583381 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:14.583381 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:01:14.583381 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:01:14.583381 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:01:14.583381 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:14.583381 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:01:14.596866 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:01:14.596866 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:01:14.596866 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:01:14.596866 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:01:14.605149 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:01:14.605149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:14.605149 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:01:14.622342 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:14.622342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:14.622342 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:01:14.625399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:14.625399 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:01:14.626431 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:01:14.626431 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:01:14.654070 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:14.654070 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:14.654070 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:01:14.654070 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:01:14.662141 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:01:14.662141 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:01:14.663484 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:01:14.663484 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:01:14.666688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01fb5287-a6cb-478c-a709-0e0801e5e476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002517E0273E0>]}
[0m17:01:14.666688 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:14.666688 [debug] [MainThread]: On master: BEGIN
[0m17:01:14.666688 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:14.687252 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:14.687252 [debug] [MainThread]: On master: COMMIT
[0m17:01:14.687252 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:14.687252 [debug] [MainThread]: On master: COMMIT
[0m17:01:14.687252 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:14.687252 [debug] [MainThread]: On master: Close
[0m17:01:14.695355 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:01:14.695355 [info ] [MainThread]: 
[0m17:01:14.696632 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:01:14.696632 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__basicincident  [RUN]
[0m17:01:14.696632 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:01:14.696632 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:01:14.706916 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:01:14.713240 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:01:14.737035 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:01:14.737035 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:01:14.737035 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: BEGIN
[0m17:01:14.737035 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:01:14.756942 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:01:14.756942 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:01:14.756942 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
)

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL_UPDATE,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR_UPDATE,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_APP,
        EMS_PER_UPDATE AS EMS_APP,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_source
    );
  
  
[0m17:01:14.756942 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
)

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL_UPDATE,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR_UPDATE,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_APP,
        EMS_PER_UPDATE AS EMS_APP,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_source
    );
  
  
[0m17:01:14.756942 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:01:14.756942 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: ROLLBACK
[0m17:01:14.764937 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:01:14.764937 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: Close
[0m17:01:14.773162 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__basicincident (models\nfirs_transformed\nfirs_transformed__basicincident.sql)
  Parser Error: syntax error at or near "basicincident_final"
[0m17:01:14.773162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01fb5287-a6cb-478c-a709-0e0801e5e476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002517E1D9250>]}
[0m17:01:14.775797 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__basicincident  [[31mERROR[0m in 0.08s]
[0m17:01:14.775797 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:01:14.777028 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:14.777028 [debug] [MainThread]: On master: BEGIN
[0m17:01:14.777028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:01:14.796688 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:14.796688 [debug] [MainThread]: On master: COMMIT
[0m17:01:14.796688 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:14.796688 [debug] [MainThread]: On master: COMMIT
[0m17:01:14.796688 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:14.796688 [debug] [MainThread]: On master: Close
[0m17:01:14.805598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:14.806111 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:01:14.806111 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:01:14.806111 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:01:14.806111 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident' was properly closed.
[0m17:01:14.806111 [info ] [MainThread]: 
[0m17:01:14.806111 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m17:01:14.806111 [debug] [MainThread]: Command end result
[0m17:01:14.835463 [info ] [MainThread]: 
[0m17:01:14.835463 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:01:14.835463 [info ] [MainThread]: 
[0m17:01:14.835463 [error] [MainThread]:   Runtime Error in model nfirs_transformed__basicincident (models\nfirs_transformed\nfirs_transformed__basicincident.sql)
  Parser Error: syntax error at or near "basicincident_final"
[0m17:01:14.835463 [info ] [MainThread]: 
[0m17:01:14.835463 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:01:14.835463 [debug] [MainThread]: Command `cli run` failed at 17:01:14.835463 after 0.93 seconds
[0m17:01:14.835463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002517DB2B800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002517C3FB1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002517BD27470>]}
[0m17:01:14.835463 [debug] [MainThread]: Flushing usage events
[0m17:01:28.063375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F23DC70E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F23DC6D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F23DC5BB0>]}


============================== 17:01:28.071372 | 6676074a-546b-49c3-a4f9-272d8c886ff2 ==============================
[0m17:01:28.071372 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:01:28.071372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:01:28.225265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6676074a-546b-49c3-a4f9-272d8c886ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F25A42810>]}
[0m17:01:28.265967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6676074a-546b-49c3-a4f9-272d8c886ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F23753BC0>]}
[0m17:01:28.265967 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:01:28.275256 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:01:28.396057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:01:28.396057 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:01:28.425959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6676074a-546b-49c3-a4f9-272d8c886ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F239EB140>]}
[0m17:01:28.506802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6676074a-546b-49c3-a4f9-272d8c886ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F25D94440>]}
[0m17:01:28.506802 [info ] [MainThread]: Found 7 models, 4 data tests, 19 sources, 524 macros
[0m17:01:28.506802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6676074a-546b-49c3-a4f9-272d8c886ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F25D86210>]}
[0m17:01:28.506802 [info ] [MainThread]: 
[0m17:01:28.506802 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:01:28.514925 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:01:28.572870 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:01:28.572870 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:01:28.572870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:28.586445 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:28.594350 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:01:28.594350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:01:28.594350 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:01:28.602349 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:01:28.602349 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:01:28.602349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:28.616860 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:28.616860 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:01:28.616860 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:01:28.616860 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:28.616860 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:01:28.624739 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:01:28.624739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:28.624739 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:01:28.626511 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:01:28.626632 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:01:28.626632 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:28.626632 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:01:28.634578 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:01:28.634578 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:01:28.634578 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:01:28.634578 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:01:28.642825 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:01:28.642825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:28.642825 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:01:28.655924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:28.655924 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:28.655924 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:28.655924 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:01:28.655924 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:01:28.663878 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:01:28.663878 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:01:28.684434 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:28.696628 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:28.696628 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:01:28.696628 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:01:28.696628 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:01:28.696628 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:01:28.696628 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:01:28.696628 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:01:28.710397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6676074a-546b-49c3-a4f9-272d8c886ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F261066C0>]}
[0m17:01:28.710940 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:28.710940 [debug] [MainThread]: On master: BEGIN
[0m17:01:28.711817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:28.724146 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:28.724146 [debug] [MainThread]: On master: COMMIT
[0m17:01:28.724146 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:28.724146 [debug] [MainThread]: On master: COMMIT
[0m17:01:28.724146 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:28.724146 [debug] [MainThread]: On master: Close
[0m17:01:28.734921 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:01:28.734921 [info ] [MainThread]: 
[0m17:01:28.736846 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:01:28.736846 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__basicincident  [RUN]
[0m17:01:28.736846 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:01:28.736846 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:01:28.746091 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:01:28.746091 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:01:28.764636 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:01:28.772800 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:01:28.773584 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: BEGIN
[0m17:01:28.773584 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:01:28.786255 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:01:28.786255 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:01:28.786255 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
),

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL_UPDATE,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR_UPDATE,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_APP,
        EMS_PER_UPDATE AS EMS_APP,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_source
    );
  
  
[0m17:01:28.786255 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
),

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL_UPDATE,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR_UPDATE,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_APP,
        EMS_PER_UPDATE AS EMS_APP,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_source
    );
  
  
[0m17:01:28.786255 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:01:28.786255 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: ROLLBACK
[0m17:01:28.794237 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:01:28.794237 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: Close
[0m17:01:28.802371 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__basicincident (models\nfirs_transformed\nfirs_transformed__basicincident.sql)
  Parser Error: syntax error at or near "DET_ALERT"
[0m17:01:28.804998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6676074a-546b-49c3-a4f9-272d8c886ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F261CB980>]}
[0m17:01:28.804998 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__basicincident  [[31mERROR[0m in 0.07s]
[0m17:01:28.804998 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:01:28.806630 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:28.806630 [debug] [MainThread]: On master: BEGIN
[0m17:01:28.806630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:01:28.823913 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:28.823913 [debug] [MainThread]: On master: COMMIT
[0m17:01:28.823913 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:28.823913 [debug] [MainThread]: On master: COMMIT
[0m17:01:28.823913 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:28.823913 [debug] [MainThread]: On master: Close
[0m17:01:28.831922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:28.831922 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:01:28.831922 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:01:28.831922 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:01:28.831922 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident' was properly closed.
[0m17:01:28.831922 [info ] [MainThread]: 
[0m17:01:28.835245 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m17:01:28.835245 [debug] [MainThread]: Command end result
[0m17:01:28.860248 [info ] [MainThread]: 
[0m17:01:28.860248 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:01:28.860248 [info ] [MainThread]: 
[0m17:01:28.860248 [error] [MainThread]:   Runtime Error in model nfirs_transformed__basicincident (models\nfirs_transformed\nfirs_transformed__basicincident.sql)
  Parser Error: syntax error at or near "DET_ALERT"
[0m17:01:28.860248 [info ] [MainThread]: 
[0m17:01:28.860248 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:01:28.860248 [debug] [MainThread]: Command `cli run` failed at 17:01:28.860248 after 0.91 seconds
[0m17:01:28.865352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F23A1EF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F7F487E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F7F487860>]}
[0m17:01:28.865352 [debug] [MainThread]: Flushing usage events
[0m17:01:40.055740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9CAC88A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C8FC8D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C8EE1CD0>]}


============================== 17:01:40.055740 | a37f6eaa-8c94-43cd-94ac-12164165a85d ==============================
[0m17:01:40.055740 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:01:40.055740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:01:40.213629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a37f6eaa-8c94-43cd-94ac-12164165a85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C983E0F0>]}
[0m17:01:40.255740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a37f6eaa-8c94-43cd-94ac-12164165a85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9CAE31E20>]}
[0m17:01:40.263780 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:01:40.273347 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:01:40.404449 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:01:40.404449 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:01:40.433678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a37f6eaa-8c94-43cd-94ac-12164165a85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C913BC50>]}
[0m17:01:40.505849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a37f6eaa-8c94-43cd-94ac-12164165a85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9CB1E1A60>]}
[0m17:01:40.513802 [info ] [MainThread]: Found 7 models, 4 data tests, 19 sources, 524 macros
[0m17:01:40.513802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37f6eaa-8c94-43cd-94ac-12164165a85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9CB05E300>]}
[0m17:01:40.513802 [info ] [MainThread]: 
[0m17:01:40.513802 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:01:40.513802 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:01:40.575776 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:01:40.575776 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:01:40.575776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:40.594298 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:40.594298 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:01:40.603206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:01:40.603206 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:01:40.612430 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:01:40.612430 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:01:40.612430 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:40.624380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:40.624380 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:01:40.624380 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:01:40.624380 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:40.624380 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:01:40.634875 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:01:40.634875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:40.636242 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:01:40.636242 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:01:40.636242 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:01:40.636242 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:40.636242 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:01:40.645339 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:01:40.645339 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:01:40.645339 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:01:40.645339 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:01:40.652711 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:01:40.652711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:40.652711 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:01:40.671216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:40.671747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:40.671747 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:01:40.671747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:40.671747 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:01:40.671747 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:01:40.671747 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:01:40.694575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:40.694575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:40.705845 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:01:40.705845 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:01:40.705845 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:01:40.708704 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:01:40.709607 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:01:40.710539 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:01:40.717102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a37f6eaa-8c94-43cd-94ac-12164165a85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9CB05CA40>]}
[0m17:01:40.717601 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:40.718101 [debug] [MainThread]: On master: BEGIN
[0m17:01:40.718601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:40.733082 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:40.733082 [debug] [MainThread]: On master: COMMIT
[0m17:01:40.733082 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:40.733082 [debug] [MainThread]: On master: COMMIT
[0m17:01:40.733082 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:40.733082 [debug] [MainThread]: On master: Close
[0m17:01:40.733082 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:01:40.733082 [info ] [MainThread]: 
[0m17:01:40.745491 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:01:40.745491 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__basicincident  [RUN]
[0m17:01:40.745491 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:01:40.745491 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:01:40.752956 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:01:40.754516 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:01:40.775608 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:01:40.775608 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:01:40.775608 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: BEGIN
[0m17:01:40.775608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:01:40.795921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:01:40.795921 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:01:40.795921 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
),

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL_UPDATE,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR_UPDATE,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_APP,
        EMS_PER_UPDATE AS EMS_APP,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ,
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_source
    );
  
  
[0m17:02:25.303393 [debug] [Thread-1 (]: SQL status: OK in 45.0 seconds
[0m17:02:25.314376 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:02:25.314376 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp" rename to "nfirs_transformed__basicincident"
[0m17:02:25.320919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:25.350657 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: COMMIT
[0m17:02:25.353707 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:02:25.353707 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: COMMIT
[0m17:02:36.194356 [debug] [Thread-1 (]: SQL status: OK in 11.0 seconds
[0m17:02:36.203844 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:02:36.203844 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_backup" cascade
[0m17:02:36.211873 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:36.211873 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: Close
[0m17:02:38.127176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a37f6eaa-8c94-43cd-94ac-12164165a85d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C864B650>]}
[0m17:02:38.128036 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__basicincident  [[32mOK[0m in 57.38s]
[0m17:02:38.129069 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:02:38.132107 [debug] [MainThread]: Using duckdb connection "master"
[0m17:02:38.132615 [debug] [MainThread]: On master: BEGIN
[0m17:02:38.133107 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:02:38.150817 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:02:38.151361 [debug] [MainThread]: On master: COMMIT
[0m17:02:38.151361 [debug] [MainThread]: Using duckdb connection "master"
[0m17:02:38.151857 [debug] [MainThread]: On master: COMMIT
[0m17:02:38.152355 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:02:38.152355 [debug] [MainThread]: On master: Close
[0m17:02:38.160086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:38.161086 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:02:38.161428 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:02:38.161428 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:02:38.161976 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident' was properly closed.
[0m17:02:38.163570 [info ] [MainThread]: 
[0m17:02:38.164137 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 57.65 seconds (57.65s).
[0m17:02:38.165155 [debug] [MainThread]: Command end result
[0m17:02:38.199136 [info ] [MainThread]: 
[0m17:02:38.200153 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:02:38.200153 [info ] [MainThread]: 
[0m17:02:38.201472 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:02:38.202801 [debug] [MainThread]: Command `cli run` succeeded at 17:02:38.202727 after 58.25 seconds
[0m17:02:38.203461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9C8FC8D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9CADE8C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9CAC88A70>]}
[0m17:02:38.203801 [debug] [MainThread]: Flushing usage events
[0m17:03:54.204638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D1C86C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D1C86CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D1C86CB30>]}


============================== 17:03:54.204638 | e0620517-79e2-4d01-8da5-8998931c5844 ==============================
[0m17:03:54.204638 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:03:54.204638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:03:54.363300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0620517-79e2-4d01-8da5-8998931c5844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D1C8BD9D0>]}
[0m17:03:54.406954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0620517-79e2-4d01-8da5-8998931c5844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D1AB0C6B0>]}
[0m17:03:54.406954 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:03:54.414987 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:03:54.535256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:54.535256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:54.574119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0620517-79e2-4d01-8da5-8998931c5844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D1C98DD60>]}
[0m17:03:54.657527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0620517-79e2-4d01-8da5-8998931c5844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D1CC1A840>]}
[0m17:03:54.657527 [info ] [MainThread]: Found 7 models, 4 data tests, 19 sources, 524 macros
[0m17:03:54.657527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0620517-79e2-4d01-8da5-8998931c5844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D1CCB1D00>]}
[0m17:03:54.657527 [info ] [MainThread]: 
[0m17:03:54.657527 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:03:54.657527 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:03:54.713167 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:03:54.721321 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:03:54.721321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:54.737427 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:03:54.737427 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:03:54.746161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:03:54.746161 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:03:54.746161 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:03:54.746161 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:03:54.754410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:54.767661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:03:54.767661 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:03:54.767661 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:03:54.767661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:03:54.767661 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:03:54.767661 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:03:54.767661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:03:54.775690 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:03:54.775690 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:03:54.775690 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:03:54.775690 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:03:54.775690 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:03:54.783730 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:03:54.783730 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:03:54.783730 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:03:54.783730 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:03:54.791693 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:03:54.791693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:54.791693 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:03:54.805869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:03:54.805869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:54.805869 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:03:54.805869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:03:54.805869 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:03:54.805869 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:03:54.814785 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:03:54.837610 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:03:54.845209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:03:54.847559 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:03:54.847559 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:03:54.847559 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:03:54.847559 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:03:54.847559 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:03:54.847559 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:03:54.856738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0620517-79e2-4d01-8da5-8998931c5844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D1D1266C0>]}
[0m17:03:54.856738 [debug] [MainThread]: Using duckdb connection "master"
[0m17:03:54.856738 [debug] [MainThread]: On master: BEGIN
[0m17:03:54.856738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:54.867344 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:03:54.875697 [debug] [MainThread]: On master: COMMIT
[0m17:03:54.875697 [debug] [MainThread]: Using duckdb connection "master"
[0m17:03:54.875697 [debug] [MainThread]: On master: COMMIT
[0m17:03:54.875697 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:03:54.875697 [debug] [MainThread]: On master: Close
[0m17:03:54.875697 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:03:54.875697 [info ] [MainThread]: 
[0m17:03:54.883957 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:03:54.883957 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__basicincident  [RUN]
[0m17:03:54.883957 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:03:54.883957 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:03:54.891971 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:03:54.891971 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:03:54.914246 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:03:54.914246 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:03:54.914246 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: BEGIN
[0m17:03:54.914246 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:03:54.935576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:03:54.935576 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:03:54.935576 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
),

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL_UPDATE,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR_UPDATE,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_APP,
        EMS_PER_UPDATE AS EMS_APP,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ,
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_final
    );
  
  
[0m17:03:54.935576 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
),

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL_UPDATE,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR_UPDATE,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_APP,
        EMS_PER_UPDATE AS EMS_APP,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ,
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_final
    );
  
  
[0m17:03:54.935576 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:03:54.935576 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: ROLLBACK
[0m17:03:54.945997 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:03:54.945997 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: Close
[0m17:03:54.947216 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__basicincident (models\nfirs_transformed\nfirs_transformed__basicincident.sql)
  Binder Error: * expression without FROM clause!
[0m17:03:54.947216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0620517-79e2-4d01-8da5-8998931c5844', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D1ADC7710>]}
[0m17:03:54.947216 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__basicincident  [[31mERROR[0m in 0.06s]
[0m17:03:54.947216 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:03:54.955159 [debug] [MainThread]: Using duckdb connection "master"
[0m17:03:54.955159 [debug] [MainThread]: On master: BEGIN
[0m17:03:54.955159 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:54.967743 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:03:54.967743 [debug] [MainThread]: On master: COMMIT
[0m17:03:54.967743 [debug] [MainThread]: Using duckdb connection "master"
[0m17:03:54.967743 [debug] [MainThread]: On master: COMMIT
[0m17:03:54.976013 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:03:54.976013 [debug] [MainThread]: On master: Close
[0m17:03:54.976968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:54.976968 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:03:54.976968 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:03:54.976968 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:03:54.976968 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident' was properly closed.
[0m17:03:54.976968 [info ] [MainThread]: 
[0m17:03:54.976968 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m17:03:54.976968 [debug] [MainThread]: Command end result
[0m17:03:55.007190 [info ] [MainThread]: 
[0m17:03:55.007839 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:03:55.007882 [info ] [MainThread]: 
[0m17:03:55.008442 [error] [MainThread]:   Runtime Error in model nfirs_transformed__basicincident (models\nfirs_transformed\nfirs_transformed__basicincident.sql)
  Binder Error: * expression without FROM clause!
[0m17:03:55.009016 [info ] [MainThread]: 
[0m17:03:55.009522 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:03:55.009534 [debug] [MainThread]: Command `cli run` failed at 17:03:55.009534 after 0.92 seconds
[0m17:03:55.009534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D1865E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D1CB68AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D1D1266C0>]}
[0m17:03:55.009534 [debug] [MainThread]: Flushing usage events
[0m17:04:14.566578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E512AF950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E528E7140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E528E7D10>]}


============================== 17:04:14.574553 | 58cfd141-c444-48d5-adaa-c01f5b2f496a ==============================
[0m17:04:14.574553 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:04:14.574553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:04:14.736720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58cfd141-c444-48d5-adaa-c01f5b2f496a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E51794650>]}
[0m17:04:14.776927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58cfd141-c444-48d5-adaa-c01f5b2f496a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E517BF6E0>]}
[0m17:04:14.776927 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:04:14.785024 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:04:14.916844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:04:14.916844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:04:14.953403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58cfd141-c444-48d5-adaa-c01f5b2f496a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E541F87D0>]}
[0m17:04:15.026444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58cfd141-c444-48d5-adaa-c01f5b2f496a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E53F984A0>]}
[0m17:04:15.026444 [info ] [MainThread]: Found 7 models, 4 data tests, 19 sources, 524 macros
[0m17:04:15.026444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58cfd141-c444-48d5-adaa-c01f5b2f496a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E541CCD70>]}
[0m17:04:15.026444 [info ] [MainThread]: 
[0m17:04:15.026444 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:04:15.026444 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:04:15.086770 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:04:15.086770 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:04:15.086770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:15.106715 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:15.106715 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:04:15.116625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:04:15.116625 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:04:15.116625 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:04:15.116625 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:04:15.116625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:15.136404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:15.136404 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:04:15.136404 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:04:15.136404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:15.136404 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:04:15.136404 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:04:15.136404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:15.144429 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:04:15.144429 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:04:15.144429 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:04:15.144429 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:15.144429 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:04:15.154339 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:04:15.156564 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:04:15.156564 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:04:15.156564 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:04:15.156564 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:04:15.156564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:15.156564 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:04:15.176786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:15.176786 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:15.176786 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:15.176786 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:04:15.176786 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:04:15.176786 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:04:15.176786 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:04:15.207778 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:15.212304 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:15.214422 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:04:15.215564 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:04:15.216574 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:04:15.217283 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:04:15.217283 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:04:15.218511 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:04:15.224499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58cfd141-c444-48d5-adaa-c01f5b2f496a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E54488AA0>]}
[0m17:04:15.225544 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:15.225544 [debug] [MainThread]: On master: BEGIN
[0m17:04:15.225544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:04:15.242050 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:04:15.243188 [debug] [MainThread]: On master: COMMIT
[0m17:04:15.243188 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:15.243188 [debug] [MainThread]: On master: COMMIT
[0m17:04:15.244239 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:04:15.244239 [debug] [MainThread]: On master: Close
[0m17:04:15.246240 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:04:15.246240 [info ] [MainThread]: 
[0m17:04:15.253592 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:04:15.253592 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__basicincident  [RUN]
[0m17:04:15.253592 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:04:15.253592 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:04:15.262788 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:04:15.262788 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:04:15.286846 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:04:15.286846 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:04:15.286846 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: BEGIN
[0m17:04:15.286846 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:04:15.303979 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:15.303979 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:04:15.303979 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
),

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL_UPDATE,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR_UPDATE,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_APP,
        EMS_PER_UPDATE AS EMS_APP,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ,
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_final
    );
  
  
[0m17:04:15.303979 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
),

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL_UPDATE,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR_UPDATE,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_APP,
        EMS_PER_UPDATE AS EMS_APP,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ,
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_final
    );
  
  
[0m17:04:15.303979 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:04:15.303979 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: ROLLBACK
[0m17:04:15.313220 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:04:15.313220 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: Close
[0m17:04:15.316364 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__basicincident (models\nfirs_transformed\nfirs_transformed__basicincident.sql)
  Binder Error: * expression without FROM clause!
[0m17:04:15.316364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58cfd141-c444-48d5-adaa-c01f5b2f496a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E524539E0>]}
[0m17:04:15.316364 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__basicincident  [[31mERROR[0m in 0.06s]
[0m17:04:15.323602 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:04:15.325413 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:15.325413 [debug] [MainThread]: On master: BEGIN
[0m17:04:15.325413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:04:15.342604 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:04:15.342604 [debug] [MainThread]: On master: COMMIT
[0m17:04:15.342604 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:15.342604 [debug] [MainThread]: On master: COMMIT
[0m17:04:15.342604 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:04:15.342604 [debug] [MainThread]: On master: Close
[0m17:04:15.346635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:15.346635 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:04:15.346635 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:04:15.346635 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:04:15.346635 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident' was properly closed.
[0m17:04:15.346635 [info ] [MainThread]: 
[0m17:04:15.346635 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m17:04:15.346635 [debug] [MainThread]: Command end result
[0m17:04:15.373878 [info ] [MainThread]: 
[0m17:04:15.375451 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:04:15.375451 [info ] [MainThread]: 
[0m17:04:15.376349 [error] [MainThread]:   Runtime Error in model nfirs_transformed__basicincident (models\nfirs_transformed\nfirs_transformed__basicincident.sql)
  Binder Error: * expression without FROM clause!
[0m17:04:15.376349 [info ] [MainThread]: 
[0m17:04:15.376349 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:04:15.376349 [debug] [MainThread]: Command `cli run` failed at 17:04:15.376349 after 0.92 seconds
[0m17:04:15.376349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E52B4C680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E53EE9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E53EE8E00>]}
[0m17:04:15.376349 [debug] [MainThread]: Flushing usage events
[0m17:04:52.222732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA40D62990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA427FAFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA427C1640>]}


============================== 17:04:52.230694 | 14cf42cf-2acb-4d99-8847-92144ef894ea ==============================
[0m17:04:52.230694 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:04:52.230694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:04:52.382641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14cf42cf-2acb-4d99-8847-92144ef894ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA41474470>]}
[0m17:04:52.434790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14cf42cf-2acb-4d99-8847-92144ef894ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA41F7F3B0>]}
[0m17:04:52.435911 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:04:52.444918 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:04:52.564406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:04:52.564406 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:04:52.594660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14cf42cf-2acb-4d99-8847-92144ef894ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA43E4F650>]}
[0m17:04:52.673930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14cf42cf-2acb-4d99-8847-92144ef894ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA43FD1E50>]}
[0m17:04:52.673930 [info ] [MainThread]: Found 7 models, 4 data tests, 19 sources, 524 macros
[0m17:04:52.673930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14cf42cf-2acb-4d99-8847-92144ef894ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA43F1A600>]}
[0m17:04:52.673930 [info ] [MainThread]: 
[0m17:04:52.673930 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:04:52.673930 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:04:52.735664 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:04:52.735664 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:04:52.735664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:52.755207 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:52.755207 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:04:52.764774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:04:52.764774 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:04:52.764774 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:04:52.764774 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:04:52.764774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:52.785691 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:52.785691 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:04:52.785691 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:04:52.785691 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:52.785691 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:04:52.785691 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:04:52.785691 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:52.785691 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:04:52.785691 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:04:52.785691 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:04:52.792849 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:52.792849 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:04:52.800892 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:04:52.800892 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:04:52.800892 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:04:52.800892 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:04:52.807849 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:04:52.808876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:52.808876 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:04:52.824460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:52.824460 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:52.824460 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:52.824460 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:04:52.824460 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:04:52.824460 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:04:52.824460 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:04:52.852732 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:52.860664 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:04:52.860664 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:04:52.860664 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:04:52.860664 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:04:52.864962 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:04:52.864962 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:04:52.864962 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:04:52.865993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14cf42cf-2acb-4d99-8847-92144ef894ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4149F7D0>]}
[0m17:04:52.865993 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:52.865993 [debug] [MainThread]: On master: BEGIN
[0m17:04:52.865993 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:04:52.885664 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:04:52.885664 [debug] [MainThread]: On master: COMMIT
[0m17:04:52.885664 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:52.885664 [debug] [MainThread]: On master: COMMIT
[0m17:04:52.885664 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:04:52.885664 [debug] [MainThread]: On master: Close
[0m17:04:52.893689 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:04:52.893689 [info ] [MainThread]: 
[0m17:04:52.893689 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:04:52.893689 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__basicincident  [RUN]
[0m17:04:52.893689 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:04:52.893689 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:04:52.905499 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:04:52.905499 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:04:52.931862 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:04:52.931862 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:04:52.931862 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: BEGIN
[0m17:04:52.934429 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:04:52.945333 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:04:52.945333 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:04:52.945333 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
),

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL_UPDATE,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR_UPDATE,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_APP,
        EMS_PER_UPDATE AS EMS_APP,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ,
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_final
    );
  
  
[0m17:04:52.945333 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
),

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL_UPDATE,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR_UPDATE,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_APP,
        EMS_PER_UPDATE AS EMS_APP,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ,
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_final
    );
  
  
[0m17:04:52.953390 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:04:52.953390 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: ROLLBACK
[0m17:04:52.953390 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:04:52.953390 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: Close
[0m17:04:52.961388 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__basicincident (models\nfirs_transformed\nfirs_transformed__basicincident.sql)
  Binder Error: * expression without FROM clause!
[0m17:04:52.964487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14cf42cf-2acb-4d99-8847-92144ef894ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA4459B860>]}
[0m17:04:52.965569 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__basicincident  [[31mERROR[0m in 0.07s]
[0m17:04:52.965569 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:04:52.965569 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:52.965569 [debug] [MainThread]: On master: BEGIN
[0m17:04:52.965569 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:04:52.982744 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:04:52.982744 [debug] [MainThread]: On master: COMMIT
[0m17:04:52.982744 [debug] [MainThread]: Using duckdb connection "master"
[0m17:04:52.982744 [debug] [MainThread]: On master: COMMIT
[0m17:04:52.982744 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:04:52.982744 [debug] [MainThread]: On master: Close
[0m17:04:52.990774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:52.990774 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:04:52.990774 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:04:52.990774 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:04:52.990774 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident' was properly closed.
[0m17:04:52.990774 [info ] [MainThread]: 
[0m17:04:52.990774 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m17:04:52.990774 [debug] [MainThread]: Command end result
[0m17:04:53.014553 [info ] [MainThread]: 
[0m17:04:53.014553 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:04:53.014553 [info ] [MainThread]: 
[0m17:04:53.014553 [error] [MainThread]:   Runtime Error in model nfirs_transformed__basicincident (models\nfirs_transformed\nfirs_transformed__basicincident.sql)
  Binder Error: * expression without FROM clause!
[0m17:04:53.014553 [info ] [MainThread]: 
[0m17:04:53.014553 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:04:53.014553 [debug] [MainThread]: Command `cli run` failed at 17:04:53.014553 after 0.90 seconds
[0m17:04:53.014553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA40D62990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA43A27B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CA42731B80>]}
[0m17:04:53.014553 [debug] [MainThread]: Flushing usage events
[0m17:06:09.340980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF2533FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF2532FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF2532090>]}


============================== 17:06:09.340980 | 48856305-9466-4a6a-a51d-aab1f1885d48 ==============================
[0m17:06:09.340980 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:06:09.340980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:06:09.508002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48856305-9466-4a6a-a51d-aab1f1885d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF3C04500>]}
[0m17:06:09.546055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48856305-9466-4a6a-a51d-aab1f1885d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF13DF4D0>]}
[0m17:06:09.546055 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:06:09.553962 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:06:09.680157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:06:09.680157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:06:09.714002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48856305-9466-4a6a-a51d-aab1f1885d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF3C2E3F0>]}
[0m17:06:09.793782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48856305-9466-4a6a-a51d-aab1f1885d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF3E39460>]}
[0m17:06:09.793782 [info ] [MainThread]: Found 7 models, 4 data tests, 19 sources, 524 macros
[0m17:06:09.793782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48856305-9466-4a6a-a51d-aab1f1885d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF1BE63C0>]}
[0m17:06:09.793782 [info ] [MainThread]: 
[0m17:06:09.793782 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:06:09.801409 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:06:09.862821 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:06:09.863943 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:06:09.863943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:09.882525 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:09.882525 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:06:09.882525 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:06:09.891427 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:06:09.894106 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:06:09.894106 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:06:09.894106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:09.912678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:09.912678 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:06:09.912678 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:06:09.912678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:09.912678 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:06:09.912678 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:06:09.912678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:09.912678 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:06:09.912678 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:06:09.912678 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:06:09.912678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:09.912678 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:06:09.920975 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:06:09.920975 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:06:09.928905 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:06:09.934321 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:06:09.934321 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:06:09.934321 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:06:09.934321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:09.934321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:09.951615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:09.951615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:09.951615 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:06:09.951615 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:06:09.951615 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:06:09.951615 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:06:09.984391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:09.984391 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:06:09.984391 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:06:09.984391 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:06:09.984391 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:06:09.984391 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:06:09.992318 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:06:09.992318 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:06:10.000353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48856305-9466-4a6a-a51d-aab1f1885d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF13DF860>]}
[0m17:06:10.000353 [debug] [MainThread]: Using duckdb connection "master"
[0m17:06:10.001478 [debug] [MainThread]: On master: BEGIN
[0m17:06:10.001644 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:10.012790 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:06:10.012790 [debug] [MainThread]: On master: COMMIT
[0m17:06:10.012790 [debug] [MainThread]: Using duckdb connection "master"
[0m17:06:10.012790 [debug] [MainThread]: On master: COMMIT
[0m17:06:10.012790 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:06:10.020852 [debug] [MainThread]: On master: Close
[0m17:06:10.020852 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:06:10.020852 [info ] [MainThread]: 
[0m17:06:10.029934 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:06:10.032536 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__basicincident  [RUN]
[0m17:06:10.032536 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:06:10.032536 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:06:10.034147 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:06:10.034147 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:06:10.059115 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:06:10.059115 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:06:10.059115 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: BEGIN
[0m17:06:10.059115 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:06:10.083917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:06:10.083917 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:06:10.083917 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
    FROM basicincident_source
),

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL_UPDATE,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR_UPDATE,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_APP,
        EMS_PER_UPDATE AS EMS_APP,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ,
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_final
    );
  
  
[0m17:06:28.347316 [debug] [Thread-1 (]: SQL status: OK in 18.0 seconds
[0m17:06:28.353494 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:06:28.360749 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident" rename to "nfirs_transformed__basicincident__dbt_backup"
[0m17:06:28.362879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:06:28.362879 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:06:28.362879 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp" rename to "nfirs_transformed__basicincident"
[0m17:06:28.362879 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:06:28.406426 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: COMMIT
[0m17:06:28.407426 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:06:28.407982 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: COMMIT
[0m17:06:37.287793 [debug] [Thread-1 (]: SQL status: OK in 9.0 seconds
[0m17:06:37.296040 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:06:37.297436 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_backup" cascade
[0m17:06:37.353174 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:06:37.357659 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: Close
[0m17:06:40.142101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48856305-9466-4a6a-a51d-aab1f1885d48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF137B6E0>]}
[0m17:06:40.142601 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__basicincident  [[32mOK[0m in 30.11s]
[0m17:06:40.142601 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:06:40.148452 [debug] [MainThread]: Using duckdb connection "master"
[0m17:06:40.149182 [debug] [MainThread]: On master: BEGIN
[0m17:06:40.150132 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:40.172656 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:06:40.172656 [debug] [MainThread]: On master: COMMIT
[0m17:06:40.172656 [debug] [MainThread]: Using duckdb connection "master"
[0m17:06:40.172656 [debug] [MainThread]: On master: COMMIT
[0m17:06:40.172656 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:06:40.179901 [debug] [MainThread]: On master: Close
[0m17:06:40.191590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:40.192079 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:06:40.192642 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:06:40.192642 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:06:40.192642 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident' was properly closed.
[0m17:06:40.192642 [info ] [MainThread]: 
[0m17:06:40.192642 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 30.40 seconds (30.40s).
[0m17:06:40.192642 [debug] [MainThread]: Command end result
[0m17:06:40.222842 [info ] [MainThread]: 
[0m17:06:40.222842 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:40.222842 [info ] [MainThread]: 
[0m17:06:40.222842 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:06:40.222842 [debug] [MainThread]: Command `cli run` succeeded at 17:06:40.222842 after 31.00 seconds
[0m17:06:40.222842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF27018E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF3A1C620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF24A7740>]}
[0m17:06:40.222842 [debug] [MainThread]: Flushing usage events
[0m17:11:43.280610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9F02C920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9F02C950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9F02F4A0>]}


============================== 17:11:43.285158 | 6192fc22-2cf6-46c3-a270-db8959fb961f ==============================
[0m17:11:43.285158 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:11:43.294699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:11:43.505488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6192fc22-2cf6-46c3-a270-db8959fb961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9CA44500>]}
[0m17:11:43.545439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6192fc22-2cf6-46c3-a270-db8959fb961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9F288CE0>]}
[0m17:11:43.545439 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:11:43.561762 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:11:43.686643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:11:43.686643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:11:43.726455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6192fc22-2cf6-46c3-a270-db8959fb961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9F4A7770>]}
[0m17:11:43.803554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6192fc22-2cf6-46c3-a270-db8959fb961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9F4E4CB0>]}
[0m17:11:43.803554 [info ] [MainThread]: Found 7 models, 4 data tests, 19 sources, 524 macros
[0m17:11:43.803554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6192fc22-2cf6-46c3-a270-db8959fb961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9F4C32C0>]}
[0m17:11:43.803554 [info ] [MainThread]: 
[0m17:11:43.803554 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:11:43.803554 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:11:43.864556 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:11:43.872588 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:11:43.872588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:43.892764 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:11:43.892764 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:11:43.898069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:11:43.898069 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:11:43.906774 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:11:43.906774 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:11:43.906774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:43.925402 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:11:43.925402 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:11:43.925402 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:11:43.925402 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:11:43.925402 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:11:43.925402 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:11:43.925402 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:11:43.925402 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:11:43.925402 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:11:43.925402 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:11:43.925402 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:11:43.925402 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:11:43.936543 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:11:43.943137 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:11:43.946345 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:11:43.946345 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:11:43.946345 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:11:43.946345 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:11:43.946345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:43.946345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:43.976530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:11:43.976530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:11:43.976530 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:11:43.976530 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:11:43.976530 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:11:43.976530 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:11:44.006960 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:11:44.006960 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:11:44.006960 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:11:44.014942 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:11:44.014942 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:11:44.014942 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:11:44.014942 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:11:44.014942 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:11:44.024404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6192fc22-2cf6-46c3-a270-db8959fb961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9F966D20>]}
[0m17:11:44.025506 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:44.025506 [debug] [MainThread]: On master: BEGIN
[0m17:11:44.025506 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:44.045285 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:11:44.045285 [debug] [MainThread]: On master: COMMIT
[0m17:11:44.046580 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:44.046580 [debug] [MainThread]: On master: COMMIT
[0m17:11:44.046580 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:11:44.046580 [debug] [MainThread]: On master: Close
[0m17:11:44.046580 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:11:44.046580 [info ] [MainThread]: 
[0m17:11:44.055140 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:11:44.055140 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__basicincident  [RUN]
[0m17:11:44.055140 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:11:44.059666 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:11:44.065957 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:11:44.066965 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:11:44.082952 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:11:44.091644 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:11:44.091644 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: BEGIN
[0m17:11:44.091644 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:11:44.104275 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:11:44.104275 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:11:44.104275 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
    FROM basicincident_source
),

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL_UPDATE,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR_UPDATE,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_APP,
        EMS_PER_UPDATE AS EMS_APP,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ,
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_final
    );
  
  
[0m17:12:02.564580 [debug] [Thread-1 (]: SQL status: OK in 18.0 seconds
[0m17:12:02.572535 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:12:02.572535 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident" rename to "nfirs_transformed__basicincident__dbt_backup"
[0m17:12:02.577199 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:12:02.577199 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:12:02.577199 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp" rename to "nfirs_transformed__basicincident"
[0m17:12:02.577199 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:12:02.593907 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: COMMIT
[0m17:12:02.593907 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:12:02.593907 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: COMMIT
[0m17:12:06.764811 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m17:12:06.773301 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:12:06.773301 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_backup" cascade
[0m17:12:06.836125 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:12:06.836125 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: Close
[0m17:12:09.456009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6192fc22-2cf6-46c3-a270-db8959fb961f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9CA0F440>]}
[0m17:12:09.456677 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__basicincident  [[32mOK[0m in 25.40s]
[0m17:12:09.457177 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:12:09.460197 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:09.460677 [debug] [MainThread]: On master: BEGIN
[0m17:12:09.460677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:09.478391 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:12:09.478836 [debug] [MainThread]: On master: COMMIT
[0m17:12:09.479371 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:09.479371 [debug] [MainThread]: On master: COMMIT
[0m17:12:09.479871 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:12:09.480371 [debug] [MainThread]: On master: Close
[0m17:12:09.489170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:09.489670 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:12:09.489670 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:12:09.489670 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:12:09.490539 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident' was properly closed.
[0m17:12:09.491066 [info ] [MainThread]: 
[0m17:12:09.491652 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 25.69 seconds (25.69s).
[0m17:12:09.492152 [debug] [MainThread]: Command end result
[0m17:12:09.516166 [info ] [MainThread]: 
[0m17:12:09.516952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:09.517516 [info ] [MainThread]: 
[0m17:12:09.517971 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:12:09.518957 [debug] [MainThread]: Command `cli run` succeeded at 17:12:09.518526 after 26.36 seconds
[0m17:12:09.518970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9F547E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9F401EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C9DBB3170>]}
[0m17:12:09.519556 [debug] [MainThread]: Flushing usage events
[0m17:22:05.047107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C0C1B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BEFA8A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BF143380>]}


============================== 17:22:05.047107 | c86ab6d8-8432-45b9-b139-f9b83a0d2c57 ==============================
[0m17:22:05.047107 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:22:05.047107 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:22:05.207233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c86ab6d8-8432-45b9-b139-f9b83a0d2c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C0DA1880>]}
[0m17:22:05.247308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c86ab6d8-8432-45b9-b139-f9b83a0d2c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BEFA8A70>]}
[0m17:22:05.247308 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:22:05.256563 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:22:05.385739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:22:05.386285 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:22:05.416566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c86ab6d8-8432-45b9-b139-f9b83a0d2c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C0DCDC40>]}
[0m17:22:05.494164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c86ab6d8-8432-45b9-b139-f9b83a0d2c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C0F10C80>]}
[0m17:22:05.494402 [info ] [MainThread]: Found 7 models, 4 data tests, 19 sources, 524 macros
[0m17:22:05.494402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c86ab6d8-8432-45b9-b139-f9b83a0d2c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C12B26F0>]}
[0m17:22:05.495945 [info ] [MainThread]: 
[0m17:22:05.496527 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:22:05.496987 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:22:05.556433 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:22:05.556433 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:22:05.556433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:05.576977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:22:05.576977 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:22:05.584987 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:22:05.584987 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:22:05.584987 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:22:05.584987 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:22:05.584987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:05.606933 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:22:05.606933 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:22:05.606933 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:22:05.606933 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:22:05.606933 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:22:05.606933 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:22:05.606933 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:22:05.606933 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:22:05.606933 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:22:05.606933 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:22:05.606933 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:22:05.615077 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:22:05.623955 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:22:05.626774 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:22:05.626774 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:22:05.626774 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:22:05.626774 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:22:05.626774 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:05.626774 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:22:05.645506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:22:05.645506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:05.645506 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:22:05.645506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:22:05.645506 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:22:05.645506 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:22:05.653937 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:22:05.676683 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:22:05.684608 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:22:05.684608 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:22:05.684608 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:22:05.684608 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:22:05.684608 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:22:05.684608 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:22:05.684608 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:22:05.696721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c86ab6d8-8432-45b9-b139-f9b83a0d2c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C0E72090>]}
[0m17:22:05.696721 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:05.696721 [debug] [MainThread]: On master: BEGIN
[0m17:22:05.696721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:05.715145 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:22:05.715145 [debug] [MainThread]: On master: COMMIT
[0m17:22:05.715145 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:05.715145 [debug] [MainThread]: On master: COMMIT
[0m17:22:05.715145 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:22:05.715145 [debug] [MainThread]: On master: Close
[0m17:22:05.723458 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:22:05.723458 [info ] [MainThread]: 
[0m17:22:05.726805 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:22:05.726805 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__basicincident  [RUN]
[0m17:22:05.726805 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:22:05.726805 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:22:05.734852 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:22:05.734852 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:22:05.757101 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:22:05.757101 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:22:05.757101 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: BEGIN
[0m17:22:05.757101 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:22:05.776690 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:22:05.776690 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:22:05.776690 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
    FROM basicincident_source
),

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_PER,
        EMS_PER_UPDATE AS EMS_PER,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ,
        DET_ALERT,
        HAZ_REL,
        MIXED_USE
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_final
    );
  
  
[0m17:22:30.155172 [debug] [Thread-1 (]: SQL status: OK in 24.0 seconds
[0m17:22:30.166027 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:22:30.166027 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident" rename to "nfirs_transformed__basicincident__dbt_backup"
[0m17:22:30.166027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:22:30.176609 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:22:30.176609 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp" rename to "nfirs_transformed__basicincident"
[0m17:22:30.176609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:22:30.216115 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: COMMIT
[0m17:22:30.216115 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:22:30.216115 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: COMMIT
[0m17:22:37.256286 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m17:22:37.265402 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:22:37.265402 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_backup" cascade
[0m17:22:37.306519 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:22:37.306519 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: Close
[0m17:22:40.550765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c86ab6d8-8432-45b9-b139-f9b83a0d2c57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217C173FE60>]}
[0m17:22:40.551931 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__basicincident  [[32mOK[0m in 34.82s]
[0m17:22:40.553487 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:22:40.556536 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:40.556536 [debug] [MainThread]: On master: BEGIN
[0m17:22:40.556536 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:22:40.585961 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:22:40.585961 [debug] [MainThread]: On master: COMMIT
[0m17:22:40.585961 [debug] [MainThread]: Using duckdb connection "master"
[0m17:22:40.585961 [debug] [MainThread]: On master: COMMIT
[0m17:22:40.585961 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:22:40.593581 [debug] [MainThread]: On master: Close
[0m17:22:40.604991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:40.613498 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:22:40.615031 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:22:40.615031 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:22:40.616563 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident' was properly closed.
[0m17:22:40.616563 [info ] [MainThread]: 
[0m17:22:40.616563 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 35.12 seconds (35.12s).
[0m17:22:40.616563 [debug] [MainThread]: Command end result
[0m17:22:40.673676 [info ] [MainThread]: 
[0m17:22:40.673676 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:22:40.673676 [info ] [MainThread]: 
[0m17:22:40.673676 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:22:40.673676 [debug] [MainThread]: Command `cli run` succeeded at 17:22:40.673676 after 35.74 seconds
[0m17:22:40.673676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BED92F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BF050770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217BF712780>]}
[0m17:22:40.673676 [debug] [MainThread]: Flushing usage events
[0m17:25:04.593143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCDCC48EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCDEFB3D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCDC74C110>]}


============================== 17:25:04.593143 | 64a5e2e0-3da4-4686-b39e-8c2fc6400504 ==============================
[0m17:25:04.593143 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:25:04.593143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:25:04.764748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64a5e2e0-3da4-4686-b39e-8c2fc6400504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE0BC9850>]}
[0m17:25:04.812063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64a5e2e0-3da4-4686-b39e-8c2fc6400504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCDF542360>]}
[0m17:25:04.812063 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:25:04.825066 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:25:04.961336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:04.961336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:04.994889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64a5e2e0-3da4-4686-b39e-8c2fc6400504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE0D903B0>]}
[0m17:25:05.073825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64a5e2e0-3da4-4686-b39e-8c2fc6400504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE1032B10>]}
[0m17:25:05.073825 [info ] [MainThread]: Found 7 models, 4 data tests, 19 sources, 524 macros
[0m17:25:05.073825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64a5e2e0-3da4-4686-b39e-8c2fc6400504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE0EDF680>]}
[0m17:25:05.082130 [info ] [MainThread]: 
[0m17:25:05.082130 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:25:05.083695 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:25:05.141296 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:25:05.141296 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:25:05.141296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:05.170095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:25:05.171208 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:25:05.174840 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:25:05.174840 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:25:05.174840 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:25:05.182903 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:25:05.182903 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:25:05.194841 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:25:05.194841 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:25:05.194841 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:25:05.203447 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:25:05.203447 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:25:05.203447 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:25:05.205611 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:25:05.206730 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:25:05.207846 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:25:05.207846 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:25:05.207846 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:25:05.209082 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:25:05.217103 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:25:05.221776 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:25:05.223308 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:25:05.223308 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:25:05.225677 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:25:05.225677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:05.225677 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:25:05.244497 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:25:05.244497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:05.244497 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:25:05.244497 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:25:05.244497 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:25:05.244497 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:25:05.244497 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:25:05.272620 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:25:05.282101 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:25:05.283239 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:25:05.283239 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:25:05.284855 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:25:05.284855 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:25:05.284855 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:25:05.284855 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:25:05.292910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64a5e2e0-3da4-4686-b39e-8c2fc6400504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCE0D93260>]}
[0m17:25:05.292910 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:05.292910 [debug] [MainThread]: On master: BEGIN
[0m17:25:05.292910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:05.314412 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:25:05.314412 [debug] [MainThread]: On master: COMMIT
[0m17:25:05.314412 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:05.314412 [debug] [MainThread]: On master: COMMIT
[0m17:25:05.314412 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:25:05.314412 [debug] [MainThread]: On master: Close
[0m17:25:05.322404 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:25:05.322404 [info ] [MainThread]: 
[0m17:25:05.322404 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:25:05.322404 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__basicincident  [RUN]
[0m17:25:05.322404 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident'
[0m17:25:05.322404 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:25:05.334670 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:25:05.334670 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:25:05.363697 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:25:05.365124 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:25:05.365767 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: BEGIN
[0m17:25:05.365767 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:25:05.382718 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:25:05.382718 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:25:05.382718 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ALARM --> DATETIME
    - ARRIVAL --> DATETIME
    - INC_CONT --> DATETIME
    - LU_CLEAR --> DATETIME
    - SUP_APP --> FLOAT
    - EMS_APP --> FLOAT
    - OTH_APP --> FLOAT
    - SUP_PER --> FLOAT
    - EMS_PER --> FLOAT
    - OTH_PER --> FLOAT
    - PROP_LOSS --> FLOAT
    - CONT_LOSS --> FLOAT
    - PROP_VAL --> FLOAT
    - CONT_VAL --> FLOAT
    - FF_DEATH --> FLOAT
    - OTH_DEATH --> FLOAT
    - FF_INJ --> FLOAT
    - OTH_INJ --> FLOAT
    
***/



WITH basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."basicincident"
),

basicincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ALARM, '%m%d%Y%H%M') AS ALARM_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(INC_CONT, '%m%d%Y%H%M') AS INC_CONT_UPDATE,
        STRPTIME(LU_CLEAR, '%m%d%Y%H%M') AS LU_CLEAR_UPDATE,
        CAST(SUP_APP AS FLOAT) AS SUP_APP_UPDATE,
        CAST(EMS_APP AS FLOAT) AS EMS_APP_UPDATE,
        CAST(OTH_APP AS FLOAT) AS OTH_APP_UPDATE,
        CAST(SUP_PER AS FLOAT) AS SUP_PER_UPDATE,
        CAST(EMS_PER AS FLOAT) AS EMS_PER_UPDATE,
        CAST(OTH_PER AS FLOAT) AS OTH_PER_UPDATE,
        CAST(PROP_LOSS AS FLOAT) AS PROP_LOSS_UPDATE,
        CAST(CONT_LOSS AS FLOAT) AS CONT_LOSS_UPDATE,
        CAST(PROP_VAL AS FLOAT) AS PROP_VAL_UPDATE,
        CAST(CONT_VAL AS FLOAT) AS CONT_VAL_UPDATE,
        CAST(FF_DEATH AS FLOAT) AS FF_DEATH_UPDATE,
        CAST(OTH_DEATH AS FLOAT) AS OTH_DEATH_UPDATE,
        CAST(FF_INJ AS FLOAT) AS FF_INJ_UPDATE,
        CAST(OTH_INJ AS FLOAT) AS OTH_INJ_UPDATE
    FROM basicincident_source
),

basicincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        DEPT_STA,
        INC_TYPE,
        ADD_WILD,
        AID,
        ALARM_UPDATE AS ALARM,
        ARRIVAL_UPDATE AS ARRIVAL,
        INC_CONT_UPDATE AS INC_CONT,
        LU_CLEAR_UPDATE AS LU_CLEAR,
        SHIFT,
        ALARMS,
        DISTRICT,
        ACT_TAK1,
        ACT_TAK2,
        ACT_TAK3,
        APP_MOD,
        SUP_APP_UPDATE AS SUP_APP,
        EMS_APP_UPDATE AS EMS_APP,
        OTH_APP_UPDATE AS OTH_APP,
        SUP_PER_UPDATE AS SUP_PER,
        EMS_PER_UPDATE AS EMS_PER,
        OTH_PER_UPDATE AS OTH_PER,
        RESOU_AID,
        PROP_LOSS_UPDATE AS PROP_LOSS,
        CONT_LOSS_UPDATE AS CONT_LOSS,
        PROP_VAL_UPDATE AS PROP_VAL,
        CONT_VAL_UPDATE AS CONT_VAL,
        FF_DEATH_UPDATE AS FF_DEATH,
        OTH_DEATH_UPDATE AS OTH_DEATH,
        FF_INJ_UPDATE AS FF_INJ,
        OTH_INJ_UPDATE AS OTH_INJ,
        DET_ALERT,
        HAZ_REL,
        MIXED_USE,
        PROP_USE,
        CENSUS
    FROM basicincident_col_data_type_update
)

SELECT * FROM basicincident_final
    );
  
  
[0m17:25:26.163901 [debug] [Thread-1 (]: SQL status: OK in 21.0 seconds
[0m17:25:26.171887 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:25:26.171887 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident" rename to "nfirs_transformed__basicincident__dbt_backup"
[0m17:25:26.171887 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:25:26.180107 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:25:26.180107 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_tmp" rename to "nfirs_transformed__basicincident"
[0m17:25:26.180107 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:25:26.203496 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: COMMIT
[0m17:25:26.203496 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:25:26.203496 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: COMMIT
[0m17:25:31.264195 [debug] [Thread-1 (]: SQL status: OK in 5.0 seconds
[0m17:25:31.272242 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"
[0m17:25:31.272242 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__basicincident"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident__dbt_backup" cascade
[0m17:25:31.433842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:25:31.433842 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__basicincident: Close
[0m17:25:33.712832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64a5e2e0-3da4-4686-b39e-8c2fc6400504', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCDF01B5F0>]}
[0m17:25:33.713957 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__basicincident  [[32mOK[0m in 28.39s]
[0m17:25:33.714894 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__basicincident
[0m17:25:33.718001 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:33.718980 [debug] [MainThread]: On master: BEGIN
[0m17:25:33.719491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:25:33.749475 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:25:33.749475 [debug] [MainThread]: On master: COMMIT
[0m17:25:33.749475 [debug] [MainThread]: Using duckdb connection "master"
[0m17:25:33.749475 [debug] [MainThread]: On master: COMMIT
[0m17:25:33.752582 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:25:33.752582 [debug] [MainThread]: On master: Close
[0m17:25:33.761908 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:33.762421 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:25:33.762971 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:25:33.763513 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:25:33.763954 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__basicincident' was properly closed.
[0m17:25:33.765572 [info ] [MainThread]: 
[0m17:25:33.765995 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 28.68 seconds (28.68s).
[0m17:25:33.766602 [debug] [MainThread]: Command end result
[0m17:25:33.794054 [info ] [MainThread]: 
[0m17:25:33.794593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:25:33.795592 [info ] [MainThread]: 
[0m17:25:33.796093 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:25:33.797189 [debug] [MainThread]: Command `cli run` succeeded at 17:25:33.796686 after 29.32 seconds
[0m17:25:33.797668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCDCC48EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCDF66BA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CCDF1043B0>]}
[0m17:25:33.798176 [debug] [MainThread]: Flushing usage events
[0m17:38:50.396770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5104C6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5104C4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A50FDCFE00>]}


============================== 17:38:50.400334 | c66d3d13-0742-4d39-8fa2-45e32a123017 ==============================
[0m17:38:50.400334 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:38:50.400334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:50.556281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c66d3d13-0742-4d39-8fa2-45e32a123017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A512088170>]}
[0m17:38:50.597416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c66d3d13-0742-4d39-8fa2-45e32a123017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5109ADE80>]}
[0m17:38:50.598417 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:38:50.608679 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:38:50.728795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:50.728795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:50.759884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c66d3d13-0742-4d39-8fa2-45e32a123017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A512244770>]}
[0m17:38:50.834655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c66d3d13-0742-4d39-8fa2-45e32a123017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5124E37A0>]}
[0m17:38:50.835700 [info ] [MainThread]: Found 8 models, 4 data tests, 19 sources, 524 macros
[0m17:38:50.835700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c66d3d13-0742-4d39-8fa2-45e32a123017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5122631D0>]}
[0m17:38:50.836665 [info ] [MainThread]: 
[0m17:38:50.837677 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:38:50.838686 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:38:50.902429 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:38:50.902429 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:38:50.902429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:50.923422 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:50.924493 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:38:50.929428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:38:50.929428 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:38:50.934466 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:38:50.935464 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:38:50.935464 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:50.953771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:50.954732 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:38:50.954732 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:38:50.955736 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:50.955736 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:38:50.955736 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:38:50.956803 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:50.957742 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:38:50.957742 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:38:50.958800 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:38:50.958800 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:50.959784 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:38:50.967846 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:38:50.968889 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:38:50.973852 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:38:50.974845 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:38:50.975845 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:38:50.976846 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:38:50.976846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:50.977845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:50.995919 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:50.995919 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:50.996918 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:38:50.996918 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:38:50.997918 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:38:50.997918 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:38:51.025117 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:51.028117 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:38:51.029117 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:38:51.030117 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:38:51.031117 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:38:51.032117 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:38:51.032117 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:38:51.033117 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:38:51.039197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c66d3d13-0742-4d39-8fa2-45e32a123017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A50F86BB30>]}
[0m17:38:51.040248 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:51.040248 [debug] [MainThread]: On master: BEGIN
[0m17:38:51.040248 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:51.057716 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:38:51.057716 [debug] [MainThread]: On master: COMMIT
[0m17:38:51.058723 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:51.058723 [debug] [MainThread]: On master: COMMIT
[0m17:38:51.058723 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:38:51.059714 [debug] [MainThread]: On master: Close
[0m17:38:51.063615 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:38:51.063615 [info ] [MainThread]: 
[0m17:38:51.067611 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty
[0m17:38:51.067611 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__civiliancasualty  [RUN]
[0m17:38:51.068615 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty'
[0m17:38:51.068615 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty
[0m17:38:51.074656 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"
[0m17:38:51.076623 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty
[0m17:38:51.100872 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"
[0m17:38:51.102835 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"
[0m17:38:51.102835 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty: BEGIN
[0m17:38:51.102835 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:38:51.120461 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:38:51.121453 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"
[0m17:38:51.121453 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Civilian Casualty Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - AGE --> INTEGER
    - INJ_DT_TIM --> DATETIME
    - STORY_INC --> FLOAT
    - STOR_INJ --> FLOAT
***/



WITH civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."civiliancasualty"
),

WITH civiliancasualty_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        STRPTIME(INJ_DT_TIM, '%m%d%Y%H%M') AS INJ_DT_TIM_UPDATE,
        CAST(STORY_INC AS FLOAT) AS STORY_INC_UPDATE,
        CAST(STORY_INJ AS FLOAT) AS STORY_INJ_UPDATE
    FROM civiliancasualty_source
),

WITH civiliancasualty_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SEQ_NUMBER,
        VERSION,
        GENDER,
        AGE_UPDATE AS AGE,
        RACE,
        ETHNICITY,
        AFFILIAT,
        INJ_DT_TIM_UPDATE AS INJ_DT_TM,
        SEV,
        CAUSE_INJ,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_INJ1,
        FACT_INJ2,
        FACT_INJ3,
        ACTIV_INJ,
        LOC_INC,
        GEN_LOC_IN,
        STORY_INC_UPDATE AS STORY_INC,
        STORY_INJ_UPDATE AS STORY_INJ,
        SPC_LOC_IN,
        PRIM_SYMP,
        BODY_PART,
        CC_DISPOS
    FROM civiliancasualty_col_data_type_update
)

SELECT * FROM civiliancasualty_final
    );
  
  
[0m17:38:51.122450 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Civilian Casualty Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - AGE --> INTEGER
    - INJ_DT_TIM --> DATETIME
    - STORY_INC --> FLOAT
    - STOR_INJ --> FLOAT
***/



WITH civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."civiliancasualty"
),

WITH civiliancasualty_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        STRPTIME(INJ_DT_TIM, '%m%d%Y%H%M') AS INJ_DT_TIM_UPDATE,
        CAST(STORY_INC AS FLOAT) AS STORY_INC_UPDATE,
        CAST(STORY_INJ AS FLOAT) AS STORY_INJ_UPDATE
    FROM civiliancasualty_source
),

WITH civiliancasualty_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SEQ_NUMBER,
        VERSION,
        GENDER,
        AGE_UPDATE AS AGE,
        RACE,
        ETHNICITY,
        AFFILIAT,
        INJ_DT_TIM_UPDATE AS INJ_DT_TM,
        SEV,
        CAUSE_INJ,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_INJ1,
        FACT_INJ2,
        FACT_INJ3,
        ACTIV_INJ,
        LOC_INC,
        GEN_LOC_IN,
        STORY_INC_UPDATE AS STORY_INC,
        STORY_INJ_UPDATE AS STORY_INJ,
        SPC_LOC_IN,
        PRIM_SYMP,
        BODY_PART,
        CC_DISPOS
    FROM civiliancasualty_col_data_type_update
)

SELECT * FROM civiliancasualty_final
    );
  
  
[0m17:38:51.122450 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:38:51.123519 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty: ROLLBACK
[0m17:38:51.127518 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty'
[0m17:38:51.127518 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty: Close
[0m17:38:51.133606 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__civiliancasualty (models\nfirs_transformed\nfirs_transformed__civiliancasualty.sql)
  Parser Error: syntax error at or near "WITH"
[0m17:38:51.135619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c66d3d13-0742-4d39-8fa2-45e32a123017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5124E3C50>]}
[0m17:38:51.135619 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__civiliancasualty  [[31mERROR[0m in 0.07s]
[0m17:38:51.136606 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty
[0m17:38:51.139250 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:51.140282 [debug] [MainThread]: On master: BEGIN
[0m17:38:51.140839 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:51.161222 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:38:51.162472 [debug] [MainThread]: On master: COMMIT
[0m17:38:51.162472 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:51.163153 [debug] [MainThread]: On master: COMMIT
[0m17:38:51.163760 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:38:51.163856 [debug] [MainThread]: On master: Close
[0m17:38:51.168305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:51.168305 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:38:51.168305 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:38:51.169305 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:38:51.169305 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty' was properly closed.
[0m17:38:51.169305 [info ] [MainThread]: 
[0m17:38:51.170336 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m17:38:51.170336 [debug] [MainThread]: Command end result
[0m17:38:51.195073 [info ] [MainThread]: 
[0m17:38:51.196073 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:38:51.196073 [info ] [MainThread]: 
[0m17:38:51.196073 [error] [MainThread]:   Runtime Error in model nfirs_transformed__civiliancasualty (models\nfirs_transformed\nfirs_transformed__civiliancasualty.sql)
  Parser Error: syntax error at or near "WITH"
[0m17:38:51.197064 [info ] [MainThread]: 
[0m17:38:51.197064 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:38:51.198064 [debug] [MainThread]: Command `cli run` failed at 17:38:51.198064 after 0.91 seconds
[0m17:38:51.198064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A511AC0DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A511AEBBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A511AEA8A0>]}
[0m17:38:51.199071 [debug] [MainThread]: Flushing usage events
[0m17:39:11.650107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002200CA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001FFA3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001FFA3500>]}


============================== 17:39:11.654181 | 0a759584-ce97-4df0-b5e8-ddf1f5e035a0 ==============================
[0m17:39:11.654181 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:39:11.654181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:39:11.806071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a759584-ce97-4df0-b5e8-ddf1f5e035a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001FA40740>]}
[0m17:39:11.848906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a759584-ce97-4df0-b5e8-ddf1f5e035a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200221BDC40>]}
[0m17:39:11.849912 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:39:11.859128 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:39:11.978671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:39:11.978671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:39:12.009985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a759584-ce97-4df0-b5e8-ddf1f5e035a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200223E3C50>]}
[0m17:39:12.087760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a759584-ce97-4df0-b5e8-ddf1f5e035a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200223E2E70>]}
[0m17:39:12.088759 [info ] [MainThread]: Found 8 models, 4 data tests, 19 sources, 524 macros
[0m17:39:12.088759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a759584-ce97-4df0-b5e8-ddf1f5e035a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002237CE90>]}
[0m17:39:12.090635 [info ] [MainThread]: 
[0m17:39:12.090635 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:39:12.091633 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:39:12.149883 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:39:12.150905 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:39:12.150905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:12.171068 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:39:12.171898 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:39:12.177759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:39:12.177759 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:39:12.182841 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:39:12.183847 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:39:12.183847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:39:12.201933 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:39:12.202935 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:39:12.203935 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:39:12.203935 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:39:12.203935 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:39:12.204934 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:39:12.204934 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:39:12.205935 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:39:12.205935 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:39:12.205935 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:39:12.206934 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:39:12.206934 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:39:12.215203 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:39:12.216391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:39:12.220471 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:39:12.222661 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:39:12.222661 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:39:12.222661 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:39:12.223664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:12.223664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:12.241819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:39:12.241819 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:39:12.241819 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:39:12.242898 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:39:12.242898 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:39:12.242898 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:39:12.269882 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:39:12.272878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:39:12.273878 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:39:12.274879 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:39:12.274879 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:39:12.276908 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:39:12.277886 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:39:12.278877 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:39:12.284889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a759584-ce97-4df0-b5e8-ddf1f5e035a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200229ED2B0>]}
[0m17:39:12.285884 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:12.285884 [debug] [MainThread]: On master: BEGIN
[0m17:39:12.285884 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:39:12.303605 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:39:12.304133 [debug] [MainThread]: On master: COMMIT
[0m17:39:12.304133 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:12.304133 [debug] [MainThread]: On master: COMMIT
[0m17:39:12.305192 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:39:12.305192 [debug] [MainThread]: On master: Close
[0m17:39:12.309250 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:39:12.309250 [info ] [MainThread]: 
[0m17:39:12.314474 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty
[0m17:39:12.315482 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__civiliancasualty  [RUN]
[0m17:39:12.315482 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty'
[0m17:39:12.316474 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty
[0m17:39:12.322139 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"
[0m17:39:12.323142 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty
[0m17:39:12.346449 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"
[0m17:39:12.347449 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"
[0m17:39:12.347449 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty: BEGIN
[0m17:39:12.348459 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:39:12.364575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:12.365575 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"
[0m17:39:12.365575 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Civilian Casualty Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - AGE --> INTEGER
    - INJ_DT_TIM --> DATETIME
    - STORY_INC --> FLOAT
    - STOR_INJ --> FLOAT
***/



WITH civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."civiliancasualty"
),

civiliancasualty_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        STRPTIME(INJ_DT_TIM, '%m%d%Y%H%M') AS INJ_DT_TIM_UPDATE,
        CAST(STORY_INC AS FLOAT) AS STORY_INC_UPDATE,
        CAST(STORY_INJ AS FLOAT) AS STORY_INJ_UPDATE
    FROM civiliancasualty_source
),

civiliancasualty_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SEQ_NUMBER,
        VERSION,
        GENDER,
        AGE_UPDATE AS AGE,
        RACE,
        ETHNICITY,
        AFFILIAT,
        INJ_DT_TIM_UPDATE AS INJ_DT_TM,
        SEV,
        CAUSE_INJ,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_INJ1,
        FACT_INJ2,
        FACT_INJ3,
        ACTIV_INJ,
        LOC_INC,
        GEN_LOC_IN,
        STORY_INC_UPDATE AS STORY_INC,
        STORY_INJ_UPDATE AS STORY_INJ,
        SPC_LOC_IN,
        PRIM_SYMP,
        BODY_PART,
        CC_DISPOS
    FROM civiliancasualty_col_data_type_update
)

SELECT * FROM civiliancasualty_final
    );
  
  
[0m17:39:12.391937 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:12.396833 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"
[0m17:39:12.397833 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty__dbt_tmp" rename to "nfirs_transformed__civiliancasualty"
[0m17:39:12.397833 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:12.411044 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty: COMMIT
[0m17:39:12.411044 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"
[0m17:39:12.411831 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty: COMMIT
[0m17:39:12.428648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:12.434220 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"
[0m17:39:12.434220 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty__dbt_backup" cascade
[0m17:39:12.435215 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:39:12.437216 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty: Close
[0m17:39:12.754302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a759584-ce97-4df0-b5e8-ddf1f5e035a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001FA0B830>]}
[0m17:39:12.755552 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__civiliancasualty  [[32mOK[0m in 0.44s]
[0m17:39:12.756581 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty
[0m17:39:12.758589 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:12.758589 [debug] [MainThread]: On master: BEGIN
[0m17:39:12.758589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:39:12.776584 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:39:12.777589 [debug] [MainThread]: On master: COMMIT
[0m17:39:12.777589 [debug] [MainThread]: Using duckdb connection "master"
[0m17:39:12.777589 [debug] [MainThread]: On master: COMMIT
[0m17:39:12.778554 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:39:12.778554 [debug] [MainThread]: On master: Close
[0m17:39:12.783229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:12.784195 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:39:12.784195 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:39:12.785194 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:39:12.785194 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__civiliancasualty' was properly closed.
[0m17:39:12.786194 [info ] [MainThread]: 
[0m17:39:12.786194 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m17:39:12.787194 [debug] [MainThread]: Command end result
[0m17:39:12.808390 [info ] [MainThread]: 
[0m17:39:12.809349 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:39:12.809349 [info ] [MainThread]: 
[0m17:39:12.810389 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:39:12.810389 [debug] [MainThread]: Command `cli run` succeeded at 17:39:12.810389 after 1.26 seconds
[0m17:39:12.811377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002207CEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020020B835F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020020B83260>]}
[0m17:39:12.811377 [debug] [MainThread]: Flushing usage events
[0m17:43:32.154910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D985BE870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D985BC2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D985BCAA0>]}


============================== 17:43:32.157910 | c92c6e1c-63d1-4ea7-aa02-bc913bd5774a ==============================
[0m17:43:32.157910 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:43:32.158902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:43:32.314253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c92c6e1c-63d1-4ea7-aa02-bc913bd5774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D987C9790>]}
[0m17:43:32.354050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c92c6e1c-63d1-4ea7-aa02-bc913bd5774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D95F54320>]}
[0m17:43:32.356050 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:43:32.365641 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:43:32.483518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:43:32.484484 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:43:32.514837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c92c6e1c-63d1-4ea7-aa02-bc913bd5774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D989CF500>]}
[0m17:43:32.589498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c92c6e1c-63d1-4ea7-aa02-bc913bd5774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D98A55850>]}
[0m17:43:32.590498 [info ] [MainThread]: Found 9 models, 4 data tests, 19 sources, 524 macros
[0m17:43:32.590498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92c6e1c-63d1-4ea7-aa02-bc913bd5774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D988F03B0>]}
[0m17:43:32.591771 [info ] [MainThread]: 
[0m17:43:32.592781 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:43:32.593767 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:43:32.651864 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:43:32.652901 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:43:32.652901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:32.673315 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:32.674313 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:43:32.679318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:43:32.679318 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:43:32.684452 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:43:32.685520 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:43:32.685520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:32.703212 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:32.705209 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:43:32.705209 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:43:32.706201 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:32.706201 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:43:32.706201 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:43:32.707209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:32.707209 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:43:32.708209 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:43:32.708209 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:43:32.708209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:32.709201 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:43:32.716926 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:43:32.717926 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:43:32.721927 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:43:32.723926 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:43:32.723926 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:43:32.724919 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:43:32.724919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:32.725919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:32.742745 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:32.742745 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:32.743745 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:43:32.743745 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:43:32.744745 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:43:32.744745 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:43:32.771274 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:32.774574 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:43:32.776567 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:43:32.777567 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:43:32.778577 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:43:32.778577 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:43:32.779575 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:43:32.781425 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:43:32.787210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92c6e1c-63d1-4ea7-aa02-bc913bd5774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D9894CA40>]}
[0m17:43:32.788211 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:32.788211 [debug] [MainThread]: On master: BEGIN
[0m17:43:32.788211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:32.806182 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:43:32.806182 [debug] [MainThread]: On master: COMMIT
[0m17:43:32.807182 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:32.807182 [debug] [MainThread]: On master: COMMIT
[0m17:43:32.808181 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:43:32.808181 [debug] [MainThread]: On master: Close
[0m17:43:32.812182 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:43:32.812182 [info ] [MainThread]: 
[0m17:43:32.816670 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__codelookup
[0m17:43:32.817712 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__codelookup ... [RUN]
[0m17:43:32.817712 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__codelookup'
[0m17:43:32.818719 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__codelookup
[0m17:43:32.823924 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__codelookup"
[0m17:43:32.825919 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__codelookup
[0m17:43:32.850879 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__codelookup"
[0m17:43:32.859997 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__codelookup"
[0m17:43:32.860997 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__codelookup: BEGIN
[0m17:43:32.860997 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:32.877997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:32.878997 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__codelookup"
[0m17:43:32.878997 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__codelookup: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__codelookup"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Basic Incident Table Creation *****/
/***
No data transformations required. Table will be a copy of the raw table.
    
***/



WITH codelookup_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."codelookup"
),

codelookup_final AS (
    SELECT
        FIELDID,
        CODE_VALUE,
        CODE_DESCR
    FROM codelookup_source
)

SELECT * FROM codelookup_final
    );
  
  
[0m17:43:32.883997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:32.888997 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__codelookup"
[0m17:43:32.888997 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__codelookup: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__codelookup"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup__dbt_tmp" rename to "nfirs_transformed__codelookup"
[0m17:43:32.889997 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:32.903997 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__codelookup: COMMIT
[0m17:43:32.903997 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__codelookup"
[0m17:43:32.903997 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__codelookup: COMMIT
[0m17:43:32.909987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:32.914404 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__codelookup"
[0m17:43:32.914404 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__codelookup: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__codelookup"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup__dbt_backup" cascade
[0m17:43:32.914987 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:43:32.916987 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__codelookup: Close
[0m17:43:33.189606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92c6e1c-63d1-4ea7-aa02-bc913bd5774a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D96C177A0>]}
[0m17:43:33.190599 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__codelookup  [[32mOK[0m in 0.37s]
[0m17:43:33.190599 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__codelookup
[0m17:43:33.192519 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:33.193527 [debug] [MainThread]: On master: BEGIN
[0m17:43:33.193527 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:43:33.209791 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:43:33.210891 [debug] [MainThread]: On master: COMMIT
[0m17:43:33.210891 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:33.211778 [debug] [MainThread]: On master: COMMIT
[0m17:43:33.211778 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:43:33.211778 [debug] [MainThread]: On master: Close
[0m17:43:33.216516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:33.217516 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:43:33.217516 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:43:33.218517 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:43:33.218517 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__codelookup' was properly closed.
[0m17:43:33.219516 [info ] [MainThread]: 
[0m17:43:33.221515 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m17:43:33.221515 [debug] [MainThread]: Command end result
[0m17:43:33.243225 [info ] [MainThread]: 
[0m17:43:33.244225 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:43:33.244225 [info ] [MainThread]: 
[0m17:43:33.245224 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:43:33.246224 [debug] [MainThread]: Command `cli run` succeeded at 17:43:33.246224 after 1.21 seconds
[0m17:43:33.246224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D987594F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D98A36C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018D98AA7F50>]}
[0m17:43:33.247226 [debug] [MainThread]: Flushing usage events
[0m17:54:49.508217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3CBFF8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3F6DCC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3F6DF440>]}


============================== 17:54:49.512287 | b69c953e-da74-411a-ae85-b18fac615a22 ==============================
[0m17:54:49.512287 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:54:49.512287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:54:49.668408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b69c953e-da74-411a-ae85-b18fac615a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3F9F34D0>]}
[0m17:54:49.711741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b69c953e-da74-411a-ae85-b18fac615a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3F8E0410>]}
[0m17:54:49.713839 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:54:49.723901 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:54:49.851116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:54:49.851116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:54:49.883258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b69c953e-da74-411a-ae85-b18fac615a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3FBB9A90>]}
[0m17:54:49.961224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b69c953e-da74-411a-ae85-b18fac615a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3FD66DE0>]}
[0m17:54:49.962225 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m17:54:49.962225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b69c953e-da74-411a-ae85-b18fac615a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3FB93CE0>]}
[0m17:54:49.963203 [info ] [MainThread]: 
[0m17:54:49.964199 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:54:49.965211 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:54:50.024311 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:54:50.024311 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:54:50.024311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:50.045080 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:50.047086 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:54:50.051080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:54:50.052080 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:54:50.056119 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:54:50.057111 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:54:50.057111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:54:50.074590 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:50.075604 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:54:50.076602 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:54:50.076602 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:50.077598 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:54:50.077598 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:54:50.077598 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:50.078590 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:54:50.078590 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:54:50.079597 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:54:50.079597 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:50.079597 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:54:50.088705 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:54:50.092740 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:54:50.093789 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:54:50.093789 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:54:50.095789 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:54:50.095789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:50.095789 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:54:50.113036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:54:50.113036 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:50.114130 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:50.114130 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:54:50.115093 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:54:50.115093 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:54:50.115093 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:54:50.141588 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:50.144662 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:54:50.145630 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:54:50.146671 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:54:50.147659 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:54:50.148667 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:54:50.148667 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:54:50.148667 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:54:50.155757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b69c953e-da74-411a-ae85-b18fac615a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3FD5F380>]}
[0m17:54:50.155757 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:50.156737 [debug] [MainThread]: On master: BEGIN
[0m17:54:50.156737 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:54:50.173991 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:54:50.173991 [debug] [MainThread]: On master: COMMIT
[0m17:54:50.175032 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:50.175032 [debug] [MainThread]: On master: COMMIT
[0m17:54:50.175032 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:54:50.176024 [debug] [MainThread]: On master: Close
[0m17:54:50.179999 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:54:50.179999 [info ] [MainThread]: 
[0m17:54:50.184128 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m17:54:50.184128 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__wildlands .... [RUN]
[0m17:54:50.185136 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m17:54:50.185136 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m17:54:50.191186 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:54:50.200191 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m17:54:50.225188 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:54:50.227188 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:54:50.228188 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: BEGIN
[0m17:54:50.228188 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:54:50.245187 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:54:50.246191 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:54:50.246191 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed EMS Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ARRIVAL --> DATETIME
    - TRANSPORT --> DATETIME
    - AGE --> INTEGER
***/



WITH ems_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."ems"
)

ems_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(TRANSPORT, '%m%d%Y%H%M') AS TRANSPORT_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE
),

ems_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        PATIENT_NO,
        VERSION,
        ARRIVAL_UPDATE AS ARRIVAL,
        TRANSPORT_UPDATE AS TRANSPORT,
        PROVIDER_A,
        AGE_UPDATE,
        GENDER,
        RACE,
        ETH_EMS,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        OTHER_FACT,
        SITE_INJ1,
        SITE_INJ2,
        SITE_INJ3,
        SITE_INJ4,
        SITE_INJ5,
        INJ_TYPE1,
        INJ_TYPE2,
        INJ_TYPE3,
        INJ_TYPE4,
        INJ_TYPE5,
        CAUSE_ILL,
        PROC_USE1,
        PROC_USE2,
        PROC_USE3,
        PROC_USE4,
        PROC_USE5,
        PROC_USE6,
        PROC_USE7,
        PROC_USE8,
        PROC_USE9,
        PROC_USE10,
        PROC_USE11,
        PROC_USE12,
        PROC_USE13,
        PROC_USE14,
        PROC_USE15,
        PROC_USE16,
        PROC_USE17,
        PROC_USE18,
        PROC_USE19,
        PROC_USE20,
        PROC_USE21,
        PROC_USE22,
        PROC_USE23,
        PROC_USE24,
        PROC_USE25,
        SAFE_EQP1,
        SAFE_EQP2,
        SAFE_EQP3,
        SAFE_EQP4,
        SAFE_EQP5,
        SAFE_EQP6,
        SAFE_EQP7,
        SAFE_EQP8,
        ARREST,
        ARR_DES1,
        ARR_DES2,
        AR_RHYTHM,
        IL_CARE,
        HIGH_CARE,
        PAT_STATUS,
        PULSE,
        EMS_DISPO,
    FROM ems_col_data_type_update
)

SELECT * FROM ems_final
    );
  
  
[0m17:54:50.247187 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed EMS Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ARRIVAL --> DATETIME
    - TRANSPORT --> DATETIME
    - AGE --> INTEGER
***/



WITH ems_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."ems"
)

ems_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(TRANSPORT, '%m%d%Y%H%M') AS TRANSPORT_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE
),

ems_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        PATIENT_NO,
        VERSION,
        ARRIVAL_UPDATE AS ARRIVAL,
        TRANSPORT_UPDATE AS TRANSPORT,
        PROVIDER_A,
        AGE_UPDATE,
        GENDER,
        RACE,
        ETH_EMS,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        OTHER_FACT,
        SITE_INJ1,
        SITE_INJ2,
        SITE_INJ3,
        SITE_INJ4,
        SITE_INJ5,
        INJ_TYPE1,
        INJ_TYPE2,
        INJ_TYPE3,
        INJ_TYPE4,
        INJ_TYPE5,
        CAUSE_ILL,
        PROC_USE1,
        PROC_USE2,
        PROC_USE3,
        PROC_USE4,
        PROC_USE5,
        PROC_USE6,
        PROC_USE7,
        PROC_USE8,
        PROC_USE9,
        PROC_USE10,
        PROC_USE11,
        PROC_USE12,
        PROC_USE13,
        PROC_USE14,
        PROC_USE15,
        PROC_USE16,
        PROC_USE17,
        PROC_USE18,
        PROC_USE19,
        PROC_USE20,
        PROC_USE21,
        PROC_USE22,
        PROC_USE23,
        PROC_USE24,
        PROC_USE25,
        SAFE_EQP1,
        SAFE_EQP2,
        SAFE_EQP3,
        SAFE_EQP4,
        SAFE_EQP5,
        SAFE_EQP6,
        SAFE_EQP7,
        SAFE_EQP8,
        ARREST,
        ARR_DES1,
        ARR_DES2,
        AR_RHYTHM,
        IL_CARE,
        HIGH_CARE,
        PAT_STATUS,
        PULSE,
        EMS_DISPO,
    FROM ems_col_data_type_update
)

SELECT * FROM ems_final
    );
  
  
[0m17:54:50.247187 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:54:50.248186 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: ROLLBACK
[0m17:54:50.252190 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m17:54:50.252190 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: Close
[0m17:54:50.258186 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Parser Error: syntax error at or near "ems_col_data_type_update"
[0m17:54:50.259192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b69c953e-da74-411a-ae85-b18fac615a22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3DDA39B0>]}
[0m17:54:50.260185 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__wildlands  [[31mERROR[0m in 0.07s]
[0m17:54:50.260185 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m17:54:50.263263 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:50.263263 [debug] [MainThread]: On master: BEGIN
[0m17:54:50.263263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:54:50.280184 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:54:50.281184 [debug] [MainThread]: On master: COMMIT
[0m17:54:50.281184 [debug] [MainThread]: Using duckdb connection "master"
[0m17:54:50.281184 [debug] [MainThread]: On master: COMMIT
[0m17:54:50.282184 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:54:50.282184 [debug] [MainThread]: On master: Close
[0m17:54:50.286187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:54:50.287187 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:54:50.287187 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:54:50.288187 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:54:50.288187 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands' was properly closed.
[0m17:54:50.288187 [info ] [MainThread]: 
[0m17:54:50.289188 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m17:54:50.289188 [debug] [MainThread]: Command end result
[0m17:54:50.313321 [info ] [MainThread]: 
[0m17:54:50.314321 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:54:50.314321 [info ] [MainThread]: 
[0m17:54:50.315322 [error] [MainThread]:   Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Parser Error: syntax error at or near "ems_col_data_type_update"
[0m17:54:50.315322 [info ] [MainThread]: 
[0m17:54:50.315322 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:54:50.316322 [debug] [MainThread]: Command `cli run` failed at 17:54:50.316322 after 0.91 seconds
[0m17:54:50.317329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3CBFF8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3F437A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3B4DC110>]}
[0m17:54:50.317329 [debug] [MainThread]: Flushing usage events
[0m17:55:04.418795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AF49F710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B0669EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B066A4B0>]}


============================== 17:55:04.422799 | 32212b63-2c65-4ebf-847e-c2af0b2701be ==============================
[0m17:55:04.422799 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:55:04.422799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:55:04.577621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32212b63-2c65-4ebf-847e-c2af0b2701be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B22902F0>]}
[0m17:55:04.619270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32212b63-2c65-4ebf-847e-c2af0b2701be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AFF84CE0>]}
[0m17:55:04.620270 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:55:04.630592 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:55:04.755180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:04.755180 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:04.787114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32212b63-2c65-4ebf-847e-c2af0b2701be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B234F230>]}
[0m17:55:04.862715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32212b63-2c65-4ebf-847e-c2af0b2701be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B261EAB0>]}
[0m17:55:04.863757 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m17:55:04.863757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32212b63-2c65-4ebf-847e-c2af0b2701be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B242A600>]}
[0m17:55:04.865816 [info ] [MainThread]: 
[0m17:55:04.865816 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:55:04.866827 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:55:04.925066 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:55:04.925994 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:55:04.925994 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:04.945987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:04.946977 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:55:04.952284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:55:04.953350 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:55:04.958356 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:55:04.958356 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:55:04.958356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:04.976379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:04.977379 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:55:04.977379 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:55:04.978379 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:04.978379 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:55:04.978379 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:55:04.979386 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:04.980387 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:55:04.980387 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:55:04.980387 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:55:04.981287 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:04.981287 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:55:04.990281 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:55:04.990281 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:55:04.994293 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:55:04.996292 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:55:04.996292 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:55:04.996292 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:55:04.997284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:04.997284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:05.013987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:05.014987 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:05.014987 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:55:05.015987 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:55:05.016987 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:55:05.016987 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:55:05.043407 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:05.047337 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:05.048378 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:55:05.049387 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:55:05.050337 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:55:05.051450 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:55:05.051450 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:55:05.051450 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:55:05.058614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32212b63-2c65-4ebf-847e-c2af0b2701be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B2635EB0>]}
[0m17:55:05.058614 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:05.058614 [debug] [MainThread]: On master: BEGIN
[0m17:55:05.059612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:05.075438 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:55:05.076438 [debug] [MainThread]: On master: COMMIT
[0m17:55:05.076438 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:05.076438 [debug] [MainThread]: On master: COMMIT
[0m17:55:05.077430 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:55:05.077430 [debug] [MainThread]: On master: Close
[0m17:55:05.081715 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:55:05.081715 [info ] [MainThread]: 
[0m17:55:05.085641 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m17:55:05.086607 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__wildlands .... [RUN]
[0m17:55:05.086607 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m17:55:05.087616 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m17:55:05.092745 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:55:05.093745 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m17:55:05.118478 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:55:05.119477 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:55:05.119477 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: BEGIN
[0m17:55:05.119477 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:55:05.136532 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:55:05.136532 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:55:05.137527 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed EMS Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ARRIVAL --> DATETIME
    - TRANSPORT --> DATETIME
    - AGE --> INTEGER
***/



WITH ems_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."ems"
),

ems_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(TRANSPORT, '%m%d%Y%H%M') AS TRANSPORT_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE
),

ems_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        PATIENT_NO,
        VERSION,
        ARRIVAL_UPDATE AS ARRIVAL,
        TRANSPORT_UPDATE AS TRANSPORT,
        PROVIDER_A,
        AGE_UPDATE,
        GENDER,
        RACE,
        ETH_EMS,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        OTHER_FACT,
        SITE_INJ1,
        SITE_INJ2,
        SITE_INJ3,
        SITE_INJ4,
        SITE_INJ5,
        INJ_TYPE1,
        INJ_TYPE2,
        INJ_TYPE3,
        INJ_TYPE4,
        INJ_TYPE5,
        CAUSE_ILL,
        PROC_USE1,
        PROC_USE2,
        PROC_USE3,
        PROC_USE4,
        PROC_USE5,
        PROC_USE6,
        PROC_USE7,
        PROC_USE8,
        PROC_USE9,
        PROC_USE10,
        PROC_USE11,
        PROC_USE12,
        PROC_USE13,
        PROC_USE14,
        PROC_USE15,
        PROC_USE16,
        PROC_USE17,
        PROC_USE18,
        PROC_USE19,
        PROC_USE20,
        PROC_USE21,
        PROC_USE22,
        PROC_USE23,
        PROC_USE24,
        PROC_USE25,
        SAFE_EQP1,
        SAFE_EQP2,
        SAFE_EQP3,
        SAFE_EQP4,
        SAFE_EQP5,
        SAFE_EQP6,
        SAFE_EQP7,
        SAFE_EQP8,
        ARREST,
        ARR_DES1,
        ARR_DES2,
        AR_RHYTHM,
        IL_CARE,
        HIGH_CARE,
        PAT_STATUS,
        PULSE,
        EMS_DISPO,
    FROM ems_col_data_type_update
)

SELECT * FROM ems_final
    );
  
  
[0m17:55:05.138526 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed EMS Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ARRIVAL --> DATETIME
    - TRANSPORT --> DATETIME
    - AGE --> INTEGER
***/



WITH ems_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."ems"
),

ems_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(TRANSPORT, '%m%d%Y%H%M') AS TRANSPORT_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE
),

ems_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        PATIENT_NO,
        VERSION,
        ARRIVAL_UPDATE AS ARRIVAL,
        TRANSPORT_UPDATE AS TRANSPORT,
        PROVIDER_A,
        AGE_UPDATE,
        GENDER,
        RACE,
        ETH_EMS,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        OTHER_FACT,
        SITE_INJ1,
        SITE_INJ2,
        SITE_INJ3,
        SITE_INJ4,
        SITE_INJ5,
        INJ_TYPE1,
        INJ_TYPE2,
        INJ_TYPE3,
        INJ_TYPE4,
        INJ_TYPE5,
        CAUSE_ILL,
        PROC_USE1,
        PROC_USE2,
        PROC_USE3,
        PROC_USE4,
        PROC_USE5,
        PROC_USE6,
        PROC_USE7,
        PROC_USE8,
        PROC_USE9,
        PROC_USE10,
        PROC_USE11,
        PROC_USE12,
        PROC_USE13,
        PROC_USE14,
        PROC_USE15,
        PROC_USE16,
        PROC_USE17,
        PROC_USE18,
        PROC_USE19,
        PROC_USE20,
        PROC_USE21,
        PROC_USE22,
        PROC_USE23,
        PROC_USE24,
        PROC_USE25,
        SAFE_EQP1,
        SAFE_EQP2,
        SAFE_EQP3,
        SAFE_EQP4,
        SAFE_EQP5,
        SAFE_EQP6,
        SAFE_EQP7,
        SAFE_EQP8,
        ARREST,
        ARR_DES1,
        ARR_DES2,
        AR_RHYTHM,
        IL_CARE,
        HIGH_CARE,
        PAT_STATUS,
        PULSE,
        EMS_DISPO,
    FROM ems_col_data_type_update
)

SELECT * FROM ems_final
    );
  
  
[0m17:55:05.138526 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:55:05.139526 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: ROLLBACK
[0m17:55:05.143548 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m17:55:05.143548 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: Close
[0m17:55:05.148772 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Binder Error: * expression without FROM clause!
[0m17:55:05.150779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32212b63-2c65-4ebf-847e-c2af0b2701be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B063F5F0>]}
[0m17:55:05.150779 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__wildlands  [[31mERROR[0m in 0.06s]
[0m17:55:05.151758 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m17:55:05.153792 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:05.153792 [debug] [MainThread]: On master: BEGIN
[0m17:55:05.153792 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:05.170785 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:55:05.171961 [debug] [MainThread]: On master: COMMIT
[0m17:55:05.171961 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:05.171961 [debug] [MainThread]: On master: COMMIT
[0m17:55:05.173127 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:55:05.173127 [debug] [MainThread]: On master: Close
[0m17:55:05.177630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:05.177630 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:55:05.178617 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:55:05.178617 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:55:05.178617 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands' was properly closed.
[0m17:55:05.179626 [info ] [MainThread]: 
[0m17:55:05.179626 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m17:55:05.180546 [debug] [MainThread]: Command end result
[0m17:55:05.211666 [info ] [MainThread]: 
[0m17:55:05.211666 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:55:05.212789 [info ] [MainThread]: 
[0m17:55:05.212789 [error] [MainThread]:   Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Binder Error: * expression without FROM clause!
[0m17:55:05.212789 [info ] [MainThread]: 
[0m17:55:05.213801 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:55:05.213801 [debug] [MainThread]: Command `cli run` failed at 17:55:05.213801 after 0.90 seconds
[0m17:55:05.214797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AF49F710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2AFF14860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B1FA9490>]}
[0m17:55:05.214797 [debug] [MainThread]: Flushing usage events
[0m17:55:18.262719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002197F47D970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021903DF7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021903DF5DF0>]}


============================== 17:55:18.266758 | 89c7bf64-2154-4316-a48c-4e19bcb93189 ==============================
[0m17:55:18.266758 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:55:18.267766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:55:18.424458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89c7bf64-2154-4316-a48c-4e19bcb93189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021905A45340>]}
[0m17:55:18.467560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89c7bf64-2154-4316-a48c-4e19bcb93189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021903DF72C0>]}
[0m17:55:18.468561 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:55:18.478820 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:55:18.603436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:18.603436 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:18.635421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89c7bf64-2154-4316-a48c-4e19bcb93189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021905B017F0>]}
[0m17:55:18.713976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89c7bf64-2154-4316-a48c-4e19bcb93189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021905C3BE00>]}
[0m17:55:18.714990 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m17:55:18.714990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89c7bf64-2154-4316-a48c-4e19bcb93189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219042EE000>]}
[0m17:55:18.716943 [info ] [MainThread]: 
[0m17:55:18.716943 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:55:18.717943 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:55:18.777297 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:55:18.778298 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:55:18.778298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:18.798591 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:18.799599 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:55:18.804453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:55:18.805454 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:55:18.810453 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:55:18.810453 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:55:18.811453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:18.830196 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:18.831196 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:55:18.832284 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:55:18.832284 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:18.833198 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:55:18.833198 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:55:18.833198 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:18.834196 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:55:18.834196 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:55:18.835196 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:55:18.835196 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:18.835196 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:55:18.845084 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:55:18.846078 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:55:18.850077 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:55:18.851157 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:55:18.852159 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:55:18.852159 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:55:18.853159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:18.853159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:18.870552 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:18.871437 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:18.871437 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:55:18.872432 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:55:18.872432 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:55:18.873446 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:55:18.899796 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:18.902993 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:55:18.904010 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:55:18.905021 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:55:18.906009 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:55:18.907022 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:55:18.907022 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:55:18.907022 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:55:18.915017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89c7bf64-2154-4316-a48c-4e19bcb93189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002197FF9F8C0>]}
[0m17:55:18.915017 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:18.916017 [debug] [MainThread]: On master: BEGIN
[0m17:55:18.916017 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:18.933284 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:55:18.933284 [debug] [MainThread]: On master: COMMIT
[0m17:55:18.934290 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:18.934290 [debug] [MainThread]: On master: COMMIT
[0m17:55:18.934290 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:55:18.935276 [debug] [MainThread]: On master: Close
[0m17:55:18.939288 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:55:18.939288 [info ] [MainThread]: 
[0m17:55:18.944370 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m17:55:18.944370 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__wildlands .... [RUN]
[0m17:55:18.945441 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m17:55:18.945441 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m17:55:18.951524 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:55:18.952529 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m17:55:18.976947 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:55:18.977980 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:55:18.977980 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: BEGIN
[0m17:55:18.978962 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:55:18.995244 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:55:18.996312 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:55:18.996312 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed EMS Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ARRIVAL --> DATETIME
    - TRANSPORT --> DATETIME
    - AGE --> INTEGER
***/



WITH ems_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."ems"
),

ems_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(TRANSPORT, '%m%d%Y%H%M') AS TRANSPORT_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE
    FROM ems_source
),

ems_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        PATIENT_NO,
        VERSION,
        ARRIVAL_UPDATE AS ARRIVAL,
        TRANSPORT_UPDATE AS TRANSPORT,
        PROVIDER_A,
        AGE_UPDATE,
        GENDER,
        RACE,
        ETH_EMS,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        OTHER_FACT,
        SITE_INJ1,
        SITE_INJ2,
        SITE_INJ3,
        SITE_INJ4,
        SITE_INJ5,
        INJ_TYPE1,
        INJ_TYPE2,
        INJ_TYPE3,
        INJ_TYPE4,
        INJ_TYPE5,
        CAUSE_ILL,
        PROC_USE1,
        PROC_USE2,
        PROC_USE3,
        PROC_USE4,
        PROC_USE5,
        PROC_USE6,
        PROC_USE7,
        PROC_USE8,
        PROC_USE9,
        PROC_USE10,
        PROC_USE11,
        PROC_USE12,
        PROC_USE13,
        PROC_USE14,
        PROC_USE15,
        PROC_USE16,
        PROC_USE17,
        PROC_USE18,
        PROC_USE19,
        PROC_USE20,
        PROC_USE21,
        PROC_USE22,
        PROC_USE23,
        PROC_USE24,
        PROC_USE25,
        SAFE_EQP1,
        SAFE_EQP2,
        SAFE_EQP3,
        SAFE_EQP4,
        SAFE_EQP5,
        SAFE_EQP6,
        SAFE_EQP7,
        SAFE_EQP8,
        ARREST,
        ARR_DES1,
        ARR_DES2,
        AR_RHYTHM,
        IL_CARE,
        HIGH_CARE,
        PAT_STATUS,
        PULSE,
        EMS_DISPO,
    FROM ems_col_data_type_update
)

SELECT * FROM ems_final
    );
  
  
[0m17:55:19.986875 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m17:55:19.991892 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:55:19.992366 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp" rename to "nfirs_transformed__wildlands"
[0m17:55:19.992892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:55:20.006030 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: COMMIT
[0m17:55:20.006030 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:55:20.007025 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: COMMIT
[0m17:55:20.911652 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m17:55:20.915922 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m17:55:20.916922 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_backup" cascade
[0m17:55:20.916922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:55:20.918922 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: Close
[0m17:55:20.972007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89c7bf64-2154-4316-a48c-4e19bcb93189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002197FF3F470>]}
[0m17:55:20.973006 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__wildlands  [[32mOK[0m in 2.03s]
[0m17:55:20.974005 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m17:55:20.976166 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:20.976674 [debug] [MainThread]: On master: BEGIN
[0m17:55:20.977178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:20.994198 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:55:20.995197 [debug] [MainThread]: On master: COMMIT
[0m17:55:20.995197 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:20.996198 [debug] [MainThread]: On master: COMMIT
[0m17:55:20.996198 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:55:20.996198 [debug] [MainThread]: On master: Close
[0m17:55:21.002229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:21.002229 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:55:21.002229 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:55:21.003221 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:55:21.003221 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands' was properly closed.
[0m17:55:21.004232 [info ] [MainThread]: 
[0m17:55:21.004232 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.29 seconds (2.29s).
[0m17:55:21.005221 [debug] [MainThread]: Command end result
[0m17:55:21.030690 [info ] [MainThread]: 
[0m17:55:21.031697 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:21.031697 [info ] [MainThread]: 
[0m17:55:21.031697 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:55:21.032691 [debug] [MainThread]: Command `cli run` succeeded at 17:55:21.032691 after 2.88 seconds
[0m17:55:21.033702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219056F7E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002190574A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021905D10B30>]}
[0m17:55:21.033702 [debug] [MainThread]: Flushing usage events
[0m17:57:23.788499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276C8288AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276C95F0500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276C95F15B0>]}


============================== 17:57:23.791507 | f1a1ce23-113f-4c53-a44f-c94d81c1e390 ==============================
[0m17:57:23.791507 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:57:23.792499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:23.947853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1a1ce23-113f-4c53-a44f-c94d81c1e390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276C9260620>]}
[0m17:57:23.988852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1a1ce23-113f-4c53-a44f-c94d81c1e390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276C983BBF0>]}
[0m17:57:23.989845 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:57:23.999882 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:57:24.127909 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:24.127909 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:24.158914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1a1ce23-113f-4c53-a44f-c94d81c1e390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276CAD1D850>]}
[0m17:57:24.238198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1a1ce23-113f-4c53-a44f-c94d81c1e390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276CB296C00>]}
[0m17:57:24.239195 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m17:57:24.239195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1a1ce23-113f-4c53-a44f-c94d81c1e390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276CB28F3E0>]}
[0m17:57:24.241198 [info ] [MainThread]: 
[0m17:57:24.241198 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:57:24.242193 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:57:24.300390 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:57:24.301385 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:57:24.301385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:24.408751 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:57:24.409759 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:57:24.410758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:24.410758 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m17:57:24.411751 [info ] [MainThread]: 
[0m17:57:24.411751 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m17:57:24.412751 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 16932)
[0m17:57:24.413750 [debug] [MainThread]: Command `cli run` failed at 17:57:24.413750 after 0.73 seconds
[0m17:57:24.413750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276C8288AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276CB0AA420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276CB0AB740>]}
[0m17:57:24.414751 [debug] [MainThread]: Flushing usage events
[0m17:57:46.240728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D6F51790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D9830B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D9833B30>]}


============================== 17:57:46.243851 | 727e7064-2f01-4cec-9032-35eccb74a0d9 ==============================
[0m17:57:46.243851 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:57:46.244846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:57:46.398207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '727e7064-2f01-4cec-9032-35eccb74a0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DAFC8F20>]}
[0m17:57:46.439051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '727e7064-2f01-4cec-9032-35eccb74a0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D8C62360>]}
[0m17:57:46.440048 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:57:46.451369 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:57:46.579228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:46.579228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:46.610597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '727e7064-2f01-4cec-9032-35eccb74a0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DB0CC1D0>]}
[0m17:57:46.687800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '727e7064-2f01-4cec-9032-35eccb74a0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DB37E900>]}
[0m17:57:46.687800 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m17:57:46.688800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '727e7064-2f01-4cec-9032-35eccb74a0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DB1E0BC0>]}
[0m17:57:46.689800 [info ] [MainThread]: 
[0m17:57:46.690800 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:57:46.691801 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:57:46.751111 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:57:46.751111 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:57:46.751111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:46.772569 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:57:46.773604 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:57:46.777676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m17:57:46.778676 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m17:57:46.783765 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:57:46.783765 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:57:46.783765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:46.800465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:57:46.802607 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:57:46.802607 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m17:57:46.803607 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:57:46.803607 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:57:46.803607 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m17:57:46.804607 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:57:46.804607 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:57:46.805705 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m17:57:46.805705 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m17:57:46.805705 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:57:46.806706 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m17:57:46.814724 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:57:46.818726 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:57:46.819767 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:57:46.819767 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:57:46.821797 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:57:46.821797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:46.821797 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:57:46.839483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:46.839483 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:57:46.840422 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:57:46.840422 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:57:46.841463 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:57:46.841463 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:57:46.841463 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:57:46.868938 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:57:46.873027 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:57:46.874027 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:57:46.875065 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:57:46.875065 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:57:46.877262 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:57:46.878280 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:57:46.878280 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:57:46.884376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '727e7064-2f01-4cec-9032-35eccb74a0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DB6D0200>]}
[0m17:57:46.885377 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:46.886420 [debug] [MainThread]: On master: BEGIN
[0m17:57:46.886420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:46.902850 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:57:46.903851 [debug] [MainThread]: On master: COMMIT
[0m17:57:46.903851 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:46.904851 [debug] [MainThread]: On master: COMMIT
[0m17:57:46.904851 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:57:46.904851 [debug] [MainThread]: On master: Close
[0m17:57:46.908909 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:57:46.909908 [info ] [MainThread]: 
[0m17:57:46.914060 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__ems
[0m17:57:46.914060 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__ems .......... [RUN]
[0m17:57:46.915067 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__ems'
[0m17:57:46.915067 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__ems
[0m17:57:46.921066 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__ems"
[0m17:57:46.923060 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__ems
[0m17:57:46.948693 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__ems"
[0m17:57:46.950684 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ems"
[0m17:57:46.950684 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ems: BEGIN
[0m17:57:46.950684 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:46.968099 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:57:46.968099 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ems"
[0m17:57:46.969146 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ems: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__ems"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__ems__dbt_tmp"
  
    as (
      /***** NFIRS Transformed EMS Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - ARRIVAL --> DATETIME
    - TRANSPORT --> DATETIME
    - AGE --> INTEGER
***/



WITH ems_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."ems"
),

ems_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        STRPTIME(ARRIVAL, '%m%d%Y%H%M') AS ARRIVAL_UPDATE,
        STRPTIME(TRANSPORT, '%m%d%Y%H%M') AS TRANSPORT_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE
    FROM ems_source
),

ems_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        PATIENT_NO,
        VERSION,
        ARRIVAL_UPDATE AS ARRIVAL,
        TRANSPORT_UPDATE AS TRANSPORT,
        PROVIDER_A,
        AGE_UPDATE,
        GENDER,
        RACE,
        ETH_EMS,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        OTHER_FACT,
        SITE_INJ1,
        SITE_INJ2,
        SITE_INJ3,
        SITE_INJ4,
        SITE_INJ5,
        INJ_TYPE1,
        INJ_TYPE2,
        INJ_TYPE3,
        INJ_TYPE4,
        INJ_TYPE5,
        CAUSE_ILL,
        PROC_USE1,
        PROC_USE2,
        PROC_USE3,
        PROC_USE4,
        PROC_USE5,
        PROC_USE6,
        PROC_USE7,
        PROC_USE8,
        PROC_USE9,
        PROC_USE10,
        PROC_USE11,
        PROC_USE12,
        PROC_USE13,
        PROC_USE14,
        PROC_USE15,
        PROC_USE16,
        PROC_USE17,
        PROC_USE18,
        PROC_USE19,
        PROC_USE20,
        PROC_USE21,
        PROC_USE22,
        PROC_USE23,
        PROC_USE24,
        PROC_USE25,
        SAFE_EQP1,
        SAFE_EQP2,
        SAFE_EQP3,
        SAFE_EQP4,
        SAFE_EQP5,
        SAFE_EQP6,
        SAFE_EQP7,
        SAFE_EQP8,
        ARREST,
        ARR_DES1,
        ARR_DES2,
        AR_RHYTHM,
        IL_CARE,
        HIGH_CARE,
        PAT_STATUS,
        PULSE,
        EMS_DISPO,
    FROM ems_col_data_type_update
)

SELECT * FROM ems_final
    );
  
  
[0m17:57:47.929520 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m17:57:47.933903 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ems"
[0m17:57:47.934906 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ems: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__ems"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__ems__dbt_tmp" rename to "nfirs_transformed__ems"
[0m17:57:47.935905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:57:47.948044 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ems: COMMIT
[0m17:57:47.949044 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ems"
[0m17:57:47.949044 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ems: COMMIT
[0m17:57:48.548320 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m17:57:48.554377 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ems"
[0m17:57:48.555494 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ems: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__ems"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__ems__dbt_backup" cascade
[0m17:57:48.556506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:57:48.557608 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ems: Close
[0m17:57:48.612050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '727e7064-2f01-4cec-9032-35eccb74a0d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7DB0CF500>]}
[0m17:57:48.613110 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__ems ..... [[32mOK[0m in 1.70s]
[0m17:57:48.614110 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__ems
[0m17:57:48.616110 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:48.617109 [debug] [MainThread]: On master: BEGIN
[0m17:57:48.617109 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:48.635528 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:57:48.636028 [debug] [MainThread]: On master: COMMIT
[0m17:57:48.636028 [debug] [MainThread]: Using duckdb connection "master"
[0m17:57:48.636028 [debug] [MainThread]: On master: COMMIT
[0m17:57:48.637033 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:57:48.637033 [debug] [MainThread]: On master: Close
[0m17:57:48.642859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:48.642859 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m17:57:48.643856 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:57:48.644856 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:57:48.644856 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__ems' was properly closed.
[0m17:57:48.645856 [info ] [MainThread]: 
[0m17:57:48.645856 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.96 seconds (1.96s).
[0m17:57:48.646899 [debug] [MainThread]: Command end result
[0m17:57:48.671360 [info ] [MainThread]: 
[0m17:57:48.671971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:57:48.672324 [info ] [MainThread]: 
[0m17:57:48.672824 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:57:48.673824 [debug] [MainThread]: Command `cli run` succeeded at 17:57:48.673824 after 2.54 seconds
[0m17:57:48.674324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D6F51790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D93D18E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7D88FB800>]}
[0m17:57:48.674824 [debug] [MainThread]: Flushing usage events
[0m10:46:08.137907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CF7BF0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CCEEAD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CC9D7C80>]}


============================== 10:46:08.154706 | b44efb68-7b32-4359-81a2-41a407555d70 ==============================
[0m10:46:08.154706 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:46:08.154706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:46:08.306751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b44efb68-7b32-4359-81a2-41a407555d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D0FD07D0>]}
[0m10:46:08.355933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b44efb68-7b32-4359-81a2-41a407555d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CF0C9E20>]}
[0m10:46:08.355933 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m10:46:08.355933 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:46:08.487997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:46:08.487997 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:46:08.523129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b44efb68-7b32-4359-81a2-41a407555d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D0C18C50>]}
[0m10:46:08.607525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b44efb68-7b32-4359-81a2-41a407555d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D1356D50>]}
[0m10:46:08.607525 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m10:46:08.607525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b44efb68-7b32-4359-81a2-41a407555d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D0E1CEF0>]}
[0m10:46:08.621060 [info ] [MainThread]: 
[0m10:46:08.621060 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:46:08.621060 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m10:46:08.854299 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m10:46:08.854299 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m10:46:08.854299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:08.888486 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:08.888486 [debug] [ThreadPool]: On list_nfirs: Close
[0m10:46:08.888486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m10:46:08.888486 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m10:46:08.888486 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m10:46:08.888486 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m10:46:08.888486 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:46:08.907626 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:08.907626 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m10:46:08.907626 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m10:46:08.921038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:08.921038 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m10:46:08.921038 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m10:46:08.921038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:08.921038 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m10:46:08.921038 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m10:46:08.921038 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m10:46:08.921038 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:08.921038 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m10:46:08.921038 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m10:46:08.937030 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m10:46:08.937654 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:46:08.937654 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:46:08.937654 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m10:46:08.937654 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m10:46:08.937654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:08.937654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:08.954276 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:08.954276 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:08.954276 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:46:08.954276 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:46:08.954276 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m10:46:08.954276 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m10:46:08.986927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:08.987706 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:08.987706 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m10:46:08.987706 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m10:46:08.987706 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m10:46:08.987706 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m10:46:08.987706 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m10:46:08.987706 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m10:46:09.004142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b44efb68-7b32-4359-81a2-41a407555d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D137BB60>]}
[0m10:46:09.004142 [debug] [MainThread]: Using duckdb connection "master"
[0m10:46:09.004142 [debug] [MainThread]: On master: BEGIN
[0m10:46:09.004142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:46:09.020896 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:46:09.020896 [debug] [MainThread]: On master: COMMIT
[0m10:46:09.020896 [debug] [MainThread]: Using duckdb connection "master"
[0m10:46:09.020896 [debug] [MainThread]: On master: COMMIT
[0m10:46:09.020896 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:46:09.020896 [debug] [MainThread]: On master: Close
[0m10:46:09.020896 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:46:09.020896 [info ] [MainThread]: 
[0m10:46:09.020896 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader
[0m10:46:09.020896 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__fdheader ..... [RUN]
[0m10:46:09.020896 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader'
[0m10:46:09.020896 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__fdheader
[0m10:46:09.039690 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"
[0m10:46:09.041591 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__fdheader
[0m10:46:09.055296 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"
[0m10:46:09.055296 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"
[0m10:46:09.055296 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader: BEGIN
[0m10:46:09.055296 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:46:09.070886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:46:09.070886 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"
[0m10:46:09.070886 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader__dbt_tmp"
  
    as (
      /***** NFIRS Transformed FD Header Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - NO_STATION --> FLOAT
    - NO_PD_FF --> FLOAT
    - NO_VOL_FF --> FLOAT
    - NO_VOL_PDC --> FLOAT
***/



WITH fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."fdheader"
),

fdheader_col_data_type_update AS (
    SELECT
        *,
        CAST(NO_STATION AS FLOAT) AS NO_STATION_UPDATE,
        CAST(NO_PD_FF AS FLOAT) AS NO_PD_FF_UPDATE,
        CAST(NO_VOL_FF AS FLOAT) AS NO_VOL_FF_UPDATE,
        CAST(NO_VOL_PDC AS FLOAT) AS NO_VOL_PDC_UPDATE
    FROM fdheader_source
),

fdheader_final AS (
    SELECT
        STATE,
        FDID,
        FD_NAME,
        FD_STR_NO,
        FD_STR_PRE,
        FD_STREET,
        FD_STR_TYP,
        FD_STR_SUF,
        FD_CITY,
        FD_ZIP,
        FD_PHONE,
        FD_FAX,
        FD_EMAIL,
        FD_FIP_CTY,
        NO_STATION_UPDATE AS NO_STATION,
        NO_PD_FF_UPDATE AS NO_PD_FF,
        NO_VOL_FF_UPDATE AS NO_VOL_FF,
        NO_VOL_PDC_UPDATE AS NO_VOL_PDC
)

SELECT * FROM fdheader_final
    );
  
  
[0m10:46:09.086522 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader__dbt_tmp"
  
    as (
      /***** NFIRS Transformed FD Header Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - NO_STATION --> FLOAT
    - NO_PD_FF --> FLOAT
    - NO_VOL_FF --> FLOAT
    - NO_VOL_PDC --> FLOAT
***/



WITH fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."fdheader"
),

fdheader_col_data_type_update AS (
    SELECT
        *,
        CAST(NO_STATION AS FLOAT) AS NO_STATION_UPDATE,
        CAST(NO_PD_FF AS FLOAT) AS NO_PD_FF_UPDATE,
        CAST(NO_VOL_FF AS FLOAT) AS NO_VOL_FF_UPDATE,
        CAST(NO_VOL_PDC AS FLOAT) AS NO_VOL_PDC_UPDATE
    FROM fdheader_source
),

fdheader_final AS (
    SELECT
        STATE,
        FDID,
        FD_NAME,
        FD_STR_NO,
        FD_STR_PRE,
        FD_STREET,
        FD_STR_TYP,
        FD_STR_SUF,
        FD_CITY,
        FD_ZIP,
        FD_PHONE,
        FD_FAX,
        FD_EMAIL,
        FD_FIP_CTY,
        NO_STATION_UPDATE AS NO_STATION,
        NO_PD_FF_UPDATE AS NO_PD_FF,
        NO_VOL_FF_UPDATE AS NO_VOL_FF,
        NO_VOL_PDC_UPDATE AS NO_VOL_PDC
)

SELECT * FROM fdheader_final
    );
  
  
[0m10:46:09.086522 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:46:09.087623 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader: ROLLBACK
[0m10:46:09.087623 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader'
[0m10:46:09.087623 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader: Close
[0m10:46:09.104098 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__fdheader (models\nfirs_transformed\nfirs_transformed__fdheader.sql)
  Binder Error: Referenced column "STATE" not found in FROM clause!
  LINE 38:         STATE,
                   ^
[0m10:46:09.104098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b44efb68-7b32-4359-81a2-41a407555d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2D175A570>]}
[0m10:46:09.104098 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__fdheader  [[31mERROR[0m in 0.08s]
[0m10:46:09.107604 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader
[0m10:46:09.107604 [debug] [MainThread]: Using duckdb connection "master"
[0m10:46:09.107604 [debug] [MainThread]: On master: BEGIN
[0m10:46:09.107604 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:46:09.126475 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:46:09.126475 [debug] [MainThread]: On master: COMMIT
[0m10:46:09.126475 [debug] [MainThread]: Using duckdb connection "master"
[0m10:46:09.126475 [debug] [MainThread]: On master: COMMIT
[0m10:46:09.126475 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:46:09.126475 [debug] [MainThread]: On master: Close
[0m10:46:09.126475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:09.126475 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m10:46:09.126475 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m10:46:09.126475 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m10:46:09.126475 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader' was properly closed.
[0m10:46:09.126475 [info ] [MainThread]: 
[0m10:46:09.126475 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m10:46:09.126475 [debug] [MainThread]: Command end result
[0m10:46:09.160078 [info ] [MainThread]: 
[0m10:46:09.160078 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:46:09.160078 [info ] [MainThread]: 
[0m10:46:09.160078 [error] [MainThread]:   Runtime Error in model nfirs_transformed__fdheader (models\nfirs_transformed\nfirs_transformed__fdheader.sql)
  Binder Error: Referenced column "STATE" not found in FROM clause!
  LINE 38:         STATE,
                   ^
[0m10:46:09.160078 [info ] [MainThread]: 
[0m10:46:09.160078 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:46:09.160078 [debug] [MainThread]: Command `cli run` failed at 10:46:09.160078 after 1.13 seconds
[0m10:46:09.160078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CEDEC920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CF379460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2CF793530>]}
[0m10:46:09.160078 [debug] [MainThread]: Flushing usage events
[0m10:46:37.526954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A525F8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A7D0CC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A7D0F500>]}


============================== 10:46:37.526954 | ffccd44f-b2d9-4120-b348-552139a299b5 ==============================
[0m10:46:37.526954 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:46:37.526954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m10:46:37.675095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffccd44f-b2d9-4120-b348-552139a299b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A7E65400>]}
[0m10:46:37.727389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffccd44f-b2d9-4120-b348-552139a299b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A50AC9E0>]}
[0m10:46:37.727389 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m10:46:37.737734 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:46:37.858457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:46:37.858457 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:46:37.892546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffccd44f-b2d9-4120-b348-552139a299b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A8134B90>]}
[0m10:46:37.974898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffccd44f-b2d9-4120-b348-552139a299b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A8144CB0>]}
[0m10:46:37.974898 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m10:46:37.974898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffccd44f-b2d9-4120-b348-552139a299b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A81363C0>]}
[0m10:46:37.974898 [info ] [MainThread]: 
[0m10:46:37.974898 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:46:37.974898 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m10:46:38.043238 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m10:46:38.043238 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m10:46:38.043238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:38.058174 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:38.058174 [debug] [ThreadPool]: On list_nfirs: Close
[0m10:46:38.058174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m10:46:38.058174 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m10:46:38.074688 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m10:46:38.074688 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m10:46:38.074688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:46:38.091333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:38.091333 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m10:46:38.091333 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m10:46:38.091333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:38.091333 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m10:46:38.091333 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m10:46:38.091333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:38.091333 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m10:46:38.091333 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m10:46:38.091333 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m10:46:38.091333 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:38.091333 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m10:46:38.107971 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m10:46:38.107971 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:46:38.107971 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m10:46:38.107971 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m10:46:38.107971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:38.107971 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:46:38.124608 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m10:46:38.124608 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:38.124608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:46:38.124608 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:46:38.124608 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:38.124608 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m10:46:38.124608 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:46:38.124608 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m10:46:38.157959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:38.157959 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:46:38.157959 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m10:46:38.157959 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m10:46:38.157959 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m10:46:38.174749 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m10:46:38.174749 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m10:46:38.174749 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m10:46:38.174749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffccd44f-b2d9-4120-b348-552139a299b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A8750410>]}
[0m10:46:38.174749 [debug] [MainThread]: Using duckdb connection "master"
[0m10:46:38.174749 [debug] [MainThread]: On master: BEGIN
[0m10:46:38.174749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:46:38.192106 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:46:38.192106 [debug] [MainThread]: On master: COMMIT
[0m10:46:38.192106 [debug] [MainThread]: Using duckdb connection "master"
[0m10:46:38.192106 [debug] [MainThread]: On master: COMMIT
[0m10:46:38.192106 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:46:38.192106 [debug] [MainThread]: On master: Close
[0m10:46:38.192106 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:46:38.192106 [info ] [MainThread]: 
[0m10:46:38.208039 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader
[0m10:46:38.208039 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__fdheader ..... [RUN]
[0m10:46:38.208039 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader'
[0m10:46:38.208039 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__fdheader
[0m10:46:38.218521 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"
[0m10:46:38.223525 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__fdheader
[0m10:46:38.243229 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"
[0m10:46:38.243229 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"
[0m10:46:38.243229 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader: BEGIN
[0m10:46:38.243229 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:46:38.259061 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:46:38.259061 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"
[0m10:46:38.259061 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader__dbt_tmp"
  
    as (
      /***** NFIRS Transformed FD Header Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - NO_STATION --> FLOAT
    - NO_PD_FF --> FLOAT
    - NO_VOL_FF --> FLOAT
    - NO_VOL_PDC --> FLOAT
***/



WITH fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."fdheader"
),

fdheader_col_data_type_update AS (
    SELECT
        *,
        CAST(NO_STATION AS FLOAT) AS NO_STATION_UPDATE,
        CAST(NO_PD_FF AS FLOAT) AS NO_PD_FF_UPDATE,
        CAST(NO_VOL_FF AS FLOAT) AS NO_VOL_FF_UPDATE,
        CAST(NO_VOL_PDC AS FLOAT) AS NO_VOL_PDC_UPDATE
    FROM fdheader_source
),

fdheader_final AS (
    SELECT
        STATE,
        FDID,
        FD_NAME,
        FD_STR_NO,
        FD_STR_PRE,
        FD_STREET,
        FD_STR_TYP,
        FD_STR_SUF,
        FD_CITY,
        FD_ZIP,
        FD_PHONE,
        FD_FAX,
        FD_EMAIL,
        FD_FIP_CTY,
        NO_STATION_UPDATE AS NO_STATION,
        NO_PD_FF_UPDATE AS NO_PD_FF,
        NO_VOL_FF_UPDATE AS NO_VOL_FF,
        NO_VOL_PDC_UPDATE AS NO_VOL_PDC
    FROM fdheader_col_data_type_update
)

SELECT * FROM fdheader_final
    );
  
  
[0m10:46:38.324861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:46:38.324861 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"
[0m10:46:38.324861 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader__dbt_tmp" rename to "nfirs_transformed__fdheader"
[0m10:46:38.324861 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:46:38.342261 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader: COMMIT
[0m10:46:38.342261 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"
[0m10:46:38.342261 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader: COMMIT
[0m10:46:38.374424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:46:38.374424 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"
[0m10:46:38.374424 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fdheader"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader__dbt_backup" cascade
[0m10:46:38.374424 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:46:38.374424 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fdheader: Close
[0m10:46:38.757825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffccd44f-b2d9-4120-b348-552139a299b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A570F440>]}
[0m10:46:38.757825 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__fdheader  [[32mOK[0m in 0.55s]
[0m10:46:38.757825 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__fdheader
[0m10:46:38.757825 [debug] [MainThread]: Using duckdb connection "master"
[0m10:46:38.757825 [debug] [MainThread]: On master: BEGIN
[0m10:46:38.757825 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:46:38.779866 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:46:38.779866 [debug] [MainThread]: On master: COMMIT
[0m10:46:38.779866 [debug] [MainThread]: Using duckdb connection "master"
[0m10:46:38.779866 [debug] [MainThread]: On master: COMMIT
[0m10:46:38.779866 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:46:38.779866 [debug] [MainThread]: On master: Close
[0m10:46:38.795159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:46:38.795159 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m10:46:38.795159 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m10:46:38.795159 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m10:46:38.795159 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__fdheader' was properly closed.
[0m10:46:38.795159 [info ] [MainThread]: 
[0m10:46:38.795159 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m10:46:38.795159 [debug] [MainThread]: Command end result
[0m10:46:38.814581 [info ] [MainThread]: 
[0m10:46:38.814581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:46:38.814581 [info ] [MainThread]: 
[0m10:46:38.823869 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:46:38.823869 [debug] [MainThread]: Command `cli run` succeeded at 10:46:38.823869 after 1.40 seconds
[0m10:46:38.824905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A7E64EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A6893350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A6893230>]}
[0m10:46:38.824905 [debug] [MainThread]: Flushing usage events
[0m11:06:31.767293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276308FAA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022765B17D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002276492F080>]}


============================== 11:06:31.784093 | 8d64c5aa-29d3-41a0-a34d-97c7401f2968 ==============================
[0m11:06:31.784093 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:06:31.784093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:06:31.967558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d64c5aa-29d3-41a0-a34d-97c7401f2968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022763574560>]}
[0m11:06:32.023267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d64c5aa-29d3-41a0-a34d-97c7401f2968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022765D6E3F0>]}
[0m11:06:32.023267 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:06:32.034142 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:06:32.183888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:06:32.183888 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:06:32.233932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d64c5aa-29d3-41a0-a34d-97c7401f2968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022766048EF0>]}
[0m11:06:32.323777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d64c5aa-29d3-41a0-a34d-97c7401f2968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227662CE870>]}
[0m11:06:32.323777 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m11:06:32.323777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d64c5aa-29d3-41a0-a34d-97c7401f2968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227645F31D0>]}
[0m11:06:32.323777 [info ] [MainThread]: 
[0m11:06:32.323777 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:06:32.323777 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:06:32.400588 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:06:32.400588 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:06:32.400588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:32.424183 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:06:32.424183 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:06:32.424183 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m11:06:32.424183 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m11:06:32.433801 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:06:32.433801 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:06:32.433801 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:06:32.450264 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:06:32.450264 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:06:32.450264 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m11:06:32.450264 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:06:32.450264 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:06:32.450264 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m11:06:32.450264 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:06:32.450264 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:06:32.465934 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:06:32.466670 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:06:32.466670 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:06:32.466670 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m11:06:32.474701 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:06:32.483102 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:06:32.482710 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:06:32.483102 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:06:32.491134 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:06:32.491134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:32.491134 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:06:32.500520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:32.500520 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:06:32.516901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:06:32.517488 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:06:32.517488 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:06:32.517488 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:06:32.517488 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:06:32.550244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:06:32.550244 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:06:32.550244 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:06:32.550244 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:06:32.550244 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:06:32.550244 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:06:32.550244 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:06:32.550244 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:06:32.567068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d64c5aa-29d3-41a0-a34d-97c7401f2968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022765F632C0>]}
[0m11:06:32.567068 [debug] [MainThread]: Using duckdb connection "master"
[0m11:06:32.567068 [debug] [MainThread]: On master: BEGIN
[0m11:06:32.567068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:06:32.583718 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:06:32.583718 [debug] [MainThread]: On master: COMMIT
[0m11:06:32.583718 [debug] [MainThread]: Using duckdb connection "master"
[0m11:06:32.583718 [debug] [MainThread]: On master: COMMIT
[0m11:06:32.583718 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:06:32.583718 [debug] [MainThread]: On master: Close
[0m11:06:32.583718 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:06:32.583718 [info ] [MainThread]: 
[0m11:06:32.600390 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty
[0m11:06:32.600390 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__ffcasualty ... [RUN]
[0m11:06:32.600390 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty'
[0m11:06:32.600390 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty
[0m11:06:32.603556 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"
[0m11:06:32.611702 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty
[0m11:06:32.635603 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"
[0m11:06:32.635603 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"
[0m11:06:32.635603 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty: BEGIN
[0m11:06:32.635603 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:06:32.652156 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:06:32.652156 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"
[0m11:06:32.652156 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Firefighter Casualty Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - AGE --> INTEGER
    - INJ_DATE --> DATETIME
    - RESPONSES --> FLOAT
    - STORY --> FLOAT
***/



WITH ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."ffcasualty"
),

ffcasualty_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        STRPTIME(INJ_DATE, '%m%d%Y%H%M') AS INJ_DATE_UPDATE,
        CAST(RESPONSES AS FLOAT) AS RESPONSES_UPDATE,
        CAST(STORY AS FLOAT) AS STORY_UPDATE
    FROM ffcasualty_source
),

ffcasualty_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        FF_SEQ_NO,
        VERSION,
        GENDER,
        CAREER,
        AGE_UPDATE AS AGE,
        INC_DATE_UPDATE AS INJ_DATE,
        RESPONSES_UPDATE AS RESPONSES,
        ASSIGNMENT,
        PHYS_COND,
        SEVERITY,
        TAKEN_TO,
        ACTIVITY,
        SYMPTON,
        PABI,
        CAUSE,
        FACTOR,
        OBJECT,
        WIO,
        RELATION,
        STORY_UPDATE AS STORY,
        LOCATION,
        VEHICLE,
        PROT_EQP
    FROM ffcasualty_col_data_type_update
)

SELECT * FROM ffcasualty_final
    );
  
  
[0m11:06:32.667092 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Firefighter Casualty Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - AGE --> INTEGER
    - INJ_DATE --> DATETIME
    - RESPONSES --> FLOAT
    - STORY --> FLOAT
***/



WITH ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."ffcasualty"
),

ffcasualty_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        STRPTIME(INJ_DATE, '%m%d%Y%H%M') AS INJ_DATE_UPDATE,
        CAST(RESPONSES AS FLOAT) AS RESPONSES_UPDATE,
        CAST(STORY AS FLOAT) AS STORY_UPDATE
    FROM ffcasualty_source
),

ffcasualty_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        FF_SEQ_NO,
        VERSION,
        GENDER,
        CAREER,
        AGE_UPDATE AS AGE,
        INC_DATE_UPDATE AS INJ_DATE,
        RESPONSES_UPDATE AS RESPONSES,
        ASSIGNMENT,
        PHYS_COND,
        SEVERITY,
        TAKEN_TO,
        ACTIVITY,
        SYMPTON,
        PABI,
        CAUSE,
        FACTOR,
        OBJECT,
        WIO,
        RELATION,
        STORY_UPDATE AS STORY,
        LOCATION,
        VEHICLE,
        PROT_EQP
    FROM ffcasualty_col_data_type_update
)

SELECT * FROM ffcasualty_final
    );
  
  
[0m11:06:32.667092 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:06:32.667092 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty: ROLLBACK
[0m11:06:32.667092 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty'
[0m11:06:32.667092 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty: Close
[0m11:06:32.667092 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__ffcasualty (models\nfirs_transformed\nfirs_transformed__ffcasualty.sql)
  Binder Error: Referenced column "SYMPTON" not found in FROM clause!
  Candidate bindings: "ffcasualty_col_data_type_update.SYMPTOM"
  LINE 58:         SYMPTON,
                   ^
[0m11:06:32.667092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d64c5aa-29d3-41a0-a34d-97c7401f2968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022764237710>]}
[0m11:06:32.682889 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__ffcasualty  [[31mERROR[0m in 0.07s]
[0m11:06:32.683538 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty
[0m11:06:32.683538 [debug] [MainThread]: Using duckdb connection "master"
[0m11:06:32.683538 [debug] [MainThread]: On master: BEGIN
[0m11:06:32.683538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:06:32.699623 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:06:32.699623 [debug] [MainThread]: On master: COMMIT
[0m11:06:32.699623 [debug] [MainThread]: Using duckdb connection "master"
[0m11:06:32.707770 [debug] [MainThread]: On master: COMMIT
[0m11:06:32.707770 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:06:32.707770 [debug] [MainThread]: On master: Close
[0m11:06:32.707770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:32.707770 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m11:06:32.707770 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:06:32.707770 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:06:32.707770 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty' was properly closed.
[0m11:06:32.707770 [info ] [MainThread]: 
[0m11:06:32.716290 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m11:06:32.716290 [debug] [MainThread]: Command end result
[0m11:06:32.736324 [info ] [MainThread]: 
[0m11:06:32.744412 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:06:32.744412 [info ] [MainThread]: 
[0m11:06:32.744412 [error] [MainThread]:   Runtime Error in model nfirs_transformed__ffcasualty (models\nfirs_transformed\nfirs_transformed__ffcasualty.sql)
  Binder Error: Referenced column "SYMPTON" not found in FROM clause!
  Candidate bindings: "ffcasualty_col_data_type_update.SYMPTOM"
  LINE 58:         SYMPTON,
                   ^
[0m11:06:32.744412 [info ] [MainThread]: 
[0m11:06:32.744412 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:06:32.744412 [debug] [MainThread]: Command `cli run` failed at 11:06:32.744412 after 1.10 seconds
[0m11:06:32.744412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227642DAE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022763A6F470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227646F3500>]}
[0m11:06:32.744412 [debug] [MainThread]: Flushing usage events
[0m11:07:51.115281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFA9BFC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFB647140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFC151E50>]}


============================== 11:07:51.116161 | f335595f-6e74-4edc-a1ca-820aa1ab95c4 ==============================
[0m11:07:51.116161 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:07:51.116161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m11:07:51.299192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f335595f-6e74-4edc-a1ca-820aa1ab95c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFD7080E0>]}
[0m11:07:51.366039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f335595f-6e74-4edc-a1ca-820aa1ab95c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFD6B4B30>]}
[0m11:07:51.366039 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:07:51.366039 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:07:51.532437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:07:51.532437 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:07:51.579042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f335595f-6e74-4edc-a1ca-820aa1ab95c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFD70A390>]}
[0m11:07:51.665949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f335595f-6e74-4edc-a1ca-820aa1ab95c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFDB3E9F0>]}
[0m11:07:51.665949 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m11:07:51.665949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f335595f-6e74-4edc-a1ca-820aa1ab95c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFD9735F0>]}
[0m11:07:51.665949 [info ] [MainThread]: 
[0m11:07:51.665949 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:07:51.665949 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:07:51.749002 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:07:51.749002 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:07:51.749002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:51.765642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:07:51.765642 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:07:51.785338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m11:07:51.788351 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m11:07:51.788351 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:07:51.788351 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:07:51.788351 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:07:51.815487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:07:51.815487 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:07:51.815487 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m11:07:51.815487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:07:51.815487 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:07:51.815487 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m11:07:51.815487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:07:51.815487 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:07:51.815487 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:07:51.815487 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:07:51.815487 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:07:51.815487 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m11:07:51.832256 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:07:51.832256 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:07:51.832256 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:07:51.832256 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:07:51.832256 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:07:51.832256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:51.832256 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:07:51.848972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:51.848972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:07:51.848972 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:07:51.848972 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:07:51.848972 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:07:51.848972 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:07:51.848972 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:07:51.888479 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:07:51.888479 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:07:51.898899 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:07:51.898899 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:07:51.898899 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:07:51.898899 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:07:51.898899 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:07:51.898899 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:07:51.898899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f335595f-6e74-4edc-a1ca-820aa1ab95c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFDEA6570>]}
[0m11:07:51.898899 [debug] [MainThread]: Using duckdb connection "master"
[0m11:07:51.898899 [debug] [MainThread]: On master: BEGIN
[0m11:07:51.898899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:51.932266 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:07:51.932266 [debug] [MainThread]: On master: COMMIT
[0m11:07:51.932266 [debug] [MainThread]: Using duckdb connection "master"
[0m11:07:51.932266 [debug] [MainThread]: On master: COMMIT
[0m11:07:51.932266 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:07:51.932266 [debug] [MainThread]: On master: Close
[0m11:07:51.932266 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:07:51.932266 [info ] [MainThread]: 
[0m11:07:51.932266 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty
[0m11:07:51.932266 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__ffcasualty ... [RUN]
[0m11:07:51.932266 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty'
[0m11:07:51.932266 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty
[0m11:07:51.945518 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"
[0m11:07:51.945518 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty
[0m11:07:51.981701 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"
[0m11:07:51.983941 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"
[0m11:07:51.983941 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty: BEGIN
[0m11:07:51.983941 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:07:51.999171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:07:51.999171 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"
[0m11:07:51.999171 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Firefighter Casualty Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - AGE --> INTEGER
    - INJ_DATE --> DATETIME
    - RESPONSES --> FLOAT
    - STORY --> FLOAT
***/



WITH ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."ffcasualty"
),

ffcasualty_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        STRPTIME(INJ_DATE, '%m%d%Y%H%M') AS INJ_DATE_UPDATE,
        CAST(RESPONSES AS FLOAT) AS RESPONSES_UPDATE,
        CAST(STORY AS FLOAT) AS STORY_UPDATE
    FROM ffcasualty_source
),

ffcasualty_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        FF_SEQ_NO,
        VERSION,
        GENDER,
        CAREER,
        AGE_UPDATE AS AGE,
        INC_DATE_UPDATE AS INJ_DATE,
        RESPONSES_UPDATE AS RESPONSES,
        ASSIGNMENT,
        PHYS_COND,
        SEVERITY,
        TAKEN_TO,
        ACTIVITY,
        SYMPTOM,
        PABI,
        CAUSE,
        FACTOR,
        OBJECT,
        WIO,
        RELATION,
        STORY_UPDATE AS STORY,
        LOCATION,
        VEHICLE,
        PROT_EQP
    FROM ffcasualty_col_data_type_update
)

SELECT * FROM ffcasualty_final
    );
  
  
[0m11:07:52.132370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:07:52.149521 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"
[0m11:07:52.149521 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty__dbt_tmp" rename to "nfirs_transformed__ffcasualty"
[0m11:07:52.149521 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:07:52.165646 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty: COMMIT
[0m11:07:52.165646 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"
[0m11:07:52.165646 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty: COMMIT
[0m11:07:52.266426 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:07:52.282574 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"
[0m11:07:52.282574 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty__dbt_backup" cascade
[0m11:07:52.282574 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:07:52.282574 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty: Close
[0m11:07:52.739468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f335595f-6e74-4edc-a1ca-820aa1ab95c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFDF39FA0>]}
[0m11:07:52.739468 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__ffcasualty  [[32mOK[0m in 0.81s]
[0m11:07:52.739468 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty
[0m11:07:52.748684 [debug] [MainThread]: Using duckdb connection "master"
[0m11:07:52.748684 [debug] [MainThread]: On master: BEGIN
[0m11:07:52.748684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:52.773443 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:07:52.773443 [debug] [MainThread]: On master: COMMIT
[0m11:07:52.773443 [debug] [MainThread]: Using duckdb connection "master"
[0m11:07:52.773443 [debug] [MainThread]: On master: COMMIT
[0m11:07:52.773443 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:07:52.773443 [debug] [MainThread]: On master: Close
[0m11:07:52.781910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:52.786771 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m11:07:52.786771 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:07:52.786771 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:07:52.786771 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__ffcasualty' was properly closed.
[0m11:07:52.786771 [info ] [MainThread]: 
[0m11:07:52.786771 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m11:07:52.786771 [debug] [MainThread]: Command end result
[0m11:07:52.820065 [info ] [MainThread]: 
[0m11:07:52.820065 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:52.820065 [info ] [MainThread]: 
[0m11:07:52.820065 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:07:52.820065 [debug] [MainThread]: Command `cli run` succeeded at 11:07:52.820065 after 1.84 seconds
[0m11:07:52.820065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFC1AAB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFC1AA9F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EFB495E50>]}
[0m11:07:52.820065 [debug] [MainThread]: Flushing usage events
[0m11:13:02.513114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065F2A6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065FB92FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020660E0AB10>]}


============================== 11:13:02.513114 | 5d290aff-55da-4786-9ca0-96d984fed94f ==============================
[0m11:13:02.513114 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:13:02.513114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:13:02.696363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d290aff-55da-4786-9ca0-96d984fed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065E8142F0>]}
[0m11:13:02.763175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d290aff-55da-4786-9ca0-96d984fed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002065C914710>]}
[0m11:13:02.763175 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:13:02.763175 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:13:02.936763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:02.937804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:02.996315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d290aff-55da-4786-9ca0-96d984fed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206611D3DD0>]}
[0m11:13:03.096375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d290aff-55da-4786-9ca0-96d984fed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206612D2510>]}
[0m11:13:03.096375 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m11:13:03.096375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d290aff-55da-4786-9ca0-96d984fed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020661132E70>]}
[0m11:13:03.096375 [info ] [MainThread]: 
[0m11:13:03.112061 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:13:03.112902 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:13:03.362279 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:13:03.363080 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:13:03.363080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:03.380726 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:13:03.380726 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:13:03.380726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m11:13:03.380726 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m11:13:03.396166 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:13:03.396166 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:13:03.396166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:03.420084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:13:03.420084 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:13:03.420084 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m11:13:03.420084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:13:03.420084 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:13:03.420084 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m11:13:03.420084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:13:03.420084 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:13:03.420084 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:13:03.420084 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:13:03.428105 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:13:03.428795 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m11:13:03.436866 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:13:03.436866 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:13:03.436866 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:13:03.436866 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:13:03.445489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:03.446031 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:13:03.462646 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:13:03.462646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:13:03.462646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:03.462646 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:13:03.462646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:13:03.462646 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:13:03.462646 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:13:03.462646 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:13:03.496011 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:13:03.496011 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:13:03.496011 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:13:03.496011 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:13:03.496011 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:13:03.496011 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:13:03.511981 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:13:03.512577 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:13:03.515982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d290aff-55da-4786-9ca0-96d984fed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206611332F0>]}
[0m11:13:03.515982 [debug] [MainThread]: Using duckdb connection "master"
[0m11:13:03.515982 [debug] [MainThread]: On master: BEGIN
[0m11:13:03.515982 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:13:03.529280 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:13:03.529280 [debug] [MainThread]: On master: COMMIT
[0m11:13:03.529280 [debug] [MainThread]: Using duckdb connection "master"
[0m11:13:03.529280 [debug] [MainThread]: On master: COMMIT
[0m11:13:03.529280 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:13:03.529280 [debug] [MainThread]: On master: Close
[0m11:13:03.545977 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:13:03.545977 [info ] [MainThread]: 
[0m11:13:03.545977 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail
[0m11:13:03.545977 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__ffequipfail .. [RUN]
[0m11:13:03.545977 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail'
[0m11:13:03.545977 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail
[0m11:13:03.556757 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail"
[0m11:13:03.564826 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail
[0m11:13:03.595368 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail"
[0m11:13:03.597885 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail"
[0m11:13:03.597885 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail: BEGIN
[0m11:13:03.597885 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:13:03.612839 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:13:03.612839 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail"
[0m11:13:03.612839 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__ffequipfail__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Fire Service Equipment Failure Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH ffequipfail_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."ffequipfail"
),

ffequipfail_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM ffequipfail_source
),

ffequipfail_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        CAS_SEQ_NO,
        EQP_SEQ_NO,
        VERSION,
        EQUIP_ITEM,
        EQP_PROB,
        EQP_MAN,
        EQP_MOD,
        EQP_SER_NO
    FROM ffequipfail_col_data_type_update
)

SELECT * FROM ffequipfail_final
    );
  
  
[0m11:13:03.663312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:13:03.679871 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail"
[0m11:13:03.679871 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__ffequipfail__dbt_tmp" rename to "nfirs_transformed__ffequipfail"
[0m11:13:03.679871 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:13:03.712727 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail: COMMIT
[0m11:13:03.712727 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail"
[0m11:13:03.712727 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail: COMMIT
[0m11:13:03.712727 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:13:03.729553 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail"
[0m11:13:03.729553 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__ffequipfail__dbt_backup" cascade
[0m11:13:03.729553 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:13:03.729553 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail: Close
[0m11:13:04.162699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d290aff-55da-4786-9ca0-96d984fed94f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206618A9520>]}
[0m11:13:04.162699 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__ffequipfail  [[32mOK[0m in 0.62s]
[0m11:13:04.162699 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail
[0m11:13:04.162699 [debug] [MainThread]: Using duckdb connection "master"
[0m11:13:04.162699 [debug] [MainThread]: On master: BEGIN
[0m11:13:04.162699 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:13:04.180004 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:13:04.180004 [debug] [MainThread]: On master: COMMIT
[0m11:13:04.180004 [debug] [MainThread]: Using duckdb connection "master"
[0m11:13:04.188077 [debug] [MainThread]: On master: COMMIT
[0m11:13:04.188188 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:13:04.188188 [debug] [MainThread]: On master: Close
[0m11:13:04.188188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:04.195086 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m11:13:04.195626 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:13:04.195626 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:13:04.195626 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__ffequipfail' was properly closed.
[0m11:13:04.195626 [info ] [MainThread]: 
[0m11:13:04.195626 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m11:13:04.195626 [debug] [MainThread]: Command end result
[0m11:13:04.223265 [info ] [MainThread]: 
[0m11:13:04.224259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:04.224846 [info ] [MainThread]: 
[0m11:13:04.225397 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:13:04.226484 [debug] [MainThread]: Command `cli run` succeeded at 11:13:04.225931 after 1.84 seconds
[0m11:13:04.226484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020660F69010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020660F68710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020660F68CE0>]}
[0m11:13:04.226484 [debug] [MainThread]: Flushing usage events
[0m11:33:41.445326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B54F36E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B56A9BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B56A989E0>]}


============================== 11:33:41.445326 | 2859e8ed-f180-4a51-a095-cc9a0db67a47 ==============================
[0m11:33:41.445326 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:33:41.445326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:33:41.608345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2859e8ed-f180-4a51-a095-cc9a0db67a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B544A0620>]}
[0m11:33:41.642812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2859e8ed-f180-4a51-a095-cc9a0db67a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B54FBC740>]}
[0m11:33:41.642812 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:33:41.659381 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:33:41.792786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:33:41.792786 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:33:41.828594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2859e8ed-f180-4a51-a095-cc9a0db67a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B56DB1DF0>]}
[0m11:33:41.909287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2859e8ed-f180-4a51-a095-cc9a0db67a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B56FF33B0>]}
[0m11:33:41.909287 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m11:33:41.909287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2859e8ed-f180-4a51-a095-cc9a0db67a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B56D1C140>]}
[0m11:33:41.909287 [info ] [MainThread]: 
[0m11:33:41.909287 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:33:41.909287 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:33:41.975367 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:33:41.975367 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:33:41.975367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:41.992732 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:41.992732 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:33:41.992732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m11:33:41.992732 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m11:33:42.009717 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:33:42.009717 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:33:42.009717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:42.026686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:42.026686 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:33:42.026686 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m11:33:42.026686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:42.026686 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:33:42.026686 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m11:33:42.026686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:42.026686 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:33:42.026686 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:33:42.026686 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:33:42.026686 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:42.026686 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m11:33:42.041970 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:33:42.049107 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:33:42.049107 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:33:42.049107 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:33:42.049107 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:33:42.049107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:42.049107 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:33:42.062765 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:42.062765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:42.062765 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:33:42.062765 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:42.062765 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:33:42.062765 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:33:42.062765 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:33:42.093723 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:42.093723 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:42.093723 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:33:42.093723 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:33:42.093723 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:33:42.110732 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:33:42.110732 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:33:42.110732 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:33:42.119772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2859e8ed-f180-4a51-a095-cc9a0db67a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B56E514F0>]}
[0m11:33:42.120271 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:42.120271 [debug] [MainThread]: On master: BEGIN
[0m11:33:42.120930 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:42.126762 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:42.126762 [debug] [MainThread]: On master: COMMIT
[0m11:33:42.126762 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:42.126762 [debug] [MainThread]: On master: COMMIT
[0m11:33:42.126762 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:42.126762 [debug] [MainThread]: On master: Close
[0m11:33:42.143317 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:33:42.143317 [info ] [MainThread]: 
[0m11:33:42.143317 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__fireincident
[0m11:33:42.143317 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__fireincident . [RUN]
[0m11:33:42.143317 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__fireincident'
[0m11:33:42.143317 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__fireincident
[0m11:33:42.143317 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"
[0m11:33:42.143317 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__fireincident
[0m11:33:42.179415 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"
[0m11:33:42.179415 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"
[0m11:33:42.179415 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fireincident: BEGIN
[0m11:33:42.179415 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:33:42.194365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:42.194365 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"
[0m11:33:42.194365 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fireincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Fire Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - NUM_UNIT --> FLOAT
    - BLDG_INVOL --> FLOAT
    - ACRES_BURN --> FLOAT
    - AGE --> INTEGER
    - BLDG_ABOVE --> FLOAT
    - BLDG_BELOW --> FLOAT
    - BLDG_LGTH --> FLOAT
    - BLDG_WIDTH --> FLOAT
    - TOT_SQ_FT --> FLOAT
    - ST_DAM_MIN --> FLOAT
    - ST_DAM_SIG --> FLOAT
    - ST_DAM_HVY --> FLOAT
    - ST_DAM_XTR --> FLOAT
    - NO_SPR_OP --> FLOAT
***/



WITH fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."fireincident"
),

fireincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(NUM_UNIT AS FLOAT) AS NUM_UNIT_UPDATE,
        CAST(BLDG_INVOL AS FLOAT) AS BLDG_INVOL_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(BLDG_ABOVE AS FLOAT) AS BLDG_ABOVE_UPDATE,
        CAST(BLDG_BELOW AS FLOAT) AS BLDG_BELOW_UPDATE,
        CAST(BLDG_LGTH AS FLOAT) AS BLDG_LGTH_UPDATE,
        CAST(BLDG_WIDTH AS FLOAT) AS BLDG_WIDTH_UPDATE,
        CAST(TOT_SQ_FT AS FLOAT) AS TOT_SQ_FT_UPDATE,
        CAST(ST_DAM_MIN AS FLOAT) AS ST_DAM_MIN_UPDATE,
        CAST(ST_DAM_SIG AS FLOAT) AS ST_DAM_SIG_UPDATE,
        CAST(ST_DAM_HVY AS FLOAT) AS ST_DAM_HVY_UPDATE,
        CAST(ST_DAM_XTR AS FLOAT) AS ST_DAM_XTR_UPDATE,
        CAST(NO_SPR_OP AS FLOAT) AS NO_SPR_OP_UPDATE
    FROM fireincident_source
),

WITH fireincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        NUM_UNIT_UPDATE AS NUM_UNIT,
        NOT_RES,
        BLDG_INVOL_UPDATE AS BLDG_INVOL,
        ACRES_BURN_UPDATE AS ACRES_BURN,
        LESS_1ACRE,
        ON_SITE_M1,
        MAT_STOR1,
        ON_SITE_M2,
        MAT_STOR2,
        ON_SITE_M3,
        MAT_STOR3,
        AREA_ORIG,
        HEAT_SOURC,
        FIRST_IGN,
        CONF_ORIG,
        TYPE_MAT,
        CAUSE_IGN,
        FACT_IGN_1,
        FACT_IGN_2,
        HUM_FAC_1,
        HUM_FAC_2,
        HUM_FAC_3,
        HUM_FAC_4,
        HUM_FAC_5,
        HUM_FAC_6,
        HUM_FAC_7,
        HUM_FAC_8,
        AGE_UPDATE AS AGE,
        SEX,
        EQUIP_INV,
        SUP_FAC_1,
        SUP_FAC_2,
        SUP_FAC_3,
        MOB_INVOL,
        MOB_TYPE,
        MOB_MAKE,
        MOB_MODEL,
        MOB_YEAR,
        MOB_LIC_PL,
        MOB_STATE,
        MOB_VIN_NO,
        EQ_BRAND,
        EQ_MODEL,
        EQ_SER_NO,
        EQ_YEAR,
        EQ_POWER,
        EQ_PORT,
        FIRE_SPRD,
        STRUC_TYPE,
        STRUC_STAT,
        BLDG_ABOVE_UPDATE AS BLDG_ABOVE,
        BLDG_BELOW_UPDATE AS BLDG_BELOW,
        BLDG_LGTH_UPDATE AS BLDG_LGTH,
        BLDG_WIDTH_UPDATE AS BLDG_WIDTH,
        TOT_SQ_FT_UPDATE AS TOT_SQ_FT,
        FIRE_ORIG,
        ST_DAM_MIN_UPDATE AS ST_DM_MIN_UPDATE,
        ST_DAM_SIG_UPDATE AS ST_DM_SIG,
        ST_DAM_HVY_UPDATE AS ST_DAM_HVY,
        ST_DAM_XTR_UPDATE AS ST_DAM_XTR,
        FLAME_SPRD,
        ITEM_SPRD,
        MAT_SPRD,
        DETECTOR,
        DET_TYPE,
        DET_POWER,
        DET_OPERAT,
        DET_EFFECT,
        DET_FAIL,
        AES_PRES,
        AES_TYPE,
        AES_OPER,
        NO_SPR_OP_UPDATE AS NO_SPR_OP,
        AES_FAIL
    FROM fireincident_col_data_type_update
)

SELECT * FROM fireincident_final
    );
  
  
[0m11:33:42.194365 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Fire Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - NUM_UNIT --> FLOAT
    - BLDG_INVOL --> FLOAT
    - ACRES_BURN --> FLOAT
    - AGE --> INTEGER
    - BLDG_ABOVE --> FLOAT
    - BLDG_BELOW --> FLOAT
    - BLDG_LGTH --> FLOAT
    - BLDG_WIDTH --> FLOAT
    - TOT_SQ_FT --> FLOAT
    - ST_DAM_MIN --> FLOAT
    - ST_DAM_SIG --> FLOAT
    - ST_DAM_HVY --> FLOAT
    - ST_DAM_XTR --> FLOAT
    - NO_SPR_OP --> FLOAT
***/



WITH fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."fireincident"
),

fireincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(NUM_UNIT AS FLOAT) AS NUM_UNIT_UPDATE,
        CAST(BLDG_INVOL AS FLOAT) AS BLDG_INVOL_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(BLDG_ABOVE AS FLOAT) AS BLDG_ABOVE_UPDATE,
        CAST(BLDG_BELOW AS FLOAT) AS BLDG_BELOW_UPDATE,
        CAST(BLDG_LGTH AS FLOAT) AS BLDG_LGTH_UPDATE,
        CAST(BLDG_WIDTH AS FLOAT) AS BLDG_WIDTH_UPDATE,
        CAST(TOT_SQ_FT AS FLOAT) AS TOT_SQ_FT_UPDATE,
        CAST(ST_DAM_MIN AS FLOAT) AS ST_DAM_MIN_UPDATE,
        CAST(ST_DAM_SIG AS FLOAT) AS ST_DAM_SIG_UPDATE,
        CAST(ST_DAM_HVY AS FLOAT) AS ST_DAM_HVY_UPDATE,
        CAST(ST_DAM_XTR AS FLOAT) AS ST_DAM_XTR_UPDATE,
        CAST(NO_SPR_OP AS FLOAT) AS NO_SPR_OP_UPDATE
    FROM fireincident_source
),

WITH fireincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        NUM_UNIT_UPDATE AS NUM_UNIT,
        NOT_RES,
        BLDG_INVOL_UPDATE AS BLDG_INVOL,
        ACRES_BURN_UPDATE AS ACRES_BURN,
        LESS_1ACRE,
        ON_SITE_M1,
        MAT_STOR1,
        ON_SITE_M2,
        MAT_STOR2,
        ON_SITE_M3,
        MAT_STOR3,
        AREA_ORIG,
        HEAT_SOURC,
        FIRST_IGN,
        CONF_ORIG,
        TYPE_MAT,
        CAUSE_IGN,
        FACT_IGN_1,
        FACT_IGN_2,
        HUM_FAC_1,
        HUM_FAC_2,
        HUM_FAC_3,
        HUM_FAC_4,
        HUM_FAC_5,
        HUM_FAC_6,
        HUM_FAC_7,
        HUM_FAC_8,
        AGE_UPDATE AS AGE,
        SEX,
        EQUIP_INV,
        SUP_FAC_1,
        SUP_FAC_2,
        SUP_FAC_3,
        MOB_INVOL,
        MOB_TYPE,
        MOB_MAKE,
        MOB_MODEL,
        MOB_YEAR,
        MOB_LIC_PL,
        MOB_STATE,
        MOB_VIN_NO,
        EQ_BRAND,
        EQ_MODEL,
        EQ_SER_NO,
        EQ_YEAR,
        EQ_POWER,
        EQ_PORT,
        FIRE_SPRD,
        STRUC_TYPE,
        STRUC_STAT,
        BLDG_ABOVE_UPDATE AS BLDG_ABOVE,
        BLDG_BELOW_UPDATE AS BLDG_BELOW,
        BLDG_LGTH_UPDATE AS BLDG_LGTH,
        BLDG_WIDTH_UPDATE AS BLDG_WIDTH,
        TOT_SQ_FT_UPDATE AS TOT_SQ_FT,
        FIRE_ORIG,
        ST_DAM_MIN_UPDATE AS ST_DM_MIN_UPDATE,
        ST_DAM_SIG_UPDATE AS ST_DM_SIG,
        ST_DAM_HVY_UPDATE AS ST_DAM_HVY,
        ST_DAM_XTR_UPDATE AS ST_DAM_XTR,
        FLAME_SPRD,
        ITEM_SPRD,
        MAT_SPRD,
        DETECTOR,
        DET_TYPE,
        DET_POWER,
        DET_OPERAT,
        DET_EFFECT,
        DET_FAIL,
        AES_PRES,
        AES_TYPE,
        AES_OPER,
        NO_SPR_OP_UPDATE AS NO_SPR_OP,
        AES_FAIL
    FROM fireincident_col_data_type_update
)

SELECT * FROM fireincident_final
    );
  
  
[0m11:33:42.194365 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:33:42.194365 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fireincident: ROLLBACK
[0m11:33:42.194365 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__fireincident'
[0m11:33:42.194365 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fireincident: Close
[0m11:33:42.210377 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__fireincident (models\nfirs_transformed\nfirs_transformed__fireincident.sql)
  Parser Error: syntax error at or near "WITH"
[0m11:33:42.210377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2859e8ed-f180-4a51-a095-cc9a0db67a47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B575DBFB0>]}
[0m11:33:42.210377 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__fireincident  [[31mERROR[0m in 0.07s]
[0m11:33:42.210377 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__fireincident
[0m11:33:42.210377 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:42.210377 [debug] [MainThread]: On master: BEGIN
[0m11:33:42.210377 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:42.234865 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:42.234865 [debug] [MainThread]: On master: COMMIT
[0m11:33:42.234865 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:42.234865 [debug] [MainThread]: On master: COMMIT
[0m11:33:42.237173 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:42.237173 [debug] [MainThread]: On master: Close
[0m11:33:42.241860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:42.243030 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m11:33:42.243030 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:33:42.243030 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:33:42.244084 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__fireincident' was properly closed.
[0m11:33:42.244084 [info ] [MainThread]: 
[0m11:33:42.245290 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m11:33:42.245290 [debug] [MainThread]: Command end result
[0m11:33:42.268739 [info ] [MainThread]: 
[0m11:33:42.268739 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:33:42.269776 [info ] [MainThread]: 
[0m11:33:42.269857 [error] [MainThread]:   Runtime Error in model nfirs_transformed__fireincident (models\nfirs_transformed\nfirs_transformed__fireincident.sql)
  Parser Error: syntax error at or near "WITH"
[0m11:33:42.269857 [info ] [MainThread]: 
[0m11:33:42.269857 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:33:42.270937 [debug] [MainThread]: Command `cli run` failed at 11:33:42.270937 after 0.93 seconds
[0m11:33:42.270937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B56AC94C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B55623380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027B556230B0>]}
[0m11:33:42.272053 [debug] [MainThread]: Flushing usage events
[0m11:33:55.689215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E345862120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E345863B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E345863A70>]}


============================== 11:33:55.702228 | 1721f8f6-7258-4b37-a1cf-d4535020dd0d ==============================
[0m11:33:55.702228 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:33:55.702932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m11:33:55.886533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1721f8f6-7258-4b37-a1cf-d4535020dd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3451990A0>]}
[0m11:33:55.943103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1721f8f6-7258-4b37-a1cf-d4535020dd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E346C86D80>]}
[0m11:33:55.943103 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:33:55.953909 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:33:56.102798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:33:56.102798 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:33:56.135991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1721f8f6-7258-4b37-a1cf-d4535020dd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E347157E30>]}
[0m11:33:56.252829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1721f8f6-7258-4b37-a1cf-d4535020dd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E34741EA20>]}
[0m11:33:56.252829 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m11:33:56.252829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1721f8f6-7258-4b37-a1cf-d4535020dd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3470B31D0>]}
[0m11:33:56.252829 [info ] [MainThread]: 
[0m11:33:56.252829 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:33:56.252829 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:33:56.320864 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:33:56.320864 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:33:56.320864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:56.355180 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:56.355180 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:33:56.355180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m11:33:56.355180 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m11:33:56.368697 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:33:56.369420 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:33:56.369420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:56.385879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:56.385879 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:33:56.385879 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m11:33:56.385879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:56.385879 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:33:56.385879 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m11:33:56.385879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:56.385879 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:33:56.385879 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:33:56.385879 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:33:56.385879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:56.385879 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m11:33:56.402448 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:33:56.402448 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:33:56.402448 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:33:56.402448 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:33:56.402448 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:33:56.402448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:56.402448 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:33:56.419614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:56.435756 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:56.435756 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:56.435756 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:33:56.435756 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:33:56.435756 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:33:56.435756 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:33:56.469325 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:56.469325 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:56.469325 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:33:56.469325 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:33:56.469325 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:33:56.469325 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:33:56.469325 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:33:56.469325 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:33:56.485919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1721f8f6-7258-4b37-a1cf-d4535020dd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E347194A40>]}
[0m11:33:56.485919 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:56.485919 [debug] [MainThread]: On master: BEGIN
[0m11:33:56.485919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:56.502563 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:56.502563 [debug] [MainThread]: On master: COMMIT
[0m11:33:56.502563 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:56.502563 [debug] [MainThread]: On master: COMMIT
[0m11:33:56.502563 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:56.502563 [debug] [MainThread]: On master: Close
[0m11:33:56.518479 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:33:56.519327 [info ] [MainThread]: 
[0m11:33:56.519327 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__fireincident
[0m11:33:56.519327 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__fireincident . [RUN]
[0m11:33:56.519327 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__fireincident'
[0m11:33:56.519327 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__fireincident
[0m11:33:56.526569 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"
[0m11:33:56.526569 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__fireincident
[0m11:33:56.554343 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"
[0m11:33:56.554343 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"
[0m11:33:56.554343 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fireincident: BEGIN
[0m11:33:56.554343 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:33:56.585939 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:56.585939 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"
[0m11:33:56.585939 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fireincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Fire Incident Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - NUM_UNIT --> FLOAT
    - BLDG_INVOL --> FLOAT
    - ACRES_BURN --> FLOAT
    - AGE --> INTEGER
    - BLDG_ABOVE --> FLOAT
    - BLDG_BELOW --> FLOAT
    - BLDG_LGTH --> FLOAT
    - BLDG_WIDTH --> FLOAT
    - TOT_SQ_FT --> FLOAT
    - ST_DAM_MIN --> FLOAT
    - ST_DAM_SIG --> FLOAT
    - ST_DAM_HVY --> FLOAT
    - ST_DAM_XTR --> FLOAT
    - NO_SPR_OP --> FLOAT
***/



WITH fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."fireincident"
),

fireincident_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(NUM_UNIT AS FLOAT) AS NUM_UNIT_UPDATE,
        CAST(BLDG_INVOL AS FLOAT) AS BLDG_INVOL_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(BLDG_ABOVE AS FLOAT) AS BLDG_ABOVE_UPDATE,
        CAST(BLDG_BELOW AS FLOAT) AS BLDG_BELOW_UPDATE,
        CAST(BLDG_LGTH AS FLOAT) AS BLDG_LGTH_UPDATE,
        CAST(BLDG_WIDTH AS FLOAT) AS BLDG_WIDTH_UPDATE,
        CAST(TOT_SQ_FT AS FLOAT) AS TOT_SQ_FT_UPDATE,
        CAST(ST_DAM_MIN AS FLOAT) AS ST_DAM_MIN_UPDATE,
        CAST(ST_DAM_SIG AS FLOAT) AS ST_DAM_SIG_UPDATE,
        CAST(ST_DAM_HVY AS FLOAT) AS ST_DAM_HVY_UPDATE,
        CAST(ST_DAM_XTR AS FLOAT) AS ST_DAM_XTR_UPDATE,
        CAST(NO_SPR_OP AS FLOAT) AS NO_SPR_OP_UPDATE
    FROM fireincident_source
),

fireincident_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        NUM_UNIT_UPDATE AS NUM_UNIT,
        NOT_RES,
        BLDG_INVOL_UPDATE AS BLDG_INVOL,
        ACRES_BURN_UPDATE AS ACRES_BURN,
        LESS_1ACRE,
        ON_SITE_M1,
        MAT_STOR1,
        ON_SITE_M2,
        MAT_STOR2,
        ON_SITE_M3,
        MAT_STOR3,
        AREA_ORIG,
        HEAT_SOURC,
        FIRST_IGN,
        CONF_ORIG,
        TYPE_MAT,
        CAUSE_IGN,
        FACT_IGN_1,
        FACT_IGN_2,
        HUM_FAC_1,
        HUM_FAC_2,
        HUM_FAC_3,
        HUM_FAC_4,
        HUM_FAC_5,
        HUM_FAC_6,
        HUM_FAC_7,
        HUM_FAC_8,
        AGE_UPDATE AS AGE,
        SEX,
        EQUIP_INV,
        SUP_FAC_1,
        SUP_FAC_2,
        SUP_FAC_3,
        MOB_INVOL,
        MOB_TYPE,
        MOB_MAKE,
        MOB_MODEL,
        MOB_YEAR,
        MOB_LIC_PL,
        MOB_STATE,
        MOB_VIN_NO,
        EQ_BRAND,
        EQ_MODEL,
        EQ_SER_NO,
        EQ_YEAR,
        EQ_POWER,
        EQ_PORT,
        FIRE_SPRD,
        STRUC_TYPE,
        STRUC_STAT,
        BLDG_ABOVE_UPDATE AS BLDG_ABOVE,
        BLDG_BELOW_UPDATE AS BLDG_BELOW,
        BLDG_LGTH_UPDATE AS BLDG_LGTH,
        BLDG_WIDTH_UPDATE AS BLDG_WIDTH,
        TOT_SQ_FT_UPDATE AS TOT_SQ_FT,
        FIRE_ORIG,
        ST_DAM_MIN_UPDATE AS ST_DM_MIN_UPDATE,
        ST_DAM_SIG_UPDATE AS ST_DM_SIG,
        ST_DAM_HVY_UPDATE AS ST_DAM_HVY,
        ST_DAM_XTR_UPDATE AS ST_DAM_XTR,
        FLAME_SPRD,
        ITEM_SPRD,
        MAT_SPRD,
        DETECTOR,
        DET_TYPE,
        DET_POWER,
        DET_OPERAT,
        DET_EFFECT,
        DET_FAIL,
        AES_PRES,
        AES_TYPE,
        AES_OPER,
        NO_SPR_OP_UPDATE AS NO_SPR_OP,
        AES_FAIL
    FROM fireincident_col_data_type_update
)

SELECT * FROM fireincident_final
    );
  
  
[0m11:33:57.651740 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m11:33:57.651740 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"
[0m11:33:57.651740 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fireincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident__dbt_tmp" rename to "nfirs_transformed__fireincident"
[0m11:33:57.651740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:57.668217 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fireincident: COMMIT
[0m11:33:57.668217 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"
[0m11:33:57.668217 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fireincident: COMMIT
[0m11:33:59.890354 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m11:33:59.901377 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"
[0m11:33:59.901377 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fireincident: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__fireincident"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident__dbt_backup" cascade
[0m11:33:59.901377 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:59.901377 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__fireincident: Close
[0m11:33:59.950886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1721f8f6-7258-4b37-a1cf-d4535020dd0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E347746D50>]}
[0m11:33:59.950886 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__fireincident  [[32mOK[0m in 3.43s]
[0m11:33:59.950886 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__fireincident
[0m11:33:59.950886 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:59.950886 [debug] [MainThread]: On master: BEGIN
[0m11:33:59.950886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:59.984050 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:59.984370 [debug] [MainThread]: On master: COMMIT
[0m11:33:59.984370 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:59.985341 [debug] [MainThread]: On master: COMMIT
[0m11:33:59.985341 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:59.985341 [debug] [MainThread]: On master: Close
[0m11:33:59.990764 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:59.990764 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m11:33:59.990764 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:33:59.990764 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:33:59.990764 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__fireincident' was properly closed.
[0m11:33:59.990764 [info ] [MainThread]: 
[0m11:33:59.990764 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m11:33:59.996026 [debug] [MainThread]: Command end result
[0m11:34:00.021476 [info ] [MainThread]: 
[0m11:34:00.021476 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:34:00.021476 [info ] [MainThread]: 
[0m11:34:00.021476 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:34:00.021476 [debug] [MainThread]: Command `cli run` succeeded at 11:34:00.021476 after 4.46 seconds
[0m11:34:00.021476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E34513AE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E346E34FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E34525BF80>]}
[0m11:34:00.021476 [debug] [MainThread]: Flushing usage events
[0m11:41:29.946973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFCFA6CE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFCFA6C6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFCFA6E270>]}


============================== 11:41:29.946973 | 49002f4e-0d15-4ee8-a8a4-42c334bd10ca ==============================
[0m11:41:29.946973 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:41:29.946973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:41:30.146586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49002f4e-0d15-4ee8-a8a4-42c334bd10ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFCF0E4560>]}
[0m11:41:30.196876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49002f4e-0d15-4ee8-a8a4-42c334bd10ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD18E46B0>]}
[0m11:41:30.212604 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:41:30.213385 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:41:30.387719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:30.387719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:30.413691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49002f4e-0d15-4ee8-a8a4-42c334bd10ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD1AC86E0>]}
[0m11:41:30.513469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49002f4e-0d15-4ee8-a8a4-42c334bd10ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD1D46B40>]}
[0m11:41:30.513469 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m11:41:30.513469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49002f4e-0d15-4ee8-a8a4-42c334bd10ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD1A9CEF0>]}
[0m11:41:30.513469 [info ] [MainThread]: 
[0m11:41:30.513469 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:41:30.513469 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:41:30.596614 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:41:30.596614 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:41:30.596614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:30.630048 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:30.630048 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:41:30.630048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m11:41:30.630048 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m11:41:30.646745 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:41:30.646745 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:41:30.646745 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:30.663330 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:30.663330 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:41:30.663330 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m11:41:30.663330 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:30.663330 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:41:30.663330 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m11:41:30.663330 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:30.663330 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:41:30.663330 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:41:30.663330 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:41:30.663330 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:30.663330 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m11:41:30.679971 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:41:30.679971 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:41:30.679971 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:41:30.679971 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:41:30.679971 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:41:30.695828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:30.696358 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:41:30.713312 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:30.713312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:30.713312 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:41:30.713312 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:30.713312 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:41:30.713312 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:41:30.713312 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:41:30.746423 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:30.746423 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:30.746423 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:41:30.746423 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:41:30.746423 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:41:30.762628 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:41:30.762628 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:41:30.763394 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:41:30.763394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49002f4e-0d15-4ee8-a8a4-42c334bd10ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD19E32C0>]}
[0m11:41:30.763394 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:30.763394 [debug] [MainThread]: On master: BEGIN
[0m11:41:30.763394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:30.795259 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:30.795822 [debug] [MainThread]: On master: COMMIT
[0m11:41:30.795822 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:30.795822 [debug] [MainThread]: On master: COMMIT
[0m11:41:30.795822 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:30.795822 [debug] [MainThread]: On master: Close
[0m11:41:30.803856 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:41:30.803856 [info ] [MainThread]: 
[0m11:41:30.803856 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:41:30.803856 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__hazchem ...... [RUN]
[0m11:41:30.803856 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazchem'
[0m11:41:30.803856 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:41:30.817752 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:41:30.817752 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:41:30.849430 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:41:30.849430 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:41:30.849430 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: BEGIN
[0m11:41:30.849430 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:41:30.863758 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:30.863758 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:41:30.863758 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazchem__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Chemical Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - CONT_CAP --> FLOAT
    - AMOUNT_REL --> FLOAT
***/



WITH hazchem_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazchem"
),

hazchem_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(CONT_CAP AS FLOAT) AS CONT_CAP_UPDATE,
        CAST(AMOUNT_REL AS FLOAT) AS AMOUNT_REL_UPDATE
    FROM hazchem_source
),

hazchem_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SEQ_NUMBER,
        VERSION,
        UN_NUMBER,
        DOT_CLASS,
        CAS_REGIS,
        CHEM_NAME,
        CONT_TYPE,
        CONT_CAP_UPDATE AS CONT_CAP,
        CAP_UNIT,
        AMOUNT_REL_UPDATE as AMOUNT_REL,
        UNIT_REL,
        PHYS_STATE,
        REL_INTO
)

SELECT * FROM hazchem_final
    );
  
  
[0m11:41:30.863758 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazchem__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Chemical Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - CONT_CAP --> FLOAT
    - AMOUNT_REL --> FLOAT
***/



WITH hazchem_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazchem"
),

hazchem_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(CONT_CAP AS FLOAT) AS CONT_CAP_UPDATE,
        CAST(AMOUNT_REL AS FLOAT) AS AMOUNT_REL_UPDATE
    FROM hazchem_source
),

hazchem_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SEQ_NUMBER,
        VERSION,
        UN_NUMBER,
        DOT_CLASS,
        CAS_REGIS,
        CHEM_NAME,
        CONT_TYPE,
        CONT_CAP_UPDATE AS CONT_CAP,
        CAP_UNIT,
        AMOUNT_REL_UPDATE as AMOUNT_REL,
        UNIT_REL,
        PHYS_STATE,
        REL_INTO
)

SELECT * FROM hazchem_final
    );
  
  
[0m11:41:30.863758 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:41:30.880054 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: ROLLBACK
[0m11:41:30.880054 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__hazchem'
[0m11:41:30.880054 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: Close
[0m11:41:30.880054 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__hazchem (models\nfirs_transformed\nfirs_transformed__hazchem.sql)
  Binder Error: Referenced column "INCIDENT_KEY" not found in FROM clause!
  LINE 36:         INCIDENT_KEY,
                   ^
[0m11:41:30.880054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49002f4e-0d15-4ee8-a8a4-42c334bd10ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFCFD7F5C0>]}
[0m11:41:30.895900 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__hazchem  [[31mERROR[0m in 0.08s]
[0m11:41:30.895900 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:41:30.899678 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:30.899678 [debug] [MainThread]: On master: BEGIN
[0m11:41:30.899678 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:30.913024 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:30.913024 [debug] [MainThread]: On master: COMMIT
[0m11:41:30.913024 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:30.913024 [debug] [MainThread]: On master: COMMIT
[0m11:41:30.913024 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:30.913024 [debug] [MainThread]: On master: Close
[0m11:41:30.929696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:30.929696 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m11:41:30.929696 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:41:30.929696 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:41:30.929696 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazchem' was properly closed.
[0m11:41:30.929696 [info ] [MainThread]: 
[0m11:41:30.929696 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m11:41:30.933738 [debug] [MainThread]: Command end result
[0m11:41:30.950858 [info ] [MainThread]: 
[0m11:41:30.950858 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:41:30.950858 [info ] [MainThread]: 
[0m11:41:30.950858 [error] [MainThread]:   Runtime Error in model nfirs_transformed__hazchem (models\nfirs_transformed\nfirs_transformed__hazchem.sql)
  Binder Error: Referenced column "INCIDENT_KEY" not found in FROM clause!
  LINE 36:         INCIDENT_KEY,
                   ^
[0m11:41:30.950858 [info ] [MainThread]: 
[0m11:41:30.962493 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:41:30.964681 [debug] [MainThread]: Command `cli run` failed at 11:41:30.962493 after 1.14 seconds
[0m11:41:30.964681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD1667980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD1692600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFD16BB3E0>]}
[0m11:41:30.964681 [debug] [MainThread]: Flushing usage events
[0m11:41:48.246319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E6240D970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E38DD1D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E661789E0>]}


============================== 11:41:48.254912 | 14ba5a75-72b1-43d1-9dff-477e303b8799 ==============================
[0m11:41:48.254912 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:41:48.255594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:41:48.422061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14ba5a75-72b1-43d1-9dff-477e303b8799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E63B80680>]}
[0m11:41:48.471969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14ba5a75-72b1-43d1-9dff-477e303b8799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E66474440>]}
[0m11:41:48.487645 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:41:48.491837 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:41:48.638439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:48.638439 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:48.688767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14ba5a75-72b1-43d1-9dff-477e303b8799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E66493D10>]}
[0m11:41:48.772025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14ba5a75-72b1-43d1-9dff-477e303b8799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E6685EBA0>]}
[0m11:41:48.788413 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m11:41:48.788413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14ba5a75-72b1-43d1-9dff-477e303b8799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E66853F50>]}
[0m11:41:48.788413 [info ] [MainThread]: 
[0m11:41:48.788413 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:41:48.788413 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:41:48.856732 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:41:48.856732 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:41:48.856732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:48.887958 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:48.888547 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:41:48.888547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m11:41:48.888547 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m11:41:48.888547 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:41:48.888547 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:41:48.904218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:48.921990 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:48.921990 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:41:48.921990 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m11:41:48.921990 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:48.921990 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:41:48.921990 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m11:41:48.921990 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:48.921990 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:41:48.921990 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:41:48.921990 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:41:48.921990 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:48.921990 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m11:41:48.941401 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:41:48.941401 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:41:48.941401 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:41:48.954454 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:41:48.954454 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:41:48.954454 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:41:48.954454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:48.954454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:48.971839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:48.971839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:48.971839 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:41:48.971839 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:41:48.971839 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:41:48.971839 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:41:49.005046 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:49.022079 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:49.022079 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:41:49.022079 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:41:49.022079 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:41:49.022079 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:41:49.022079 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:41:49.022079 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:41:49.037922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14ba5a75-72b1-43d1-9dff-477e303b8799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E66BCA5A0>]}
[0m11:41:49.038495 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:49.038495 [debug] [MainThread]: On master: BEGIN
[0m11:41:49.038495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:49.061317 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:49.061317 [debug] [MainThread]: On master: COMMIT
[0m11:41:49.061317 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:49.062563 [debug] [MainThread]: On master: COMMIT
[0m11:41:49.062563 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:49.063716 [debug] [MainThread]: On master: Close
[0m11:41:49.068415 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:41:49.068415 [info ] [MainThread]: 
[0m11:41:49.077001 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:41:49.077001 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__hazchem ...... [RUN]
[0m11:41:49.078175 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazchem'
[0m11:41:49.078175 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:41:49.085324 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:41:49.085324 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:41:49.106768 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:41:49.106768 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:41:49.106768 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: BEGIN
[0m11:41:49.106768 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:41:49.138218 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:49.138218 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:41:49.138218 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazchem__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Chemical Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - CONT_CAP --> FLOAT
    - AMOUNT_REL --> FLOAT
***/



WITH hazchem_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazchem"
),

hazchem_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(CONT_CAP AS FLOAT) AS CONT_CAP_UPDATE,
        CAST(AMOUNT_REL AS FLOAT) AS AMOUNT_REL_UPDATE
    FROM hazchem_source
),

hazchem_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SEQ_NUMBER,
        VERSION,
        UN_NUMBER,
        DOT_CLASS,
        CAS_REGIS,
        CHEM_NAME,
        CONT_TYPE,
        CONT_CAP_UPDATE AS CONT_CAP,
        CAP_UNIT,
        AMOUNT_REL_UPDATE as AMOUNT_REL,
        UNIT_REL,
        PHYS_STATE,
        REL_INTO
    FROM hazchem_col_data_type_update
)

SELECT * FROM hazchem_final
    );
  
  
[0m11:41:49.138218 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazchem__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Chemical Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - CONT_CAP --> FLOAT
    - AMOUNT_REL --> FLOAT
***/



WITH hazchem_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazchem"
),

hazchem_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(CONT_CAP AS FLOAT) AS CONT_CAP_UPDATE,
        CAST(AMOUNT_REL AS FLOAT) AS AMOUNT_REL_UPDATE
    FROM hazchem_source
),

hazchem_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SEQ_NUMBER,
        VERSION,
        UN_NUMBER,
        DOT_CLASS,
        CAS_REGIS,
        CHEM_NAME,
        CONT_TYPE,
        CONT_CAP_UPDATE AS CONT_CAP,
        CAP_UNIT,
        AMOUNT_REL_UPDATE as AMOUNT_REL,
        UNIT_REL,
        PHYS_STATE,
        REL_INTO
    FROM hazchem_col_data_type_update
)

SELECT * FROM hazchem_final
    );
  
  
[0m11:41:49.138218 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:41:49.138218 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: ROLLBACK
[0m11:41:49.138218 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__hazchem'
[0m11:41:49.138218 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: Close
[0m11:41:49.155209 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__hazchem (models\nfirs_transformed\nfirs_transformed__hazchem.sql)
  Binder Error: Referenced column "UNIT_REL" not found in FROM clause!
  Candidate bindings: "hazchem_col_data_type_update.UNITS_REL", "hazchem_col_data_type_update.AMOUNT_REL"
  LINE 52:         UNIT_REL,
                   ^
[0m11:41:49.155209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14ba5a75-72b1-43d1-9dff-477e303b8799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E64833680>]}
[0m11:41:49.155209 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__hazchem  [[31mERROR[0m in 0.08s]
[0m11:41:49.155209 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:41:49.155209 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:49.155209 [debug] [MainThread]: On master: BEGIN
[0m11:41:49.155209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:49.179806 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:49.179806 [debug] [MainThread]: On master: COMMIT
[0m11:41:49.179806 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:49.179806 [debug] [MainThread]: On master: COMMIT
[0m11:41:49.179806 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:49.179806 [debug] [MainThread]: On master: Close
[0m11:41:49.187775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:49.187775 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m11:41:49.187775 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:41:49.187775 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:41:49.187775 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazchem' was properly closed.
[0m11:41:49.187775 [info ] [MainThread]: 
[0m11:41:49.187775 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m11:41:49.187775 [debug] [MainThread]: Command end result
[0m11:41:49.215430 [info ] [MainThread]: 
[0m11:41:49.215430 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:41:49.221035 [info ] [MainThread]: 
[0m11:41:49.221035 [error] [MainThread]:   Runtime Error in model nfirs_transformed__hazchem (models\nfirs_transformed\nfirs_transformed__hazchem.sql)
  Binder Error: Referenced column "UNIT_REL" not found in FROM clause!
  Candidate bindings: "hazchem_col_data_type_update.UNITS_REL", "hazchem_col_data_type_update.AMOUNT_REL"
  LINE 52:         UNIT_REL,
                   ^
[0m11:41:49.221035 [info ] [MainThread]: 
[0m11:41:49.221035 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:41:49.221035 [debug] [MainThread]: Command `cli run` failed at 11:41:49.221035 after 1.10 seconds
[0m11:41:49.221035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E6240D970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E662DC8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E65F0C8C0>]}
[0m11:41:49.221035 [debug] [MainThread]: Flushing usage events
[0m11:43:13.932652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214C78B5A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CA4601D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CA461220>]}


============================== 11:43:13.932652 | 039fc547-b909-4dca-bfa8-f8f31ff80103 ==============================
[0m11:43:13.932652 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:43:13.932652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:43:14.112112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '039fc547-b909-4dca-bfa8-f8f31ff80103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CBA44DD0>]}
[0m11:43:14.165141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '039fc547-b909-4dca-bfa8-f8f31ff80103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214C92B4500>]}
[0m11:43:14.165141 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:43:14.183861 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:43:14.333354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:43:14.333354 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:43:14.364705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '039fc547-b909-4dca-bfa8-f8f31ff80103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CBD258E0>]}
[0m11:43:14.464878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '039fc547-b909-4dca-bfa8-f8f31ff80103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CBD132C0>]}
[0m11:43:14.464878 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m11:43:14.464878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '039fc547-b909-4dca-bfa8-f8f31ff80103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CBD5C2C0>]}
[0m11:43:14.464878 [info ] [MainThread]: 
[0m11:43:14.464878 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:43:14.464878 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:43:14.533556 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:43:14.533556 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:43:14.533556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:14.569510 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:14.569510 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:43:14.569510 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m11:43:14.569510 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m11:43:14.585338 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:43:14.585338 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:43:14.585338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:14.600956 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:14.600956 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:43:14.600956 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m11:43:14.600956 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:14.600956 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:43:14.600956 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m11:43:14.600956 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:14.616477 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:43:14.616477 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:43:14.616477 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:43:14.616477 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:14.616477 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m11:43:14.616477 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:43:14.616477 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:43:14.633724 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:43:14.633724 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:43:14.633724 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:43:14.633724 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:43:14.633724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:14.633724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:14.649382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:14.649382 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:43:14.649382 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:14.665004 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:43:14.665004 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:43:14.665004 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:43:14.684275 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:14.699209 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:14.699209 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:43:14.699209 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:43:14.699209 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:43:14.699209 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:43:14.699209 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:43:14.699209 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:43:14.714904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '039fc547-b909-4dca-bfa8-f8f31ff80103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CC334440>]}
[0m11:43:14.714904 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:14.714904 [debug] [MainThread]: On master: BEGIN
[0m11:43:14.714904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:14.733638 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:43:14.733638 [debug] [MainThread]: On master: COMMIT
[0m11:43:14.733638 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:14.733638 [debug] [MainThread]: On master: COMMIT
[0m11:43:14.733638 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:43:14.733638 [debug] [MainThread]: On master: Close
[0m11:43:14.749297 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:43:14.749297 [info ] [MainThread]: 
[0m11:43:14.749297 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:43:14.749297 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__hazchem ...... [RUN]
[0m11:43:14.749297 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazchem'
[0m11:43:14.749297 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:43:14.756914 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:43:14.756914 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:43:14.784223 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:43:14.784223 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:43:14.784223 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: BEGIN
[0m11:43:14.784223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:43:14.816191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:14.816191 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:43:14.816191 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazchem__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Chemical Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - CONT_CAP --> FLOAT
    - AMOUNT_REL --> FLOAT
***/



WITH hazchem_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazchem"
),

hazchem_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(CONT_CAP AS FLOAT) AS CONT_CAP_UPDATE,
        CAST(AMOUNT_REL AS FLOAT) AS AMOUNT_REL_UPDATE
    FROM hazchem_source
),

hazchem_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SEQ_NUMBER,
        VERSION,
        UN_NUMBER,
        DOT_CLASS,
        CAS_REGIS,
        CHEM_NAME,
        CONT_TYPE,
        CONT_CAP_UPDATE AS CONT_CAP,
        CAP_UNIT,
        AMOUNT_REL_UPDATE AS AMOUNT_REL,
        UNIT_REL,
        PHYS_STATE,
        REL_INTO
    FROM hazchem_col_data_type_update
)

SELECT * FROM hazchem_final
    );
  
  
[0m11:43:14.816191 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazchem__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Chemical Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - CONT_CAP --> FLOAT
    - AMOUNT_REL --> FLOAT
***/



WITH hazchem_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazchem"
),

hazchem_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(CONT_CAP AS FLOAT) AS CONT_CAP_UPDATE,
        CAST(AMOUNT_REL AS FLOAT) AS AMOUNT_REL_UPDATE
    FROM hazchem_source
),

hazchem_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SEQ_NUMBER,
        VERSION,
        UN_NUMBER,
        DOT_CLASS,
        CAS_REGIS,
        CHEM_NAME,
        CONT_TYPE,
        CONT_CAP_UPDATE AS CONT_CAP,
        CAP_UNIT,
        AMOUNT_REL_UPDATE AS AMOUNT_REL,
        UNIT_REL,
        PHYS_STATE,
        REL_INTO
    FROM hazchem_col_data_type_update
)

SELECT * FROM hazchem_final
    );
  
  
[0m11:43:14.816191 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:43:14.816191 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: ROLLBACK
[0m11:43:14.816191 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__hazchem'
[0m11:43:14.816191 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: Close
[0m11:43:14.834469 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__hazchem (models\nfirs_transformed\nfirs_transformed__hazchem.sql)
  Binder Error: Referenced column "UNIT_REL" not found in FROM clause!
  Candidate bindings: "hazchem_col_data_type_update.UNITS_REL", "hazchem_col_data_type_update.AMOUNT_REL"
  LINE 52:         UNIT_REL,
                   ^
[0m11:43:14.834469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '039fc547-b909-4dca-bfa8-f8f31ff80103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214C9F37770>]}
[0m11:43:14.834469 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__hazchem  [[31mERROR[0m in 0.09s]
[0m11:43:14.834469 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:43:14.834469 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:14.834469 [debug] [MainThread]: On master: BEGIN
[0m11:43:14.834469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:14.859201 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:43:14.859201 [debug] [MainThread]: On master: COMMIT
[0m11:43:14.865839 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:14.865839 [debug] [MainThread]: On master: COMMIT
[0m11:43:14.866826 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:43:14.866826 [debug] [MainThread]: On master: Close
[0m11:43:14.870291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:14.870291 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m11:43:14.870291 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:43:14.870291 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:43:14.870291 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazchem' was properly closed.
[0m11:43:14.870291 [info ] [MainThread]: 
[0m11:43:14.870291 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m11:43:14.870291 [debug] [MainThread]: Command end result
[0m11:43:14.903532 [info ] [MainThread]: 
[0m11:43:14.903532 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:43:14.903532 [info ] [MainThread]: 
[0m11:43:14.903532 [error] [MainThread]:   Runtime Error in model nfirs_transformed__hazchem (models\nfirs_transformed\nfirs_transformed__hazchem.sql)
  Binder Error: Referenced column "UNIT_REL" not found in FROM clause!
  Candidate bindings: "hazchem_col_data_type_update.UNITS_REL", "hazchem_col_data_type_update.AMOUNT_REL"
  LINE 52:         UNIT_REL,
                   ^
[0m11:43:14.903532 [info ] [MainThread]: 
[0m11:43:14.903532 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:43:14.903532 [debug] [MainThread]: Command `cli run` failed at 11:43:14.903532 after 1.10 seconds
[0m11:43:14.903532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214C78B5A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214CB87F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214C9DDFF80>]}
[0m11:43:14.903532 [debug] [MainThread]: Flushing usage events
[0m11:43:37.055254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B0F88AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5AEEBDD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5AEEBD940>]}


============================== 11:43:37.073350 | 79b2d60e-8bdf-4ccc-b2cd-1c2f52d565c6 ==============================
[0m11:43:37.073350 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:43:37.073350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:43:37.258547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79b2d60e-8bdf-4ccc-b2cd-1c2f52d565c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5AE994500>]}
[0m11:43:37.310341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79b2d60e-8bdf-4ccc-b2cd-1c2f52d565c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B119C890>]}
[0m11:43:37.310341 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:43:37.322662 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:43:37.472326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:43:37.472326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:43:37.522465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79b2d60e-8bdf-4ccc-b2cd-1c2f52d565c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B12097F0>]}
[0m11:43:37.610782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79b2d60e-8bdf-4ccc-b2cd-1c2f52d565c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B1676A80>]}
[0m11:43:37.610782 [info ] [MainThread]: Found 20 models, 4 data tests, 19 sources, 524 macros
[0m11:43:37.610782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79b2d60e-8bdf-4ccc-b2cd-1c2f52d565c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5B1354320>]}
[0m11:43:37.610782 [info ] [MainThread]: 
[0m11:43:37.622192 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:43:37.622192 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:43:37.690339 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:43:37.690339 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:43:37.690339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:37.710927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:37.710927 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:43:37.725148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m11:43:37.725148 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m11:43:37.725148 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:43:37.725148 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:43:37.725148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:37.746476 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:37.754451 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:43:37.754451 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m11:43:37.754451 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:37.754451 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:43:37.754451 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m11:43:37.754451 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:37.754451 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:43:37.754451 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:43:37.754451 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:43:37.754451 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:37.754451 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m11:43:37.771612 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:43:37.772315 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:43:37.772315 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:43:37.772315 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:43:37.772315 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:43:37.772315 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:43:37.772315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:37.772315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:37.805374 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:37.805374 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:37.805374 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:43:37.805374 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:43:37.805374 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:43:37.805374 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:43:37.839131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:37.839131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:37.839131 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:43:37.839131 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:43:37.839131 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:43:37.839131 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:43:37.854897 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:43:37.855646 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:43:37.855646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79b2d60e-8bdf-4ccc-b2cd-1c2f52d565c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5AE9BF7D0>]}
[0m11:43:37.855646 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:37.855646 [debug] [MainThread]: On master: BEGIN
[0m11:43:37.855646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:37.872050 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:43:37.872050 [debug] [MainThread]: On master: COMMIT
[0m11:43:37.872050 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:37.872050 [debug] [MainThread]: On master: COMMIT
[0m11:43:37.872050 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:43:37.872050 [debug] [MainThread]: On master: Close
[0m11:43:37.888875 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:43:37.888875 [info ] [MainThread]: 
[0m11:43:37.888875 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:43:37.888875 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__hazchem ...... [RUN]
[0m11:43:37.888875 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazchem'
[0m11:43:37.888875 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:43:37.898640 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:43:37.898640 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:43:37.933080 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:43:37.933080 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:43:37.933080 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: BEGIN
[0m11:43:37.933080 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:43:37.955468 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:37.955468 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:43:37.955468 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazchem__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Chemical Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - CONT_CAP --> FLOAT
    - AMOUNT_REL --> FLOAT
***/



WITH hazchem_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazchem"
),

hazchem_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(CONT_CAP AS FLOAT) AS CONT_CAP_UPDATE,
        CAST(AMOUNT_REL AS FLOAT) AS AMOUNT_REL_UPDATE
    FROM hazchem_source
),

hazchem_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        SEQ_NUMBER,
        VERSION,
        UN_NUMBER,
        DOT_CLASS,
        CAS_REGIS,
        CHEM_NAME,
        CONT_TYPE,
        CONT_CAP_UPDATE AS CONT_CAP,
        CAP_UNIT,
        AMOUNT_REL_UPDATE AS AMOUNT_REL,
        UNITS_REL,
        PHYS_STATE,
        REL_INTO
    FROM hazchem_col_data_type_update
)

SELECT * FROM hazchem_final
    );
  
  
[0m11:43:37.989562 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:38.005070 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:43:38.005638 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__hazchem__dbt_tmp" rename to "nfirs_transformed__hazchem"
[0m11:43:38.006583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:38.022224 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: COMMIT
[0m11:43:38.022224 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:43:38.022224 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: COMMIT
[0m11:43:38.122769 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:38.139274 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"
[0m11:43:38.139274 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazchem"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__hazchem__dbt_backup" cascade
[0m11:43:38.139274 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:38.139274 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazchem: Close
[0m11:43:39.538263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b2d60e-8bdf-4ccc-b2cd-1c2f52d565c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5AE95B5C0>]}
[0m11:43:39.538263 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__hazchem . [[32mOK[0m in 1.65s]
[0m11:43:39.554627 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__hazchem
[0m11:43:39.554627 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:39.554627 [debug] [MainThread]: On master: BEGIN
[0m11:43:39.554627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:39.570625 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:43:39.608032 [debug] [MainThread]: On master: COMMIT
[0m11:43:39.608032 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:39.608032 [debug] [MainThread]: On master: COMMIT
[0m11:43:39.608032 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:43:39.608032 [debug] [MainThread]: On master: Close
[0m11:43:39.613531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:39.613531 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m11:43:39.613531 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:43:39.613531 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:43:39.613531 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazchem' was properly closed.
[0m11:43:39.620692 [info ] [MainThread]: 
[0m11:43:39.620692 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m11:43:39.621698 [debug] [MainThread]: Command end result
[0m11:43:39.646323 [info ] [MainThread]: 
[0m11:43:39.646323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:39.646323 [info ] [MainThread]: 
[0m11:43:39.646323 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:43:39.646323 [debug] [MainThread]: Command `cli run` succeeded at 11:43:39.646323 after 2.73 seconds
[0m11:43:39.646323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5AF592300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5AEF4AFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5AF740A10>]}
[0m11:43:39.646323 [debug] [MainThread]: Flushing usage events
[0m11:55:10.914758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A39457740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A0EBE1D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3BF28C50>]}


============================== 11:55:10.918946 | d3f791e7-9c9d-44a7-9ebb-0803fb49a02b ==============================
[0m11:55:10.918946 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:55:10.920019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:55:11.107299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3f791e7-9c9d-44a7-9ebb-0803fb49a02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A39934290>]}
[0m11:55:11.156951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3f791e7-9c9d-44a7-9ebb-0803fb49a02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3C12DA30>]}
[0m11:55:11.156951 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:55:11.177044 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:55:11.326805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:11.326805 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:11.357057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3f791e7-9c9d-44a7-9ebb-0803fb49a02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3C377D70>]}
[0m11:55:11.457158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3f791e7-9c9d-44a7-9ebb-0803fb49a02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3C63B0B0>]}
[0m11:55:11.457158 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m11:55:11.457158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3f791e7-9c9d-44a7-9ebb-0803fb49a02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3C2B32C0>]}
[0m11:55:11.457158 [info ] [MainThread]: 
[0m11:55:11.457158 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:55:11.457158 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:55:11.525847 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:55:11.539615 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:55:11.539615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:11.563672 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:11.563672 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:55:11.563672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m11:55:11.571696 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m11:55:11.573669 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:11.573669 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:55:11.573669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:11.590343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:11.590343 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:11.590343 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m11:55:11.590343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:11.590343 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:11.590343 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m11:55:11.590343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:11.590343 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:55:11.590343 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:11.590343 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:55:11.590343 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:11.590343 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m11:55:11.606737 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:55:11.606737 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:55:11.622860 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:55:11.622860 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:55:11.623630 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:55:11.623630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:11.623630 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:55:11.640255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:11.640255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:11.640255 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:11.640255 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:55:11.640255 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:55:11.640255 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:55:11.640255 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:55:11.673392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:11.673392 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:11.690246 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:55:11.690246 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:55:11.690246 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:55:11.690246 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:55:11.690246 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:55:11.690246 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:55:11.690246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3f791e7-9c9d-44a7-9ebb-0803fb49a02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3C30EDE0>]}
[0m11:55:11.690246 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:11.690246 [debug] [MainThread]: On master: BEGIN
[0m11:55:11.690246 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:11.723499 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:11.723499 [debug] [MainThread]: On master: COMMIT
[0m11:55:11.723499 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:11.723499 [debug] [MainThread]: On master: COMMIT
[0m11:55:11.723499 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:11.723499 [debug] [MainThread]: On master: Close
[0m11:55:11.723499 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:55:11.723499 [info ] [MainThread]: 
[0m11:55:11.723499 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:11.723499 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__hazmat ....... [RUN]
[0m11:55:11.723499 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmat'
[0m11:55:11.723499 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:11.739588 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:11.747842 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:11.775449 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:11.775449 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:11.775449 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: BEGIN
[0m11:55:11.775449 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:55:11.792171 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:55:11.792171 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:11.792171 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazmat__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - REL_STORY --> FLOAT
    - POP_DENS --> FLOAT
    - AFFEC_MEAS --> FLOAT
    - EVAC_MEAS --> FLOAT
    - PEOP_EVAC --> FLOAT
    - BLDG_EVAC --> FLOAT
    - HAZ_DEATH --> FLOAT
    - HAZ_INJ --> FLOAT
***/



WITH hazmat_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazmat"
),

SELECT hazmat_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(REL_STORY AS FLOAT) AS REL_STORY_UPDATE,
        CAST(POP_DENS AS FLOAT) AS POP_DENS_UPDATE,
        CAST(AFFEC_MEAS AS FLOAT) AS AFFEC_MEAS_UPDATE,
        CAST(EVAC_MEAS AS FLOAT) AS EVAC_MEAS_UPDATE,
        CAST(PEOP_EVAC AS FLOAT) AS PEOP_EVAC_UPDATE,
        CAST(BLDG_EVAC AS FLOAT) AS BLDG_EVAC_UPDATE,
        CAST(HAZ_DEATH AS FLOAT) AS HAZ_DEATH_UPDATE,
        CAST(HAZ_INJ AS FLOAT) AS HAZ_INJ_UPDATE
    FROM hazmat_source
),

hazmat_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        REL_FROM,
        REL_STORY_UPDATE AS REL_STORY,
        POP_DENS_UPDATE AS POP_DENS,
        AFFEC_MEAS_UPDATE AS AFFEC_MEAS,
        AFFEC_UNIT,
        EVAC_MEAS_UPDATE AS EVAC_MEAS,
        EVAC_UNIT,
        PEOP_EVAC_UPDATE AS PEOP_EVAC,
        BLDG_EVAC_UPDATE AS BLDG_EVAC
        HAZ_ACT1,
        HAZ_ACT2,
        HAZ_ACT3,
        OCCUR_FIRS,
        CAUSE_REL,
        FACT_REL1,
        FACT_REL2,
        FACT_REL3,
        MIT_FACT1,
        MIT_FACT2,
        MIT_FACT3,
        EQ_INV_REL,
        HAZ_DISPO,
        HAZ_DEATH_UPDATE AS HAZ_DEATH,
        HAZ_INJ_UPDATE AS HAZ_INJ
)

SELECT * FROM hazmat_final
    );
  
  
[0m11:55:11.792171 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazmat__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - REL_STORY --> FLOAT
    - POP_DENS --> FLOAT
    - AFFEC_MEAS --> FLOAT
    - EVAC_MEAS --> FLOAT
    - PEOP_EVAC --> FLOAT
    - BLDG_EVAC --> FLOAT
    - HAZ_DEATH --> FLOAT
    - HAZ_INJ --> FLOAT
***/



WITH hazmat_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazmat"
),

SELECT hazmat_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(REL_STORY AS FLOAT) AS REL_STORY_UPDATE,
        CAST(POP_DENS AS FLOAT) AS POP_DENS_UPDATE,
        CAST(AFFEC_MEAS AS FLOAT) AS AFFEC_MEAS_UPDATE,
        CAST(EVAC_MEAS AS FLOAT) AS EVAC_MEAS_UPDATE,
        CAST(PEOP_EVAC AS FLOAT) AS PEOP_EVAC_UPDATE,
        CAST(BLDG_EVAC AS FLOAT) AS BLDG_EVAC_UPDATE,
        CAST(HAZ_DEATH AS FLOAT) AS HAZ_DEATH_UPDATE,
        CAST(HAZ_INJ AS FLOAT) AS HAZ_INJ_UPDATE
    FROM hazmat_source
),

hazmat_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        REL_FROM,
        REL_STORY_UPDATE AS REL_STORY,
        POP_DENS_UPDATE AS POP_DENS,
        AFFEC_MEAS_UPDATE AS AFFEC_MEAS,
        AFFEC_UNIT,
        EVAC_MEAS_UPDATE AS EVAC_MEAS,
        EVAC_UNIT,
        PEOP_EVAC_UPDATE AS PEOP_EVAC,
        BLDG_EVAC_UPDATE AS BLDG_EVAC
        HAZ_ACT1,
        HAZ_ACT2,
        HAZ_ACT3,
        OCCUR_FIRS,
        CAUSE_REL,
        FACT_REL1,
        FACT_REL2,
        FACT_REL3,
        MIT_FACT1,
        MIT_FACT2,
        MIT_FACT3,
        EQ_INV_REL,
        HAZ_DISPO,
        HAZ_DEATH_UPDATE AS HAZ_DEATH,
        HAZ_INJ_UPDATE AS HAZ_INJ
)

SELECT * FROM hazmat_final
    );
  
  
[0m11:55:11.792171 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:55:11.792171 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: ROLLBACK
[0m11:55:11.807218 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__hazmat'
[0m11:55:11.807218 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: Close
[0m11:55:11.807218 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__hazmat (models\nfirs_transformed\nfirs_transformed__hazmat.sql)
  Parser Error: syntax error at or near "SELECT"
[0m11:55:11.807218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f791e7-9c9d-44a7-9ebb-0803fb49a02b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A3A5F3950>]}
[0m11:55:11.807218 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__hazmat  [[31mERROR[0m in 0.08s]
[0m11:55:11.807218 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:11.822771 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:11.822771 [debug] [MainThread]: On master: BEGIN
[0m11:55:11.822771 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:11.840669 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:11.840669 [debug] [MainThread]: On master: COMMIT
[0m11:55:11.840669 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:11.840669 [debug] [MainThread]: On master: COMMIT
[0m11:55:11.848740 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:11.848740 [debug] [MainThread]: On master: Close
[0m11:55:11.848740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:11.848740 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m11:55:11.848740 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:55:11.848740 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:55:11.848740 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmat' was properly closed.
[0m11:55:11.848740 [info ] [MainThread]: 
[0m11:55:11.856113 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m11:55:11.856113 [debug] [MainThread]: Command end result
[0m11:55:11.884029 [info ] [MainThread]: 
[0m11:55:11.889472 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:55:11.889472 [info ] [MainThread]: 
[0m11:55:11.889472 [error] [MainThread]:   Runtime Error in model nfirs_transformed__hazmat (models\nfirs_transformed\nfirs_transformed__hazmat.sql)
  Parser Error: syntax error at or near "SELECT"
[0m11:55:11.889472 [info ] [MainThread]: 
[0m11:55:11.889472 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:55:11.889472 [debug] [MainThread]: Command `cli run` failed at 11:55:11.889472 after 1.10 seconds
[0m11:55:11.889472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A39457740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A39EB3AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027A39EB1C40>]}
[0m11:55:11.889472 [debug] [MainThread]: Flushing usage events
[0m11:55:24.884302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E658B6F740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E657415970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E657417F80>]}


============================== 11:55:24.884302 | a6914d91-7e1e-4929-a807-cb12cea28440 ==============================
[0m11:55:24.884302 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:55:24.884302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:55:25.067646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6914d91-7e1e-4929-a807-cb12cea28440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E65B84FB30>]}
[0m11:55:25.134269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6914d91-7e1e-4929-a807-cb12cea28440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E659AD2CC0>]}
[0m11:55:25.134269 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:55:25.134269 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:55:25.300837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:25.300837 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:25.333907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6914d91-7e1e-4929-a807-cb12cea28440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E65B99E330>]}
[0m11:55:25.450870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6914d91-7e1e-4929-a807-cb12cea28440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E65BD0CA70>]}
[0m11:55:25.450870 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m11:55:25.450870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6914d91-7e1e-4929-a807-cb12cea28440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E65BB0A810>]}
[0m11:55:25.450870 [info ] [MainThread]: 
[0m11:55:25.450870 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:55:25.450870 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:55:25.518585 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:55:25.518585 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:55:25.518585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:25.550540 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:25.550540 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:55:25.550540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m11:55:25.550540 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m11:55:25.567340 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:25.567340 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:55:25.567340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:25.584456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:25.584456 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:25.584456 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m11:55:25.584456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:25.584456 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:25.584456 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m11:55:25.584456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:25.584456 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:55:25.584456 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:25.584456 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:55:25.584456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:25.584456 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m11:55:25.600664 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:55:25.600664 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:55:25.600664 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:55:25.600664 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:55:25.600664 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:55:25.600664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:25.616324 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:55:25.634064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:25.634064 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:25.634064 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:25.634064 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:55:25.634064 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:55:25.634064 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:55:25.634064 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:55:25.667325 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:25.667325 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:55:25.667325 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:25.667325 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:55:25.667325 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:55:25.667325 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:55:25.667325 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:55:25.667325 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:55:25.684595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6914d91-7e1e-4929-a807-cb12cea28440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E65BCD6630>]}
[0m11:55:25.684595 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:25.684595 [debug] [MainThread]: On master: BEGIN
[0m11:55:25.684595 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:25.700671 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:25.700671 [debug] [MainThread]: On master: COMMIT
[0m11:55:25.700671 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:25.700671 [debug] [MainThread]: On master: COMMIT
[0m11:55:25.700671 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:25.700671 [debug] [MainThread]: On master: Close
[0m11:55:25.717352 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:55:25.717352 [info ] [MainThread]: 
[0m11:55:25.717352 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:25.717352 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__hazmat ....... [RUN]
[0m11:55:25.717352 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmat'
[0m11:55:25.717352 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:25.725068 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:25.725068 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:25.752322 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:25.752322 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:25.752322 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: BEGIN
[0m11:55:25.752322 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:55:25.782699 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:55:25.782699 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:25.782699 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazmat__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - REL_STORY --> FLOAT
    - POP_DENS --> FLOAT
    - AFFEC_MEAS --> FLOAT
    - EVAC_MEAS --> FLOAT
    - PEOP_EVAC --> FLOAT
    - BLDG_EVAC --> FLOAT
    - HAZ_DEATH --> FLOAT
    - HAZ_INJ --> FLOAT
***/



WITH hazmat_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazmat"
),

hazmat_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(REL_STORY AS FLOAT) AS REL_STORY_UPDATE,
        CAST(POP_DENS AS FLOAT) AS POP_DENS_UPDATE,
        CAST(AFFEC_MEAS AS FLOAT) AS AFFEC_MEAS_UPDATE,
        CAST(EVAC_MEAS AS FLOAT) AS EVAC_MEAS_UPDATE,
        CAST(PEOP_EVAC AS FLOAT) AS PEOP_EVAC_UPDATE,
        CAST(BLDG_EVAC AS FLOAT) AS BLDG_EVAC_UPDATE,
        CAST(HAZ_DEATH AS FLOAT) AS HAZ_DEATH_UPDATE,
        CAST(HAZ_INJ AS FLOAT) AS HAZ_INJ_UPDATE
    FROM hazmat_source
),

hazmat_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        REL_FROM,
        REL_STORY_UPDATE AS REL_STORY,
        POP_DENS_UPDATE AS POP_DENS,
        AFFEC_MEAS_UPDATE AS AFFEC_MEAS,
        AFFEC_UNIT,
        EVAC_MEAS_UPDATE AS EVAC_MEAS,
        EVAC_UNIT,
        PEOP_EVAC_UPDATE AS PEOP_EVAC,
        BLDG_EVAC_UPDATE AS BLDG_EVAC
        HAZ_ACT1,
        HAZ_ACT2,
        HAZ_ACT3,
        OCCUR_FIRS,
        CAUSE_REL,
        FACT_REL1,
        FACT_REL2,
        FACT_REL3,
        MIT_FACT1,
        MIT_FACT2,
        MIT_FACT3,
        EQ_INV_REL,
        HAZ_DISPO,
        HAZ_DEATH_UPDATE AS HAZ_DEATH,
        HAZ_INJ_UPDATE AS HAZ_INJ
)

SELECT * FROM hazmat_final
    );
  
  
[0m11:55:25.782699 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazmat__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - REL_STORY --> FLOAT
    - POP_DENS --> FLOAT
    - AFFEC_MEAS --> FLOAT
    - EVAC_MEAS --> FLOAT
    - PEOP_EVAC --> FLOAT
    - BLDG_EVAC --> FLOAT
    - HAZ_DEATH --> FLOAT
    - HAZ_INJ --> FLOAT
***/



WITH hazmat_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazmat"
),

hazmat_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(REL_STORY AS FLOAT) AS REL_STORY_UPDATE,
        CAST(POP_DENS AS FLOAT) AS POP_DENS_UPDATE,
        CAST(AFFEC_MEAS AS FLOAT) AS AFFEC_MEAS_UPDATE,
        CAST(EVAC_MEAS AS FLOAT) AS EVAC_MEAS_UPDATE,
        CAST(PEOP_EVAC AS FLOAT) AS PEOP_EVAC_UPDATE,
        CAST(BLDG_EVAC AS FLOAT) AS BLDG_EVAC_UPDATE,
        CAST(HAZ_DEATH AS FLOAT) AS HAZ_DEATH_UPDATE,
        CAST(HAZ_INJ AS FLOAT) AS HAZ_INJ_UPDATE
    FROM hazmat_source
),

hazmat_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        REL_FROM,
        REL_STORY_UPDATE AS REL_STORY,
        POP_DENS_UPDATE AS POP_DENS,
        AFFEC_MEAS_UPDATE AS AFFEC_MEAS,
        AFFEC_UNIT,
        EVAC_MEAS_UPDATE AS EVAC_MEAS,
        EVAC_UNIT,
        PEOP_EVAC_UPDATE AS PEOP_EVAC,
        BLDG_EVAC_UPDATE AS BLDG_EVAC
        HAZ_ACT1,
        HAZ_ACT2,
        HAZ_ACT3,
        OCCUR_FIRS,
        CAUSE_REL,
        FACT_REL1,
        FACT_REL2,
        FACT_REL3,
        MIT_FACT1,
        MIT_FACT2,
        MIT_FACT3,
        EQ_INV_REL,
        HAZ_DISPO,
        HAZ_DEATH_UPDATE AS HAZ_DEATH,
        HAZ_INJ_UPDATE AS HAZ_INJ
)

SELECT * FROM hazmat_final
    );
  
  
[0m11:55:25.782699 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:55:25.782699 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: ROLLBACK
[0m11:55:25.782699 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__hazmat'
[0m11:55:25.790739 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: Close
[0m11:55:25.790739 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__hazmat (models\nfirs_transformed\nfirs_transformed__hazmat.sql)
  Parser Error: syntax error at or near "HAZ_ACT1"
[0m11:55:25.798734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6914d91-7e1e-4929-a807-cb12cea28440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E659D1F620>]}
[0m11:55:25.799907 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__hazmat  [[31mERROR[0m in 0.07s]
[0m11:55:25.800601 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:25.800601 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:25.800601 [debug] [MainThread]: On master: BEGIN
[0m11:55:25.800601 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:25.817334 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:25.817334 [debug] [MainThread]: On master: COMMIT
[0m11:55:25.817334 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:25.817334 [debug] [MainThread]: On master: COMMIT
[0m11:55:25.825420 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:25.825420 [debug] [MainThread]: On master: Close
[0m11:55:25.825420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:25.825420 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m11:55:25.825420 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:55:25.825420 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:55:25.825420 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmat' was properly closed.
[0m11:55:25.825420 [info ] [MainThread]: 
[0m11:55:25.825420 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m11:55:25.825420 [debug] [MainThread]: Command end result
[0m11:55:25.855197 [info ] [MainThread]: 
[0m11:55:25.855197 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:55:25.855197 [info ] [MainThread]: 
[0m11:55:25.855197 [error] [MainThread]:   Runtime Error in model nfirs_transformed__hazmat (models\nfirs_transformed\nfirs_transformed__hazmat.sql)
  Parser Error: syntax error at or near "HAZ_ACT1"
[0m11:55:25.855197 [info ] [MainThread]: 
[0m11:55:25.855197 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:55:25.855197 [debug] [MainThread]: Command `cli run` failed at 11:55:25.855197 after 1.09 seconds
[0m11:55:25.855197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E657417F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E6598B2A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E62E341D30>]}
[0m11:55:25.855197 [debug] [MainThread]: Flushing usage events
[0m11:55:37.245899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50AC396A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50AC39DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50AC3BF20>]}


============================== 11:55:37.262410 | a257633a-ab47-4df9-89f4-9cc799df6b2d ==============================
[0m11:55:37.262410 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:55:37.262410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m11:55:37.445245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a257633a-ab47-4df9-89f4-9cc799df6b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50AC3BF20>]}
[0m11:55:37.496076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a257633a-ab47-4df9-89f4-9cc799df6b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A508AF1820>]}
[0m11:55:37.496076 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:55:37.512381 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:55:37.661815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:37.661815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:37.695150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a257633a-ab47-4df9-89f4-9cc799df6b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A508C241D0>]}
[0m11:55:37.799878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a257633a-ab47-4df9-89f4-9cc799df6b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50B32C9B0>]}
[0m11:55:37.800926 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m11:55:37.800926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a257633a-ab47-4df9-89f4-9cc799df6b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50AE35D90>]}
[0m11:55:37.803274 [info ] [MainThread]: 
[0m11:55:37.803274 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:55:37.804404 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:55:37.877921 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:55:37.878726 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:55:37.878726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:37.895121 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:37.895121 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:55:37.911908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m11:55:37.911908 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m11:55:37.911908 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:37.911908 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:55:37.911908 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:37.928492 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:37.928492 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:37.928492 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m11:55:37.928492 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:37.928492 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:37.944541 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m11:55:37.945266 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:37.947120 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:55:37.947696 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:37.947696 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:55:37.947696 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:37.947696 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m11:55:37.961255 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:55:37.961255 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:55:37.961255 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:55:37.961255 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:55:37.961255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:37.969363 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:55:37.985977 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:55:37.985977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:37.985977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:37.985977 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:55:37.985977 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:37.985977 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:55:37.993944 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:55:37.995187 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:55:38.011659 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:38.028522 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:55:38.028522 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:38.028522 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:55:38.028522 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:55:38.028522 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:55:38.028522 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:55:38.028522 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:55:38.028522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a257633a-ab47-4df9-89f4-9cc799df6b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50AF11580>]}
[0m11:55:38.028522 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:38.028522 [debug] [MainThread]: On master: BEGIN
[0m11:55:38.028522 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:38.062028 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:38.062028 [debug] [MainThread]: On master: COMMIT
[0m11:55:38.062028 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:38.062028 [debug] [MainThread]: On master: COMMIT
[0m11:55:38.062028 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:38.062028 [debug] [MainThread]: On master: Close
[0m11:55:38.062028 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:55:38.062028 [info ] [MainThread]: 
[0m11:55:38.062028 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:38.062028 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__hazmat ....... [RUN]
[0m11:55:38.062028 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmat'
[0m11:55:38.077806 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:38.077806 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:38.085990 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:38.113324 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:38.113324 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:38.113324 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: BEGIN
[0m11:55:38.113324 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:55:38.131930 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:55:38.131930 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:38.131930 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazmat__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - REL_STORY --> FLOAT
    - POP_DENS --> FLOAT
    - AFFEC_MEAS --> FLOAT
    - EVAC_MEAS --> FLOAT
    - PEOP_EVAC --> FLOAT
    - BLDG_EVAC --> FLOAT
    - HAZ_DEATH --> FLOAT
    - HAZ_INJ --> FLOAT
***/



WITH hazmat_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazmat"
),

hazmat_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(REL_STORY AS FLOAT) AS REL_STORY_UPDATE,
        CAST(POP_DENS AS FLOAT) AS POP_DENS_UPDATE,
        CAST(AFFEC_MEAS AS FLOAT) AS AFFEC_MEAS_UPDATE,
        CAST(EVAC_MEAS AS FLOAT) AS EVAC_MEAS_UPDATE,
        CAST(PEOP_EVAC AS FLOAT) AS PEOP_EVAC_UPDATE,
        CAST(BLDG_EVAC AS FLOAT) AS BLDG_EVAC_UPDATE,
        CAST(HAZ_DEATH AS FLOAT) AS HAZ_DEATH_UPDATE,
        CAST(HAZ_INJ AS FLOAT) AS HAZ_INJ_UPDATE
    FROM hazmat_source
),

hazmat_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        REL_FROM,
        REL_STORY_UPDATE AS REL_STORY,
        POP_DENS_UPDATE AS POP_DENS,
        AFFEC_MEAS_UPDATE AS AFFEC_MEAS,
        AFFEC_UNIT,
        EVAC_MEAS_UPDATE AS EVAC_MEAS,
        EVAC_UNIT,
        PEOP_EVAC_UPDATE AS PEOP_EVAC,
        BLDG_EVAC_UPDATE AS BLDG_EVAC,
        HAZ_ACT1,
        HAZ_ACT2,
        HAZ_ACT3,
        OCCUR_FIRS,
        CAUSE_REL,
        FACT_REL1,
        FACT_REL2,
        FACT_REL3,
        MIT_FACT1,
        MIT_FACT2,
        MIT_FACT3,
        EQ_INV_REL,
        HAZ_DISPO,
        HAZ_DEATH_UPDATE AS HAZ_DEATH,
        HAZ_INJ_UPDATE AS HAZ_INJ
)

SELECT * FROM hazmat_final
    );
  
  
[0m11:55:38.131930 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazmat__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - REL_STORY --> FLOAT
    - POP_DENS --> FLOAT
    - AFFEC_MEAS --> FLOAT
    - EVAC_MEAS --> FLOAT
    - PEOP_EVAC --> FLOAT
    - BLDG_EVAC --> FLOAT
    - HAZ_DEATH --> FLOAT
    - HAZ_INJ --> FLOAT
***/



WITH hazmat_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazmat"
),

hazmat_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(REL_STORY AS FLOAT) AS REL_STORY_UPDATE,
        CAST(POP_DENS AS FLOAT) AS POP_DENS_UPDATE,
        CAST(AFFEC_MEAS AS FLOAT) AS AFFEC_MEAS_UPDATE,
        CAST(EVAC_MEAS AS FLOAT) AS EVAC_MEAS_UPDATE,
        CAST(PEOP_EVAC AS FLOAT) AS PEOP_EVAC_UPDATE,
        CAST(BLDG_EVAC AS FLOAT) AS BLDG_EVAC_UPDATE,
        CAST(HAZ_DEATH AS FLOAT) AS HAZ_DEATH_UPDATE,
        CAST(HAZ_INJ AS FLOAT) AS HAZ_INJ_UPDATE
    FROM hazmat_source
),

hazmat_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        REL_FROM,
        REL_STORY_UPDATE AS REL_STORY,
        POP_DENS_UPDATE AS POP_DENS,
        AFFEC_MEAS_UPDATE AS AFFEC_MEAS,
        AFFEC_UNIT,
        EVAC_MEAS_UPDATE AS EVAC_MEAS,
        EVAC_UNIT,
        PEOP_EVAC_UPDATE AS PEOP_EVAC,
        BLDG_EVAC_UPDATE AS BLDG_EVAC,
        HAZ_ACT1,
        HAZ_ACT2,
        HAZ_ACT3,
        OCCUR_FIRS,
        CAUSE_REL,
        FACT_REL1,
        FACT_REL2,
        FACT_REL3,
        MIT_FACT1,
        MIT_FACT2,
        MIT_FACT3,
        EQ_INV_REL,
        HAZ_DISPO,
        HAZ_DEATH_UPDATE AS HAZ_DEATH,
        HAZ_INJ_UPDATE AS HAZ_INJ
)

SELECT * FROM hazmat_final
    );
  
  
[0m11:55:38.131930 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m11:55:38.131930 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: ROLLBACK
[0m11:55:38.150565 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__hazmat'
[0m11:55:38.151640 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: Close
[0m11:55:38.157469 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__hazmat (models\nfirs_transformed\nfirs_transformed__hazmat.sql)
  Binder Error: Referenced column "INCIDENT_KEY" not found in FROM clause!
  LINE 48:         INCIDENT_KEY,
                   ^
[0m11:55:38.158633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a257633a-ab47-4df9-89f4-9cc799df6b2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5092CB650>]}
[0m11:55:38.159803 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__hazmat  [[31mERROR[0m in 0.10s]
[0m11:55:38.160937 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:38.163423 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:38.163423 [debug] [MainThread]: On master: BEGIN
[0m11:55:38.163423 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:38.183949 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:38.184035 [debug] [MainThread]: On master: COMMIT
[0m11:55:38.184035 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:38.185078 [debug] [MainThread]: On master: COMMIT
[0m11:55:38.185078 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:38.185078 [debug] [MainThread]: On master: Close
[0m11:55:38.185078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:38.185078 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m11:55:38.185078 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:55:38.185078 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:55:38.185078 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmat' was properly closed.
[0m11:55:38.185078 [info ] [MainThread]: 
[0m11:55:38.185078 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m11:55:38.185078 [debug] [MainThread]: Command end result
[0m11:55:38.216262 [info ] [MainThread]: 
[0m11:55:38.216262 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:55:38.216262 [info ] [MainThread]: 
[0m11:55:38.216262 [error] [MainThread]:   Runtime Error in model nfirs_transformed__hazmat (models\nfirs_transformed\nfirs_transformed__hazmat.sql)
  Binder Error: Referenced column "INCIDENT_KEY" not found in FROM clause!
  LINE 48:         INCIDENT_KEY,
                   ^
[0m11:55:38.216262 [info ] [MainThread]: 
[0m11:55:38.216262 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:55:38.216262 [debug] [MainThread]: Command `cli run` failed at 11:55:38.216262 after 1.09 seconds
[0m11:55:38.216262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50AD68F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50AD69130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A50AD691F0>]}
[0m11:55:38.216262 [debug] [MainThread]: Flushing usage events
[0m11:55:59.002724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C490A2F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48EDEDDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C490A2CA70>]}


============================== 11:55:59.020888 | 78d48e31-efda-4617-ae70-b4d0dcd1c9b5 ==============================
[0m11:55:59.020888 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:55:59.020888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:55:59.202564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78d48e31-efda-4617-ae70-b4d0dcd1c9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48E444530>]}
[0m11:55:59.252622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78d48e31-efda-4617-ae70-b4d0dcd1c9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C490C59FD0>]}
[0m11:55:59.252622 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:55:59.268512 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:55:59.422806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:59.422806 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:59.452187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78d48e31-efda-4617-ae70-b4d0dcd1c9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C490D409B0>]}
[0m11:55:59.552537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78d48e31-efda-4617-ae70-b4d0dcd1c9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C49110AD50>]}
[0m11:55:59.552537 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m11:55:59.552537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78d48e31-efda-4617-ae70-b4d0dcd1c9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C490DE4E90>]}
[0m11:55:59.552537 [info ] [MainThread]: 
[0m11:55:59.552537 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:55:59.552537 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:55:59.621876 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:55:59.621876 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:55:59.635025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:59.652486 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:59.652486 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:55:59.652486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m11:55:59.652486 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m11:55:59.669043 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:59.669043 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:55:59.669043 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:59.685582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:59.685582 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:59.685582 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m11:55:59.685582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:59.685582 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:59.685582 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m11:55:59.685582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:59.685582 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:55:59.685582 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m11:55:59.685582 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m11:55:59.701596 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:59.702429 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m11:55:59.702429 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:55:59.702429 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:55:59.722227 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:55:59.722227 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:55:59.722227 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:55:59.722227 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:55:59.722227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:59.722227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:59.751208 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:59.751605 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:59.752456 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:55:59.752456 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:55:59.752456 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:55:59.752456 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:55:59.785702 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:59.785702 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:55:59.785702 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:55:59.785702 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:55:59.785702 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:55:59.785702 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:55:59.785702 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:55:59.785702 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:55:59.802307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78d48e31-efda-4617-ae70-b4d0dcd1c9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C490C89E50>]}
[0m11:55:59.802307 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:59.802307 [debug] [MainThread]: On master: BEGIN
[0m11:55:59.802307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:59.822475 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:59.822475 [debug] [MainThread]: On master: COMMIT
[0m11:55:59.822475 [debug] [MainThread]: Using duckdb connection "master"
[0m11:55:59.822475 [debug] [MainThread]: On master: COMMIT
[0m11:55:59.822475 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:55:59.822475 [debug] [MainThread]: On master: Close
[0m11:55:59.835762 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:55:59.835762 [info ] [MainThread]: 
[0m11:55:59.835762 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:59.835762 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__hazmat ....... [RUN]
[0m11:55:59.835762 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmat'
[0m11:55:59.835762 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:59.844938 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:59.844938 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:55:59.870613 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:59.870613 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:59.870613 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: BEGIN
[0m11:55:59.884959 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:55:59.902226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:55:59.902226 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:59.902226 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazmat__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - REL_STORY --> FLOAT
    - POP_DENS --> FLOAT
    - AFFEC_MEAS --> FLOAT
    - EVAC_MEAS --> FLOAT
    - PEOP_EVAC --> FLOAT
    - BLDG_EVAC --> FLOAT
    - HAZ_DEATH --> FLOAT
    - HAZ_INJ --> FLOAT
***/



WITH hazmat_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazmat"
),

hazmat_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(REL_STORY AS FLOAT) AS REL_STORY_UPDATE,
        CAST(POP_DENS AS FLOAT) AS POP_DENS_UPDATE,
        CAST(AFFEC_MEAS AS FLOAT) AS AFFEC_MEAS_UPDATE,
        CAST(EVAC_MEAS AS FLOAT) AS EVAC_MEAS_UPDATE,
        CAST(PEOP_EVAC AS FLOAT) AS PEOP_EVAC_UPDATE,
        CAST(BLDG_EVAC AS FLOAT) AS BLDG_EVAC_UPDATE,
        CAST(HAZ_DEATH AS FLOAT) AS HAZ_DEATH_UPDATE,
        CAST(HAZ_INJ AS FLOAT) AS HAZ_INJ_UPDATE
    FROM hazmat_source
),

hazmat_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        REL_FROM,
        REL_STORY_UPDATE AS REL_STORY,
        POP_DENS_UPDATE AS POP_DENS,
        AFFEC_MEAS_UPDATE AS AFFEC_MEAS,
        AFFEC_UNIT,
        EVAC_MEAS_UPDATE AS EVAC_MEAS,
        EVAC_UNIT,
        PEOP_EVAC_UPDATE AS PEOP_EVAC,
        BLDG_EVAC_UPDATE AS BLDG_EVAC,
        HAZ_ACT1,
        HAZ_ACT2,
        HAZ_ACT3,
        OCCUR_FIRS,
        CAUSE_REL,
        FACT_REL1,
        FACT_REL2,
        FACT_REL3,
        MIT_FACT1,
        MIT_FACT2,
        MIT_FACT3,
        EQ_INV_REL,
        HAZ_DISPO,
        HAZ_DEATH_UPDATE AS HAZ_DEATH,
        HAZ_INJ_UPDATE AS HAZ_INJ
    FROM hazmat_col_data_type_update
)

SELECT * FROM hazmat_final
    );
  
  
[0m11:55:59.938704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:55:59.938704 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:59.938704 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__hazmat__dbt_tmp" rename to "nfirs_transformed__hazmat"
[0m11:55:59.938704 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:55:59.952178 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: COMMIT
[0m11:55:59.952178 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:55:59.952178 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: COMMIT
[0m11:56:00.022723 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:56:00.035945 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"
[0m11:56:00.035945 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmat"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__hazmat__dbt_backup" cascade
[0m11:56:00.035945 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:56:00.035945 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmat: Close
[0m11:56:01.135171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78d48e31-efda-4617-ae70-b4d0dcd1c9b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C49110B230>]}
[0m11:56:01.135171 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__hazmat .. [[32mOK[0m in 1.30s]
[0m11:56:01.135171 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__hazmat
[0m11:56:01.135171 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:01.135171 [debug] [MainThread]: On master: BEGIN
[0m11:56:01.135171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:56:01.160634 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:56:01.160634 [debug] [MainThread]: On master: COMMIT
[0m11:56:01.160634 [debug] [MainThread]: Using duckdb connection "master"
[0m11:56:01.160634 [debug] [MainThread]: On master: COMMIT
[0m11:56:01.160634 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:56:01.167636 [debug] [MainThread]: On master: Close
[0m11:56:01.172351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:01.172351 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m11:56:01.172351 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:56:01.172351 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:56:01.172351 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmat' was properly closed.
[0m11:56:01.172351 [info ] [MainThread]: 
[0m11:56:01.172351 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m11:56:01.172351 [debug] [MainThread]: Command end result
[0m11:56:01.200946 [info ] [MainThread]: 
[0m11:56:01.200946 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:01.200946 [info ] [MainThread]: 
[0m11:56:01.200946 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:56:01.200946 [debug] [MainThread]: Command `cli run` succeeded at 11:56:01.200946 after 2.32 seconds
[0m11:56:01.205734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48EDEDDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48F128E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C490D432C0>]}
[0m11:56:01.205734 [debug] [MainThread]: Flushing usage events
[0m12:54:59.963720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4E742450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4E742120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4D96D400>]}


============================== 12:54:59.979712 | 2711bd2f-9184-4e4a-b5cf-7c6eba2241fd ==============================
[0m12:54:59.979712 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:54:59.979712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:55:00.197246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2711bd2f-9184-4e4a-b5cf-7c6eba2241fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4FD0D790>]}
[0m12:55:00.254574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2711bd2f-9184-4e4a-b5cf-7c6eba2241fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4FDDB4D0>]}
[0m12:55:00.254574 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:55:00.263882 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:55:00.421435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:55:00.421435 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:55:00.466106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2711bd2f-9184-4e4a-b5cf-7c6eba2241fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4FFC7B90>]}
[0m12:55:00.589386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2711bd2f-9184-4e4a-b5cf-7c6eba2241fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5009F6E0>]}
[0m12:55:00.596078 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m12:55:00.596895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2711bd2f-9184-4e4a-b5cf-7c6eba2241fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F500B1BE0>]}
[0m12:55:00.596895 [info ] [MainThread]: 
[0m12:55:00.596895 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:55:00.596895 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m12:55:00.696666 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m12:55:00.696666 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m12:55:00.696666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:00.762685 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:00.762685 [debug] [ThreadPool]: On list_nfirs: Close
[0m12:55:00.770722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m12:55:00.770722 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m12:55:00.780082 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m12:55:00.780082 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m12:55:00.780082 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:00.805784 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:00.805784 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m12:55:00.805784 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m12:55:00.805784 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:00.805784 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m12:55:00.805784 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m12:55:00.813411 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:00.813411 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m12:55:00.813411 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m12:55:00.813411 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m12:55:00.813411 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:00.813411 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m12:55:00.813411 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m12:55:00.830135 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:55:00.830135 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m12:55:00.830135 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m12:55:00.830135 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:55:00.830135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:00.830135 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m12:55:00.846754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:00.846754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:00.846754 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:55:00.846754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:00.846754 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m12:55:00.862590 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:55:00.862590 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m12:55:00.904598 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:00.913310 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m12:55:00.913310 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:00.913310 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m12:55:00.913310 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m12:55:00.913310 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m12:55:00.913310 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m12:55:00.913310 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m12:55:00.929244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2711bd2f-9184-4e4a-b5cf-7c6eba2241fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F500B2120>]}
[0m12:55:00.929244 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:00.929244 [debug] [MainThread]: On master: BEGIN
[0m12:55:00.929244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:00.946686 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:55:00.946686 [debug] [MainThread]: On master: COMMIT
[0m12:55:00.946686 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:00.946686 [debug] [MainThread]: On master: COMMIT
[0m12:55:00.946686 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:55:00.946686 [debug] [MainThread]: On master: Close
[0m12:55:00.963453 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:55:00.963453 [info ] [MainThread]: 
[0m12:55:00.971486 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved
[0m12:55:00.971486 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__hazmatequipinvolved  [RUN]
[0m12:55:00.971486 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved'
[0m12:55:00.971486 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved
[0m12:55:00.979255 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"
[0m12:55:00.985129 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved
[0m12:55:01.012598 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"
[0m12:55:01.018301 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"
[0m12:55:01.018301 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved: BEGIN
[0m12:55:01.018301 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:55:01.037357 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:55:01.037357 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"
[0m12:55:01.037357 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazmatequipinvolved__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazmat Material Equipment Involved Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH hazmatequipinvolved_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazmatequipinvolved"
)

hazmatequipinvolved_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM hazmatequipinvolved_source
),

hazmatequipinvolved_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        EQ_BRAND,
        EQ_MODEL,
        EQ_SER_NO,
        EQ_YEAR
    FROM hazmatequipinvolved_col_data_type_update
)

SELECT * FROM hazmatequipinvolved_final
    );
  
  
[0m12:55:01.045329 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazmatequipinvolved__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazmat Material Equipment Involved Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH hazmatequipinvolved_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazmatequipinvolved"
)

hazmatequipinvolved_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM hazmatequipinvolved_source
),

hazmatequipinvolved_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        EQ_BRAND,
        EQ_MODEL,
        EQ_SER_NO,
        EQ_YEAR
    FROM hazmatequipinvolved_col_data_type_update
)

SELECT * FROM hazmatequipinvolved_final
    );
  
  
[0m12:55:01.045329 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:55:01.045329 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved: ROLLBACK
[0m12:55:01.053333 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved'
[0m12:55:01.061328 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved: Close
[0m12:55:01.062493 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__hazmatequipinvolved (models\nfirs_transformed\nfirs_transformed__hazmatequipinvolved.sql)
  Parser Error: syntax error at or near "hazmatequipinvolved_col_data_type_update"
[0m12:55:01.062493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2711bd2f-9184-4e4a-b5cf-7c6eba2241fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F506A1880>]}
[0m12:55:01.070570 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__hazmatequipinvolved  [[31mERROR[0m in 0.09s]
[0m12:55:01.070570 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved
[0m12:55:01.070570 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:01.070570 [debug] [MainThread]: On master: BEGIN
[0m12:55:01.070570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:55:01.095800 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:55:01.095955 [debug] [MainThread]: On master: COMMIT
[0m12:55:01.095955 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:01.095955 [debug] [MainThread]: On master: COMMIT
[0m12:55:01.095955 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:55:01.095955 [debug] [MainThread]: On master: Close
[0m12:55:01.104028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:01.104028 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m12:55:01.104028 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m12:55:01.104028 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m12:55:01.104028 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved' was properly closed.
[0m12:55:01.104028 [info ] [MainThread]: 
[0m12:55:01.104028 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m12:55:01.104028 [debug] [MainThread]: Command end result
[0m12:55:01.137385 [info ] [MainThread]: 
[0m12:55:01.137385 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:55:01.137385 [info ] [MainThread]: 
[0m12:55:01.137385 [error] [MainThread]:   Runtime Error in model nfirs_transformed__hazmatequipinvolved (models\nfirs_transformed\nfirs_transformed__hazmatequipinvolved.sql)
  Parser Error: syntax error at or near "hazmatequipinvolved_col_data_type_update"
[0m12:55:01.137385 [info ] [MainThread]: 
[0m12:55:01.137385 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:55:01.137385 [debug] [MainThread]: Command `cli run` failed at 12:55:01.137385 after 1.32 seconds
[0m12:55:01.137385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4FB8F290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4FCE3FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F4FCE2360>]}
[0m12:55:01.137385 [debug] [MainThread]: Flushing usage events
[0m12:55:12.265717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA11612C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1135F8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1135EE40>]}


============================== 12:55:12.265717 | 65f546c1-b796-4ef1-9d00-91136a820e4f ==============================
[0m12:55:12.265717 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:55:12.265717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:55:12.426935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65f546c1-b796-4ef1-9d00-91136a820e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA13533830>]}
[0m12:55:12.476075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65f546c1-b796-4ef1-9d00-91136a820e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA13577EC0>]}
[0m12:55:12.477205 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:55:12.486332 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:55:12.614340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:55:12.614340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:55:12.658434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65f546c1-b796-4ef1-9d00-91136a820e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA13772390>]}
[0m12:55:12.735363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65f546c1-b796-4ef1-9d00-91136a820e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA13A5CB90>]}
[0m12:55:12.735363 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m12:55:12.740824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65f546c1-b796-4ef1-9d00-91136a820e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA135AC980>]}
[0m12:55:12.740824 [info ] [MainThread]: 
[0m12:55:12.740824 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:55:12.740824 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m12:55:12.798792 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m12:55:12.798792 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m12:55:12.798792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:12.825002 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:12.825002 [debug] [ThreadPool]: On list_nfirs: Close
[0m12:55:12.833002 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m12:55:12.833002 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m12:55:12.833002 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m12:55:12.833002 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m12:55:12.833002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:12.858311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:12.858311 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m12:55:12.858311 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m12:55:12.858311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:12.858311 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m12:55:12.858311 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m12:55:12.858311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:12.858311 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m12:55:12.858311 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m12:55:12.858311 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m12:55:12.858311 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:12.858311 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m12:55:12.866310 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m12:55:12.874310 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m12:55:12.876249 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:55:12.876249 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:55:12.876249 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m12:55:12.876249 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m12:55:12.876249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:12.876249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:12.898777 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:12.898777 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:12.898777 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:55:12.898777 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:55:12.898777 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m12:55:12.898777 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m12:55:12.924087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:12.932087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:55:12.932087 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m12:55:12.932087 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m12:55:12.932087 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m12:55:12.932087 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m12:55:12.940087 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m12:55:12.940087 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m12:55:12.942257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65f546c1-b796-4ef1-9d00-91136a820e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA1377F320>]}
[0m12:55:12.942257 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:12.942257 [debug] [MainThread]: On master: BEGIN
[0m12:55:12.942257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:12.965423 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:55:12.965423 [debug] [MainThread]: On master: COMMIT
[0m12:55:12.965423 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:12.965423 [debug] [MainThread]: On master: COMMIT
[0m12:55:12.965423 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:55:12.965423 [debug] [MainThread]: On master: Close
[0m12:55:12.973423 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:55:12.973423 [info ] [MainThread]: 
[0m12:55:12.975180 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved
[0m12:55:12.975180 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__hazmatequipinvolved  [RUN]
[0m12:55:12.975180 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved'
[0m12:55:12.980172 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved
[0m12:55:12.982686 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"
[0m12:55:12.982686 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved
[0m12:55:13.007840 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"
[0m12:55:13.007840 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"
[0m12:55:13.007840 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved: BEGIN
[0m12:55:13.007840 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:55:13.026588 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:55:13.026588 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"
[0m12:55:13.026588 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazmatequipinvolved__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazmat Material Equipment Involved Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH hazmatequipinvolved_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazmatequipinvolved"
),

hazmatequipinvolved_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM hazmatequipinvolved_source
),

hazmatequipinvolved_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        EQ_BRAND,
        EQ_MODEL,
        EQ_SER_NO,
        EQ_YEAR
    FROM hazmatequipinvolved_col_data_type_update
)

SELECT * FROM hazmatequipinvolved_final
    );
  
  
[0m12:55:13.107599 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:55:13.110794 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"
[0m12:55:13.110794 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__hazmatequipinvolved__dbt_tmp" rename to "nfirs_transformed__hazmatequipinvolved"
[0m12:55:13.110794 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:55:13.125787 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved: COMMIT
[0m12:55:13.125787 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"
[0m12:55:13.125787 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved: COMMIT
[0m12:55:13.125787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:55:13.141585 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"
[0m12:55:13.142889 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__hazmatequipinvolved__dbt_backup" cascade
[0m12:55:13.142889 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:55:13.142889 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved: Close
[0m12:55:13.441742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65f546c1-b796-4ef1-9d00-91136a820e4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA10D7B6B0>]}
[0m12:55:13.449743 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__hazmatequipinvolved  [[32mOK[0m in 0.47s]
[0m12:55:13.449743 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved
[0m12:55:13.449743 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:13.449743 [debug] [MainThread]: On master: BEGIN
[0m12:55:13.449743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:55:13.461555 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:55:13.461555 [debug] [MainThread]: On master: COMMIT
[0m12:55:13.461555 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:13.461555 [debug] [MainThread]: On master: COMMIT
[0m12:55:13.461555 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:55:13.461555 [debug] [MainThread]: On master: Close
[0m12:55:13.476154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:13.476154 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m12:55:13.476154 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m12:55:13.476154 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m12:55:13.476154 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmatequipinvolved' was properly closed.
[0m12:55:13.476154 [info ] [MainThread]: 
[0m12:55:13.476154 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m12:55:13.476154 [debug] [MainThread]: Command end result
[0m12:55:13.496066 [info ] [MainThread]: 
[0m12:55:13.496066 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:55:13.496066 [info ] [MainThread]: 
[0m12:55:13.507137 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:55:13.507137 [debug] [MainThread]: Command `cli run` succeeded at 12:55:13.507137 after 1.35 seconds
[0m12:55:13.507137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA13508CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA135090A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA13508B30>]}
[0m12:55:13.507137 [debug] [MainThread]: Flushing usage events
[0m13:00:06.747502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFFF06480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D8EA02000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D90190AD0>]}


============================== 13:00:06.764274 | b0698bf8-0aac-4675-b336-0be609265350 ==============================
[0m13:00:06.764274 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:00:06.766319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m13:00:06.947835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0698bf8-0aac-4675-b336-0be609265350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D905D78C0>]}
[0m13:00:06.997570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0698bf8-0aac-4675-b336-0be609265350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D906106B0>]}
[0m13:00:06.997570 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:00:07.014287 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:00:07.180847 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:07.180847 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:07.214287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0698bf8-0aac-4675-b336-0be609265350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D907F0950>]}
[0m13:00:07.314099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0698bf8-0aac-4675-b336-0be609265350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D90B4CD10>]}
[0m13:00:07.314099 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m13:00:07.314099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0698bf8-0aac-4675-b336-0be609265350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D9040C980>]}
[0m13:00:07.314099 [info ] [MainThread]: 
[0m13:00:07.314099 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:00:07.314099 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m13:00:07.382449 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m13:00:07.382449 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m13:00:07.382449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:07.414169 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:00:07.414852 [debug] [ThreadPool]: On list_nfirs: Close
[0m13:00:07.420668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m13:00:07.420668 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m13:00:07.426606 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:00:07.427776 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m13:00:07.427776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:07.448877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:00:07.448877 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:00:07.448877 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m13:00:07.448877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:00:07.448877 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:00:07.448877 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m13:00:07.448877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:00:07.448877 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m13:00:07.448877 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:00:07.448877 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m13:00:07.448877 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:00:07.448877 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m13:00:07.463891 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m13:00:07.467429 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:00:07.467429 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m13:00:07.467429 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m13:00:07.467429 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:00:07.467429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:07.467429 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m13:00:07.496505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:07.496956 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:00:07.496956 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:00:07.496956 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:00:07.496956 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:00:07.496956 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m13:00:07.496956 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m13:00:07.530594 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:00:07.530594 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:00:07.530594 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m13:00:07.530594 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m13:00:07.530594 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m13:00:07.530594 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m13:00:07.530594 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m13:00:07.530594 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m13:00:07.547331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0698bf8-0aac-4675-b336-0be609265350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D907F3410>]}
[0m13:00:07.547331 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:07.547331 [debug] [MainThread]: On master: BEGIN
[0m13:00:07.547331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:00:07.567596 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:00:07.567596 [debug] [MainThread]: On master: COMMIT
[0m13:00:07.567596 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:07.567596 [debug] [MainThread]: On master: COMMIT
[0m13:00:07.567596 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:00:07.567596 [debug] [MainThread]: On master: Close
[0m13:00:07.579985 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:00:07.580662 [info ] [MainThread]: 
[0m13:00:07.580662 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop
[0m13:00:07.580662 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__hazmobprop ... [RUN]
[0m13:00:07.580662 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop'
[0m13:00:07.580662 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop
[0m13:00:07.586941 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop"
[0m13:00:07.595006 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop
[0m13:00:07.616012 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop"
[0m13:00:07.616012 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop"
[0m13:00:07.616012 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop: BEGIN
[0m13:00:07.616012 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:00:07.647264 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:00:07.647264 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop"
[0m13:00:07.647264 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__hazmobprop__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Hazardous Material Mobile Property Type Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH hazmobprop_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."hazmobprop"
),

hazmobprop_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
    FROM hazmobprop_source
),

hazmobprop_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        MP_TYPE,
        MP_MAKE,
        MP_MODEL,
        MP_YEAR,
        MP_LICENSE,
        MP_STATE,
        MP_DOT_ICC
    FROM hazmobprop_col_data_type_update
)

SELECT * FROM hazmobprop_final
    );
  
  
[0m13:00:07.667781 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:00:07.675904 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop"
[0m13:00:07.675904 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__hazmobprop__dbt_tmp" rename to "nfirs_transformed__hazmobprop"
[0m13:00:07.675904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:00:07.688051 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop: COMMIT
[0m13:00:07.688051 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop"
[0m13:00:07.688051 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop: COMMIT
[0m13:00:07.697159 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:00:07.697159 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop"
[0m13:00:07.697159 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__hazmobprop__dbt_backup" cascade
[0m13:00:07.712823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:00:07.713761 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop: Close
[0m13:00:08.068567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0698bf8-0aac-4675-b336-0be609265350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D8DE0B7A0>]}
[0m13:00:08.068567 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__hazmobprop  [[32mOK[0m in 0.49s]
[0m13:00:08.068567 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop
[0m13:00:08.068567 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:08.068567 [debug] [MainThread]: On master: BEGIN
[0m13:00:08.068567 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:00:08.096262 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:00:08.096262 [debug] [MainThread]: On master: COMMIT
[0m13:00:08.096262 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:08.096262 [debug] [MainThread]: On master: COMMIT
[0m13:00:08.096262 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:00:08.096262 [debug] [MainThread]: On master: Close
[0m13:00:08.101461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:08.101461 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m13:00:08.101461 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m13:00:08.101461 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m13:00:08.101461 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__hazmobprop' was properly closed.
[0m13:00:08.101461 [info ] [MainThread]: 
[0m13:00:08.101461 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m13:00:08.101461 [debug] [MainThread]: Command end result
[0m13:00:08.134514 [info ] [MainThread]: 
[0m13:00:08.134514 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:08.134514 [info ] [MainThread]: 
[0m13:00:08.134514 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:00:08.134514 [debug] [MainThread]: Command `cli run` succeeded at 13:00:08.134514 after 1.51 seconds
[0m13:00:08.134514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DFFF06480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D90092120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022D9097FB00>]}
[0m13:00:08.134514 [debug] [MainThread]: Flushing usage events
[0m13:03:43.742843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001794682F710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179479C7200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179479C6FC0>]}


============================== 13:03:43.742843 | c1a03f7f-2a3f-4231-b86b-4163a7f48753 ==============================
[0m13:03:43.742843 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:03:43.742843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:03:43.926213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1a03f7f-2a3f-4231-b86b-4163a7f48753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179480280E0>]}
[0m13:03:43.983432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1a03f7f-2a3f-4231-b86b-4163a7f48753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179494BD460>]}
[0m13:03:43.983432 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:03:43.991432 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:03:44.143028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:03:44.143028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:03:44.192765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1a03f7f-2a3f-4231-b86b-4163a7f48753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179496F3DD0>]}
[0m13:03:44.292843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1a03f7f-2a3f-4231-b86b-4163a7f48753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179497AF830>]}
[0m13:03:44.292843 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m13:03:44.292843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1a03f7f-2a3f-4231-b86b-4163a7f48753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179497D3950>]}
[0m13:03:44.292843 [info ] [MainThread]: 
[0m13:03:44.292843 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:03:44.292843 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m13:03:44.376185 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m13:03:44.376185 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m13:03:44.376185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:44.409239 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:03:44.409239 [debug] [ThreadPool]: On list_nfirs: Close
[0m13:03:44.409239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m13:03:44.409239 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m13:03:44.409239 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:03:44.425679 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m13:03:44.425892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:03:44.442739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:03:44.442739 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:03:44.442739 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m13:03:44.442739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:03:44.442739 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:03:44.442739 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m13:03:44.442739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:03:44.442739 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m13:03:44.442739 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:03:44.442739 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m13:03:44.442739 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:03:44.442739 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m13:03:44.459209 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m13:03:44.475109 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m13:03:44.475709 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:03:44.475709 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:03:44.475709 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m13:03:44.475709 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m13:03:44.475709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:44.475709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:03:44.492509 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:03:44.492509 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:03:44.492509 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:03:44.492509 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:03:44.492509 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m13:03:44.492509 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m13:03:44.542678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:03:44.542678 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:03:44.542678 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m13:03:44.542678 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m13:03:44.542678 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m13:03:44.542678 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m13:03:44.542678 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m13:03:44.542678 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m13:03:44.559241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1a03f7f-2a3f-4231-b86b-4163a7f48753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017949880E00>]}
[0m13:03:44.559241 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:44.559241 [debug] [MainThread]: On master: BEGIN
[0m13:03:44.559241 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:03:44.575767 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:03:44.575767 [debug] [MainThread]: On master: COMMIT
[0m13:03:44.575767 [debug] [MainThread]: Using duckdb connection "master"
[0m13:03:44.575767 [debug] [MainThread]: On master: COMMIT
[0m13:03:44.575767 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:03:44.591755 [debug] [MainThread]: On master: Close
[0m13:03:44.592530 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:03:44.592530 [info ] [MainThread]: 
[0m13:03:44.592530 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress
[0m13:03:44.592530 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__incidentaddress  [RUN]
[0m13:03:44.592530 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress'
[0m13:03:44.592530 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress
[0m13:03:44.605337 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress"
[0m13:03:44.613958 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress
[0m13:03:44.641829 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress"
[0m13:03:44.644587 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress"
[0m13:03:44.644587 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress: BEGIN
[0m13:03:44.644587 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:03:44.659177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:03:44.659177 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress"
[0m13:03:44.659177 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__incidentaddress__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Incident Address Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH incidentaddress_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."incidentaddress"
),

incidentaddress_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM incidentaddress_source
),

incidentaddress_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        LOC_TYPE,
        NUM_MILE,
        STREET_PRE,
        STREETNAME,
        STREETTYPE,
        STREETSUF,
        APT_NO,
        CITY,
        STATE_ID,
        ZIP5,
        ZIP4,
        X_STREET
    FROM incidentaddress_col_data_type_update
)

SELECT * FROM incidentaddress_final
    );
  
  
[0m13:03:54.753452 [debug] [Thread-1 (]: SQL status: OK in 10.0 seconds
[0m13:03:54.753452 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress"
[0m13:03:54.753452 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__incidentaddress__dbt_tmp" rename to "nfirs_transformed__incidentaddress"
[0m13:03:54.753452 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:03:54.769110 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress: COMMIT
[0m13:03:54.769110 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress"
[0m13:03:54.769110 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress: COMMIT
[0m13:04:00.323954 [debug] [Thread-1 (]: SQL status: OK in 6.0 seconds
[0m13:04:00.333977 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress"
[0m13:04:00.336668 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__incidentaddress__dbt_backup" cascade
[0m13:04:00.337903 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:04:00.338912 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress: Close
[0m13:04:01.326708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a03f7f-2a3f-4231-b86b-4163a7f48753', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017949A4CAD0>]}
[0m13:04:01.326708 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__incidentaddress  [[32mOK[0m in 16.73s]
[0m13:04:01.326708 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress
[0m13:04:01.334700 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:01.334700 [debug] [MainThread]: On master: BEGIN
[0m13:04:01.334700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:01.362868 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:04:01.370915 [debug] [MainThread]: On master: COMMIT
[0m13:04:01.370915 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:01.370915 [debug] [MainThread]: On master: COMMIT
[0m13:04:01.375230 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:04:01.375731 [debug] [MainThread]: On master: Close
[0m13:04:01.383262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:01.383262 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m13:04:01.383262 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m13:04:01.383262 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m13:04:01.383262 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__incidentaddress' was properly closed.
[0m13:04:01.383262 [info ] [MainThread]: 
[0m13:04:01.383262 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 17.09 seconds (17.09s).
[0m13:04:01.391844 [debug] [MainThread]: Command end result
[0m13:04:01.442736 [info ] [MainThread]: 
[0m13:04:01.442736 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:01.442736 [info ] [MainThread]: 
[0m13:04:01.442736 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:04:01.450783 [debug] [MainThread]: Command `cli run` succeeded at 13:04:01.450783 after 17.84 seconds
[0m13:04:01.450783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001794682F710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017949464CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179479C7860>]}
[0m13:04:01.450783 [debug] [MainThread]: Flushing usage events
[0m13:08:58.865663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269535E8EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269549E8AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269549EB2C0>]}


============================== 13:08:58.865663 | a63e10a6-9ab3-463b-b8c1-bf43fad61dc3 ==============================
[0m13:08:58.865663 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:08:58.865663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:08:59.066298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a63e10a6-9ab3-463b-b8c1-bf43fad61dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002695648C770>]}
[0m13:08:59.114143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a63e10a6-9ab3-463b-b8c1-bf43fad61dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026953D4B7A0>]}
[0m13:08:59.114143 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:08:59.128311 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:08:59.294445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:08:59.294445 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:08:59.344624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a63e10a6-9ab3-463b-b8c1-bf43fad61dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026956730EF0>]}
[0m13:08:59.443777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a63e10a6-9ab3-463b-b8c1-bf43fad61dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269569ACB90>]}
[0m13:08:59.444483 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m13:08:59.444483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a63e10a6-9ab3-463b-b8c1-bf43fad61dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026956653860>]}
[0m13:08:59.444483 [info ] [MainThread]: 
[0m13:08:59.444483 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:08:59.444483 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m13:08:59.527939 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m13:08:59.527939 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m13:08:59.527939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:59.544569 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:08:59.544569 [debug] [ThreadPool]: On list_nfirs: Close
[0m13:08:59.561159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m13:08:59.561159 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m13:08:59.567739 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:08:59.567739 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m13:08:59.567739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:59.594370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:08:59.594370 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:08:59.594370 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m13:08:59.594370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:08:59.594370 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:08:59.594370 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m13:08:59.594370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:08:59.594370 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m13:08:59.594370 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:08:59.594370 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m13:08:59.594370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:08:59.594370 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m13:08:59.611147 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m13:08:59.626974 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m13:08:59.627676 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:08:59.627676 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:08:59.627676 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m13:08:59.627676 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m13:08:59.627676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:59.627676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:59.644280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:08:59.644280 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:08:59.659942 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:08:59.660413 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:08:59.661291 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m13:08:59.661291 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m13:08:59.697082 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:08:59.699549 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:08:59.700929 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m13:08:59.702157 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m13:08:59.702157 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m13:08:59.703444 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m13:08:59.704677 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m13:08:59.704677 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m13:08:59.713141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a63e10a6-9ab3-463b-b8c1-bf43fad61dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269569C9700>]}
[0m13:08:59.714198 [debug] [MainThread]: Using duckdb connection "master"
[0m13:08:59.714198 [debug] [MainThread]: On master: BEGIN
[0m13:08:59.714198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:08:59.727815 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:08:59.727815 [debug] [MainThread]: On master: COMMIT
[0m13:08:59.727815 [debug] [MainThread]: Using duckdb connection "master"
[0m13:08:59.727815 [debug] [MainThread]: On master: COMMIT
[0m13:08:59.727815 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:08:59.727815 [debug] [MainThread]: On master: Close
[0m13:08:59.743667 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:08:59.744370 [info ] [MainThread]: 
[0m13:08:59.744370 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses
[0m13:08:59.744370 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__structurefirecauses  [RUN]
[0m13:08:59.744370 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses'
[0m13:08:59.750838 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses
[0m13:08:59.750838 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:08:59.758991 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses
[0m13:08:59.797461 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:08:59.797461 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:08:59.797461 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: BEGIN
[0m13:08:59.797461 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:08:59.827533 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:08:59.827533 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:08:59.827533 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__structurefirecauses__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Cause for Structure Fire Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH structurefirecauses_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."structurefirecauses"
),

structurefirecauses_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM structurefirecauses_source
),

structurefirecauses_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        PCC,
        CAUSE_CODE,
        GCC
    FROM structurefirecauses_col_data_type_update
)

SELECT * FROM structurefirecauses_final
    );
  
  
[0m13:08:59.844502 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__structurefirecauses__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Cause for Structure Fire Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH structurefirecauses_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."structurefirecauses"
),

structurefirecauses_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM structurefirecauses_source
),

structurefirecauses_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        PCC,
        CAUSE_CODE,
        GCC
    FROM structurefirecauses_col_data_type_update
)

SELECT * FROM structurefirecauses_final
    );
  
  
[0m13:08:59.844502 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:08:59.844502 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: ROLLBACK
[0m13:08:59.844502 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses'
[0m13:08:59.844502 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: Close
[0m13:08:59.860266 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__structurefirecauses (models\nfirs_transformed\nfirs_transformed__structurefirecauses.sql)
  Invalid Input Error: Could not parse string "6052022" according to format specifier "%m%d%Y"
  6052022
  ^
  Error: Month out of range, expected a value between 1 and 12
[0m13:08:59.860266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a63e10a6-9ab3-463b-b8c1-bf43fad61dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269549EB680>]}
[0m13:08:59.864865 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__structurefirecauses  [[31mERROR[0m in 0.12s]
[0m13:08:59.864865 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses
[0m13:08:59.867930 [debug] [MainThread]: Using duckdb connection "master"
[0m13:08:59.867930 [debug] [MainThread]: On master: BEGIN
[0m13:08:59.867930 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:08:59.893716 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:08:59.893716 [debug] [MainThread]: On master: COMMIT
[0m13:08:59.893716 [debug] [MainThread]: Using duckdb connection "master"
[0m13:08:59.893716 [debug] [MainThread]: On master: COMMIT
[0m13:08:59.893716 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:08:59.893716 [debug] [MainThread]: On master: Close
[0m13:08:59.898987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:59.898987 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m13:08:59.898987 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m13:08:59.898987 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m13:08:59.898987 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses' was properly closed.
[0m13:08:59.898987 [info ] [MainThread]: 
[0m13:08:59.898987 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m13:08:59.898987 [debug] [MainThread]: Command end result
[0m13:08:59.935013 [info ] [MainThread]: 
[0m13:08:59.935013 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:08:59.935013 [info ] [MainThread]: 
[0m13:08:59.935013 [error] [MainThread]:   Runtime Error in model nfirs_transformed__structurefirecauses (models\nfirs_transformed\nfirs_transformed__structurefirecauses.sql)
  Invalid Input Error: Could not parse string "6052022" according to format specifier "%m%d%Y"
  6052022
  ^
  Error: Month out of range, expected a value between 1 and 12
[0m13:08:59.935013 [info ] [MainThread]: 
[0m13:08:59.935013 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:08:59.935013 [debug] [MainThread]: Command `cli run` failed at 13:08:59.935013 after 1.22 seconds
[0m13:08:59.935013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026956302E70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026954ECC230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026956539490>]}
[0m13:08:59.935013 [debug] [MainThread]: Flushing usage events
[0m13:11:08.538444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455478F830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024555650D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245559C20C0>]}


============================== 13:11:08.538444 | 2e1675a7-74a9-4e4b-99dd-3380a7757213 ==============================
[0m13:11:08.538444 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:11:08.538444 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:11:08.738389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e1675a7-74a9-4e4b-99dd-3380a7757213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024554C744A0>]}
[0m13:11:08.788495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e1675a7-74a9-4e4b-99dd-3380a7757213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455313EBA0>]}
[0m13:11:08.788495 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:11:08.804910 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:11:08.955055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:08.955055 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:08.988245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e1675a7-74a9-4e4b-99dd-3380a7757213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455774F500>]}
[0m13:11:09.088477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e1675a7-74a9-4e4b-99dd-3380a7757213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245579FACF0>]}
[0m13:11:09.088477 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m13:11:09.088477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e1675a7-74a9-4e4b-99dd-3380a7757213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245576931D0>]}
[0m13:11:09.088477 [info ] [MainThread]: 
[0m13:11:09.088477 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:11:09.088477 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m13:11:09.171962 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m13:11:09.171962 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m13:11:09.171962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:09.191404 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:11:09.204381 [debug] [ThreadPool]: On list_nfirs: Close
[0m13:11:09.205087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m13:11:09.205087 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m13:11:09.205087 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:11:09.205087 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m13:11:09.205087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:09.238914 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:11:09.238914 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:11:09.238914 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m13:11:09.238914 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:11:09.238914 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:11:09.238914 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m13:11:09.238914 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:11:09.238914 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m13:11:09.238914 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:11:09.238914 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m13:11:09.238914 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:11:09.238914 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m13:11:09.255067 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m13:11:09.255067 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:11:09.255067 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m13:11:09.255067 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m13:11:09.255067 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:11:09.255067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:09.255067 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m13:11:09.288234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:09.288234 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:11:09.288234 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:11:09.288234 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:11:09.288234 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:11:09.288234 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m13:11:09.288234 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m13:11:09.321530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:11:09.321530 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:11:09.337562 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m13:11:09.338280 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m13:11:09.338280 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m13:11:09.338280 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m13:11:09.338280 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m13:11:09.338280 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m13:11:09.338280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e1675a7-74a9-4e4b-99dd-3380a7757213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024557D6E630>]}
[0m13:11:09.338280 [debug] [MainThread]: Using duckdb connection "master"
[0m13:11:09.338280 [debug] [MainThread]: On master: BEGIN
[0m13:11:09.338280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:09.371569 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:11:09.371569 [debug] [MainThread]: On master: COMMIT
[0m13:11:09.371569 [debug] [MainThread]: Using duckdb connection "master"
[0m13:11:09.371569 [debug] [MainThread]: On master: COMMIT
[0m13:11:09.371569 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:11:09.371569 [debug] [MainThread]: On master: Close
[0m13:11:09.371569 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:11:09.371569 [info ] [MainThread]: 
[0m13:11:09.371569 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses
[0m13:11:09.387428 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__structurefirecauses  [RUN]
[0m13:11:09.387428 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses'
[0m13:11:09.387428 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses
[0m13:11:09.391465 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:11:09.391465 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses
[0m13:11:09.423237 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:11:09.423237 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:11:09.423237 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: BEGIN
[0m13:11:09.423237 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:11:09.442561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:11:09.442561 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:11:09.442561 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__structurefirecauses__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Cause for Structure Fire Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH structurefirecauses_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."structurefirecauses"
),

structurefirecauses_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM structurefirecauses_source
),

structurefirecauses_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        PCC,
        CAUSE_CODE,
        GCC
    FROM structurefirecauses_col_data_type_update
)

SELECT * FROM structurefirecauses_final
    );
  
  
[0m13:11:09.455395 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__structurefirecauses__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Cause for Structure Fire Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH structurefirecauses_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."structurefirecauses"
),

structurefirecauses_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM structurefirecauses_source
),

structurefirecauses_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        PCC,
        CAUSE_CODE,
        GCC
    FROM structurefirecauses_col_data_type_update
)

SELECT * FROM structurefirecauses_final
    );
  
  
[0m13:11:09.455395 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:11:09.455395 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: ROLLBACK
[0m13:11:09.455395 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses'
[0m13:11:09.455395 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: Close
[0m13:11:09.471519 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__structurefirecauses (models\nfirs_transformed\nfirs_transformed__structurefirecauses.sql)
  Invalid Input Error: Could not parse string "2102022" according to format specifier "%m%d%Y"
  2102022
  ^
  Error: Month out of range, expected a value between 1 and 12
[0m13:11:09.471519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e1675a7-74a9-4e4b-99dd-3380a7757213', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245559339B0>]}
[0m13:11:09.471519 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__structurefirecauses  [[31mERROR[0m in 0.08s]
[0m13:11:09.471519 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses
[0m13:11:09.471519 [debug] [MainThread]: Using duckdb connection "master"
[0m13:11:09.471519 [debug] [MainThread]: On master: BEGIN
[0m13:11:09.471519 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:09.495784 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:11:09.495784 [debug] [MainThread]: On master: COMMIT
[0m13:11:09.495784 [debug] [MainThread]: Using duckdb connection "master"
[0m13:11:09.495784 [debug] [MainThread]: On master: COMMIT
[0m13:11:09.495784 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:11:09.495784 [debug] [MainThread]: On master: Close
[0m13:11:09.509543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:09.509543 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m13:11:09.509543 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m13:11:09.509543 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m13:11:09.509543 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses' was properly closed.
[0m13:11:09.509543 [info ] [MainThread]: 
[0m13:11:09.509543 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m13:11:09.509543 [debug] [MainThread]: Command end result
[0m13:11:09.537484 [info ] [MainThread]: 
[0m13:11:09.537484 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:11:09.543016 [info ] [MainThread]: 
[0m13:11:09.543016 [error] [MainThread]:   Runtime Error in model nfirs_transformed__structurefirecauses (models\nfirs_transformed\nfirs_transformed__structurefirecauses.sql)
  Invalid Input Error: Could not parse string "2102022" according to format specifier "%m%d%Y"
  2102022
  ^
  Error: Month out of range, expected a value between 1 and 12
[0m13:11:09.543016 [info ] [MainThread]: 
[0m13:11:09.543016 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:11:09.543016 [debug] [MainThread]: Command `cli run` failed at 13:11:09.543016 after 1.12 seconds
[0m13:11:09.543016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455306C0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245577373B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002455777B6E0>]}
[0m13:11:09.543016 [debug] [MainThread]: Flushing usage events
[0m13:18:32.791193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9267CC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9263D340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9263F110>]}


============================== 13:18:32.799194 | d99a7c6d-e995-4ca8-93a3-e834680147c7 ==============================
[0m13:18:32.799194 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:18:32.799194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:18:32.981557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd99a7c6d-e995-4ca8-93a3-e834680147c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD927D4290>]}
[0m13:18:33.031883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd99a7c6d-e995-4ca8-93a3-e834680147c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD911551F0>]}
[0m13:18:33.031883 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:18:33.052151 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:18:33.209675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:18:33.210180 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:18:33.244989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd99a7c6d-e995-4ca8-93a3-e834680147c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD92A02990>]}
[0m13:18:33.340736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd99a7c6d-e995-4ca8-93a3-e834680147c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD92C9CC80>]}
[0m13:18:33.340736 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m13:18:33.340736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd99a7c6d-e995-4ca8-93a3-e834680147c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD92940980>]}
[0m13:18:33.340736 [info ] [MainThread]: 
[0m13:18:33.340736 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:18:33.340736 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m13:18:33.415885 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m13:18:33.415960 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m13:18:33.415960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:33.440747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:18:33.440747 [debug] [ThreadPool]: On list_nfirs: Close
[0m13:18:33.440747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m13:18:33.448975 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m13:18:33.448975 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:18:33.448975 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m13:18:33.448975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:33.473879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:18:33.473879 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:18:33.473879 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m13:18:33.473879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:18:33.473879 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:18:33.473879 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m13:18:33.473879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:18:33.482028 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m13:18:33.482028 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m13:18:33.482028 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m13:18:33.482028 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:18:33.482028 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m13:18:33.490296 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m13:18:33.490296 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m13:18:33.498500 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:18:33.498500 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:18:33.498500 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m13:18:33.498500 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m13:18:33.498500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:33.498500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:33.524389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:18:33.524389 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:18:33.524389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:18:33.524389 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m13:18:33.524389 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:18:33.524389 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m13:18:33.557369 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:18:33.565514 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:18:33.565514 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m13:18:33.565514 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m13:18:33.565514 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m13:18:33.565514 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m13:18:33.565514 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m13:18:33.565514 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m13:18:33.573745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd99a7c6d-e995-4ca8-93a3-e834680147c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD92A24A10>]}
[0m13:18:33.573745 [debug] [MainThread]: Using duckdb connection "master"
[0m13:18:33.581786 [debug] [MainThread]: On master: BEGIN
[0m13:18:33.581786 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:33.598341 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:18:33.598341 [debug] [MainThread]: On master: COMMIT
[0m13:18:33.598341 [debug] [MainThread]: Using duckdb connection "master"
[0m13:18:33.598341 [debug] [MainThread]: On master: COMMIT
[0m13:18:33.598341 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:18:33.598341 [debug] [MainThread]: On master: Close
[0m13:18:33.607913 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:18:33.607913 [info ] [MainThread]: 
[0m13:18:33.607913 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses
[0m13:18:33.607913 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__structurefirecauses  [RUN]
[0m13:18:33.607913 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses'
[0m13:18:33.616089 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses
[0m13:18:33.616089 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:18:33.624089 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses
[0m13:18:33.648794 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:18:33.648794 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:18:33.648794 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: BEGIN
[0m13:18:33.648794 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:18:33.673342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:18:33.673342 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:18:33.673342 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__structurefirecauses__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Cause for Structure Fire Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
***/



WITH structurefirecauses_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."structurefirecauses"
),

structurefirecauses_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(LPAD(INC_DATE, 8, '0'), '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM structurefirecauses_source
),

structurefirecauses_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        PCC,
        CAUSE_CODE,
        GCC
    FROM structurefirecauses_col_data_type_update
)

SELECT * FROM structurefirecauses_final
    );
  
  
[0m13:18:33.941257 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:18:33.949456 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:18:33.949456 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__structurefirecauses__dbt_tmp" rename to "nfirs_transformed__structurefirecauses"
[0m13:18:33.949456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:18:33.965881 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: COMMIT
[0m13:18:33.965881 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:18:33.965881 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: COMMIT
[0m13:18:34.374230 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:18:34.382509 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"
[0m13:18:34.382509 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__structurefirecauses__dbt_backup" cascade
[0m13:18:34.382509 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:18:34.390698 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses: Close
[0m13:18:34.424957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd99a7c6d-e995-4ca8-93a3-e834680147c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD92C9FB30>]}
[0m13:18:34.433031 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__structurefirecauses  [[32mOK[0m in 0.82s]
[0m13:18:34.433355 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses
[0m13:18:34.433355 [debug] [MainThread]: Using duckdb connection "master"
[0m13:18:34.433355 [debug] [MainThread]: On master: BEGIN
[0m13:18:34.433355 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:18:34.458061 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:18:34.458061 [debug] [MainThread]: On master: COMMIT
[0m13:18:34.458061 [debug] [MainThread]: Using duckdb connection "master"
[0m13:18:34.458061 [debug] [MainThread]: On master: COMMIT
[0m13:18:34.458061 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:18:34.458061 [debug] [MainThread]: On master: Close
[0m13:18:34.466148 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:34.466148 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m13:18:34.466148 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m13:18:34.466148 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m13:18:34.466148 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__structurefirecauses' was properly closed.
[0m13:18:34.466148 [info ] [MainThread]: 
[0m13:18:34.466148 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m13:18:34.466148 [debug] [MainThread]: Command end result
[0m13:18:34.493320 [info ] [MainThread]: 
[0m13:18:34.501536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:18:34.501536 [info ] [MainThread]: 
[0m13:18:34.501536 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:18:34.501536 [debug] [MainThread]: Command `cli run` succeeded at 13:18:34.501536 after 1.83 seconds
[0m13:18:34.501536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9263D340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD92CBA540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD929251C0>]}
[0m13:18:34.501536 [debug] [MainThread]: Flushing usage events
[0m15:07:43.116556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271BDC0F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271BEDE9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271BEDE9FA0>]}


============================== 15:07:43.120564 | 1e7b2d7c-31d7-45f3-ad16-3cad4913841b ==============================
[0m15:07:43.120564 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:07:43.121557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:07:43.276178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e7b2d7c-31d7-45f3-ad16-3cad4913841b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271C097FFB0>]}
[0m15:07:43.317274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e7b2d7c-31d7-45f3-ad16-3cad4913841b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271BE6F7FE0>]}
[0m15:07:43.318279 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:07:43.327275 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:07:43.451284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:43.451284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:43.481270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e7b2d7c-31d7-45f3-ad16-3cad4913841b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271C08FF410>]}
[0m15:07:43.559254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e7b2d7c-31d7-45f3-ad16-3cad4913841b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271C0E3B020>]}
[0m15:07:43.559254 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m15:07:43.560257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e7b2d7c-31d7-45f3-ad16-3cad4913841b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271C0B77EC0>]}
[0m15:07:43.561257 [info ] [MainThread]: 
[0m15:07:43.562257 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:07:43.563256 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:07:43.742210 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:07:43.742210 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:07:43.743208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:43.764204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:43.765204 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:07:43.770205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:07:43.770205 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:07:43.775204 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:07:43.776204 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:07:43.776204 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:43.795203 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:43.796204 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:07:43.797204 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:07:43.797204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:43.797204 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:07:43.798204 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:07:43.798204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:43.799204 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:07:43.799204 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:07:43.799204 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:07:43.800204 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:43.800204 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:07:43.810203 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:07:43.813203 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:07:43.814209 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:07:43.814209 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:07:43.816203 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:07:43.816203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:43.817203 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:07:43.836285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:43.837276 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:43.837276 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:43.837276 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:07:43.838276 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:07:43.838831 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:07:43.838831 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:07:43.865916 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:43.871911 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:07:43.872911 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:07:43.873930 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:07:43.874929 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:07:43.874929 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:07:43.875917 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:07:43.877915 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:07:43.883914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e7b2d7c-31d7-45f3-ad16-3cad4913841b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271C11AE390>]}
[0m15:07:43.884893 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:43.884893 [debug] [MainThread]: On master: BEGIN
[0m15:07:43.884893 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:43.904954 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:43.904954 [debug] [MainThread]: On master: COMMIT
[0m15:07:43.904954 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:43.906015 [debug] [MainThread]: On master: COMMIT
[0m15:07:43.906015 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:43.906015 [debug] [MainThread]: On master: Close
[0m15:07:43.910017 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:07:43.911017 [info ] [MainThread]: 
[0m15:07:43.915649 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:07:43.916149 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__wildlands .... [RUN]
[0m15:07:43.917802 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m15:07:43.918301 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:07:43.931485 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:07:43.936484 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:07:43.962554 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:07:43.964539 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:07:43.964539 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: BEGIN
[0m15:07:43.964539 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:07:43.986580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:07:43.986580 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:07:43.987557 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Wildland Fire Table Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - WIND_SPEED --> FLOAT
    - AIR_TEMP --> FLOAT
    - REL_HUMID --> FLOAT
    - FUEL_MOIST --> FLOAT
    - BLDG_INV --> FLOAT
    - BLDG_THR --> FLOAT
    - ACRES_BURN --> FLOAT
    - UNDET_BURN --> FLOAT
    - TAX_BURN --> FLOAT
    - NOTAX_BURN --> FLOAT
    - LOCAL_BURN --> FLOAT
    - COUTY_BURN --> FLOAT
    - ST_BURN --> FLOAT
    - FED_BURN --> FLOAT
    - FOREI_BURN --> FLOAT
    - MILIT_BURN --> FLOAT
    - OTHER_BURN --> FLOAT
    - AGE --> INTEGER
    - HORIZ_DIS --> FLOAT
    - ELEVATION --> FLOAT
    - FLAME_LGTH --> FLOAT
    - SPREAD_RAT --> FLOAT
***/



WITH wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."wildlands"
),

wildlands_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(WIND_SPEED AS FLOAT) AS WIND_SPEED_UPDATE,
        CAST(AIR_TEMP AS FLOAT) AS AIR_TEMP_UPDATE,
        CAST(REL_HUMID AS FLOAT) AS REL_HUMID_UPDATE,
        CAST(FUEL_MOIST AS FLOAT) AS FUEL_MOIST_UPDATE,
        CAST(BLDG_INV AS FLOAT) AS BLDG_INV_UPDATE,
        CAST(BLDG_THR AS FLOAT) AS BLDG_THR_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(UNDET_BURN AS FLOAT) AS UNDET_BURN_UPDATE,
        CAST(TAX_BURN AS FLOAT) AS TAX_BURN_UPDATE,
        CAST(NOTAX_BURN AS FLOAT) AS NOTAX_BURN_UPDATE,
        CAST(LOCAL_BURN AS FLOAT) AS LOCAL_BURN_UPDATE,
        CAST(COUTY_BURN AS FLOAT) AS COUTY_BURN_UPDATE,
        CAST(ST_BURN AS FLOAT) AS ST_BURN_UPDATE,
        CAST(FED_BURN AS FLOAT) AS FED_BURN_UPDATE,
        CAST(FOREI_BURN AS FLOAT) AS FOREI_BURN_UPDATE,
        CAST(MILIT_BURN AS FLOAT) AS MILIT_BURN_UPDATE,
        CAST(OTHER_BURN AS FLOAT) AS OTHER_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(HORIZ_DIS AS FLOAT) AS HORIZ_DIS_UPDATE,
        CAST(ELEVATION AS FLOAT) AS ELEVATION_UPDATE,
        CAST(FLAME_LGTH AS FLOAT) AS FLAME_LGTH_UPDATE,
        CAST(SPREAD_RAT AS FLOAT) AS SPREAD_RAT_UPDATE
    FROM wildlands_source
),

wildlands_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        LATITUDE,
        LONGITUDE,
        TOWNSHIP,
        NORTH_SOU,
        RANGE,
        EAST_WEST,
        SECTION,
        SUBSECTION,
        MERIDIAN,
        AREA_TYPE,
        FIRE_CAUSE,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_IGN1,
        FACT_IGN2,
        SUPP_FACT1,
        SUPP_FACT2,
        SUPP_FACT3,
        HEAT_SOURC,
        MOB_PROP,
        EQ_INV_IG,
        NFDRS_ID,
        WEATH_TYPE,
        WIND_DIR,
        WIND_SPEED_UPDATE AS WIND_SPEED.
        AIR_TEMP_UPDATE AS AIR_TEMP,
        REL_HUMID_UPDATE AS REL_HUMID,
        FUEL_MOIST_UPDATE AS FUEL_MOIST,
        DANGR_RATE,
        BLDG_INV_UPDATE AS BLDG_INV,
        BLDG_THR_UPDATE AS BLDG_THR
        ACRES_BURN_UPDATE AS ACRES_BURN,
        CROP_BURN1,
        CROP_BURN2,
        CROP_BURN3,
        UNDET_BURN_UPDATE AS UNDET_BURN,
        TAX_BURN_UPDATE AS TAX_BURN,
        NOTAX_BURN_UPDATE AS NOTAX_BURN,
        LOCAL_BURN_UPDATE AS LOCAL_BURN,
        COUTY_BURN_UPDATE AS COUTY_BURN,
        ST_BURN_UPDATE AS ST_BURN,
        FED_BURN_UPDATE AS FED_BURN,
        FOREI_BURN_UPDATE AS FOREI_BURN,
        MILIT_BURN_UPDATE AS MILIT_BURN,
        OTHER_BURN_UPDATE AS OTHER_BURN
        PROP_MANAG,
        FED_CODE,
        NFDRS_FM,
        PERSON_FIR,
        GENDER,
        AGE_UPDATE AS AGE,
        ACTIVITY_W,
        HORIZ_DIS_UPDATE AS HORIZ_DIS,
        TYPE_ROW,
        ELEVATION_UPDATE AS ELEVATION,
        POS_SLOPE,
        ASPECT,
        FLAME_LGTH_UPDATE AS FLAME_LGTH,
        SPREAD_RAT_UPDATE AS SPREAD_RAT
    FROM wildlands_final
)

SELECT * FROM wildlands_final
    );
  
  
[0m15:07:43.988560 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Wildland Fire Table Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - WIND_SPEED --> FLOAT
    - AIR_TEMP --> FLOAT
    - REL_HUMID --> FLOAT
    - FUEL_MOIST --> FLOAT
    - BLDG_INV --> FLOAT
    - BLDG_THR --> FLOAT
    - ACRES_BURN --> FLOAT
    - UNDET_BURN --> FLOAT
    - TAX_BURN --> FLOAT
    - NOTAX_BURN --> FLOAT
    - LOCAL_BURN --> FLOAT
    - COUTY_BURN --> FLOAT
    - ST_BURN --> FLOAT
    - FED_BURN --> FLOAT
    - FOREI_BURN --> FLOAT
    - MILIT_BURN --> FLOAT
    - OTHER_BURN --> FLOAT
    - AGE --> INTEGER
    - HORIZ_DIS --> FLOAT
    - ELEVATION --> FLOAT
    - FLAME_LGTH --> FLOAT
    - SPREAD_RAT --> FLOAT
***/



WITH wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."wildlands"
),

wildlands_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(WIND_SPEED AS FLOAT) AS WIND_SPEED_UPDATE,
        CAST(AIR_TEMP AS FLOAT) AS AIR_TEMP_UPDATE,
        CAST(REL_HUMID AS FLOAT) AS REL_HUMID_UPDATE,
        CAST(FUEL_MOIST AS FLOAT) AS FUEL_MOIST_UPDATE,
        CAST(BLDG_INV AS FLOAT) AS BLDG_INV_UPDATE,
        CAST(BLDG_THR AS FLOAT) AS BLDG_THR_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(UNDET_BURN AS FLOAT) AS UNDET_BURN_UPDATE,
        CAST(TAX_BURN AS FLOAT) AS TAX_BURN_UPDATE,
        CAST(NOTAX_BURN AS FLOAT) AS NOTAX_BURN_UPDATE,
        CAST(LOCAL_BURN AS FLOAT) AS LOCAL_BURN_UPDATE,
        CAST(COUTY_BURN AS FLOAT) AS COUTY_BURN_UPDATE,
        CAST(ST_BURN AS FLOAT) AS ST_BURN_UPDATE,
        CAST(FED_BURN AS FLOAT) AS FED_BURN_UPDATE,
        CAST(FOREI_BURN AS FLOAT) AS FOREI_BURN_UPDATE,
        CAST(MILIT_BURN AS FLOAT) AS MILIT_BURN_UPDATE,
        CAST(OTHER_BURN AS FLOAT) AS OTHER_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(HORIZ_DIS AS FLOAT) AS HORIZ_DIS_UPDATE,
        CAST(ELEVATION AS FLOAT) AS ELEVATION_UPDATE,
        CAST(FLAME_LGTH AS FLOAT) AS FLAME_LGTH_UPDATE,
        CAST(SPREAD_RAT AS FLOAT) AS SPREAD_RAT_UPDATE
    FROM wildlands_source
),

wildlands_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        LATITUDE,
        LONGITUDE,
        TOWNSHIP,
        NORTH_SOU,
        RANGE,
        EAST_WEST,
        SECTION,
        SUBSECTION,
        MERIDIAN,
        AREA_TYPE,
        FIRE_CAUSE,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_IGN1,
        FACT_IGN2,
        SUPP_FACT1,
        SUPP_FACT2,
        SUPP_FACT3,
        HEAT_SOURC,
        MOB_PROP,
        EQ_INV_IG,
        NFDRS_ID,
        WEATH_TYPE,
        WIND_DIR,
        WIND_SPEED_UPDATE AS WIND_SPEED.
        AIR_TEMP_UPDATE AS AIR_TEMP,
        REL_HUMID_UPDATE AS REL_HUMID,
        FUEL_MOIST_UPDATE AS FUEL_MOIST,
        DANGR_RATE,
        BLDG_INV_UPDATE AS BLDG_INV,
        BLDG_THR_UPDATE AS BLDG_THR
        ACRES_BURN_UPDATE AS ACRES_BURN,
        CROP_BURN1,
        CROP_BURN2,
        CROP_BURN3,
        UNDET_BURN_UPDATE AS UNDET_BURN,
        TAX_BURN_UPDATE AS TAX_BURN,
        NOTAX_BURN_UPDATE AS NOTAX_BURN,
        LOCAL_BURN_UPDATE AS LOCAL_BURN,
        COUTY_BURN_UPDATE AS COUTY_BURN,
        ST_BURN_UPDATE AS ST_BURN,
        FED_BURN_UPDATE AS FED_BURN,
        FOREI_BURN_UPDATE AS FOREI_BURN,
        MILIT_BURN_UPDATE AS MILIT_BURN,
        OTHER_BURN_UPDATE AS OTHER_BURN
        PROP_MANAG,
        FED_CODE,
        NFDRS_FM,
        PERSON_FIR,
        GENDER,
        AGE_UPDATE AS AGE,
        ACTIVITY_W,
        HORIZ_DIS_UPDATE AS HORIZ_DIS,
        TYPE_ROW,
        ELEVATION_UPDATE AS ELEVATION,
        POS_SLOPE,
        ASPECT,
        FLAME_LGTH_UPDATE AS FLAME_LGTH,
        SPREAD_RAT_UPDATE AS SPREAD_RAT
    FROM wildlands_final
)

SELECT * FROM wildlands_final
    );
  
  
[0m15:07:43.988560 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:07:43.989558 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: ROLLBACK
[0m15:07:43.992695 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m15:07:43.993767 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: Close
[0m15:07:44.000008 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Parser Error: syntax error at or near "."
[0m15:07:44.000927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7b2d7c-31d7-45f3-ad16-3cad4913841b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271BEDBF500>]}
[0m15:07:44.001926 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__wildlands  [[31mERROR[0m in 0.08s]
[0m15:07:44.001926 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:07:44.004926 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:44.004926 [debug] [MainThread]: On master: BEGIN
[0m15:07:44.005926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:44.024926 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:44.025926 [debug] [MainThread]: On master: COMMIT
[0m15:07:44.025926 [debug] [MainThread]: Using duckdb connection "master"
[0m15:07:44.026927 [debug] [MainThread]: On master: COMMIT
[0m15:07:44.026927 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:07:44.027926 [debug] [MainThread]: On master: Close
[0m15:07:44.031731 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:44.031731 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:07:44.032744 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:07:44.032744 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:07:44.032744 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands' was properly closed.
[0m15:07:44.032744 [info ] [MainThread]: 
[0m15:07:44.033730 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m15:07:44.033730 [debug] [MainThread]: Command end result
[0m15:07:44.057738 [info ] [MainThread]: 
[0m15:07:44.058726 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:07:44.058726 [info ] [MainThread]: 
[0m15:07:44.059751 [error] [MainThread]:   Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Parser Error: syntax error at or near "."
[0m15:07:44.059751 [info ] [MainThread]: 
[0m15:07:44.059751 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:07:44.060740 [debug] [MainThread]: Command `cli run` failed at 15:07:44.060740 after 1.07 seconds
[0m15:07:44.061738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271BDC0F890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271C085E360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271C072DD00>]}
[0m15:07:44.061738 [debug] [MainThread]: Flushing usage events
[0m15:08:07.541483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264C45F2FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264C458AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264C4898E00>]}


============================== 15:08:07.545522 | de062266-e6b7-4ea9-97af-bc633ed124b5 ==============================
[0m15:08:07.545522 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:08:07.545522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:07.696440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de062266-e6b7-4ea9-97af-bc633ed124b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264C4A4D220>]}
[0m15:08:07.737429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de062266-e6b7-4ea9-97af-bc633ed124b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264C45F2FC0>]}
[0m15:08:07.738430 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:08:07.748428 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:08:07.871594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:07.872607 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:07.901774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de062266-e6b7-4ea9-97af-bc633ed124b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264C4C57950>]}
[0m15:08:07.980750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de062266-e6b7-4ea9-97af-bc633ed124b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264C4FAC920>]}
[0m15:08:07.981734 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m15:08:07.981734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de062266-e6b7-4ea9-97af-bc633ed124b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264C4DE39E0>]}
[0m15:08:07.982731 [info ] [MainThread]: 
[0m15:08:07.983725 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:08:07.984691 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:08:08.050096 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:08:08.050096 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:08:08.051096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:08.072197 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:08.073150 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:08:08.079167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:08:08.079167 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:08:08.084130 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:08:08.084130 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:08:08.085146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:08.106034 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:08.108000 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:08:08.108000 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:08:08.109089 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:08.109089 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:08:08.110071 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:08:08.110071 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:08.111034 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:08:08.111034 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:08:08.112034 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:08:08.112034 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:08.112034 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:08:08.121394 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:08:08.121394 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:08:08.126401 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:08:08.127422 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:08:08.128362 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:08:08.128362 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:08:08.128362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:08.129397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:08.147499 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:08.147499 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:08.148483 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:08:08.148483 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:08:08.149442 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:08:08.149442 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:08:08.177582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:08.181547 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:08.182559 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:08:08.183543 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:08:08.184576 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:08:08.185572 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:08:08.185572 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:08:08.186554 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:08:08.194564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de062266-e6b7-4ea9-97af-bc633ed124b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264C49F4EC0>]}
[0m15:08:08.195552 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:08.195552 [debug] [MainThread]: On master: BEGIN
[0m15:08:08.195552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:08.215353 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:08.215353 [debug] [MainThread]: On master: COMMIT
[0m15:08:08.216346 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:08.216346 [debug] [MainThread]: On master: COMMIT
[0m15:08:08.217330 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:08.217330 [debug] [MainThread]: On master: Close
[0m15:08:08.221364 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:08:08.222536 [info ] [MainThread]: 
[0m15:08:08.228649 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:08:08.229530 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__wildlands .... [RUN]
[0m15:08:08.230822 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m15:08:08.231733 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:08:08.240038 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:08:08.241039 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:08:08.267177 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:08:08.268176 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:08:08.268176 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: BEGIN
[0m15:08:08.269177 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:08.289177 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:08.289177 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:08:08.290152 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Wildland Fire Table Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - WIND_SPEED --> FLOAT
    - AIR_TEMP --> FLOAT
    - REL_HUMID --> FLOAT
    - FUEL_MOIST --> FLOAT
    - BLDG_INV --> FLOAT
    - BLDG_THR --> FLOAT
    - ACRES_BURN --> FLOAT
    - UNDET_BURN --> FLOAT
    - TAX_BURN --> FLOAT
    - NOTAX_BURN --> FLOAT
    - LOCAL_BURN --> FLOAT
    - COUTY_BURN --> FLOAT
    - ST_BURN --> FLOAT
    - FED_BURN --> FLOAT
    - FOREI_BURN --> FLOAT
    - MILIT_BURN --> FLOAT
    - OTHER_BURN --> FLOAT
    - AGE --> INTEGER
    - HORIZ_DIS --> FLOAT
    - ELEVATION --> FLOAT
    - FLAME_LGTH --> FLOAT
    - SPREAD_RAT --> FLOAT
***/



WITH wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."wildlands"
),

wildlands_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(WIND_SPEED AS FLOAT) AS WIND_SPEED_UPDATE,
        CAST(AIR_TEMP AS FLOAT) AS AIR_TEMP_UPDATE,
        CAST(REL_HUMID AS FLOAT) AS REL_HUMID_UPDATE,
        CAST(FUEL_MOIST AS FLOAT) AS FUEL_MOIST_UPDATE,
        CAST(BLDG_INV AS FLOAT) AS BLDG_INV_UPDATE,
        CAST(BLDG_THR AS FLOAT) AS BLDG_THR_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(UNDET_BURN AS FLOAT) AS UNDET_BURN_UPDATE,
        CAST(TAX_BURN AS FLOAT) AS TAX_BURN_UPDATE,
        CAST(NOTAX_BURN AS FLOAT) AS NOTAX_BURN_UPDATE,
        CAST(LOCAL_BURN AS FLOAT) AS LOCAL_BURN_UPDATE,
        CAST(COUTY_BURN AS FLOAT) AS COUTY_BURN_UPDATE,
        CAST(ST_BURN AS FLOAT) AS ST_BURN_UPDATE,
        CAST(FED_BURN AS FLOAT) AS FED_BURN_UPDATE,
        CAST(FOREI_BURN AS FLOAT) AS FOREI_BURN_UPDATE,
        CAST(MILIT_BURN AS FLOAT) AS MILIT_BURN_UPDATE,
        CAST(OTHER_BURN AS FLOAT) AS OTHER_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(HORIZ_DIS AS FLOAT) AS HORIZ_DIS_UPDATE,
        CAST(ELEVATION AS FLOAT) AS ELEVATION_UPDATE,
        CAST(FLAME_LGTH AS FLOAT) AS FLAME_LGTH_UPDATE,
        CAST(SPREAD_RAT AS FLOAT) AS SPREAD_RAT_UPDATE
    FROM wildlands_source
),

wildlands_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        LATITUDE,
        LONGITUDE,
        TOWNSHIP,
        NORTH_SOU,
        RANGE,
        EAST_WEST,
        SECTION,
        SUBSECTION,
        MERIDIAN,
        AREA_TYPE,
        FIRE_CAUSE,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_IGN1,
        FACT_IGN2,
        SUPP_FACT1,
        SUPP_FACT2,
        SUPP_FACT3,
        HEAT_SOURC,
        MOB_PROP,
        EQ_INV_IG,
        NFDRS_ID,
        WEATH_TYPE,
        WIND_DIR,
        WIND_SPEED_UPDATE AS WIND_SPEED,
        AIR_TEMP_UPDATE AS AIR_TEMP,
        REL_HUMID_UPDATE AS REL_HUMID,
        FUEL_MOIST_UPDATE AS FUEL_MOIST,
        DANGR_RATE,
        BLDG_INV_UPDATE AS BLDG_INV,
        BLDG_THR_UPDATE AS BLDG_THR
        ACRES_BURN_UPDATE AS ACRES_BURN,
        CROP_BURN1,
        CROP_BURN2,
        CROP_BURN3,
        UNDET_BURN_UPDATE AS UNDET_BURN,
        TAX_BURN_UPDATE AS TAX_BURN,
        NOTAX_BURN_UPDATE AS NOTAX_BURN,
        LOCAL_BURN_UPDATE AS LOCAL_BURN,
        COUTY_BURN_UPDATE AS COUTY_BURN,
        ST_BURN_UPDATE AS ST_BURN,
        FED_BURN_UPDATE AS FED_BURN,
        FOREI_BURN_UPDATE AS FOREI_BURN,
        MILIT_BURN_UPDATE AS MILIT_BURN,
        OTHER_BURN_UPDATE AS OTHER_BURN
        PROP_MANAG,
        FED_CODE,
        NFDRS_FM,
        PERSON_FIR,
        GENDER,
        AGE_UPDATE AS AGE,
        ACTIVITY_W,
        HORIZ_DIS_UPDATE AS HORIZ_DIS,
        TYPE_ROW,
        ELEVATION_UPDATE AS ELEVATION,
        POS_SLOPE,
        ASPECT,
        FLAME_LGTH_UPDATE AS FLAME_LGTH,
        SPREAD_RAT_UPDATE AS SPREAD_RAT
    FROM wildlands_final
)

SELECT * FROM wildlands_final
    );
  
  
[0m15:08:08.291153 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Wildland Fire Table Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - WIND_SPEED --> FLOAT
    - AIR_TEMP --> FLOAT
    - REL_HUMID --> FLOAT
    - FUEL_MOIST --> FLOAT
    - BLDG_INV --> FLOAT
    - BLDG_THR --> FLOAT
    - ACRES_BURN --> FLOAT
    - UNDET_BURN --> FLOAT
    - TAX_BURN --> FLOAT
    - NOTAX_BURN --> FLOAT
    - LOCAL_BURN --> FLOAT
    - COUTY_BURN --> FLOAT
    - ST_BURN --> FLOAT
    - FED_BURN --> FLOAT
    - FOREI_BURN --> FLOAT
    - MILIT_BURN --> FLOAT
    - OTHER_BURN --> FLOAT
    - AGE --> INTEGER
    - HORIZ_DIS --> FLOAT
    - ELEVATION --> FLOAT
    - FLAME_LGTH --> FLOAT
    - SPREAD_RAT --> FLOAT
***/



WITH wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."wildlands"
),

wildlands_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(WIND_SPEED AS FLOAT) AS WIND_SPEED_UPDATE,
        CAST(AIR_TEMP AS FLOAT) AS AIR_TEMP_UPDATE,
        CAST(REL_HUMID AS FLOAT) AS REL_HUMID_UPDATE,
        CAST(FUEL_MOIST AS FLOAT) AS FUEL_MOIST_UPDATE,
        CAST(BLDG_INV AS FLOAT) AS BLDG_INV_UPDATE,
        CAST(BLDG_THR AS FLOAT) AS BLDG_THR_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(UNDET_BURN AS FLOAT) AS UNDET_BURN_UPDATE,
        CAST(TAX_BURN AS FLOAT) AS TAX_BURN_UPDATE,
        CAST(NOTAX_BURN AS FLOAT) AS NOTAX_BURN_UPDATE,
        CAST(LOCAL_BURN AS FLOAT) AS LOCAL_BURN_UPDATE,
        CAST(COUTY_BURN AS FLOAT) AS COUTY_BURN_UPDATE,
        CAST(ST_BURN AS FLOAT) AS ST_BURN_UPDATE,
        CAST(FED_BURN AS FLOAT) AS FED_BURN_UPDATE,
        CAST(FOREI_BURN AS FLOAT) AS FOREI_BURN_UPDATE,
        CAST(MILIT_BURN AS FLOAT) AS MILIT_BURN_UPDATE,
        CAST(OTHER_BURN AS FLOAT) AS OTHER_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(HORIZ_DIS AS FLOAT) AS HORIZ_DIS_UPDATE,
        CAST(ELEVATION AS FLOAT) AS ELEVATION_UPDATE,
        CAST(FLAME_LGTH AS FLOAT) AS FLAME_LGTH_UPDATE,
        CAST(SPREAD_RAT AS FLOAT) AS SPREAD_RAT_UPDATE
    FROM wildlands_source
),

wildlands_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        LATITUDE,
        LONGITUDE,
        TOWNSHIP,
        NORTH_SOU,
        RANGE,
        EAST_WEST,
        SECTION,
        SUBSECTION,
        MERIDIAN,
        AREA_TYPE,
        FIRE_CAUSE,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_IGN1,
        FACT_IGN2,
        SUPP_FACT1,
        SUPP_FACT2,
        SUPP_FACT3,
        HEAT_SOURC,
        MOB_PROP,
        EQ_INV_IG,
        NFDRS_ID,
        WEATH_TYPE,
        WIND_DIR,
        WIND_SPEED_UPDATE AS WIND_SPEED,
        AIR_TEMP_UPDATE AS AIR_TEMP,
        REL_HUMID_UPDATE AS REL_HUMID,
        FUEL_MOIST_UPDATE AS FUEL_MOIST,
        DANGR_RATE,
        BLDG_INV_UPDATE AS BLDG_INV,
        BLDG_THR_UPDATE AS BLDG_THR
        ACRES_BURN_UPDATE AS ACRES_BURN,
        CROP_BURN1,
        CROP_BURN2,
        CROP_BURN3,
        UNDET_BURN_UPDATE AS UNDET_BURN,
        TAX_BURN_UPDATE AS TAX_BURN,
        NOTAX_BURN_UPDATE AS NOTAX_BURN,
        LOCAL_BURN_UPDATE AS LOCAL_BURN,
        COUTY_BURN_UPDATE AS COUTY_BURN,
        ST_BURN_UPDATE AS ST_BURN,
        FED_BURN_UPDATE AS FED_BURN,
        FOREI_BURN_UPDATE AS FOREI_BURN,
        MILIT_BURN_UPDATE AS MILIT_BURN,
        OTHER_BURN_UPDATE AS OTHER_BURN
        PROP_MANAG,
        FED_CODE,
        NFDRS_FM,
        PERSON_FIR,
        GENDER,
        AGE_UPDATE AS AGE,
        ACTIVITY_W,
        HORIZ_DIS_UPDATE AS HORIZ_DIS,
        TYPE_ROW,
        ELEVATION_UPDATE AS ELEVATION,
        POS_SLOPE,
        ASPECT,
        FLAME_LGTH_UPDATE AS FLAME_LGTH,
        SPREAD_RAT_UPDATE AS SPREAD_RAT
    FROM wildlands_final
)

SELECT * FROM wildlands_final
    );
  
  
[0m15:08:08.291153 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:08:08.292176 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: ROLLBACK
[0m15:08:08.296206 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m15:08:08.296206 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: Close
[0m15:08:08.302177 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Parser Error: syntax error at or near "ACRES_BURN_UPDATE"
[0m15:08:08.303173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de062266-e6b7-4ea9-97af-bc633ed124b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264C2F67680>]}
[0m15:08:08.304177 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__wildlands  [[31mERROR[0m in 0.07s]
[0m15:08:08.305199 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:08:08.307137 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:08.307137 [debug] [MainThread]: On master: BEGIN
[0m15:08:08.307137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:08.327149 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:08.327149 [debug] [MainThread]: On master: COMMIT
[0m15:08:08.328143 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:08.328143 [debug] [MainThread]: On master: COMMIT
[0m15:08:08.328143 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:08.329161 [debug] [MainThread]: On master: Close
[0m15:08:08.334180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:08.335171 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:08:08.335171 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:08:08.335171 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:08:08.335171 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands' was properly closed.
[0m15:08:08.336170 [info ] [MainThread]: 
[0m15:08:08.336170 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:08:08.337188 [debug] [MainThread]: Command end result
[0m15:08:08.363036 [info ] [MainThread]: 
[0m15:08:08.364036 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:08:08.365036 [info ] [MainThread]: 
[0m15:08:08.366038 [error] [MainThread]:   Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Parser Error: syntax error at or near "ACRES_BURN_UPDATE"
[0m15:08:08.367071 [info ] [MainThread]: 
[0m15:08:08.367071 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:08:08.368170 [debug] [MainThread]: Command `cli run` failed at 15:08:08.368170 after 0.93 seconds
[0m15:08:08.368170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264C303B4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264C285BDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264C4898D40>]}
[0m15:08:08.369161 [debug] [MainThread]: Flushing usage events
[0m15:08:28.037293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020512A07980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020512A06AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020512A07680>]}


============================== 15:08:28.041294 | d72cd5cf-c6f3-4890-9b05-668afb53ead1 ==============================
[0m15:08:28.041294 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:08:28.041294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:28.189623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd72cd5cf-c6f3-4890-9b05-668afb53ead1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020512CDBDA0>]}
[0m15:08:28.229674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd72cd5cf-c6f3-4890-9b05-668afb53ead1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051047F650>]}
[0m15:08:28.230671 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:08:28.240673 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:08:28.364221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:28.364221 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:28.394214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd72cd5cf-c6f3-4890-9b05-668afb53ead1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020512EB8F50>]}
[0m15:08:28.470297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd72cd5cf-c6f3-4890-9b05-668afb53ead1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051312F740>]}
[0m15:08:28.471300 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m15:08:28.471300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd72cd5cf-c6f3-4890-9b05-668afb53ead1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020512E8C320>]}
[0m15:08:28.473292 [info ] [MainThread]: 
[0m15:08:28.473292 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:08:28.474212 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:08:28.534492 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:08:28.534492 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:08:28.535474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:28.556578 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.558574 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:08:28.563497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:08:28.563497 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:08:28.568573 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:08:28.568573 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:08:28.569573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:28.587579 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.589578 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:08:28.589578 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:08:28.589578 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.590597 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:08:28.590597 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:08:28.590597 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.591589 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:08:28.592575 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:08:28.592575 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:08:28.592575 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.593572 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:08:28.602572 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:08:28.603578 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:08:28.607582 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:08:28.609579 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:08:28.610504 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:08:28.610504 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:08:28.611494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:28.611494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:28.630498 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.630498 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.631585 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:08:28.631585 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:08:28.632666 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:08:28.633667 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:08:28.664171 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.666272 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:28.667259 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:08:28.668253 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:08:28.670216 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:08:28.670216 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:08:28.671249 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:08:28.672251 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:08:28.678645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd72cd5cf-c6f3-4890-9b05-668afb53ead1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020512CB5EE0>]}
[0m15:08:28.679618 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:28.679618 [debug] [MainThread]: On master: BEGIN
[0m15:08:28.680570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:28.699613 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:28.700131 [debug] [MainThread]: On master: COMMIT
[0m15:08:28.700131 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:28.700131 [debug] [MainThread]: On master: COMMIT
[0m15:08:28.701135 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:28.701135 [debug] [MainThread]: On master: Close
[0m15:08:28.705202 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:08:28.706195 [info ] [MainThread]: 
[0m15:08:28.710160 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:08:28.710160 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__wildlands .... [RUN]
[0m15:08:28.711161 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m15:08:28.711161 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:08:28.717191 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:08:28.718123 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:08:28.742193 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:08:28.743122 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:08:28.743122 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: BEGIN
[0m15:08:28.743122 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:28.762175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:28.762175 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:08:28.763202 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Wildland Fire Table Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - WIND_SPEED --> FLOAT
    - AIR_TEMP --> FLOAT
    - REL_HUMID --> FLOAT
    - FUEL_MOIST --> FLOAT
    - BLDG_INV --> FLOAT
    - BLDG_THR --> FLOAT
    - ACRES_BURN --> FLOAT
    - UNDET_BURN --> FLOAT
    - TAX_BURN --> FLOAT
    - NOTAX_BURN --> FLOAT
    - LOCAL_BURN --> FLOAT
    - COUTY_BURN --> FLOAT
    - ST_BURN --> FLOAT
    - FED_BURN --> FLOAT
    - FOREI_BURN --> FLOAT
    - MILIT_BURN --> FLOAT
    - OTHER_BURN --> FLOAT
    - AGE --> INTEGER
    - HORIZ_DIS --> FLOAT
    - ELEVATION --> FLOAT
    - FLAME_LGTH --> FLOAT
    - SPREAD_RAT --> FLOAT
***/



WITH wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."wildlands"
),

wildlands_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(WIND_SPEED AS FLOAT) AS WIND_SPEED_UPDATE,
        CAST(AIR_TEMP AS FLOAT) AS AIR_TEMP_UPDATE,
        CAST(REL_HUMID AS FLOAT) AS REL_HUMID_UPDATE,
        CAST(FUEL_MOIST AS FLOAT) AS FUEL_MOIST_UPDATE,
        CAST(BLDG_INV AS FLOAT) AS BLDG_INV_UPDATE,
        CAST(BLDG_THR AS FLOAT) AS BLDG_THR_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(UNDET_BURN AS FLOAT) AS UNDET_BURN_UPDATE,
        CAST(TAX_BURN AS FLOAT) AS TAX_BURN_UPDATE,
        CAST(NOTAX_BURN AS FLOAT) AS NOTAX_BURN_UPDATE,
        CAST(LOCAL_BURN AS FLOAT) AS LOCAL_BURN_UPDATE,
        CAST(COUTY_BURN AS FLOAT) AS COUTY_BURN_UPDATE,
        CAST(ST_BURN AS FLOAT) AS ST_BURN_UPDATE,
        CAST(FED_BURN AS FLOAT) AS FED_BURN_UPDATE,
        CAST(FOREI_BURN AS FLOAT) AS FOREI_BURN_UPDATE,
        CAST(MILIT_BURN AS FLOAT) AS MILIT_BURN_UPDATE,
        CAST(OTHER_BURN AS FLOAT) AS OTHER_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(HORIZ_DIS AS FLOAT) AS HORIZ_DIS_UPDATE,
        CAST(ELEVATION AS FLOAT) AS ELEVATION_UPDATE,
        CAST(FLAME_LGTH AS FLOAT) AS FLAME_LGTH_UPDATE,
        CAST(SPREAD_RAT AS FLOAT) AS SPREAD_RAT_UPDATE
    FROM wildlands_source
),

wildlands_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        LATITUDE,
        LONGITUDE,
        TOWNSHIP,
        NORTH_SOU,
        RANGE,
        EAST_WEST,
        SECTION,
        SUBSECTION,
        MERIDIAN,
        AREA_TYPE,
        FIRE_CAUSE,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_IGN1,
        FACT_IGN2,
        SUPP_FACT1,
        SUPP_FACT2,
        SUPP_FACT3,
        HEAT_SOURC,
        MOB_PROP,
        EQ_INV_IG,
        NFDRS_ID,
        WEATH_TYPE,
        WIND_DIR,
        WIND_SPEED_UPDATE AS WIND_SPEED,
        AIR_TEMP_UPDATE AS AIR_TEMP,
        REL_HUMID_UPDATE AS REL_HUMID,
        FUEL_MOIST_UPDATE AS FUEL_MOIST,
        DANGR_RATE,
        BLDG_INV_UPDATE AS BLDG_INV,
        BLDG_THR_UPDATE AS BLDG_THR,
        ACRES_BURN_UPDATE AS ACRES_BURN,
        CROP_BURN1,
        CROP_BURN2,
        CROP_BURN3,
        UNDET_BURN_UPDATE AS UNDET_BURN,
        TAX_BURN_UPDATE AS TAX_BURN,
        NOTAX_BURN_UPDATE AS NOTAX_BURN,
        LOCAL_BURN_UPDATE AS LOCAL_BURN,
        COUTY_BURN_UPDATE AS COUTY_BURN,
        ST_BURN_UPDATE AS ST_BURN,
        FED_BURN_UPDATE AS FED_BURN,
        FOREI_BURN_UPDATE AS FOREI_BURN,
        MILIT_BURN_UPDATE AS MILIT_BURN,
        OTHER_BURN_UPDATE AS OTHER_BURN
        PROP_MANAG,
        FED_CODE,
        NFDRS_FM,
        PERSON_FIR,
        GENDER,
        AGE_UPDATE AS AGE,
        ACTIVITY_W,
        HORIZ_DIS_UPDATE AS HORIZ_DIS,
        TYPE_ROW,
        ELEVATION_UPDATE AS ELEVATION,
        POS_SLOPE,
        ASPECT,
        FLAME_LGTH_UPDATE AS FLAME_LGTH,
        SPREAD_RAT_UPDATE AS SPREAD_RAT
    FROM wildlands_final
)

SELECT * FROM wildlands_final
    );
  
  
[0m15:08:28.764121 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Wildland Fire Table Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - WIND_SPEED --> FLOAT
    - AIR_TEMP --> FLOAT
    - REL_HUMID --> FLOAT
    - FUEL_MOIST --> FLOAT
    - BLDG_INV --> FLOAT
    - BLDG_THR --> FLOAT
    - ACRES_BURN --> FLOAT
    - UNDET_BURN --> FLOAT
    - TAX_BURN --> FLOAT
    - NOTAX_BURN --> FLOAT
    - LOCAL_BURN --> FLOAT
    - COUTY_BURN --> FLOAT
    - ST_BURN --> FLOAT
    - FED_BURN --> FLOAT
    - FOREI_BURN --> FLOAT
    - MILIT_BURN --> FLOAT
    - OTHER_BURN --> FLOAT
    - AGE --> INTEGER
    - HORIZ_DIS --> FLOAT
    - ELEVATION --> FLOAT
    - FLAME_LGTH --> FLOAT
    - SPREAD_RAT --> FLOAT
***/



WITH wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."wildlands"
),

wildlands_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(WIND_SPEED AS FLOAT) AS WIND_SPEED_UPDATE,
        CAST(AIR_TEMP AS FLOAT) AS AIR_TEMP_UPDATE,
        CAST(REL_HUMID AS FLOAT) AS REL_HUMID_UPDATE,
        CAST(FUEL_MOIST AS FLOAT) AS FUEL_MOIST_UPDATE,
        CAST(BLDG_INV AS FLOAT) AS BLDG_INV_UPDATE,
        CAST(BLDG_THR AS FLOAT) AS BLDG_THR_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(UNDET_BURN AS FLOAT) AS UNDET_BURN_UPDATE,
        CAST(TAX_BURN AS FLOAT) AS TAX_BURN_UPDATE,
        CAST(NOTAX_BURN AS FLOAT) AS NOTAX_BURN_UPDATE,
        CAST(LOCAL_BURN AS FLOAT) AS LOCAL_BURN_UPDATE,
        CAST(COUTY_BURN AS FLOAT) AS COUTY_BURN_UPDATE,
        CAST(ST_BURN AS FLOAT) AS ST_BURN_UPDATE,
        CAST(FED_BURN AS FLOAT) AS FED_BURN_UPDATE,
        CAST(FOREI_BURN AS FLOAT) AS FOREI_BURN_UPDATE,
        CAST(MILIT_BURN AS FLOAT) AS MILIT_BURN_UPDATE,
        CAST(OTHER_BURN AS FLOAT) AS OTHER_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(HORIZ_DIS AS FLOAT) AS HORIZ_DIS_UPDATE,
        CAST(ELEVATION AS FLOAT) AS ELEVATION_UPDATE,
        CAST(FLAME_LGTH AS FLOAT) AS FLAME_LGTH_UPDATE,
        CAST(SPREAD_RAT AS FLOAT) AS SPREAD_RAT_UPDATE
    FROM wildlands_source
),

wildlands_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        LATITUDE,
        LONGITUDE,
        TOWNSHIP,
        NORTH_SOU,
        RANGE,
        EAST_WEST,
        SECTION,
        SUBSECTION,
        MERIDIAN,
        AREA_TYPE,
        FIRE_CAUSE,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_IGN1,
        FACT_IGN2,
        SUPP_FACT1,
        SUPP_FACT2,
        SUPP_FACT3,
        HEAT_SOURC,
        MOB_PROP,
        EQ_INV_IG,
        NFDRS_ID,
        WEATH_TYPE,
        WIND_DIR,
        WIND_SPEED_UPDATE AS WIND_SPEED,
        AIR_TEMP_UPDATE AS AIR_TEMP,
        REL_HUMID_UPDATE AS REL_HUMID,
        FUEL_MOIST_UPDATE AS FUEL_MOIST,
        DANGR_RATE,
        BLDG_INV_UPDATE AS BLDG_INV,
        BLDG_THR_UPDATE AS BLDG_THR,
        ACRES_BURN_UPDATE AS ACRES_BURN,
        CROP_BURN1,
        CROP_BURN2,
        CROP_BURN3,
        UNDET_BURN_UPDATE AS UNDET_BURN,
        TAX_BURN_UPDATE AS TAX_BURN,
        NOTAX_BURN_UPDATE AS NOTAX_BURN,
        LOCAL_BURN_UPDATE AS LOCAL_BURN,
        COUTY_BURN_UPDATE AS COUTY_BURN,
        ST_BURN_UPDATE AS ST_BURN,
        FED_BURN_UPDATE AS FED_BURN,
        FOREI_BURN_UPDATE AS FOREI_BURN,
        MILIT_BURN_UPDATE AS MILIT_BURN,
        OTHER_BURN_UPDATE AS OTHER_BURN
        PROP_MANAG,
        FED_CODE,
        NFDRS_FM,
        PERSON_FIR,
        GENDER,
        AGE_UPDATE AS AGE,
        ACTIVITY_W,
        HORIZ_DIS_UPDATE AS HORIZ_DIS,
        TYPE_ROW,
        ELEVATION_UPDATE AS ELEVATION,
        POS_SLOPE,
        ASPECT,
        FLAME_LGTH_UPDATE AS FLAME_LGTH,
        SPREAD_RAT_UPDATE AS SPREAD_RAT
    FROM wildlands_final
)

SELECT * FROM wildlands_final
    );
  
  
[0m15:08:28.764121 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:08:28.765163 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: ROLLBACK
[0m15:08:28.768201 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m15:08:28.769193 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: Close
[0m15:08:28.775192 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Parser Error: syntax error at or near "PROP_MANAG"
[0m15:08:28.776199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd72cd5cf-c6f3-4890-9b05-668afb53ead1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020511103A40>]}
[0m15:08:28.776199 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__wildlands  [[31mERROR[0m in 0.07s]
[0m15:08:28.777200 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:08:28.779154 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:28.780157 [debug] [MainThread]: On master: BEGIN
[0m15:08:28.780157 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:28.798158 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:28.799147 [debug] [MainThread]: On master: COMMIT
[0m15:08:28.799147 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:28.800160 [debug] [MainThread]: On master: COMMIT
[0m15:08:28.800160 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:28.800160 [debug] [MainThread]: On master: Close
[0m15:08:28.805195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:28.805195 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:08:28.806190 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:08:28.806190 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:08:28.806190 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands' was properly closed.
[0m15:08:28.807200 [info ] [MainThread]: 
[0m15:08:28.807200 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m15:08:28.808175 [debug] [MainThread]: Command end result
[0m15:08:28.832124 [info ] [MainThread]: 
[0m15:08:28.832124 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:08:28.833169 [info ] [MainThread]: 
[0m15:08:28.833169 [error] [MainThread]:   Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Parser Error: syntax error at or near "PROP_MANAG"
[0m15:08:28.833169 [info ] [MainThread]: 
[0m15:08:28.834120 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:08:28.834120 [debug] [MainThread]: Command `cli run` failed at 15:08:28.834120 after 0.90 seconds
[0m15:08:28.835120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051103D400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020512BBD130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020512A07680>]}
[0m15:08:28.835120 [debug] [MainThread]: Flushing usage events
[0m15:08:46.380088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FBC0BB3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FB97EC200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FBC0BB110>]}


============================== 15:08:46.383117 | a70443ce-618e-4050-a340-e4df51e9cd87 ==============================
[0m15:08:46.383117 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:08:46.384072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:46.534936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a70443ce-618e-4050-a340-e4df51e9cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FBB3F4620>]}
[0m15:08:46.574909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a70443ce-618e-4050-a340-e4df51e9cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FBB41F650>]}
[0m15:08:46.575834 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:08:46.585909 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:08:46.710037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:08:46.710037 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:08:46.741056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a70443ce-618e-4050-a340-e4df51e9cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FBDC58E90>]}
[0m15:08:46.818213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a70443ce-618e-4050-a340-e4df51e9cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FBDFC7590>]}
[0m15:08:46.818213 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m15:08:46.818213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a70443ce-618e-4050-a340-e4df51e9cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FBDC0D040>]}
[0m15:08:46.820190 [info ] [MainThread]: 
[0m15:08:46.820190 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:08:46.822158 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:08:46.880225 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:08:46.881229 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:08:46.881229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:46.902227 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:46.903296 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:08:46.908232 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:08:46.909156 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:08:46.914232 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:08:46.914232 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:08:46.915232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:08:46.933223 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:46.934236 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:08:46.935227 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:08:46.935227 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:46.935227 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:08:46.936231 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:08:46.936231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:46.937229 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:08:46.937229 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:08:46.937229 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:08:46.938228 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:46.938755 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:08:46.949851 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:08:46.953813 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:08:46.953813 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:08:46.954819 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:08:46.956782 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:08:46.957782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:46.958782 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:08:46.978782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:46.978782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:08:46.979782 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:08:46.980782 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:46.980782 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:08:46.981781 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:08:46.982781 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:08:47.013890 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:47.018176 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:08:47.019176 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:08:47.020179 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:08:47.022158 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:08:47.023157 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:08:47.023157 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:08:47.023157 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:08:47.031365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a70443ce-618e-4050-a340-e4df51e9cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FBDD133B0>]}
[0m15:08:47.032445 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:47.032445 [debug] [MainThread]: On master: BEGIN
[0m15:08:47.032445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:47.051489 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:47.052487 [debug] [MainThread]: On master: COMMIT
[0m15:08:47.052487 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:47.052487 [debug] [MainThread]: On master: COMMIT
[0m15:08:47.053502 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:47.053502 [debug] [MainThread]: On master: Close
[0m15:08:47.057480 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:08:47.058485 [info ] [MainThread]: 
[0m15:08:47.062486 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:08:47.063478 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__wildlands .... [RUN]
[0m15:08:47.063478 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m15:08:47.063478 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:08:47.069486 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:08:47.070485 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:08:47.095446 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:08:47.096490 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:08:47.096490 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: BEGIN
[0m15:08:47.097490 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:08:47.115480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:08:47.116490 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:08:47.116490 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Wildland Fire Table Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - WIND_SPEED --> FLOAT
    - AIR_TEMP --> FLOAT
    - REL_HUMID --> FLOAT
    - FUEL_MOIST --> FLOAT
    - BLDG_INV --> FLOAT
    - BLDG_THR --> FLOAT
    - ACRES_BURN --> FLOAT
    - UNDET_BURN --> FLOAT
    - TAX_BURN --> FLOAT
    - NOTAX_BURN --> FLOAT
    - LOCAL_BURN --> FLOAT
    - COUTY_BURN --> FLOAT
    - ST_BURN --> FLOAT
    - FED_BURN --> FLOAT
    - FOREI_BURN --> FLOAT
    - MILIT_BURN --> FLOAT
    - OTHER_BURN --> FLOAT
    - AGE --> INTEGER
    - HORIZ_DIS --> FLOAT
    - ELEVATION --> FLOAT
    - FLAME_LGTH --> FLOAT
    - SPREAD_RAT --> FLOAT
***/



WITH wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."wildlands"
),

wildlands_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(WIND_SPEED AS FLOAT) AS WIND_SPEED_UPDATE,
        CAST(AIR_TEMP AS FLOAT) AS AIR_TEMP_UPDATE,
        CAST(REL_HUMID AS FLOAT) AS REL_HUMID_UPDATE,
        CAST(FUEL_MOIST AS FLOAT) AS FUEL_MOIST_UPDATE,
        CAST(BLDG_INV AS FLOAT) AS BLDG_INV_UPDATE,
        CAST(BLDG_THR AS FLOAT) AS BLDG_THR_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(UNDET_BURN AS FLOAT) AS UNDET_BURN_UPDATE,
        CAST(TAX_BURN AS FLOAT) AS TAX_BURN_UPDATE,
        CAST(NOTAX_BURN AS FLOAT) AS NOTAX_BURN_UPDATE,
        CAST(LOCAL_BURN AS FLOAT) AS LOCAL_BURN_UPDATE,
        CAST(COUTY_BURN AS FLOAT) AS COUTY_BURN_UPDATE,
        CAST(ST_BURN AS FLOAT) AS ST_BURN_UPDATE,
        CAST(FED_BURN AS FLOAT) AS FED_BURN_UPDATE,
        CAST(FOREI_BURN AS FLOAT) AS FOREI_BURN_UPDATE,
        CAST(MILIT_BURN AS FLOAT) AS MILIT_BURN_UPDATE,
        CAST(OTHER_BURN AS FLOAT) AS OTHER_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(HORIZ_DIS AS FLOAT) AS HORIZ_DIS_UPDATE,
        CAST(ELEVATION AS FLOAT) AS ELEVATION_UPDATE,
        CAST(FLAME_LGTH AS FLOAT) AS FLAME_LGTH_UPDATE,
        CAST(SPREAD_RAT AS FLOAT) AS SPREAD_RAT_UPDATE
    FROM wildlands_source
),

wildlands_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        LATITUDE,
        LONGITUDE,
        TOWNSHIP,
        NORTH_SOU,
        RANGE,
        EAST_WEST,
        SECTION,
        SUBSECTION,
        MERIDIAN,
        AREA_TYPE,
        FIRE_CAUSE,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_IGN1,
        FACT_IGN2,
        SUPP_FACT1,
        SUPP_FACT2,
        SUPP_FACT3,
        HEAT_SOURC,
        MOB_PROP,
        EQ_INV_IG,
        NFDRS_ID,
        WEATH_TYPE,
        WIND_DIR,
        WIND_SPEED_UPDATE AS WIND_SPEED,
        AIR_TEMP_UPDATE AS AIR_TEMP,
        REL_HUMID_UPDATE AS REL_HUMID,
        FUEL_MOIST_UPDATE AS FUEL_MOIST,
        DANGR_RATE,
        BLDG_INV_UPDATE AS BLDG_INV,
        BLDG_THR_UPDATE AS BLDG_THR,
        ACRES_BURN_UPDATE AS ACRES_BURN,
        CROP_BURN1,
        CROP_BURN2,
        CROP_BURN3,
        UNDET_BURN_UPDATE AS UNDET_BURN,
        TAX_BURN_UPDATE AS TAX_BURN,
        NOTAX_BURN_UPDATE AS NOTAX_BURN,
        LOCAL_BURN_UPDATE AS LOCAL_BURN,
        COUTY_BURN_UPDATE AS COUTY_BURN,
        ST_BURN_UPDATE AS ST_BURN,
        FED_BURN_UPDATE AS FED_BURN,
        FOREI_BURN_UPDATE AS FOREI_BURN,
        MILIT_BURN_UPDATE AS MILIT_BURN,
        OTHER_BURN_UPDATE AS OTHER_BURN,
        PROP_MANAG,
        FED_CODE,
        NFDRS_FM,
        PERSON_FIR,
        GENDER,
        AGE_UPDATE AS AGE,
        ACTIVITY_W,
        HORIZ_DIS_UPDATE AS HORIZ_DIS,
        TYPE_ROW,
        ELEVATION_UPDATE AS ELEVATION,
        POS_SLOPE,
        ASPECT,
        FLAME_LGTH_UPDATE AS FLAME_LGTH,
        SPREAD_RAT_UPDATE AS SPREAD_RAT
    FROM wildlands_final
)

SELECT * FROM wildlands_final
    );
  
  
[0m15:08:47.126619 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Wildland Fire Table Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - WIND_SPEED --> FLOAT
    - AIR_TEMP --> FLOAT
    - REL_HUMID --> FLOAT
    - FUEL_MOIST --> FLOAT
    - BLDG_INV --> FLOAT
    - BLDG_THR --> FLOAT
    - ACRES_BURN --> FLOAT
    - UNDET_BURN --> FLOAT
    - TAX_BURN --> FLOAT
    - NOTAX_BURN --> FLOAT
    - LOCAL_BURN --> FLOAT
    - COUTY_BURN --> FLOAT
    - ST_BURN --> FLOAT
    - FED_BURN --> FLOAT
    - FOREI_BURN --> FLOAT
    - MILIT_BURN --> FLOAT
    - OTHER_BURN --> FLOAT
    - AGE --> INTEGER
    - HORIZ_DIS --> FLOAT
    - ELEVATION --> FLOAT
    - FLAME_LGTH --> FLOAT
    - SPREAD_RAT --> FLOAT
***/



WITH wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."wildlands"
),

wildlands_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(WIND_SPEED AS FLOAT) AS WIND_SPEED_UPDATE,
        CAST(AIR_TEMP AS FLOAT) AS AIR_TEMP_UPDATE,
        CAST(REL_HUMID AS FLOAT) AS REL_HUMID_UPDATE,
        CAST(FUEL_MOIST AS FLOAT) AS FUEL_MOIST_UPDATE,
        CAST(BLDG_INV AS FLOAT) AS BLDG_INV_UPDATE,
        CAST(BLDG_THR AS FLOAT) AS BLDG_THR_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(UNDET_BURN AS FLOAT) AS UNDET_BURN_UPDATE,
        CAST(TAX_BURN AS FLOAT) AS TAX_BURN_UPDATE,
        CAST(NOTAX_BURN AS FLOAT) AS NOTAX_BURN_UPDATE,
        CAST(LOCAL_BURN AS FLOAT) AS LOCAL_BURN_UPDATE,
        CAST(COUTY_BURN AS FLOAT) AS COUTY_BURN_UPDATE,
        CAST(ST_BURN AS FLOAT) AS ST_BURN_UPDATE,
        CAST(FED_BURN AS FLOAT) AS FED_BURN_UPDATE,
        CAST(FOREI_BURN AS FLOAT) AS FOREI_BURN_UPDATE,
        CAST(MILIT_BURN AS FLOAT) AS MILIT_BURN_UPDATE,
        CAST(OTHER_BURN AS FLOAT) AS OTHER_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(HORIZ_DIS AS FLOAT) AS HORIZ_DIS_UPDATE,
        CAST(ELEVATION AS FLOAT) AS ELEVATION_UPDATE,
        CAST(FLAME_LGTH AS FLOAT) AS FLAME_LGTH_UPDATE,
        CAST(SPREAD_RAT AS FLOAT) AS SPREAD_RAT_UPDATE
    FROM wildlands_source
),

wildlands_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        LATITUDE,
        LONGITUDE,
        TOWNSHIP,
        NORTH_SOU,
        RANGE,
        EAST_WEST,
        SECTION,
        SUBSECTION,
        MERIDIAN,
        AREA_TYPE,
        FIRE_CAUSE,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_IGN1,
        FACT_IGN2,
        SUPP_FACT1,
        SUPP_FACT2,
        SUPP_FACT3,
        HEAT_SOURC,
        MOB_PROP,
        EQ_INV_IG,
        NFDRS_ID,
        WEATH_TYPE,
        WIND_DIR,
        WIND_SPEED_UPDATE AS WIND_SPEED,
        AIR_TEMP_UPDATE AS AIR_TEMP,
        REL_HUMID_UPDATE AS REL_HUMID,
        FUEL_MOIST_UPDATE AS FUEL_MOIST,
        DANGR_RATE,
        BLDG_INV_UPDATE AS BLDG_INV,
        BLDG_THR_UPDATE AS BLDG_THR,
        ACRES_BURN_UPDATE AS ACRES_BURN,
        CROP_BURN1,
        CROP_BURN2,
        CROP_BURN3,
        UNDET_BURN_UPDATE AS UNDET_BURN,
        TAX_BURN_UPDATE AS TAX_BURN,
        NOTAX_BURN_UPDATE AS NOTAX_BURN,
        LOCAL_BURN_UPDATE AS LOCAL_BURN,
        COUTY_BURN_UPDATE AS COUTY_BURN,
        ST_BURN_UPDATE AS ST_BURN,
        FED_BURN_UPDATE AS FED_BURN,
        FOREI_BURN_UPDATE AS FOREI_BURN,
        MILIT_BURN_UPDATE AS MILIT_BURN,
        OTHER_BURN_UPDATE AS OTHER_BURN,
        PROP_MANAG,
        FED_CODE,
        NFDRS_FM,
        PERSON_FIR,
        GENDER,
        AGE_UPDATE AS AGE,
        ACTIVITY_W,
        HORIZ_DIS_UPDATE AS HORIZ_DIS,
        TYPE_ROW,
        ELEVATION_UPDATE AS ELEVATION,
        POS_SLOPE,
        ASPECT,
        FLAME_LGTH_UPDATE AS FLAME_LGTH,
        SPREAD_RAT_UPDATE AS SPREAD_RAT
    FROM wildlands_final
)

SELECT * FROM wildlands_final
    );
  
  
[0m15:08:47.127585 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:08:47.127585 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: ROLLBACK
[0m15:08:47.131591 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m15:08:47.131591 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: Close
[0m15:08:47.138819 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Binder Error: Circular reference to CTE "wildlands_final", There are two possible solutions. 
  1. use WITH RECURSIVE to use recursive CTEs. 
  2. If you want to use the TABLE name "wildlands_final" the same as the CTE name, please explicitly add "SCHEMA" before table name. You can try "main.wildlands_final" (main is the duckdb default schema)
[0m15:08:47.139819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a70443ce-618e-4050-a340-e4df51e9cd87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FBC0BB6E0>]}
[0m15:08:47.140819 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__wildlands  [[31mERROR[0m in 0.08s]
[0m15:08:47.141819 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:08:47.143429 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:47.144528 [debug] [MainThread]: On master: BEGIN
[0m15:08:47.144528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:08:47.163513 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:47.163513 [debug] [MainThread]: On master: COMMIT
[0m15:08:47.163513 [debug] [MainThread]: Using duckdb connection "master"
[0m15:08:47.164463 [debug] [MainThread]: On master: COMMIT
[0m15:08:47.164463 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:08:47.164463 [debug] [MainThread]: On master: Close
[0m15:08:47.169501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:08:47.169501 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:08:47.169501 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:08:47.170502 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:08:47.170502 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands' was properly closed.
[0m15:08:47.170502 [info ] [MainThread]: 
[0m15:08:47.171502 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:08:47.171502 [debug] [MainThread]: Command end result
[0m15:08:47.195486 [info ] [MainThread]: 
[0m15:08:47.196466 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:08:47.196466 [info ] [MainThread]: 
[0m15:08:47.197436 [error] [MainThread]:   Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Binder Error: Circular reference to CTE "wildlands_final", There are two possible solutions. 
  1. use WITH RECURSIVE to use recursive CTEs. 
  2. If you want to use the TABLE name "wildlands_final" the same as the CTE name, please explicitly add "SCHEMA" before table name. You can try "main.wildlands_final" (main is the duckdb default schema)
[0m15:08:47.197436 [info ] [MainThread]: 
[0m15:08:47.197436 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:08:47.198472 [debug] [MainThread]: Command `cli run` failed at 15:08:47.198472 after 0.93 seconds
[0m15:08:47.198472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FBB41CA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FBE0FFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FBDFF8740>]}
[0m15:08:47.199512 [debug] [MainThread]: Flushing usage events
[0m15:09:15.839507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335108B830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023352AC6B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233511E3830>]}


============================== 15:09:15.842431 | 5803929b-7e17-4ddf-8a06-a3275c5df428 ==============================
[0m15:09:15.842431 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:09:15.843434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:09:15.996066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5803929b-7e17-4ddf-8a06-a3275c5df428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023352E84BC0>]}
[0m15:09:16.037045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5803929b-7e17-4ddf-8a06-a3275c5df428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233517E1310>]}
[0m15:09:16.038039 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:09:16.047046 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:09:16.173046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:16.174040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:16.204041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5803929b-7e17-4ddf-8a06-a3275c5df428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023352F564E0>]}
[0m15:09:16.286673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5803929b-7e17-4ddf-8a06-a3275c5df428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233531FCC20>]}
[0m15:09:16.286673 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m15:09:16.287673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5803929b-7e17-4ddf-8a06-a3275c5df428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023352B8CE90>]}
[0m15:09:16.288675 [info ] [MainThread]: 
[0m15:09:16.289711 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:09:16.290673 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:09:16.347676 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:09:16.347676 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:09:16.347676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:16.369866 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:16.370871 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:09:16.376866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:09:16.376866 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:09:16.381870 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:09:16.382870 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:09:16.382870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:16.403836 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:16.405635 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:09:16.405736 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:09:16.406324 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:16.406324 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:09:16.406931 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:09:16.407439 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:16.407439 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:09:16.408442 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:09:16.408442 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:09:16.409437 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:16.409437 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:09:16.419682 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:09:16.420682 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:09:16.424682 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:09:16.425681 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:09:16.426681 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:09:16.427681 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:09:16.427681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:16.428682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:16.448081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:16.449081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:16.449081 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:09:16.449081 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:09:16.450081 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:09:16.450081 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:09:16.477081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:16.481081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:16.482081 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:09:16.483085 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:09:16.484082 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:09:16.485080 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:09:16.486086 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:09:16.486086 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:09:16.494080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5803929b-7e17-4ddf-8a06-a3275c5df428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002335309A5D0>]}
[0m15:09:16.495081 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:16.495081 [debug] [MainThread]: On master: BEGIN
[0m15:09:16.495081 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:16.514081 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:09:16.515079 [debug] [MainThread]: On master: COMMIT
[0m15:09:16.515079 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:16.515079 [debug] [MainThread]: On master: COMMIT
[0m15:09:16.516080 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:09:16.516080 [debug] [MainThread]: On master: Close
[0m15:09:16.521080 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:09:16.522080 [info ] [MainThread]: 
[0m15:09:16.529079 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:09:16.529079 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__wildlands .... [RUN]
[0m15:09:16.530079 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m15:09:16.530079 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:09:16.536079 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:09:16.537079 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:09:16.562078 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:09:16.563095 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:09:16.563095 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: BEGIN
[0m15:09:16.563095 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:09:16.583078 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:09:16.583078 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:09:16.584078 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Wildland Fire Table Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - WIND_SPEED --> FLOAT
    - AIR_TEMP --> FLOAT
    - REL_HUMID --> FLOAT
    - FUEL_MOIST --> FLOAT
    - BLDG_INV --> FLOAT
    - BLDG_THR --> FLOAT
    - ACRES_BURN --> FLOAT
    - UNDET_BURN --> FLOAT
    - TAX_BURN --> FLOAT
    - NOTAX_BURN --> FLOAT
    - LOCAL_BURN --> FLOAT
    - COUTY_BURN --> FLOAT
    - ST_BURN --> FLOAT
    - FED_BURN --> FLOAT
    - FOREI_BURN --> FLOAT
    - MILIT_BURN --> FLOAT
    - OTHER_BURN --> FLOAT
    - AGE --> INTEGER
    - HORIZ_DIS --> FLOAT
    - ELEVATION --> FLOAT
    - FLAME_LGTH --> FLOAT
    - SPREAD_RAT --> FLOAT
***/



WITH wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."wildlands"
),

wildlands_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(WIND_SPEED AS FLOAT) AS WIND_SPEED_UPDATE,
        CAST(AIR_TEMP AS FLOAT) AS AIR_TEMP_UPDATE,
        CAST(REL_HUMID AS FLOAT) AS REL_HUMID_UPDATE,
        CAST(FUEL_MOIST AS FLOAT) AS FUEL_MOIST_UPDATE,
        CAST(BLDG_INV AS FLOAT) AS BLDG_INV_UPDATE,
        CAST(BLDG_THR AS FLOAT) AS BLDG_THR_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(UNDET_BURN AS FLOAT) AS UNDET_BURN_UPDATE,
        CAST(TAX_BURN AS FLOAT) AS TAX_BURN_UPDATE,
        CAST(NOTAX_BURN AS FLOAT) AS NOTAX_BURN_UPDATE,
        CAST(LOCAL_BURN AS FLOAT) AS LOCAL_BURN_UPDATE,
        CAST(COUTY_BURN AS FLOAT) AS COUTY_BURN_UPDATE,
        CAST(ST_BURN AS FLOAT) AS ST_BURN_UPDATE,
        CAST(FED_BURN AS FLOAT) AS FED_BURN_UPDATE,
        CAST(FOREI_BURN AS FLOAT) AS FOREI_BURN_UPDATE,
        CAST(MILIT_BURN AS FLOAT) AS MILIT_BURN_UPDATE,
        CAST(OTHER_BURN AS FLOAT) AS OTHER_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(HORIZ_DIS AS FLOAT) AS HORIZ_DIS_UPDATE,
        CAST(ELEVATION AS FLOAT) AS ELEVATION_UPDATE,
        CAST(FLAME_LGTH AS FLOAT) AS FLAME_LGTH_UPDATE,
        CAST(SPREAD_RAT AS FLOAT) AS SPREAD_RAT_UPDATE
    FROM wildlands_source
),

wildlands_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        LATITUDE,
        LONGITUDE,
        TOWNSHIP,
        NORTH_SOU,
        RANGE,
        EAST_WEST,
        SECTION,
        SUBSECTION,
        MERIDIAN,
        AREA_TYPE,
        FIRE_CAUSE,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_IGN1,
        FACT_IGN2,
        SUPP_FACT1,
        SUPP_FACT2,
        SUPP_FACT3,
        HEAT_SOURC,
        MOB_PROP,
        EQ_INV_IG,
        NFDRS_ID,
        WEATH_TYPE,
        WIND_DIR,
        WIND_SPEED_UPDATE AS WIND_SPEED,
        AIR_TEMP_UPDATE AS AIR_TEMP,
        REL_HUMID_UPDATE AS REL_HUMID,
        FUEL_MOIST_UPDATE AS FUEL_MOIST,
        DANGR_RATE,
        BLDG_INV_UPDATE AS BLDG_INV,
        BLDG_THR_UPDATE AS BLDG_THR,
        ACRES_BURN_UPDATE AS ACRES_BURN,
        CROP_BURN1,
        CROP_BURN2,
        CROP_BURN3,
        UNDET_BURN_UPDATE AS UNDET_BURN,
        TAX_BURN_UPDATE AS TAX_BURN,
        NOTAX_BURN_UPDATE AS NOTAX_BURN,
        LOCAL_BURN_UPDATE AS LOCAL_BURN,
        COUTY_BURN_UPDATE AS COUTY_BURN,
        ST_BURN_UPDATE AS ST_BURN,
        FED_BURN_UPDATE AS FED_BURN,
        FOREI_BURN_UPDATE AS FOREI_BURN,
        MILIT_BURN_UPDATE AS MILIT_BURN,
        OTHER_BURN_UPDATE AS OTHER_BURN,
        PROP_MANAG,
        FED_CODE,
        NFDRS_FM,
        PERSON_FIR,
        GENDER,
        AGE_UPDATE AS AGE,
        ACTIVITY_W,
        HORIZ_DIS_UPDATE AS HORIZ_DIS,
        TYPE_ROW,
        ELEVATION_UPDATE AS ELEVATION,
        POS_SLOPE,
        ASPECT,
        FLAME_LGTH_UPDATE AS FLAME_LGTH,
        SPREAD_RAT_UPDATE AS SPREAD_RAT
    FROM wildlands_col_data_type_update
)

SELECT * FROM wildlands_final
    );
  
  
[0m15:09:16.589051 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Wildland Fire Table Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - WIND_SPEED --> FLOAT
    - AIR_TEMP --> FLOAT
    - REL_HUMID --> FLOAT
    - FUEL_MOIST --> FLOAT
    - BLDG_INV --> FLOAT
    - BLDG_THR --> FLOAT
    - ACRES_BURN --> FLOAT
    - UNDET_BURN --> FLOAT
    - TAX_BURN --> FLOAT
    - NOTAX_BURN --> FLOAT
    - LOCAL_BURN --> FLOAT
    - COUTY_BURN --> FLOAT
    - ST_BURN --> FLOAT
    - FED_BURN --> FLOAT
    - FOREI_BURN --> FLOAT
    - MILIT_BURN --> FLOAT
    - OTHER_BURN --> FLOAT
    - AGE --> INTEGER
    - HORIZ_DIS --> FLOAT
    - ELEVATION --> FLOAT
    - FLAME_LGTH --> FLOAT
    - SPREAD_RAT --> FLOAT
***/



WITH wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."wildlands"
),

wildlands_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(WIND_SPEED AS FLOAT) AS WIND_SPEED_UPDATE,
        CAST(AIR_TEMP AS FLOAT) AS AIR_TEMP_UPDATE,
        CAST(REL_HUMID AS FLOAT) AS REL_HUMID_UPDATE,
        CAST(FUEL_MOIST AS FLOAT) AS FUEL_MOIST_UPDATE,
        CAST(BLDG_INV AS FLOAT) AS BLDG_INV_UPDATE,
        CAST(BLDG_THR AS FLOAT) AS BLDG_THR_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(UNDET_BURN AS FLOAT) AS UNDET_BURN_UPDATE,
        CAST(TAX_BURN AS FLOAT) AS TAX_BURN_UPDATE,
        CAST(NOTAX_BURN AS FLOAT) AS NOTAX_BURN_UPDATE,
        CAST(LOCAL_BURN AS FLOAT) AS LOCAL_BURN_UPDATE,
        CAST(COUTY_BURN AS FLOAT) AS COUTY_BURN_UPDATE,
        CAST(ST_BURN AS FLOAT) AS ST_BURN_UPDATE,
        CAST(FED_BURN AS FLOAT) AS FED_BURN_UPDATE,
        CAST(FOREI_BURN AS FLOAT) AS FOREI_BURN_UPDATE,
        CAST(MILIT_BURN AS FLOAT) AS MILIT_BURN_UPDATE,
        CAST(OTHER_BURN AS FLOAT) AS OTHER_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(HORIZ_DIS AS FLOAT) AS HORIZ_DIS_UPDATE,
        CAST(ELEVATION AS FLOAT) AS ELEVATION_UPDATE,
        CAST(FLAME_LGTH AS FLOAT) AS FLAME_LGTH_UPDATE,
        CAST(SPREAD_RAT AS FLOAT) AS SPREAD_RAT_UPDATE
    FROM wildlands_source
),

wildlands_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        LATITUDE,
        LONGITUDE,
        TOWNSHIP,
        NORTH_SOU,
        RANGE,
        EAST_WEST,
        SECTION,
        SUBSECTION,
        MERIDIAN,
        AREA_TYPE,
        FIRE_CAUSE,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_IGN1,
        FACT_IGN2,
        SUPP_FACT1,
        SUPP_FACT2,
        SUPP_FACT3,
        HEAT_SOURC,
        MOB_PROP,
        EQ_INV_IG,
        NFDRS_ID,
        WEATH_TYPE,
        WIND_DIR,
        WIND_SPEED_UPDATE AS WIND_SPEED,
        AIR_TEMP_UPDATE AS AIR_TEMP,
        REL_HUMID_UPDATE AS REL_HUMID,
        FUEL_MOIST_UPDATE AS FUEL_MOIST,
        DANGR_RATE,
        BLDG_INV_UPDATE AS BLDG_INV,
        BLDG_THR_UPDATE AS BLDG_THR,
        ACRES_BURN_UPDATE AS ACRES_BURN,
        CROP_BURN1,
        CROP_BURN2,
        CROP_BURN3,
        UNDET_BURN_UPDATE AS UNDET_BURN,
        TAX_BURN_UPDATE AS TAX_BURN,
        NOTAX_BURN_UPDATE AS NOTAX_BURN,
        LOCAL_BURN_UPDATE AS LOCAL_BURN,
        COUTY_BURN_UPDATE AS COUTY_BURN,
        ST_BURN_UPDATE AS ST_BURN,
        FED_BURN_UPDATE AS FED_BURN,
        FOREI_BURN_UPDATE AS FOREI_BURN,
        MILIT_BURN_UPDATE AS MILIT_BURN,
        OTHER_BURN_UPDATE AS OTHER_BURN,
        PROP_MANAG,
        FED_CODE,
        NFDRS_FM,
        PERSON_FIR,
        GENDER,
        AGE_UPDATE AS AGE,
        ACTIVITY_W,
        HORIZ_DIS_UPDATE AS HORIZ_DIS,
        TYPE_ROW,
        ELEVATION_UPDATE AS ELEVATION,
        POS_SLOPE,
        ASPECT,
        FLAME_LGTH_UPDATE AS FLAME_LGTH,
        SPREAD_RAT_UPDATE AS SPREAD_RAT
    FROM wildlands_col_data_type_update
)

SELECT * FROM wildlands_final
    );
  
  
[0m15:09:16.590053 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:09:16.590053 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: ROLLBACK
[0m15:09:16.594053 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m15:09:16.594053 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: Close
[0m15:09:16.600052 [debug] [Thread-1 (]: Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Binder Error: Referenced column "EQ_INV_IG" not found in FROM clause!
  Candidate bindings: "wildlands_col_data_type_update.EQ_INV_IGN"
  LINE 109:         EQ_INV_IG,
                    ^
[0m15:09:16.602052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5803929b-7e17-4ddf-8a06-a3275c5df428', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233511E3A70>]}
[0m15:09:16.602052 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_transformed.nfirs_transformed__wildlands  [[31mERROR[0m in 0.07s]
[0m15:09:16.603052 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:09:16.605052 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:16.605052 [debug] [MainThread]: On master: BEGIN
[0m15:09:16.605052 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:16.624051 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:09:16.625052 [debug] [MainThread]: On master: COMMIT
[0m15:09:16.625052 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:16.626052 [debug] [MainThread]: On master: COMMIT
[0m15:09:16.627052 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:09:16.627052 [debug] [MainThread]: On master: Close
[0m15:09:16.632051 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:16.633051 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:09:16.633051 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:09:16.633051 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:09:16.634051 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands' was properly closed.
[0m15:09:16.634051 [info ] [MainThread]: 
[0m15:09:16.634051 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m15:09:16.635052 [debug] [MainThread]: Command end result
[0m15:09:16.658051 [info ] [MainThread]: 
[0m15:09:16.659051 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:09:16.659051 [info ] [MainThread]: 
[0m15:09:16.660051 [error] [MainThread]:   Runtime Error in model nfirs_transformed__wildlands (models\nfirs_transformed\nfirs_transformed__wildlands.sql)
  Binder Error: Referenced column "EQ_INV_IG" not found in FROM clause!
  Candidate bindings: "wildlands_col_data_type_update.EQ_INV_IGN"
  LINE 109:         EQ_INV_IG,
                    ^
[0m15:09:16.660051 [info ] [MainThread]: 
[0m15:09:16.661051 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:09:16.662051 [debug] [MainThread]: Command `cli run` failed at 15:09:16.661051 after 0.93 seconds
[0m15:09:16.662051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233517E3EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023352B18B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023352B18B00>]}
[0m15:09:16.662051 [debug] [MainThread]: Flushing usage events
[0m15:09:45.386214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61975FB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C619C0B410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61A85E270>]}


============================== 15:09:45.389210 | 41099214-4df5-4ea1-a7ca-bf81f8b09ca8 ==============================
[0m15:09:45.389210 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:09:45.390213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:09:45.546277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41099214-4df5-4ea1-a7ca-bf81f8b09ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C619C44740>]}
[0m15:09:45.587354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41099214-4df5-4ea1-a7ca-bf81f8b09ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61BC52C00>]}
[0m15:09:45.588359 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:09:45.598340 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:09:45.721132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:45.722270 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:45.752413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41099214-4df5-4ea1-a7ca-bf81f8b09ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61C69F470>]}
[0m15:09:45.831435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41099214-4df5-4ea1-a7ca-bf81f8b09ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61C93CC20>]}
[0m15:09:45.832437 [info ] [MainThread]: Found 21 models, 4 data tests, 19 sources, 524 macros
[0m15:09:45.832437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41099214-4df5-4ea1-a7ca-bf81f8b09ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61C413410>]}
[0m15:09:45.834430 [info ] [MainThread]: 
[0m15:09:45.834430 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:09:45.835438 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:09:45.894476 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:09:45.894476 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:09:45.895434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:45.917485 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:45.918434 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:09:45.923837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m15:09:45.923837 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m15:09:45.928767 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:09:45.928767 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:09:45.929815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:45.949927 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:45.950846 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:09:45.950846 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m15:09:45.951845 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:45.951845 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:09:45.952878 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m15:09:45.952878 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:45.953482 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:09:45.953482 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m15:09:45.954522 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m15:09:45.954522 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:45.954522 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m15:09:45.963522 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:09:45.968515 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:09:45.968515 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:09:45.969534 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:09:45.970527 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:09:45.971519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:45.971519 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:09:45.990559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:45.990559 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:45.991566 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:45.991566 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:09:45.991566 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:09:45.992523 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:09:45.992523 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:09:46.020604 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:46.024626 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:09:46.026626 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:09:46.027606 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:09:46.029633 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:09:46.029633 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:09:46.030604 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:09:46.030604 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:09:46.043619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41099214-4df5-4ea1-a7ca-bf81f8b09ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61CCBE6F0>]}
[0m15:09:46.044659 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:46.044659 [debug] [MainThread]: On master: BEGIN
[0m15:09:46.044659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:46.065613 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:09:46.065613 [debug] [MainThread]: On master: COMMIT
[0m15:09:46.066639 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:46.066639 [debug] [MainThread]: On master: COMMIT
[0m15:09:46.066639 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:09:46.067606 [debug] [MainThread]: On master: Close
[0m15:09:46.071646 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:09:46.072662 [info ] [MainThread]: 
[0m15:09:46.076695 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:09:46.076695 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__wildlands .... [RUN]
[0m15:09:46.077651 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands'
[0m15:09:46.077651 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:09:46.083651 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:09:46.084660 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:09:46.108729 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:09:46.109742 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:09:46.109742 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: BEGIN
[0m15:09:46.110650 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:09:46.128651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:09:46.129650 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:09:46.129650 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Wildland Fire Table Table Creation *****/
/***
The below model will transform the folling columns to the appropriate data type:
    - INC_DATE --> DATE
    - WIND_SPEED --> FLOAT
    - AIR_TEMP --> FLOAT
    - REL_HUMID --> FLOAT
    - FUEL_MOIST --> FLOAT
    - BLDG_INV --> FLOAT
    - BLDG_THR --> FLOAT
    - ACRES_BURN --> FLOAT
    - UNDET_BURN --> FLOAT
    - TAX_BURN --> FLOAT
    - NOTAX_BURN --> FLOAT
    - LOCAL_BURN --> FLOAT
    - COUTY_BURN --> FLOAT
    - ST_BURN --> FLOAT
    - FED_BURN --> FLOAT
    - FOREI_BURN --> FLOAT
    - MILIT_BURN --> FLOAT
    - OTHER_BURN --> FLOAT
    - AGE --> INTEGER
    - HORIZ_DIS --> FLOAT
    - ELEVATION --> FLOAT
    - FLAME_LGTH --> FLOAT
    - SPREAD_RAT --> FLOAT
***/



WITH wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."wildlands"
),

wildlands_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE,
        CAST(WIND_SPEED AS FLOAT) AS WIND_SPEED_UPDATE,
        CAST(AIR_TEMP AS FLOAT) AS AIR_TEMP_UPDATE,
        CAST(REL_HUMID AS FLOAT) AS REL_HUMID_UPDATE,
        CAST(FUEL_MOIST AS FLOAT) AS FUEL_MOIST_UPDATE,
        CAST(BLDG_INV AS FLOAT) AS BLDG_INV_UPDATE,
        CAST(BLDG_THR AS FLOAT) AS BLDG_THR_UPDATE,
        CAST(ACRES_BURN AS FLOAT) AS ACRES_BURN_UPDATE,
        CAST(UNDET_BURN AS FLOAT) AS UNDET_BURN_UPDATE,
        CAST(TAX_BURN AS FLOAT) AS TAX_BURN_UPDATE,
        CAST(NOTAX_BURN AS FLOAT) AS NOTAX_BURN_UPDATE,
        CAST(LOCAL_BURN AS FLOAT) AS LOCAL_BURN_UPDATE,
        CAST(COUTY_BURN AS FLOAT) AS COUTY_BURN_UPDATE,
        CAST(ST_BURN AS FLOAT) AS ST_BURN_UPDATE,
        CAST(FED_BURN AS FLOAT) AS FED_BURN_UPDATE,
        CAST(FOREI_BURN AS FLOAT) AS FOREI_BURN_UPDATE,
        CAST(MILIT_BURN AS FLOAT) AS MILIT_BURN_UPDATE,
        CAST(OTHER_BURN AS FLOAT) AS OTHER_BURN_UPDATE,
        CAST(AGE AS INT) AS AGE_UPDATE,
        CAST(HORIZ_DIS AS FLOAT) AS HORIZ_DIS_UPDATE,
        CAST(ELEVATION AS FLOAT) AS ELEVATION_UPDATE,
        CAST(FLAME_LGTH AS FLOAT) AS FLAME_LGTH_UPDATE,
        CAST(SPREAD_RAT AS FLOAT) AS SPREAD_RAT_UPDATE
    FROM wildlands_source
),

wildlands_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        LATITUDE,
        LONGITUDE,
        TOWNSHIP,
        NORTH_SOU,
        RANGE,
        EAST_WEST,
        SECTION,
        SUBSECTION,
        MERIDIAN,
        AREA_TYPE,
        FIRE_CAUSE,
        HUM_FACT1,
        HUM_FACT2,
        HUM_FACT3,
        HUM_FACT4,
        HUM_FACT5,
        HUM_FACT6,
        HUM_FACT7,
        HUM_FACT8,
        FACT_IGN1,
        FACT_IGN2,
        SUPP_FACT1,
        SUPP_FACT2,
        SUPP_FACT3,
        HEAT_SOURC,
        MOB_PROP,
        EQ_INV_IGN,
        NFDRS_ID,
        WEATH_TYPE,
        WIND_DIR,
        WIND_SPEED_UPDATE AS WIND_SPEED,
        AIR_TEMP_UPDATE AS AIR_TEMP,
        REL_HUMID_UPDATE AS REL_HUMID,
        FUEL_MOIST_UPDATE AS FUEL_MOIST,
        DANGR_RATE,
        BLDG_INV_UPDATE AS BLDG_INV,
        BLDG_THR_UPDATE AS BLDG_THR,
        ACRES_BURN_UPDATE AS ACRES_BURN,
        CROP_BURN1,
        CROP_BURN2,
        CROP_BURN3,
        UNDET_BURN_UPDATE AS UNDET_BURN,
        TAX_BURN_UPDATE AS TAX_BURN,
        NOTAX_BURN_UPDATE AS NOTAX_BURN,
        LOCAL_BURN_UPDATE AS LOCAL_BURN,
        COUTY_BURN_UPDATE AS COUTY_BURN,
        ST_BURN_UPDATE AS ST_BURN,
        FED_BURN_UPDATE AS FED_BURN,
        FOREI_BURN_UPDATE AS FOREI_BURN,
        MILIT_BURN_UPDATE AS MILIT_BURN,
        OTHER_BURN_UPDATE AS OTHER_BURN,
        PROP_MANAG,
        FED_CODE,
        NFDRS_FM,
        PERSON_FIR,
        GENDER,
        AGE_UPDATE AS AGE,
        ACTIVITY_W,
        HORIZ_DIS_UPDATE AS HORIZ_DIS,
        TYPE_ROW,
        ELEVATION_UPDATE AS ELEVATION,
        POS_SLOPE,
        ASPECT,
        FLAME_LGTH_UPDATE AS FLAME_LGTH,
        SPREAD_RAT_UPDATE AS SPREAD_RAT
    FROM wildlands_col_data_type_update
)

SELECT * FROM wildlands_final
    );
  
  
[0m15:09:46.374104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:09:46.379031 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:09:46.380030 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_tmp" rename to "nfirs_transformed__wildlands"
[0m15:09:46.381030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:09:46.393971 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: COMMIT
[0m15:09:46.394971 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:09:46.395646 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: COMMIT
[0m15:09:47.139004 [debug] [Thread-1 (]: SQL status: OK in 1.0 seconds
[0m15:09:47.143016 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"
[0m15:09:47.144016 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__wildlands"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands__dbt_backup" cascade
[0m15:09:47.144016 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:09:47.146283 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__wildlands: Close
[0m15:09:47.179701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41099214-4df5-4ea1-a7ca-bf81f8b09ca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C619C0B7A0>]}
[0m15:09:47.180701 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__wildlands  [[32mOK[0m in 1.10s]
[0m15:09:47.181701 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__wildlands
[0m15:09:47.183701 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:47.183701 [debug] [MainThread]: On master: BEGIN
[0m15:09:47.184701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:47.203832 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:09:47.204832 [debug] [MainThread]: On master: COMMIT
[0m15:09:47.204832 [debug] [MainThread]: Using duckdb connection "master"
[0m15:09:47.205500 [debug] [MainThread]: On master: COMMIT
[0m15:09:47.205500 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:09:47.205500 [debug] [MainThread]: On master: Close
[0m15:09:47.210585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:47.210585 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m15:09:47.211452 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m15:09:47.211957 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m15:09:47.211957 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__wildlands' was properly closed.
[0m15:09:47.212963 [info ] [MainThread]: 
[0m15:09:47.212963 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m15:09:47.214009 [debug] [MainThread]: Command end result
[0m15:09:47.238194 [info ] [MainThread]: 
[0m15:09:47.238194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:47.239164 [info ] [MainThread]: 
[0m15:09:47.239164 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:09:47.240174 [debug] [MainThread]: Command `cli run` succeeded at 15:09:47.240174 after 1.96 seconds
[0m15:09:47.240174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61A6A6D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61BF57860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C61BF57680>]}
[0m15:09:47.241151 [debug] [MainThread]: Flushing usage events
[0m17:30:34.813412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002963E132FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002963EB672C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002963E9535C0>]}


============================== 17:30:34.813412 | 5135429f-9076-4451-ab6e-3693aa605bca ==============================
[0m17:30:34.813412 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:30:34.813412 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:30:34.985027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5135429f-9076-4451-ab6e-3693aa605bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296402B08F0>]}
[0m17:30:35.029987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5135429f-9076-4451-ab6e-3693aa605bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964030D070>]}
[0m17:30:35.029987 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:30:35.040381 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:30:35.179219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:35.179219 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:35.207302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5135429f-9076-4451-ab6e-3693aa605bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640380A40>]}
[0m17:30:35.349619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5135429f-9076-4451-ab6e-3693aa605bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296403BC950>]}
[0m17:30:35.349619 [info ] [MainThread]: Found 22 models, 4 data tests, 19 sources, 524 macros
[0m17:30:35.349619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5135429f-9076-4451-ab6e-3693aa605bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964042AED0>]}
[0m17:30:35.349619 [info ] [MainThread]: 
[0m17:30:35.349619 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:30:35.349619 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:30:35.648951 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:30:35.650135 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:30:35.650135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:35.689763 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:30:35.689763 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:30:35.689763 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m17:30:35.697435 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m17:30:35.703217 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:30:35.703217 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:30:35.703217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:30:35.728450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:30:35.730135 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:30:35.730747 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m17:30:35.730747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:30:35.730747 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:30:35.730747 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m17:30:35.730747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:30:35.730747 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m17:30:35.730747 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:30:35.730747 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m17:30:35.739822 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:30:35.739822 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m17:30:36.109285 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:30:36.109285 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:30:36.109285 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:30:36.119736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:36.119612 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m17:30:36.136449 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:30:36.140060 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:30:36.140060 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:30:36.140060 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:30:36.140060 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:30:36.140060 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m17:30:36.140060 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:30:36.140060 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:30:36.140060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:36.145099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:36.145099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:30:36.145099 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:30:36.145099 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:30:36.145099 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:30:36.145099 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m17:30:36.145099 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:30:36.179247 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:30:36.186401 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:30:36.186401 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:30:36.190034 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:30:36.190034 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m17:30:36.190034 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:30:36.190034 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:30:36.190034 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m17:30:36.190034 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:30:36.190034 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:30:36.190034 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m17:30:36.190034 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:30:36.203226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5135429f-9076-4451-ab6e-3693aa605bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029640660D70>]}
[0m17:30:36.203226 [debug] [MainThread]: Using duckdb connection "master"
[0m17:30:36.203226 [debug] [MainThread]: On master: BEGIN
[0m17:30:36.203226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:36.224873 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:30:36.224873 [debug] [MainThread]: On master: COMMIT
[0m17:30:36.224873 [debug] [MainThread]: Using duckdb connection "master"
[0m17:30:36.224873 [debug] [MainThread]: On master: COMMIT
[0m17:30:36.224873 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:30:36.224873 [debug] [MainThread]: On master: Close
[0m17:30:36.230122 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:30:36.230122 [info ] [MainThread]: 
[0m17:30:36.239809 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:30:36.239809 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents ........ [RUN]
[0m17:30:36.239809 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents'
[0m17:30:36.239809 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:30:36.239809 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:30:36.249331 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:30:36.275023 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:30:36.275023 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:30:36.275023 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: BEGIN
[0m17:30:36.275023 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:30:36.290271 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:30:36.290271 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:30:36.290271 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents Table Creation *****/
/***
The below model will join the following tables together to for further analysis:
- nfirs_transformed__fdheader
- nfirs_transformed__basicincident
- nfirs_transformed__fireincident

The following logic will be applied:
- FD Header CTE to aggregate numeric columns
- Basic Incident CTE to select all columns from the respective table
- Fire Incident CTE to select all columns from the respective table
- The Basic Incident CTE serves at the base table and the FD Header and
  Fire Incident table are left joined to basic incident

All columns will be written out to clearly specify what columns are included
***/



WITH transformed_fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader"
)

SELECT * FROM transformed_fdheader_source
    );
  
  
[0m17:30:36.340112 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:30:36.352899 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:30:36.352899 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp" rename to "nfirs_processed__incidents"
[0m17:30:36.352899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:30:36.369106 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: COMMIT
[0m17:30:36.369307 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:30:36.369878 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: COMMIT
[0m17:30:36.399211 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:30:36.401701 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:30:36.401701 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */
drop table if exists "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_backup" cascade
[0m17:30:36.401701 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:30:36.401701 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: Close
[0m17:30:36.852709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5135429f-9076-4451-ab6e-3693aa605bca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002963D89F4D0>]}
[0m17:30:36.852709 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_processed.nfirs_processed__incidents ... [[32mOK[0m in 0.61s]
[0m17:30:36.852709 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:30:36.860055 [debug] [MainThread]: Using duckdb connection "master"
[0m17:30:36.860055 [debug] [MainThread]: On master: BEGIN
[0m17:30:36.860055 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:36.879954 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:30:36.879954 [debug] [MainThread]: On master: COMMIT
[0m17:30:36.879954 [debug] [MainThread]: Using duckdb connection "master"
[0m17:30:36.879954 [debug] [MainThread]: On master: COMMIT
[0m17:30:36.879954 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:30:36.879954 [debug] [MainThread]: On master: Close
[0m17:30:36.879954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:36.879954 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m17:30:36.879954 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:30:36.879954 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m17:30:36.879954 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:30:36.879954 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents' was properly closed.
[0m17:30:36.888990 [info ] [MainThread]: 
[0m17:30:36.888990 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m17:30:36.888990 [debug] [MainThread]: Command end result
[0m17:30:36.920128 [info ] [MainThread]: 
[0m17:30:36.921642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:36.922223 [info ] [MainThread]: 
[0m17:30:36.922818 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:30:36.923371 [debug] [MainThread]: Command `cli run` succeeded at 17:30:36.923371 after 2.23 seconds
[0m17:30:36.923371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002963DF03B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002963FEB2300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002963EB3C110>]}
[0m17:30:36.923371 [debug] [MainThread]: Flushing usage events
[0m17:47:57.095209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026159E97710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026159E94B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026159E96F60>]}


============================== 17:47:57.099211 | 0a778c71-2b81-4a96-bbd0-bf60c39b5acf ==============================
[0m17:47:57.099211 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:47:57.099211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:47:57.253128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a778c71-2b81-4a96-bbd0-bf60c39b5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615BC1FEC0>]}
[0m17:47:57.296129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a778c71-2b81-4a96-bbd0-bf60c39b5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615B9DC110>]}
[0m17:47:57.297135 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:47:57.307072 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:47:57.440300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:47:57.440300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:47:57.472293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a778c71-2b81-4a96-bbd0-bf60c39b5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615BCC4A70>]}
[0m17:47:57.551075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a778c71-2b81-4a96-bbd0-bf60c39b5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615BF40E90>]}
[0m17:47:57.551075 [info ] [MainThread]: Found 22 models, 4 data tests, 19 sources, 524 macros
[0m17:47:57.551075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a778c71-2b81-4a96-bbd0-bf60c39b5acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615BC948F0>]}
[0m17:47:57.551075 [info ] [MainThread]: 
[0m17:47:57.551075 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:47:57.551075 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:47:57.620401 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:47:57.621394 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:47:57.621394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:57.768039 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:47:57.768039 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m17:47:57.768039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:57.768039 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m17:47:57.768039 [info ] [MainThread]: 
[0m17:47:57.768039 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m17:47:57.768039 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 12012)
[0m17:47:57.768039 [debug] [MainThread]: Command `cli run` failed at 17:47:57.768039 after 0.79 seconds
[0m17:47:57.768039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615B92A390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615BCC72C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002615B951430>]}
[0m17:47:57.768039 [debug] [MainThread]: Flushing usage events
[0m17:48:09.015262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DED28E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DED28CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DED2B6B0>]}


============================== 17:48:09.015262 | 79de84fa-78d7-4c3e-b2c5-44031e384b0b ==============================
[0m17:48:09.015262 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:48:09.015262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:48:09.173204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79de84fa-78d7-4c3e-b2c5-44031e384b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DF0E35C0>]}
[0m17:48:09.217738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79de84fa-78d7-4c3e-b2c5-44031e384b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DC86FE00>]}
[0m17:48:09.218850 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:48:09.228114 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:48:09.358245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:09.358245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:09.391574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79de84fa-78d7-4c3e-b2c5-44031e384b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DF1BF950>]}
[0m17:48:09.478111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79de84fa-78d7-4c3e-b2c5-44031e384b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DF2F7DA0>]}
[0m17:48:09.478111 [info ] [MainThread]: Found 22 models, 4 data tests, 19 sources, 524 macros
[0m17:48:09.478111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79de84fa-78d7-4c3e-b2c5-44031e384b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DF0E0A40>]}
[0m17:48:09.478111 [info ] [MainThread]: 
[0m17:48:09.478111 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:48:09.478111 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:48:09.553486 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:48:09.553486 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:48:09.553486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:09.575081 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:09.575081 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:48:09.583087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m17:48:09.583087 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m17:48:09.592235 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:48:09.592235 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:48:09.592235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:09.612753 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:09.612753 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:48:09.614973 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m17:48:09.614973 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:09.614973 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:48:09.614973 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m17:48:09.614973 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:09.614973 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m17:48:09.614973 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:48:09.614973 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m17:48:09.618095 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:09.618438 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m17:48:09.625675 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:48:09.628323 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:48:09.632861 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m17:48:09.632861 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:48:09.633898 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:48:09.633995 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:48:09.633995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:09.636042 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:48:09.636042 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m17:48:09.654518 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:48:09.656615 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:09.656615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:09.656615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:09.656615 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:48:09.658346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:09.658346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:09.658346 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:48:09.658346 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:48:09.658346 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:48:09.658346 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m17:48:09.658346 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:48:09.688156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:09.693207 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:09.695325 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:48:09.695325 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:09.695325 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:48:09.698178 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m17:48:09.698178 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:48:09.698178 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:48:09.698178 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m17:48:09.698178 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:48:09.698178 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m17:48:09.698178 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:48:09.708374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79de84fa-78d7-4c3e-b2c5-44031e384b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DC8B8530>]}
[0m17:48:09.708374 [debug] [MainThread]: Using duckdb connection "master"
[0m17:48:09.708374 [debug] [MainThread]: On master: BEGIN
[0m17:48:09.708374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:09.729191 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:48:09.729191 [debug] [MainThread]: On master: COMMIT
[0m17:48:09.729191 [debug] [MainThread]: Using duckdb connection "master"
[0m17:48:09.729191 [debug] [MainThread]: On master: COMMIT
[0m17:48:09.729191 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:48:09.729191 [debug] [MainThread]: On master: Close
[0m17:48:09.737407 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:48:09.737968 [info ] [MainThread]: 
[0m17:48:09.738456 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:48:09.738456 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents ........ [RUN]
[0m17:48:09.738456 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents'
[0m17:48:09.738456 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:48:09.748440 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:48:09.748440 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:48:09.778423 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:48:09.778423 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:48:09.778423 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: BEGIN
[0m17:48:09.778423 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:48:09.798359 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:09.798359 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:48:09.798359 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents Table Creation *****/
/***
The below model will join the following tables together to for further analysis:
- nfirs_transformed__fdheader
- nfirs_transformed__basicincident
- nfirs_transformed__fireincident

The following logic will be applied:
- FD Header CTE to aggregate numeric columns
- Basic Incident CTE to select all columns from the respective table
- Fire Incident CTE to select all columns from the respective table
- The Basic Incident CTE serves at the base table and the FD Header and
  Fire Incident table are left joined to basic incident

All columns will be written out to clearly specify what columns are included
***/



-- Create FD Header CTEs
WITH transformed_fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader"
),

fdheader_processed AS (
    SELECT
        state,
        fdid,
        fd_name,
        fd_str_no,
        fd_str_pre,
        fd_street,
        fd_str_typ,
        fd_str_suf,
        fd_city,
        fd_zip,
        fd_phone,
        fd_fax,
        fd_email,
        fd_fip_cty,
        SUM(no_station) AS no_station,
        SUM(no_pd_ff) AS no_pd_ff,
        SUM(no_vol_ff) AS no_vol_ff,
        SUM(no_vol_pdc) AS no_vol_pdc
    FROM transformed_fdheader_source
    GROUP BY ALL
)

-- Create Basic Incident CTEs
transformed_basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident"
),

basicincident_processed AS (
    SELECT
        *
    FROM transformed_basicincident_source
),

-- Create Fire Incident CTEs
transformed_fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident"
),

fireincident_processed AS (
    SELECT
        *
    FROM fireincident_source
),

-- Join the three processed CTEs together
incidents_processed_final AS (
    SELECT
        fd.state,
        fd.fdid,
        fd.fd_name,
        fd.fd_str_no,
        fd.fd_str_pre,
        fd.fd_street,
        fd.fd_str_typ,
        fd.fd_str_suf,
        fd.fd_city,
        fd.fd_zip,
        fd.fd_phone,
        fd.fd_fax,
        fd.fd_email,
        fd.fd_fip_cty
        b.incident_key,
	    b.inc_date,
	    b.inc_no,
        b.exp_no,
        b.dept_sta,
        b.inc_type,
        b.add_wild,
        b.aid,
        b.alarm,
        b.arrival,
        b.inc_cont,
        b.lu_clear,
        b.shift,
        b.alarms,
        b.district,
		b.act_tak1,
		b.act_tak2,
		b.act_tak3,
		b.app_mod,
		b.sup_app,
		b.ems_app,
		b.oth_app,
		b.sup_per,
		b.ems_per,
		b.oth_per,
		b.resou_aid,
		b.prop_loss,
		b.cont_loss,
		b.prop_val,
		b.cont_val,
		b.ff_death,
		b.oth_death,
		b.ff_inj,
		b.oth_inj,
		b.det_alert,
		b.haz_rel,
		b.mixed_use,
		b.prop_use,
		b.census,
        f.num_unit,
		f.not_res,
		f.bldg_invol,
		f.acres_burn,
		f.less_1acre,
		f.on_site_m1,
		f.mat_stor1,
		f.on_site_m2,
		f.mat_stor2,
		f.on_site_m3,
		f.mat_stor3,
		f.area_orig,
		f.heat_sourc,
		f.first_ign,
		f.conf_orig,
		f.type_mat,
		f.cause_ign,
		f.fact_ign_1,
		f.fact_ign_2,
		f.hum_fac_1,
		f.hum_fac_2,
		f.hum_fac_3,
		f.hum_fac_4,
		f.hum_fac_5,
		f.hum_fac_6,
		f.hum_fac_7,
		f.hum_fac_8,
		f.age,
		f.sex,
		f.equip_inv,
		f.sup_fac_1,
		f.sup_fac_2,
		f.sup_fac_3,
		f.mob_invol,
		f.mob_type,
		f.mob_make,
		f.mob_model,
		f.mob_year,
		f.mob_lic_pl,
		f.mob_state,
		f.mob_vin_no,
		f.eq_brand,
		f.eq_model,
		f.eq_ser_no,
		f.eq_year,
		f.eq_power,
		f.eq_port,
		f.fire_sprd,
		f.struc_type,
		f.struc_stat,
		f.bldg_above,
		f.bldg_below,
		f.bldg_lgth,
		f.bldg_width,
		f.tot_sq_ft,
		f.fire_orig,
		f.st_dm_min_update,
		f.st_dm_sig,
		f.st_dam_hvy,
		f.st_dam_xtr,
		f.flame_sprd,
		f.item_sprd,
		f.mat_sprd,
		f.detector,
		f.det_type,
		f.det_power,
		f.det_operat,
		f.det_effect,
		f.det_fail,
		f.aes_pres,
		f.aes_type,
		f.aes_oper,
		f.no_spr_op,
		f.aes_fail
    FROM basicincident_processed b
    LEFT JOIN fdheader_processed fd
        ON b.fdid = fd.fdid AND b.state = fd.state
    LEFT JOIN fireincident_processed f
        ON b.incident_key = f.incident_key AND b.inc_no = f.inc_no
),


SELECT * FROM incidents_processed_final
    );
  
  
[0m17:48:09.848501 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents Table Creation *****/
/***
The below model will join the following tables together to for further analysis:
- nfirs_transformed__fdheader
- nfirs_transformed__basicincident
- nfirs_transformed__fireincident

The following logic will be applied:
- FD Header CTE to aggregate numeric columns
- Basic Incident CTE to select all columns from the respective table
- Fire Incident CTE to select all columns from the respective table
- The Basic Incident CTE serves at the base table and the FD Header and
  Fire Incident table are left joined to basic incident

All columns will be written out to clearly specify what columns are included
***/



-- Create FD Header CTEs
WITH transformed_fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader"
),

fdheader_processed AS (
    SELECT
        state,
        fdid,
        fd_name,
        fd_str_no,
        fd_str_pre,
        fd_street,
        fd_str_typ,
        fd_str_suf,
        fd_city,
        fd_zip,
        fd_phone,
        fd_fax,
        fd_email,
        fd_fip_cty,
        SUM(no_station) AS no_station,
        SUM(no_pd_ff) AS no_pd_ff,
        SUM(no_vol_ff) AS no_vol_ff,
        SUM(no_vol_pdc) AS no_vol_pdc
    FROM transformed_fdheader_source
    GROUP BY ALL
)

-- Create Basic Incident CTEs
transformed_basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident"
),

basicincident_processed AS (
    SELECT
        *
    FROM transformed_basicincident_source
),

-- Create Fire Incident CTEs
transformed_fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident"
),

fireincident_processed AS (
    SELECT
        *
    FROM fireincident_source
),

-- Join the three processed CTEs together
incidents_processed_final AS (
    SELECT
        fd.state,
        fd.fdid,
        fd.fd_name,
        fd.fd_str_no,
        fd.fd_str_pre,
        fd.fd_street,
        fd.fd_str_typ,
        fd.fd_str_suf,
        fd.fd_city,
        fd.fd_zip,
        fd.fd_phone,
        fd.fd_fax,
        fd.fd_email,
        fd.fd_fip_cty
        b.incident_key,
	    b.inc_date,
	    b.inc_no,
        b.exp_no,
        b.dept_sta,
        b.inc_type,
        b.add_wild,
        b.aid,
        b.alarm,
        b.arrival,
        b.inc_cont,
        b.lu_clear,
        b.shift,
        b.alarms,
        b.district,
		b.act_tak1,
		b.act_tak2,
		b.act_tak3,
		b.app_mod,
		b.sup_app,
		b.ems_app,
		b.oth_app,
		b.sup_per,
		b.ems_per,
		b.oth_per,
		b.resou_aid,
		b.prop_loss,
		b.cont_loss,
		b.prop_val,
		b.cont_val,
		b.ff_death,
		b.oth_death,
		b.ff_inj,
		b.oth_inj,
		b.det_alert,
		b.haz_rel,
		b.mixed_use,
		b.prop_use,
		b.census,
        f.num_unit,
		f.not_res,
		f.bldg_invol,
		f.acres_burn,
		f.less_1acre,
		f.on_site_m1,
		f.mat_stor1,
		f.on_site_m2,
		f.mat_stor2,
		f.on_site_m3,
		f.mat_stor3,
		f.area_orig,
		f.heat_sourc,
		f.first_ign,
		f.conf_orig,
		f.type_mat,
		f.cause_ign,
		f.fact_ign_1,
		f.fact_ign_2,
		f.hum_fac_1,
		f.hum_fac_2,
		f.hum_fac_3,
		f.hum_fac_4,
		f.hum_fac_5,
		f.hum_fac_6,
		f.hum_fac_7,
		f.hum_fac_8,
		f.age,
		f.sex,
		f.equip_inv,
		f.sup_fac_1,
		f.sup_fac_2,
		f.sup_fac_3,
		f.mob_invol,
		f.mob_type,
		f.mob_make,
		f.mob_model,
		f.mob_year,
		f.mob_lic_pl,
		f.mob_state,
		f.mob_vin_no,
		f.eq_brand,
		f.eq_model,
		f.eq_ser_no,
		f.eq_year,
		f.eq_power,
		f.eq_port,
		f.fire_sprd,
		f.struc_type,
		f.struc_stat,
		f.bldg_above,
		f.bldg_below,
		f.bldg_lgth,
		f.bldg_width,
		f.tot_sq_ft,
		f.fire_orig,
		f.st_dm_min_update,
		f.st_dm_sig,
		f.st_dam_hvy,
		f.st_dam_xtr,
		f.flame_sprd,
		f.item_sprd,
		f.mat_sprd,
		f.detector,
		f.det_type,
		f.det_power,
		f.det_operat,
		f.det_effect,
		f.det_fail,
		f.aes_pres,
		f.aes_type,
		f.aes_oper,
		f.no_spr_op,
		f.aes_fail
    FROM basicincident_processed b
    LEFT JOIN fdheader_processed fd
        ON b.fdid = fd.fdid AND b.state = fd.state
    LEFT JOIN fireincident_processed f
        ON b.incident_key = f.incident_key AND b.inc_no = f.inc_no
),


SELECT * FROM incidents_processed_final
    );
  
  
[0m17:48:09.848501 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:48:09.857332 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: ROLLBACK
[0m17:48:09.873346 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__incidents'
[0m17:48:09.873346 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: Close
[0m17:48:09.881362 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__incidents (models\nfirs_processed\nfirs_processed__incidents.sql)
  Parser Error: syntax error at or near "transformed_basicincident_source"
[0m17:48:09.881362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79de84fa-78d7-4c3e-b2c5-44031e384b0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DF8979E0>]}
[0m17:48:09.888219 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__incidents  [[31mERROR[0m in 0.14s]
[0m17:48:09.888219 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:48:09.888219 [debug] [MainThread]: Using duckdb connection "master"
[0m17:48:09.888219 [debug] [MainThread]: On master: BEGIN
[0m17:48:09.888219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:09.914385 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:48:09.918081 [debug] [MainThread]: On master: COMMIT
[0m17:48:09.918081 [debug] [MainThread]: Using duckdb connection "master"
[0m17:48:09.918081 [debug] [MainThread]: On master: COMMIT
[0m17:48:09.918081 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:48:09.918081 [debug] [MainThread]: On master: Close
[0m17:48:09.918081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:09.918081 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m17:48:09.918081 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:48:09.918081 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m17:48:09.918081 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:48:09.918081 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents' was properly closed.
[0m17:48:09.918081 [info ] [MainThread]: 
[0m17:48:09.928254 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m17:48:09.928254 [debug] [MainThread]: Command end result
[0m17:48:09.958114 [info ] [MainThread]: 
[0m17:48:09.958114 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:48:09.958114 [info ] [MainThread]: 
[0m17:48:09.958114 [error] [MainThread]:   Runtime Error in model nfirs_processed__incidents (models\nfirs_processed\nfirs_processed__incidents.sql)
  Parser Error: syntax error at or near "transformed_basicincident_source"
[0m17:48:09.958114 [info ] [MainThread]: 
[0m17:48:09.958114 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:48:09.958114 [debug] [MainThread]: Command `cli run` failed at 17:48:09.958114 after 1.06 seconds
[0m17:48:09.958114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DEE84CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DD38EC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177DED59610>]}
[0m17:48:09.958114 [debug] [MainThread]: Flushing usage events
[0m17:48:48.472106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB09DBBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB09DAD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB09D8CE0>]}


============================== 17:48:48.472106 | 6c1411b5-4dbb-47b0-976a-cec4dabd04de ==============================
[0m17:48:48.472106 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:48:48.472106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:48:48.627464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c1411b5-4dbb-47b0-976a-cec4dabd04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DAE284380>]}
[0m17:48:48.668451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c1411b5-4dbb-47b0-976a-cec4dabd04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB0A88140>]}
[0m17:48:48.668451 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:48:48.684868 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:48:48.806780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:48.815266 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:48.839452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c1411b5-4dbb-47b0-976a-cec4dabd04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB0E0AC90>]}
[0m17:48:48.920537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c1411b5-4dbb-47b0-976a-cec4dabd04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB0E38050>]}
[0m17:48:48.920537 [info ] [MainThread]: Found 22 models, 4 data tests, 19 sources, 524 macros
[0m17:48:48.920537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c1411b5-4dbb-47b0-976a-cec4dabd04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB08ECE90>]}
[0m17:48:48.928583 [info ] [MainThread]: 
[0m17:48:48.928583 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:48:48.928583 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:48:48.985363 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:48:48.985363 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:48:48.985363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:49.009839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:49.009839 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:48:49.009839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m17:48:49.009839 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m17:48:49.018235 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:48:49.018235 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:48:49.018235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:49.042501 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:49.042501 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:48:49.042501 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m17:48:49.042501 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:49.042501 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:48:49.042501 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m17:48:49.042501 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:49.042501 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m17:48:49.042501 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:48:49.042501 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m17:48:49.042501 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:49.042501 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m17:48:49.058548 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:48:49.058548 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m17:48:49.058548 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:48:49.058548 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:48:49.058548 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:48:49.066542 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:48:49.066749 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:48:49.066749 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m17:48:49.066749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:49.066749 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:48:49.066749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:49.082862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:49.082862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:49.082862 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:49.082862 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:48:49.090848 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:49.090848 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:48:49.090848 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:48:49.090848 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:48:49.090848 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m17:48:49.090848 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:48:49.115468 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:49.123498 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:49.123498 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:48:49.123498 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m17:48:49.123498 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:48:49.123498 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:48:49.123498 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:48:49.131644 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:48:49.131644 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m17:48:49.131644 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:48:49.131644 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:48:49.131644 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m17:48:49.139843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c1411b5-4dbb-47b0-976a-cec4dabd04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB13AA8A0>]}
[0m17:48:49.139843 [debug] [MainThread]: Using duckdb connection "master"
[0m17:48:49.139843 [debug] [MainThread]: On master: BEGIN
[0m17:48:49.139843 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:49.155947 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:48:49.155947 [debug] [MainThread]: On master: COMMIT
[0m17:48:49.155947 [debug] [MainThread]: Using duckdb connection "master"
[0m17:48:49.155947 [debug] [MainThread]: On master: COMMIT
[0m17:48:49.164113 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:48:49.164113 [debug] [MainThread]: On master: Close
[0m17:48:49.164113 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:48:49.164113 [info ] [MainThread]: 
[0m17:48:49.172215 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:48:49.172215 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents ........ [RUN]
[0m17:48:49.172215 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents'
[0m17:48:49.172215 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:48:49.180189 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:48:49.180189 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:48:49.204917 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:48:49.204917 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:48:49.204917 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: BEGIN
[0m17:48:49.204917 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:48:49.220916 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:48:49.228890 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:48:49.228890 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents Table Creation *****/
/***
The below model will join the following tables together to for further analysis:
- nfirs_transformed__fdheader
- nfirs_transformed__basicincident
- nfirs_transformed__fireincident

The following logic will be applied:
- FD Header CTE to aggregate numeric columns
- Basic Incident CTE to select all columns from the respective table
- Fire Incident CTE to select all columns from the respective table
- The Basic Incident CTE serves at the base table and the FD Header and
  Fire Incident table are left joined to basic incident

All columns will be written out to clearly specify what columns are included
***/



-- Create FD Header CTEs
WITH transformed_fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader"
),

fdheader_processed AS (
    SELECT
        state,
        fdid,
        fd_name,
        fd_str_no,
        fd_str_pre,
        fd_street,
        fd_str_typ,
        fd_str_suf,
        fd_city,
        fd_zip,
        fd_phone,
        fd_fax,
        fd_email,
        fd_fip_cty,
        SUM(no_station) AS no_station,
        SUM(no_pd_ff) AS no_pd_ff,
        SUM(no_vol_ff) AS no_vol_ff,
        SUM(no_vol_pdc) AS no_vol_pdc
    FROM transformed_fdheader_source
    GROUP BY ALL
),

-- Create Basic Incident CTEs
transformed_basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident"
),

basicincident_processed AS (
    SELECT
        *
    FROM transformed_basicincident_source
),

-- Create Fire Incident CTEs
transformed_fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident"
),

fireincident_processed AS (
    SELECT
        *
    FROM fireincident_source
),

-- Join the three processed CTEs together
incidents_processed_final AS (
    SELECT
        fd.state,
        fd.fdid,
        fd.fd_name,
        fd.fd_str_no,
        fd.fd_str_pre,
        fd.fd_street,
        fd.fd_str_typ,
        fd.fd_str_suf,
        fd.fd_city,
        fd.fd_zip,
        fd.fd_phone,
        fd.fd_fax,
        fd.fd_email,
        fd.fd_fip_cty
        b.incident_key,
	    b.inc_date,
	    b.inc_no,
        b.exp_no,
        b.dept_sta,
        b.inc_type,
        b.add_wild,
        b.aid,
        b.alarm,
        b.arrival,
        b.inc_cont,
        b.lu_clear,
        b.shift,
        b.alarms,
        b.district,
		b.act_tak1,
		b.act_tak2,
		b.act_tak3,
		b.app_mod,
		b.sup_app,
		b.ems_app,
		b.oth_app,
		b.sup_per,
		b.ems_per,
		b.oth_per,
		b.resou_aid,
		b.prop_loss,
		b.cont_loss,
		b.prop_val,
		b.cont_val,
		b.ff_death,
		b.oth_death,
		b.ff_inj,
		b.oth_inj,
		b.det_alert,
		b.haz_rel,
		b.mixed_use,
		b.prop_use,
		b.census,
        f.num_unit,
		f.not_res,
		f.bldg_invol,
		f.acres_burn,
		f.less_1acre,
		f.on_site_m1,
		f.mat_stor1,
		f.on_site_m2,
		f.mat_stor2,
		f.on_site_m3,
		f.mat_stor3,
		f.area_orig,
		f.heat_sourc,
		f.first_ign,
		f.conf_orig,
		f.type_mat,
		f.cause_ign,
		f.fact_ign_1,
		f.fact_ign_2,
		f.hum_fac_1,
		f.hum_fac_2,
		f.hum_fac_3,
		f.hum_fac_4,
		f.hum_fac_5,
		f.hum_fac_6,
		f.hum_fac_7,
		f.hum_fac_8,
		f.age,
		f.sex,
		f.equip_inv,
		f.sup_fac_1,
		f.sup_fac_2,
		f.sup_fac_3,
		f.mob_invol,
		f.mob_type,
		f.mob_make,
		f.mob_model,
		f.mob_year,
		f.mob_lic_pl,
		f.mob_state,
		f.mob_vin_no,
		f.eq_brand,
		f.eq_model,
		f.eq_ser_no,
		f.eq_year,
		f.eq_power,
		f.eq_port,
		f.fire_sprd,
		f.struc_type,
		f.struc_stat,
		f.bldg_above,
		f.bldg_below,
		f.bldg_lgth,
		f.bldg_width,
		f.tot_sq_ft,
		f.fire_orig,
		f.st_dm_min_update,
		f.st_dm_sig,
		f.st_dam_hvy,
		f.st_dam_xtr,
		f.flame_sprd,
		f.item_sprd,
		f.mat_sprd,
		f.detector,
		f.det_type,
		f.det_power,
		f.det_operat,
		f.det_effect,
		f.det_fail,
		f.aes_pres,
		f.aes_type,
		f.aes_oper,
		f.no_spr_op,
		f.aes_fail
    FROM basicincident_processed b
    LEFT JOIN fdheader_processed fd
        ON b.fdid = fd.fdid AND b.state = fd.state
    LEFT JOIN fireincident_processed f
        ON b.incident_key = f.incident_key AND b.inc_no = f.inc_no
),


SELECT * FROM incidents_processed_final
    );
  
  
[0m17:48:49.228890 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents Table Creation *****/
/***
The below model will join the following tables together to for further analysis:
- nfirs_transformed__fdheader
- nfirs_transformed__basicincident
- nfirs_transformed__fireincident

The following logic will be applied:
- FD Header CTE to aggregate numeric columns
- Basic Incident CTE to select all columns from the respective table
- Fire Incident CTE to select all columns from the respective table
- The Basic Incident CTE serves at the base table and the FD Header and
  Fire Incident table are left joined to basic incident

All columns will be written out to clearly specify what columns are included
***/



-- Create FD Header CTEs
WITH transformed_fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader"
),

fdheader_processed AS (
    SELECT
        state,
        fdid,
        fd_name,
        fd_str_no,
        fd_str_pre,
        fd_street,
        fd_str_typ,
        fd_str_suf,
        fd_city,
        fd_zip,
        fd_phone,
        fd_fax,
        fd_email,
        fd_fip_cty,
        SUM(no_station) AS no_station,
        SUM(no_pd_ff) AS no_pd_ff,
        SUM(no_vol_ff) AS no_vol_ff,
        SUM(no_vol_pdc) AS no_vol_pdc
    FROM transformed_fdheader_source
    GROUP BY ALL
),

-- Create Basic Incident CTEs
transformed_basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident"
),

basicincident_processed AS (
    SELECT
        *
    FROM transformed_basicincident_source
),

-- Create Fire Incident CTEs
transformed_fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident"
),

fireincident_processed AS (
    SELECT
        *
    FROM fireincident_source
),

-- Join the three processed CTEs together
incidents_processed_final AS (
    SELECT
        fd.state,
        fd.fdid,
        fd.fd_name,
        fd.fd_str_no,
        fd.fd_str_pre,
        fd.fd_street,
        fd.fd_str_typ,
        fd.fd_str_suf,
        fd.fd_city,
        fd.fd_zip,
        fd.fd_phone,
        fd.fd_fax,
        fd.fd_email,
        fd.fd_fip_cty
        b.incident_key,
	    b.inc_date,
	    b.inc_no,
        b.exp_no,
        b.dept_sta,
        b.inc_type,
        b.add_wild,
        b.aid,
        b.alarm,
        b.arrival,
        b.inc_cont,
        b.lu_clear,
        b.shift,
        b.alarms,
        b.district,
		b.act_tak1,
		b.act_tak2,
		b.act_tak3,
		b.app_mod,
		b.sup_app,
		b.ems_app,
		b.oth_app,
		b.sup_per,
		b.ems_per,
		b.oth_per,
		b.resou_aid,
		b.prop_loss,
		b.cont_loss,
		b.prop_val,
		b.cont_val,
		b.ff_death,
		b.oth_death,
		b.ff_inj,
		b.oth_inj,
		b.det_alert,
		b.haz_rel,
		b.mixed_use,
		b.prop_use,
		b.census,
        f.num_unit,
		f.not_res,
		f.bldg_invol,
		f.acres_burn,
		f.less_1acre,
		f.on_site_m1,
		f.mat_stor1,
		f.on_site_m2,
		f.mat_stor2,
		f.on_site_m3,
		f.mat_stor3,
		f.area_orig,
		f.heat_sourc,
		f.first_ign,
		f.conf_orig,
		f.type_mat,
		f.cause_ign,
		f.fact_ign_1,
		f.fact_ign_2,
		f.hum_fac_1,
		f.hum_fac_2,
		f.hum_fac_3,
		f.hum_fac_4,
		f.hum_fac_5,
		f.hum_fac_6,
		f.hum_fac_7,
		f.hum_fac_8,
		f.age,
		f.sex,
		f.equip_inv,
		f.sup_fac_1,
		f.sup_fac_2,
		f.sup_fac_3,
		f.mob_invol,
		f.mob_type,
		f.mob_make,
		f.mob_model,
		f.mob_year,
		f.mob_lic_pl,
		f.mob_state,
		f.mob_vin_no,
		f.eq_brand,
		f.eq_model,
		f.eq_ser_no,
		f.eq_year,
		f.eq_power,
		f.eq_port,
		f.fire_sprd,
		f.struc_type,
		f.struc_stat,
		f.bldg_above,
		f.bldg_below,
		f.bldg_lgth,
		f.bldg_width,
		f.tot_sq_ft,
		f.fire_orig,
		f.st_dm_min_update,
		f.st_dm_sig,
		f.st_dam_hvy,
		f.st_dam_xtr,
		f.flame_sprd,
		f.item_sprd,
		f.mat_sprd,
		f.detector,
		f.det_type,
		f.det_power,
		f.det_operat,
		f.det_effect,
		f.det_fail,
		f.aes_pres,
		f.aes_type,
		f.aes_oper,
		f.no_spr_op,
		f.aes_fail
    FROM basicincident_processed b
    LEFT JOIN fdheader_processed fd
        ON b.fdid = fd.fdid AND b.state = fd.state
    LEFT JOIN fireincident_processed f
        ON b.incident_key = f.incident_key AND b.inc_no = f.inc_no
),


SELECT * FROM incidents_processed_final
    );
  
  
[0m17:48:49.228890 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:48:49.228890 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: ROLLBACK
[0m17:48:49.228890 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__incidents'
[0m17:48:49.228890 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: Close
[0m17:48:49.237062 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__incidents (models\nfirs_processed\nfirs_processed__incidents.sql)
  Parser Error: syntax error at or near "."
[0m17:48:49.237062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c1411b5-4dbb-47b0-976a-cec4dabd04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DAEF47800>]}
[0m17:48:49.237062 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__incidents  [[31mERROR[0m in 0.06s]
[0m17:48:49.237062 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:48:49.245338 [debug] [MainThread]: Using duckdb connection "master"
[0m17:48:49.245338 [debug] [MainThread]: On master: BEGIN
[0m17:48:49.245338 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:49.261717 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:48:49.261717 [debug] [MainThread]: On master: COMMIT
[0m17:48:49.261717 [debug] [MainThread]: Using duckdb connection "master"
[0m17:48:49.261717 [debug] [MainThread]: On master: COMMIT
[0m17:48:49.261717 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:48:49.261717 [debug] [MainThread]: On master: Close
[0m17:48:49.269848 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:49.269848 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m17:48:49.269848 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:48:49.269848 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m17:48:49.269848 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:48:49.269848 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents' was properly closed.
[0m17:48:49.269848 [info ] [MainThread]: 
[0m17:48:49.269848 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m17:48:49.269848 [debug] [MainThread]: Command end result
[0m17:48:49.295390 [info ] [MainThread]: 
[0m17:48:49.295390 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:48:49.295390 [info ] [MainThread]: 
[0m17:48:49.295390 [error] [MainThread]:   Runtime Error in model nfirs_processed__incidents (models\nfirs_processed\nfirs_processed__incidents.sql)
  Parser Error: syntax error at or near "."
[0m17:48:49.295390 [info ] [MainThread]: 
[0m17:48:49.295390 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:48:49.295390 [debug] [MainThread]: Command `cli run` failed at 17:48:49.295390 after 0.94 seconds
[0m17:48:49.295390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DAF4992B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB0A216A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029DB0D81520>]}
[0m17:48:49.295390 [debug] [MainThread]: Flushing usage events
[0m17:50:01.732877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D609BB7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D609BB5E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D609BB5E80>]}


============================== 17:50:01.741194 | 8f2c0007-0d2f-4ba0-a501-020105a60f84 ==============================
[0m17:50:01.741194 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:50:01.741194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:50:01.890390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f2c0007-0d2f-4ba0-a501-020105a60f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60B97FFE0>]}
[0m17:50:01.939725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f2c0007-0d2f-4ba0-a501-020105a60f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D608A67800>]}
[0m17:50:01.939725 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:50:01.947720 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:50:02.069361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:02.077253 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:02.109659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f2c0007-0d2f-4ba0-a501-020105a60f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60B9FF560>]}
[0m17:50:02.190326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f2c0007-0d2f-4ba0-a501-020105a60f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60BA99940>]}
[0m17:50:02.190326 [info ] [MainThread]: Found 22 models, 4 data tests, 19 sources, 524 macros
[0m17:50:02.190326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f2c0007-0d2f-4ba0-a501-020105a60f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60B9E2E70>]}
[0m17:50:02.190326 [info ] [MainThread]: 
[0m17:50:02.190326 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:50:02.190326 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:50:02.247289 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:50:02.247289 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:50:02.247289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:02.271508 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:02.271508 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:50:02.271508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m17:50:02.271508 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m17:50:02.279546 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:50:02.279546 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:50:02.279546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:02.304190 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:02.304190 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:50:02.304190 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m17:50:02.304190 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:02.304190 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:50:02.304190 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m17:50:02.304190 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:02.304190 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m17:50:02.304190 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:50:02.304190 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m17:50:02.312417 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:02.312417 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m17:50:02.320452 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m17:50:02.320452 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:50:02.320452 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:50:02.320452 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m17:50:02.320452 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:50:02.320452 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:50:02.320452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:02.328467 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:50:02.328467 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:50:02.344669 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:50:02.344669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:02.344669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:02.344669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:02.344669 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:50:02.344669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:02.344669 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:02.344669 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m17:50:02.344669 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:50:02.344669 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:50:02.352682 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:50:02.352682 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:50:02.377134 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:02.385384 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m17:50:02.385384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:02.385384 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:02.385384 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m17:50:02.385384 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:50:02.385384 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m17:50:02.385384 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:50:02.385384 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:50:02.385384 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:50:02.393615 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:50:02.393615 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:50:02.401685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f2c0007-0d2f-4ba0-a501-020105a60f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60BB19760>]}
[0m17:50:02.401685 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:02.401685 [debug] [MainThread]: On master: BEGIN
[0m17:50:02.401685 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:02.417899 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:50:02.417899 [debug] [MainThread]: On master: COMMIT
[0m17:50:02.417899 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:02.417899 [debug] [MainThread]: On master: COMMIT
[0m17:50:02.417899 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:50:02.417899 [debug] [MainThread]: On master: Close
[0m17:50:02.425927 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:50:02.425927 [info ] [MainThread]: 
[0m17:50:02.433944 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:50:02.433944 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents ........ [RUN]
[0m17:50:02.433944 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents'
[0m17:50:02.433944 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:50:02.433944 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:50:02.442233 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:50:02.458303 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:50:02.466528 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:50:02.466528 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: BEGIN
[0m17:50:02.466528 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:02.482601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:02.482601 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:50:02.482601 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents Table Creation *****/
/***
The below model will join the following tables together to for further analysis:
- nfirs_transformed__fdheader
- nfirs_transformed__basicincident
- nfirs_transformed__fireincident

The following logic will be applied:
- FD Header CTE to aggregate numeric columns
- Basic Incident CTE to select all columns from the respective table
- Fire Incident CTE to select all columns from the respective table
- The Basic Incident CTE serves at the base table and the FD Header and
  Fire Incident table are left joined to basic incident

All columns will be written out to clearly specify what columns are included
***/



-- Create FD Header CTEs
WITH transformed_fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader"
),

fdheader_processed AS (
    SELECT
        state,
        fdid,
        fd_name,
        fd_str_no,
        fd_str_pre,
        fd_street,
        fd_str_typ,
        fd_str_suf,
        fd_city,
        fd_zip,
        fd_phone,
        fd_fax,
        fd_email,
        fd_fip_cty,
        SUM(no_station) AS no_station,
        SUM(no_pd_ff) AS no_pd_ff,
        SUM(no_vol_ff) AS no_vol_ff,
        SUM(no_vol_pdc) AS no_vol_pdc
    FROM transformed_fdheader_source
    GROUP BY ALL
),

-- Create Basic Incident CTEs
transformed_basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident"
),

basicincident_processed AS (
    SELECT
        *
    FROM transformed_basicincident_source
),

-- Create Fire Incident CTEs
transformed_fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident"
),

fireincident_processed AS (
    SELECT
        *
    FROM fireincident_source
),

-- Join the three processed CTEs together
incidents_processed_final AS (
    SELECT
        fd.state,
        fd.fdid,
        fd.fd_name,
        fd.fd_str_no,
        fd.fd_str_pre,
        fd.fd_street,
        fd.fd_str_typ,
        fd.fd_str_suf,
        fd.fd_city,
        fd.fd_zip,
        fd.fd_phone,
        fd.fd_fax,
        fd.fd_email,
        fd.fd_fip_cty
        b.incident_key,
	    b.inc_date,
	    b.inc_no,
        b.exp_no,
        b.dept_sta,
        b.inc_type,
        b.add_wild,
        b.aid,
        b.alarm,
        b.arrival,
        b.inc_cont,
        b.lu_clear,
        b.shift,
        b.alarms,
        b.district,
		b.act_tak1,
		b.act_tak2,
		b.act_tak3,
		b.app_mod,
		b.sup_app,
		b.ems_app,
		b.oth_app,
		b.sup_per,
		b.ems_per,
		b.oth_per,
		b.resou_aid,
		b.prop_loss,
		b.cont_loss,
		b.prop_val,
		b.cont_val,
		b.ff_death,
		b.oth_death,
		b.ff_inj,
		b.oth_inj,
		b.det_alert,
		b.haz_rel,
		b.mixed_use,
		b.prop_use,
		b.census,
        f.num_unit,
		f.not_res,
		f.bldg_invol,
		f.acres_burn,
		f.less_1acre,
		f.on_site_m1,
		f.mat_stor1,
		f.on_site_m2,
		f.mat_stor2,
		f.on_site_m3,
		f.mat_stor3,
		f.area_orig,
		f.heat_sourc,
		f.first_ign,
		f.conf_orig,
		f.type_mat,
		f.cause_ign,
		f.fact_ign_1,
		f.fact_ign_2,
		f.hum_fac_1,
		f.hum_fac_2,
		f.hum_fac_3,
		f.hum_fac_4,
		f.hum_fac_5,
		f.hum_fac_6,
		f.hum_fac_7,
		f.hum_fac_8,
		f.age,
		f.sex,
		f.equip_inv,
		f.sup_fac_1,
		f.sup_fac_2,
		f.sup_fac_3,
		f.mob_invol,
		f.mob_type,
		f.mob_make,
		f.mob_model,
		f.mob_year,
		f.mob_lic_pl,
		f.mob_state,
		f.mob_vin_no,
		f.eq_brand,
		f.eq_model,
		f.eq_ser_no,
		f.eq_year,
		f.eq_power,
		f.eq_port,
		f.fire_sprd,
		f.struc_type,
		f.struc_stat,
		f.bldg_above,
		f.bldg_below,
		f.bldg_lgth,
		f.bldg_width,
		f.tot_sq_ft,
		f.fire_orig,
		f.st_dm_min_update,
		f.st_dm_sig,
		f.st_dam_hvy,
		f.st_dam_xtr,
		f.flame_sprd,
		f.item_sprd,
		f.mat_sprd,
		f.detector,
		f.det_type,
		f.det_power,
		f.det_operat,
		f.det_effect,
		f.det_fail,
		f.aes_pres,
		f.aes_type,
		f.aes_oper,
		f.no_spr_op,
		f.aes_fail
    FROM basicincident_processed b
    LEFT JOIN fdheader_processed fd
        ON b.fdid = fd.fdid AND b.state = fd.state
    LEFT JOIN fireincident_processed f
        ON b.incident_key = f.incident_key AND b.inc_no = f.inc_no
)


SELECT * FROM incidents_processed_final
    );
  
  
[0m17:50:02.482601 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents Table Creation *****/
/***
The below model will join the following tables together to for further analysis:
- nfirs_transformed__fdheader
- nfirs_transformed__basicincident
- nfirs_transformed__fireincident

The following logic will be applied:
- FD Header CTE to aggregate numeric columns
- Basic Incident CTE to select all columns from the respective table
- Fire Incident CTE to select all columns from the respective table
- The Basic Incident CTE serves at the base table and the FD Header and
  Fire Incident table are left joined to basic incident

All columns will be written out to clearly specify what columns are included
***/



-- Create FD Header CTEs
WITH transformed_fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader"
),

fdheader_processed AS (
    SELECT
        state,
        fdid,
        fd_name,
        fd_str_no,
        fd_str_pre,
        fd_street,
        fd_str_typ,
        fd_str_suf,
        fd_city,
        fd_zip,
        fd_phone,
        fd_fax,
        fd_email,
        fd_fip_cty,
        SUM(no_station) AS no_station,
        SUM(no_pd_ff) AS no_pd_ff,
        SUM(no_vol_ff) AS no_vol_ff,
        SUM(no_vol_pdc) AS no_vol_pdc
    FROM transformed_fdheader_source
    GROUP BY ALL
),

-- Create Basic Incident CTEs
transformed_basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident"
),

basicincident_processed AS (
    SELECT
        *
    FROM transformed_basicincident_source
),

-- Create Fire Incident CTEs
transformed_fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident"
),

fireincident_processed AS (
    SELECT
        *
    FROM fireincident_source
),

-- Join the three processed CTEs together
incidents_processed_final AS (
    SELECT
        fd.state,
        fd.fdid,
        fd.fd_name,
        fd.fd_str_no,
        fd.fd_str_pre,
        fd.fd_street,
        fd.fd_str_typ,
        fd.fd_str_suf,
        fd.fd_city,
        fd.fd_zip,
        fd.fd_phone,
        fd.fd_fax,
        fd.fd_email,
        fd.fd_fip_cty
        b.incident_key,
	    b.inc_date,
	    b.inc_no,
        b.exp_no,
        b.dept_sta,
        b.inc_type,
        b.add_wild,
        b.aid,
        b.alarm,
        b.arrival,
        b.inc_cont,
        b.lu_clear,
        b.shift,
        b.alarms,
        b.district,
		b.act_tak1,
		b.act_tak2,
		b.act_tak3,
		b.app_mod,
		b.sup_app,
		b.ems_app,
		b.oth_app,
		b.sup_per,
		b.ems_per,
		b.oth_per,
		b.resou_aid,
		b.prop_loss,
		b.cont_loss,
		b.prop_val,
		b.cont_val,
		b.ff_death,
		b.oth_death,
		b.ff_inj,
		b.oth_inj,
		b.det_alert,
		b.haz_rel,
		b.mixed_use,
		b.prop_use,
		b.census,
        f.num_unit,
		f.not_res,
		f.bldg_invol,
		f.acres_burn,
		f.less_1acre,
		f.on_site_m1,
		f.mat_stor1,
		f.on_site_m2,
		f.mat_stor2,
		f.on_site_m3,
		f.mat_stor3,
		f.area_orig,
		f.heat_sourc,
		f.first_ign,
		f.conf_orig,
		f.type_mat,
		f.cause_ign,
		f.fact_ign_1,
		f.fact_ign_2,
		f.hum_fac_1,
		f.hum_fac_2,
		f.hum_fac_3,
		f.hum_fac_4,
		f.hum_fac_5,
		f.hum_fac_6,
		f.hum_fac_7,
		f.hum_fac_8,
		f.age,
		f.sex,
		f.equip_inv,
		f.sup_fac_1,
		f.sup_fac_2,
		f.sup_fac_3,
		f.mob_invol,
		f.mob_type,
		f.mob_make,
		f.mob_model,
		f.mob_year,
		f.mob_lic_pl,
		f.mob_state,
		f.mob_vin_no,
		f.eq_brand,
		f.eq_model,
		f.eq_ser_no,
		f.eq_year,
		f.eq_power,
		f.eq_port,
		f.fire_sprd,
		f.struc_type,
		f.struc_stat,
		f.bldg_above,
		f.bldg_below,
		f.bldg_lgth,
		f.bldg_width,
		f.tot_sq_ft,
		f.fire_orig,
		f.st_dm_min_update,
		f.st_dm_sig,
		f.st_dam_hvy,
		f.st_dam_xtr,
		f.flame_sprd,
		f.item_sprd,
		f.mat_sprd,
		f.detector,
		f.det_type,
		f.det_power,
		f.det_operat,
		f.det_effect,
		f.det_fail,
		f.aes_pres,
		f.aes_type,
		f.aes_oper,
		f.no_spr_op,
		f.aes_fail
    FROM basicincident_processed b
    LEFT JOIN fdheader_processed fd
        ON b.fdid = fd.fdid AND b.state = fd.state
    LEFT JOIN fireincident_processed f
        ON b.incident_key = f.incident_key AND b.inc_no = f.inc_no
)


SELECT * FROM incidents_processed_final
    );
  
  
[0m17:50:02.482601 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:50:02.490636 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: ROLLBACK
[0m17:50:02.490880 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__incidents'
[0m17:50:02.490880 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: Close
[0m17:50:02.499138 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__incidents (models\nfirs_processed\nfirs_processed__incidents.sql)
  Parser Error: syntax error at or near "."
[0m17:50:02.499138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f2c0007-0d2f-4ba0-a501-020105a60f84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D609BB78F0>]}
[0m17:50:02.499138 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__incidents  [[31mERROR[0m in 0.07s]
[0m17:50:02.499138 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:50:02.499138 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:02.499138 [debug] [MainThread]: On master: BEGIN
[0m17:50:02.507223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:02.523524 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:50:02.523524 [debug] [MainThread]: On master: COMMIT
[0m17:50:02.523524 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:02.523524 [debug] [MainThread]: On master: COMMIT
[0m17:50:02.523524 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:50:02.523524 [debug] [MainThread]: On master: Close
[0m17:50:02.531494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:02.531494 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m17:50:02.531494 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m17:50:02.531494 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:50:02.531494 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:50:02.531494 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents' was properly closed.
[0m17:50:02.531494 [info ] [MainThread]: 
[0m17:50:02.531494 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m17:50:02.531494 [debug] [MainThread]: Command end result
[0m17:50:02.555802 [info ] [MainThread]: 
[0m17:50:02.555802 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:50:02.555802 [info ] [MainThread]: 
[0m17:50:02.555802 [error] [MainThread]:   Runtime Error in model nfirs_processed__incidents (models\nfirs_processed\nfirs_processed__incidents.sql)
  Parser Error: syntax error at or near "."
[0m17:50:02.555802 [info ] [MainThread]: 
[0m17:50:02.555802 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:50:02.555802 [debug] [MainThread]: Command `cli run` failed at 17:50:02.555802 after 0.93 seconds
[0m17:50:02.555802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D609BE5CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60A1C2660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D60B97EAB0>]}
[0m17:50:02.555802 [debug] [MainThread]: Flushing usage events
[0m17:50:33.611242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EF80F8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EE0DC0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182C4FA1D30>]}


============================== 17:50:33.619265 | 227d03d6-c9b4-4a71-a0b7-65fa6ab9034f ==============================
[0m17:50:33.619265 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:50:33.619265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:50:33.772041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '227d03d6-c9b4-4a71-a0b7-65fa6ab9034f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182EFCF4560>]}
[0m17:50:33.809584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '227d03d6-c9b4-4a71-a0b7-65fa6ab9034f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F24B4B30>]}
[0m17:50:33.809584 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:50:33.817991 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:50:33.953113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:33.953113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:33.985742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '227d03d6-c9b4-4a71-a0b7-65fa6ab9034f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F27A2900>]}
[0m17:50:34.066743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '227d03d6-c9b4-4a71-a0b7-65fa6ab9034f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F2B00F50>]}
[0m17:50:34.066743 [info ] [MainThread]: Found 22 models, 4 data tests, 19 sources, 524 macros
[0m17:50:34.066743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '227d03d6-c9b4-4a71-a0b7-65fa6ab9034f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F27DCE90>]}
[0m17:50:34.066743 [info ] [MainThread]: 
[0m17:50:34.066743 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:50:34.074781 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:50:34.131485 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:50:34.131485 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:50:34.131485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:34.147902 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:34.155926 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:50:34.155926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m17:50:34.155926 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m17:50:34.163966 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:50:34.163966 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:50:34.163966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:34.180088 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:34.180088 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:50:34.188534 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m17:50:34.188534 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:34.188534 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:50:34.188534 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m17:50:34.188534 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:34.188534 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m17:50:34.188534 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:50:34.188534 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m17:50:34.188534 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:34.188534 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m17:50:34.196706 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:50:34.196706 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:50:34.196706 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m17:50:34.204789 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:50:34.204789 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:50:34.204789 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:50:34.204789 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:50:34.204789 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:50:34.204789 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m17:50:34.204789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:34.204789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:34.204789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:34.228747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:34.228747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:34.228747 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:34.228747 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:50:34.228747 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:50:34.228747 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:50:34.228747 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:50:34.228747 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:50:34.228747 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m17:50:34.261779 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:34.261779 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:34.261779 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:50:34.269879 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m17:50:34.269879 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:50:34.269879 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:50:34.269879 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:50:34.269879 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m17:50:34.269879 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:50:34.269879 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:50:34.269879 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m17:50:34.277880 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:50:34.277880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '227d03d6-c9b4-4a71-a0b7-65fa6ab9034f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F2546090>]}
[0m17:50:34.277880 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:34.277880 [debug] [MainThread]: On master: BEGIN
[0m17:50:34.286048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:34.303117 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:50:34.303117 [debug] [MainThread]: On master: COMMIT
[0m17:50:34.303117 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:34.303117 [debug] [MainThread]: On master: COMMIT
[0m17:50:34.303117 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:50:34.303117 [debug] [MainThread]: On master: Close
[0m17:50:34.303117 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:50:34.311446 [info ] [MainThread]: 
[0m17:50:34.311627 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:50:34.311627 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents ........ [RUN]
[0m17:50:34.311627 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents'
[0m17:50:34.319688 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:50:34.319882 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:50:34.319882 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:50:34.344837 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:50:34.344837 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:50:34.344837 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: BEGIN
[0m17:50:34.344837 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:34.369451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:50:34.369451 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:50:34.369451 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents Table Creation *****/
/***
The below model will join the following tables together to for further analysis:
- nfirs_transformed__fdheader
- nfirs_transformed__basicincident
- nfirs_transformed__fireincident

The following logic will be applied:
- FD Header CTE to aggregate numeric columns
- Basic Incident CTE to select all columns from the respective table
- Fire Incident CTE to select all columns from the respective table
- The Basic Incident CTE serves at the base table and the FD Header and
  Fire Incident table are left joined to basic incident

All columns will be written out to clearly specify what columns are included
***/



-- Create FD Header CTEs
WITH transformed_fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader"
),

fdheader_processed AS (
    SELECT
        state,
        fdid,
        fd_name,
        fd_str_no,
        fd_str_pre,
        fd_street,
        fd_str_typ,
        fd_str_suf,
        fd_city,
        fd_zip,
        fd_phone,
        fd_fax,
        fd_email,
        fd_fip_cty,
        SUM(no_station) AS no_station,
        SUM(no_pd_ff) AS no_pd_ff,
        SUM(no_vol_ff) AS no_vol_ff,
        SUM(no_vol_pdc) AS no_vol_pdc
    FROM transformed_fdheader_source
    GROUP BY ALL
),

-- Create Basic Incident CTEs
transformed_basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident"
),

basicincident_processed AS (
    SELECT
        *
    FROM transformed_basicincident_source
),

-- Create Fire Incident CTEs
transformed_fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident"
),

fireincident_processed AS (
    SELECT
        *
    FROM fireincident_source
),

-- Join the three processed CTEs together
incidents_processed_final AS (
    SELECT
        fd.state,
        fd.fdid,
        fd.fd_name,
        fd.fd_str_no,
        fd.fd_str_pre,
        fd.fd_street,
        fd.fd_str_typ,
        fd.fd_str_suf,
        fd.fd_city,
        fd.fd_zip,
        fd.fd_phone,
        fd.fd_fax,
        fd.fd_email,
        fd.fd_fip_cty,
        b.incident_key,
	    b.inc_date,
	    b.inc_no,
        b.exp_no,
        b.dept_sta,
        b.inc_type,
        b.add_wild,
        b.aid,
        b.alarm,
        b.arrival,
        b.inc_cont,
        b.lu_clear,
        b.shift,
        b.alarms,
        b.district,
		b.act_tak1,
		b.act_tak2,
		b.act_tak3,
		b.app_mod,
		b.sup_app,
		b.ems_app,
		b.oth_app,
		b.sup_per,
		b.ems_per,
		b.oth_per,
		b.resou_aid,
		b.prop_loss,
		b.cont_loss,
		b.prop_val,
		b.cont_val,
		b.ff_death,
		b.oth_death,
		b.ff_inj,
		b.oth_inj,
		b.det_alert,
		b.haz_rel,
		b.mixed_use,
		b.prop_use,
		b.census,
        f.num_unit,
		f.not_res,
		f.bldg_invol,
		f.acres_burn,
		f.less_1acre,
		f.on_site_m1,
		f.mat_stor1,
		f.on_site_m2,
		f.mat_stor2,
		f.on_site_m3,
		f.mat_stor3,
		f.area_orig,
		f.heat_sourc,
		f.first_ign,
		f.conf_orig,
		f.type_mat,
		f.cause_ign,
		f.fact_ign_1,
		f.fact_ign_2,
		f.hum_fac_1,
		f.hum_fac_2,
		f.hum_fac_3,
		f.hum_fac_4,
		f.hum_fac_5,
		f.hum_fac_6,
		f.hum_fac_7,
		f.hum_fac_8,
		f.age,
		f.sex,
		f.equip_inv,
		f.sup_fac_1,
		f.sup_fac_2,
		f.sup_fac_3,
		f.mob_invol,
		f.mob_type,
		f.mob_make,
		f.mob_model,
		f.mob_year,
		f.mob_lic_pl,
		f.mob_state,
		f.mob_vin_no,
		f.eq_brand,
		f.eq_model,
		f.eq_ser_no,
		f.eq_year,
		f.eq_power,
		f.eq_port,
		f.fire_sprd,
		f.struc_type,
		f.struc_stat,
		f.bldg_above,
		f.bldg_below,
		f.bldg_lgth,
		f.bldg_width,
		f.tot_sq_ft,
		f.fire_orig,
		f.st_dm_min_update,
		f.st_dm_sig,
		f.st_dam_hvy,
		f.st_dam_xtr,
		f.flame_sprd,
		f.item_sprd,
		f.mat_sprd,
		f.detector,
		f.det_type,
		f.det_power,
		f.det_operat,
		f.det_effect,
		f.det_fail,
		f.aes_pres,
		f.aes_type,
		f.aes_oper,
		f.no_spr_op,
		f.aes_fail
    FROM basicincident_processed b
    LEFT JOIN fdheader_processed fd
        ON b.fdid = fd.fdid AND b.state = fd.state
    LEFT JOIN fireincident_processed f
        ON b.incident_key = f.incident_key AND b.inc_no = f.inc_no
)


SELECT * FROM incidents_processed_final
    );
  
  
[0m17:50:34.452928 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents Table Creation *****/
/***
The below model will join the following tables together to for further analysis:
- nfirs_transformed__fdheader
- nfirs_transformed__basicincident
- nfirs_transformed__fireincident

The following logic will be applied:
- FD Header CTE to aggregate numeric columns
- Basic Incident CTE to select all columns from the respective table
- Fire Incident CTE to select all columns from the respective table
- The Basic Incident CTE serves at the base table and the FD Header and
  Fire Incident table are left joined to basic incident

All columns will be written out to clearly specify what columns are included
***/



-- Create FD Header CTEs
WITH transformed_fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader"
),

fdheader_processed AS (
    SELECT
        state,
        fdid,
        fd_name,
        fd_str_no,
        fd_str_pre,
        fd_street,
        fd_str_typ,
        fd_str_suf,
        fd_city,
        fd_zip,
        fd_phone,
        fd_fax,
        fd_email,
        fd_fip_cty,
        SUM(no_station) AS no_station,
        SUM(no_pd_ff) AS no_pd_ff,
        SUM(no_vol_ff) AS no_vol_ff,
        SUM(no_vol_pdc) AS no_vol_pdc
    FROM transformed_fdheader_source
    GROUP BY ALL
),

-- Create Basic Incident CTEs
transformed_basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident"
),

basicincident_processed AS (
    SELECT
        *
    FROM transformed_basicincident_source
),

-- Create Fire Incident CTEs
transformed_fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident"
),

fireincident_processed AS (
    SELECT
        *
    FROM fireincident_source
),

-- Join the three processed CTEs together
incidents_processed_final AS (
    SELECT
        fd.state,
        fd.fdid,
        fd.fd_name,
        fd.fd_str_no,
        fd.fd_str_pre,
        fd.fd_street,
        fd.fd_str_typ,
        fd.fd_str_suf,
        fd.fd_city,
        fd.fd_zip,
        fd.fd_phone,
        fd.fd_fax,
        fd.fd_email,
        fd.fd_fip_cty,
        b.incident_key,
	    b.inc_date,
	    b.inc_no,
        b.exp_no,
        b.dept_sta,
        b.inc_type,
        b.add_wild,
        b.aid,
        b.alarm,
        b.arrival,
        b.inc_cont,
        b.lu_clear,
        b.shift,
        b.alarms,
        b.district,
		b.act_tak1,
		b.act_tak2,
		b.act_tak3,
		b.app_mod,
		b.sup_app,
		b.ems_app,
		b.oth_app,
		b.sup_per,
		b.ems_per,
		b.oth_per,
		b.resou_aid,
		b.prop_loss,
		b.cont_loss,
		b.prop_val,
		b.cont_val,
		b.ff_death,
		b.oth_death,
		b.ff_inj,
		b.oth_inj,
		b.det_alert,
		b.haz_rel,
		b.mixed_use,
		b.prop_use,
		b.census,
        f.num_unit,
		f.not_res,
		f.bldg_invol,
		f.acres_burn,
		f.less_1acre,
		f.on_site_m1,
		f.mat_stor1,
		f.on_site_m2,
		f.mat_stor2,
		f.on_site_m3,
		f.mat_stor3,
		f.area_orig,
		f.heat_sourc,
		f.first_ign,
		f.conf_orig,
		f.type_mat,
		f.cause_ign,
		f.fact_ign_1,
		f.fact_ign_2,
		f.hum_fac_1,
		f.hum_fac_2,
		f.hum_fac_3,
		f.hum_fac_4,
		f.hum_fac_5,
		f.hum_fac_6,
		f.hum_fac_7,
		f.hum_fac_8,
		f.age,
		f.sex,
		f.equip_inv,
		f.sup_fac_1,
		f.sup_fac_2,
		f.sup_fac_3,
		f.mob_invol,
		f.mob_type,
		f.mob_make,
		f.mob_model,
		f.mob_year,
		f.mob_lic_pl,
		f.mob_state,
		f.mob_vin_no,
		f.eq_brand,
		f.eq_model,
		f.eq_ser_no,
		f.eq_year,
		f.eq_power,
		f.eq_port,
		f.fire_sprd,
		f.struc_type,
		f.struc_stat,
		f.bldg_above,
		f.bldg_below,
		f.bldg_lgth,
		f.bldg_width,
		f.tot_sq_ft,
		f.fire_orig,
		f.st_dm_min_update,
		f.st_dm_sig,
		f.st_dam_hvy,
		f.st_dam_xtr,
		f.flame_sprd,
		f.item_sprd,
		f.mat_sprd,
		f.detector,
		f.det_type,
		f.det_power,
		f.det_operat,
		f.det_effect,
		f.det_fail,
		f.aes_pres,
		f.aes_type,
		f.aes_oper,
		f.no_spr_op,
		f.aes_fail
    FROM basicincident_processed b
    LEFT JOIN fdheader_processed fd
        ON b.fdid = fd.fdid AND b.state = fd.state
    LEFT JOIN fireincident_processed f
        ON b.incident_key = f.incident_key AND b.inc_no = f.inc_no
)


SELECT * FROM incidents_processed_final
    );
  
  
[0m17:50:34.452928 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:50:34.452928 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: ROLLBACK
[0m17:50:34.452928 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__incidents'
[0m17:50:34.452928 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: Close
[0m17:50:34.461456 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__incidents (models\nfirs_processed\nfirs_processed__incidents.sql)
  Catalog Error: Table with name fireincident_source does not exist!
  Did you mean "nfirs_raw.fireincident"?
  LINE 78:     FROM fireincident_source
                    ^
[0m17:50:34.461456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227d03d6-c9b4-4a71-a0b7-65fa6ab9034f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F09A7800>]}
[0m17:50:34.469638 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__incidents  [[31mERROR[0m in 0.15s]
[0m17:50:34.469638 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:50:34.469638 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:34.469638 [debug] [MainThread]: On master: BEGIN
[0m17:50:34.469638 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:34.493789 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:50:34.493789 [debug] [MainThread]: On master: COMMIT
[0m17:50:34.493789 [debug] [MainThread]: Using duckdb connection "master"
[0m17:50:34.493789 [debug] [MainThread]: On master: COMMIT
[0m17:50:34.493789 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:50:34.493789 [debug] [MainThread]: On master: Close
[0m17:50:34.493789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:34.501809 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m17:50:34.501809 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:50:34.501809 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:50:34.501809 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m17:50:34.501809 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents' was properly closed.
[0m17:50:34.501809 [info ] [MainThread]: 
[0m17:50:34.501809 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m17:50:34.501809 [debug] [MainThread]: Command end result
[0m17:50:34.526036 [info ] [MainThread]: 
[0m17:50:34.526036 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:50:34.526036 [info ] [MainThread]: 
[0m17:50:34.526036 [error] [MainThread]:   Runtime Error in model nfirs_processed__incidents (models\nfirs_processed\nfirs_processed__incidents.sql)
  Catalog Error: Table with name fireincident_source does not exist!
  Did you mean "nfirs_raw.fireincident"?
  LINE 78:     FROM fireincident_source
                    ^
[0m17:50:34.526036 [info ] [MainThread]: 
[0m17:50:34.526036 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:50:34.526036 [debug] [MainThread]: Command `cli run` failed at 17:50:34.526036 after 1.02 seconds
[0m17:50:34.526036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F0FA3FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F24EEF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182F0908F50>]}
[0m17:50:34.526036 [debug] [MainThread]: Flushing usage events
[0m17:51:54.519033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94CBE52E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94CBE5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94CBE5100>]}


============================== 17:51:54.527076 | e5b01a75-2555-4d45-bdb1-25b1387d650f ==============================
[0m17:51:54.527076 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:51:54.527076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:51:54.672127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5b01a75-2555-4d45-bdb1-25b1387d650f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94CC31E80>]}
[0m17:51:54.713539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5b01a75-2555-4d45-bdb1-25b1387d650f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94CD0BFB0>]}
[0m17:51:54.721630 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:51:54.729616 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:51:54.856884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:51:54.856884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:51:54.886590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5b01a75-2555-4d45-bdb1-25b1387d650f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94CF21730>]}
[0m17:51:54.967670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5b01a75-2555-4d45-bdb1-25b1387d650f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94D1D0EC0>]}
[0m17:51:54.967670 [info ] [MainThread]: Found 22 models, 4 data tests, 19 sources, 524 macros
[0m17:51:54.967670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5b01a75-2555-4d45-bdb1-25b1387d650f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94D011850>]}
[0m17:51:54.967670 [info ] [MainThread]: 
[0m17:51:54.967670 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:51:54.967670 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:51:55.027436 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:51:55.027436 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:51:55.027436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:55.051953 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:55.051953 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:51:55.059924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m17:51:55.059924 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m17:51:55.068162 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:51:55.068162 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:51:55.068162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:51:55.084762 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:55.084762 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:51:55.084762 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m17:51:55.084762 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:55.084762 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:51:55.093007 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m17:51:55.093007 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:55.093007 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m17:51:55.093007 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m17:51:55.093007 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m17:51:55.093007 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:55.093007 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m17:51:55.101074 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:51:55.109234 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m17:51:55.109234 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:51:55.109234 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:51:55.109234 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:51:55.109234 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:51:55.109234 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:51:55.109234 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m17:51:55.109234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:55.109234 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:51:55.109234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:55.133778 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:55.133778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:55.133778 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:55.133778 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:51:55.133778 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:55.133778 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:51:55.133778 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:51:55.133778 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:51:55.133778 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m17:51:55.133778 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:51:55.166185 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:55.166185 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:55.174238 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m17:51:55.174238 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m17:51:55.174238 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m17:51:55.174238 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:51:55.174238 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:51:55.174238 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:51:55.174238 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:51:55.174238 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:51:55.174238 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:51:55.174238 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:51:55.182277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5b01a75-2555-4d45-bdb1-25b1387d650f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94CCE5FA0>]}
[0m17:51:55.182277 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:55.182277 [debug] [MainThread]: On master: BEGIN
[0m17:51:55.182277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:51:55.207160 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:51:55.207160 [debug] [MainThread]: On master: COMMIT
[0m17:51:55.207160 [debug] [MainThread]: Using duckdb connection "master"
[0m17:51:55.207160 [debug] [MainThread]: On master: COMMIT
[0m17:51:55.207160 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:51:55.207160 [debug] [MainThread]: On master: Close
[0m17:51:55.215497 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:51:55.215497 [info ] [MainThread]: 
[0m17:51:55.215497 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:51:55.215497 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents ........ [RUN]
[0m17:51:55.215497 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents'
[0m17:51:55.215497 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:51:55.223576 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:51:55.223576 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:51:55.247826 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:51:55.247826 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:51:55.247826 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: BEGIN
[0m17:51:55.247826 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:55.271858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:51:55.271858 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:51:55.271858 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents Table Creation *****/
/***
The below model will join the following tables together to for further analysis:
- nfirs_transformed__fdheader
- nfirs_transformed__basicincident
- nfirs_transformed__fireincident

The following logic will be applied:
- FD Header CTE to aggregate numeric columns
- Basic Incident CTE to select all columns from the respective table
- Fire Incident CTE to select all columns from the respective table
- The Basic Incident CTE serves at the base table and the FD Header and
  Fire Incident table are left joined to basic incident

All columns will be written out to clearly specify what columns are included
***/



-- Create FD Header CTEs
WITH transformed_fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader"
),

fdheader_processed AS (
    SELECT
        state,
        fdid,
        fd_name,
        fd_str_no,
        fd_str_pre,
        fd_street,
        fd_str_typ,
        fd_str_suf,
        fd_city,
        fd_zip,
        fd_phone,
        fd_fax,
        fd_email,
        fd_fip_cty,
        SUM(no_station) AS no_station,
        SUM(no_pd_ff) AS no_pd_ff,
        SUM(no_vol_ff) AS no_vol_ff,
        SUM(no_vol_pdc) AS no_vol_pdc
    FROM transformed_fdheader_source
    GROUP BY ALL
),

-- Create Basic Incident CTEs
transformed_basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident"
),

basicincident_processed AS (
    SELECT
        *
    FROM transformed_basicincident_source
),

-- Create Fire Incident CTEs
transformed_fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident"
),

fireincident_processed AS (
    SELECT
        *
    FROM transformed_fireincident_source
),

-- Join the three processed CTEs together
incidents_processed_final AS (
    SELECT
        fd.state,
        fd.fdid,
        fd.fd_name,
        fd.fd_str_no,
        fd.fd_str_pre,
        fd.fd_street,
        fd.fd_str_typ,
        fd.fd_str_suf,
        fd.fd_city,
        fd.fd_zip,
        fd.fd_phone,
        fd.fd_fax,
        fd.fd_email,
        fd.fd_fip_cty,
        b.incident_key,
	    b.inc_date,
	    b.inc_no,
        b.exp_no,
        b.dept_sta,
        b.inc_type,
        b.add_wild,
        b.aid,
        b.alarm,
        b.arrival,
        b.inc_cont,
        b.lu_clear,
        b.shift,
        b.alarms,
        b.district,
		b.act_tak1,
		b.act_tak2,
		b.act_tak3,
		b.app_mod,
		b.sup_app,
		b.ems_app,
		b.oth_app,
		b.sup_per,
		b.ems_per,
		b.oth_per,
		b.resou_aid,
		b.prop_loss,
		b.cont_loss,
		b.prop_val,
		b.cont_val,
		b.ff_death,
		b.oth_death,
		b.ff_inj,
		b.oth_inj,
		b.det_alert,
		b.haz_rel,
		b.mixed_use,
		b.prop_use,
		b.census,
        f.num_unit,
		f.not_res,
		f.bldg_invol,
		f.acres_burn,
		f.less_1acre,
		f.on_site_m1,
		f.mat_stor1,
		f.on_site_m2,
		f.mat_stor2,
		f.on_site_m3,
		f.mat_stor3,
		f.area_orig,
		f.heat_sourc,
		f.first_ign,
		f.conf_orig,
		f.type_mat,
		f.cause_ign,
		f.fact_ign_1,
		f.fact_ign_2,
		f.hum_fac_1,
		f.hum_fac_2,
		f.hum_fac_3,
		f.hum_fac_4,
		f.hum_fac_5,
		f.hum_fac_6,
		f.hum_fac_7,
		f.hum_fac_8,
		f.age,
		f.sex,
		f.equip_inv,
		f.sup_fac_1,
		f.sup_fac_2,
		f.sup_fac_3,
		f.mob_invol,
		f.mob_type,
		f.mob_make,
		f.mob_model,
		f.mob_year,
		f.mob_lic_pl,
		f.mob_state,
		f.mob_vin_no,
		f.eq_brand,
		f.eq_model,
		f.eq_ser_no,
		f.eq_year,
		f.eq_power,
		f.eq_port,
		f.fire_sprd,
		f.struc_type,
		f.struc_stat,
		f.bldg_above,
		f.bldg_below,
		f.bldg_lgth,
		f.bldg_width,
		f.tot_sq_ft,
		f.fire_orig,
		f.st_dm_min_update,
		f.st_dm_sig,
		f.st_dam_hvy,
		f.st_dam_xtr,
		f.flame_sprd,
		f.item_sprd,
		f.mat_sprd,
		f.detector,
		f.det_type,
		f.det_power,
		f.det_operat,
		f.det_effect,
		f.det_fail,
		f.aes_pres,
		f.aes_type,
		f.aes_oper,
		f.no_spr_op,
		f.aes_fail
    FROM basicincident_processed b
    LEFT JOIN fdheader_processed fd
        ON b.fdid = fd.fdid AND b.state = fd.state
    LEFT JOIN fireincident_processed f
        ON b.incident_key = f.incident_key AND b.inc_no = f.inc_no
)


SELECT * FROM incidents_processed_final
    );
  
  
[0m17:55:28.890951 [debug] [Thread-1 (]: SQL status: OK in 214.0 seconds
[0m17:55:28.894334 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:55:28.894334 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp" rename to "nfirs_processed__incidents"
[0m17:55:28.898935 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:55:28.913476 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: COMMIT
[0m17:55:28.913476 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:55:28.913476 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: COMMIT
[0m17:55:50.757446 [debug] [Thread-1 (]: SQL status: OK in 22.0 seconds
[0m17:55:50.764272 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m17:55:50.765866 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */
drop table if exists "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_backup" cascade
[0m17:55:50.765866 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:55:50.765866 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: Close
[0m17:55:56.177398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5b01a75-2555-4d45-bdb1-25b1387d650f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94A44F470>]}
[0m17:55:56.178598 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_processed.nfirs_processed__incidents ... [[32mOK[0m in 240.96s]
[0m17:55:56.180791 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m17:55:56.184125 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:56.184125 [debug] [MainThread]: On master: BEGIN
[0m17:55:56.184125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:56.243861 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:55:56.243861 [debug] [MainThread]: On master: COMMIT
[0m17:55:56.243861 [debug] [MainThread]: Using duckdb connection "master"
[0m17:55:56.248914 [debug] [MainThread]: On master: COMMIT
[0m17:55:56.250329 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:55:56.250329 [debug] [MainThread]: On master: Close
[0m17:55:56.284314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:56.284314 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m17:55:56.284314 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:55:56.284314 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m17:55:56.284314 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:55:56.284314 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents' was properly closed.
[0m17:55:56.297789 [info ] [MainThread]: 
[0m17:55:56.297789 [info ] [MainThread]: Finished running 1 table model in 0 hours 4 minutes and 1.33 seconds (241.33s).
[0m17:55:56.297789 [debug] [MainThread]: Command end result
[0m17:55:56.378983 [info ] [MainThread]: 
[0m17:55:56.378983 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:56.384357 [info ] [MainThread]: 
[0m17:55:56.384357 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:55:56.384357 [debug] [MainThread]: Command `cli run` succeeded at 17:55:56.384357 after 241.98 seconds
[0m17:55:56.384357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94B6C6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94D608620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B94B603380>]}
[0m17:55:56.384357 [debug] [MainThread]: Flushing usage events
[0m10:58:22.571668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256496B89B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025647C073E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564832B650>]}


============================== 10:58:22.587335 | cb3a01dc-759e-4705-81b2-ef3523e8b7d5 ==============================
[0m10:58:22.587335 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:58:22.587335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:58:22.746038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb3a01dc-759e-4705-81b2-ef3523e8b7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256498BE600>]}
[0m10:58:22.786995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb3a01dc-759e-4705-81b2-ef3523e8b7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256498C9BB0>]}
[0m10:58:22.787999 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m10:58:22.797042 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:58:22.924032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:58:22.925035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:58:22.956232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb3a01dc-759e-4705-81b2-ef3523e8b7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025649B47920>]}
[0m10:58:23.191682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb3a01dc-759e-4705-81b2-ef3523e8b7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025649C811F0>]}
[0m10:58:23.192659 [info ] [MainThread]: Found 23 models, 4 data tests, 19 sources, 524 macros
[0m10:58:23.192659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb3a01dc-759e-4705-81b2-ef3523e8b7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025649ACD1C0>]}
[0m10:58:23.194733 [info ] [MainThread]: 
[0m10:58:23.194733 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:58:23.195749 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m10:58:23.502763 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m10:58:23.502763 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m10:58:23.502763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:23.606667 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m10:58:23.606667 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m10:58:23.607744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:23.608706 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m10:58:23.608706 [info ] [MainThread]: 
[0m10:58:23.608706 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m10:58:23.609677 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 12052)
[0m10:58:23.610670 [debug] [MainThread]: Command `cli run` failed at 10:58:23.609677 after 1.14 seconds
[0m10:58:23.610670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256493AA4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564A14E690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002564A14CAA0>]}
[0m10:58:23.610670 [debug] [MainThread]: Flushing usage events
[0m10:58:37.496759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177F7558DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177F634F920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177F8F89190>]}


============================== 10:58:37.496759 | 8d9a2653-0cbc-482c-a58c-557c8fd73f28 ==============================
[0m10:58:37.496759 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:58:37.496759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:58:37.654210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d9a2653-0cbc-482c-a58c-557c8fd73f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177F8B518E0>]}
[0m10:58:37.696793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d9a2653-0cbc-482c-a58c-557c8fd73f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177F9038230>]}
[0m10:58:37.696793 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m10:58:37.714880 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:58:37.846733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:58:37.846733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:58:37.879985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d9a2653-0cbc-482c-a58c-557c8fd73f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177F92D97F0>]}
[0m10:58:37.946868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d9a2653-0cbc-482c-a58c-557c8fd73f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177F93480B0>]}
[0m10:58:37.946868 [info ] [MainThread]: Found 23 models, 4 data tests, 19 sources, 524 macros
[0m10:58:37.946868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d9a2653-0cbc-482c-a58c-557c8fd73f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177F74F7380>]}
[0m10:58:37.946868 [info ] [MainThread]: 
[0m10:58:37.946868 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:58:37.946868 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m10:58:38.015634 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m10:58:38.015634 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m10:58:38.015634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:38.113363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:38.113363 [debug] [ThreadPool]: On list_nfirs: Close
[0m10:58:38.113363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m10:58:38.113363 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m10:58:38.130032 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:58:38.130032 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m10:58:38.130032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:38.146754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:38.146754 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:58:38.146754 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m10:58:38.146754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:38.146754 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:58:38.146754 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m10:58:38.146754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:38.162699 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m10:58:38.163271 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:58:38.163271 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m10:58:38.163271 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:38.163271 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m10:58:38.163271 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m10:58:38.178969 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:58:38.179890 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m10:58:38.179890 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m10:58:38.179890 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m10:58:38.179890 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:58:38.179890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:38.179890 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:58:38.179890 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m10:58:38.196456 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m10:58:38.196456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:38.196456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:38.196456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:38.196456 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:58:38.196456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:38.196456 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:38.196456 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m10:58:38.196456 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:58:38.196456 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:58:38.196456 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m10:58:38.196456 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m10:58:38.247016 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:38.247016 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:38.247016 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:38.255061 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m10:58:38.255061 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m10:58:38.255061 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m10:58:38.255061 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m10:58:38.255061 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m10:58:38.262667 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m10:58:38.262667 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m10:58:38.262667 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m10:58:38.262667 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m10:58:38.270743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d9a2653-0cbc-482c-a58c-557c8fd73f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177F922F200>]}
[0m10:58:38.270743 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:38.270743 [debug] [MainThread]: On master: BEGIN
[0m10:58:38.270743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:38.280520 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:58:38.280520 [debug] [MainThread]: On master: COMMIT
[0m10:58:38.280520 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:38.280520 [debug] [MainThread]: On master: COMMIT
[0m10:58:38.295983 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:58:38.295983 [debug] [MainThread]: On master: Close
[0m10:58:38.297797 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:58:38.297797 [info ] [MainThread]: 
[0m10:58:38.297797 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup
[0m10:58:38.297797 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents_codelookup  [RUN]
[0m10:58:38.297797 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup'
[0m10:58:38.297797 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup
[0m10:58:38.318181 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m10:58:38.318181 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup
[0m10:58:38.331815 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m10:58:38.348379 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m10:58:38.348379 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: BEGIN
[0m10:58:38.348379 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:58:38.363298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:58:38.363298 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m10:58:38.363298 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_codelookup__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents with Code Descriptions Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)

The following logic will be applied:
- nfirs_processed__incidents served as the base table
- Create CTEs for INC_TYPE, ACT_TAK1, ACT_TAK2, ACT_TAK3, SUP_FAC_1,
  SUP_FAC_2, SUP_FAC_3, DETECTOR, DET_TYPE, DET_OPERAT, DET_EFFECT,
  DET_FAIL, AES_PRES, AES_TYPE, AES_OPER, AES_FAIL

All columns will be taken from nfirs_processed__incidents and the code
descriptions for the above fields/codes.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Code Lookup CTEs
inc_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'INC_TYPE'
),

act_tak1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK1'
),

act_tak2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK2'
),

act_tak3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK3'
),

sup_fac_1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'SUP_FAC_1'
),

sup_fac_2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'SUP_FAC_2'
),

sup_fac_3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'SUP_FAC_3'
),

detector_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DETECTOR'
),

det_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_TYPE'
),

det_power_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_POWER'
),

det_operat_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_OPERAT'
),

det_effect_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_EFFECT'
),

det_fail_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_FAIL'
),

aes_pres_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_PRES'
),

aes_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_TYPE'
),

aes_oper_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_OPER'
),

aes_fail_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_FAIL'
)

incidents_codelookup_final AS (
    SELECT
        inc.*,
        inc_type.code_descr AS inc_type_code_descr,
		act_tak1.code_descr AS act_tak1_code_descr,
		act_tak2.code_descr AS act_tak2_code_descr,
		act_tak3.code_descr AS act_tak3_code_descr,
		sup_fac_1.code_descr AS sup_fac_1_code_descr,
		sup_fac_2.code_descr AS sup_fac_2_code_descr,
		sup_fac_3.code_descr AS sup_fac_4_code_descr,
		det.code_descr AS detector_code_descr,
		det_type.code_descr AS det_type_code_descr,
		det_power.code_descr AS det_power_code_descr,
		det_operat.code_descr AS det_operat_code_descr,
		det_fail.code_descr AS det_fail_code_descr,
		aes_pres.code_descr AS aes_pres_code_descr,
		aes_type.code_descr AS aes_type_code_descr,
		aes_oper.code_descr AS aes_oper_code_descr,
		aes_fail.code_descr AS aes_fail_code_descr
    FROM incidents_source inc
    LEFT JOIN inc_type_code_lookup_source inc_type
        ON inc.inc_type = inc_type.code_value
    LEFT JOIN act_tak1_code_lookup_source act_tak1
        ON inc.act_tak1 = act_tak1.code_value
    LEFT JOIN act_tak2_code_lookup_source act_tak2
        ON inc.act_tak2 = act_tak2.code_value
    LEFT JOIN act_tak3_code_lookup_source act_tak3
        ON inc.act_tak3 = act_tak3.code_value
    LEFT JOIN sup_fac_1_code_lookup_source sup_fac_1
        ON inc.sup_fac_1 = sup_fac_1.code_value
    LEFT JOIN sup_fac_2_code_lookup_source sup_fac_2
        ON inc.sup_fac_2 = sup_fac_2.code_value
    LEFT JOIN sup_fac_3_code_lookup_source sup_fac_3
        ON inc.sup_fac_3 = sup_fac_3.code_value
    LEFT JOIN detector_code_lookup_source det
        ON inc.detector = det.code_value
    LEFT JOIN det_type_code_lookup_source det_type
        ON inc.det_type = det_type.code_value
    LEFT JOIN det_power_code_lookup_source det_power
        ON inc.det_power = det_power.code_value
    LEFT JOIN det_operat_code_lookup_source det_operat
        ON inc.det_operat = det_operat.code_value
    LEFT JOIN det_fail_code_lookup_source det_fail
        ON inc.det_fail = det_fail.code_value
    LEFT JOIN aes_pres_code_lookup_source aes_pres
        ON inc.aes_pres = aes_pres.code_value
    LEFT JOIN aes_type_code_lookup_source aes_type
        ON inc.aes_type = aes_type.code_value
    LEFT JOIN aes_oper_code_lookup_source aes_oper
        ON inc.aes_oper = aes_oper.code_value
    LEFT JOIN aes_fail_code_lookup_source aes_fail
        ON inc.aes_fail = aes_fail.code_value
)

SELECT * FROM incidents_codelookup_final
    );
  
  
[0m10:58:38.363298 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_codelookup__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents with Code Descriptions Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)

The following logic will be applied:
- nfirs_processed__incidents served as the base table
- Create CTEs for INC_TYPE, ACT_TAK1, ACT_TAK2, ACT_TAK3, SUP_FAC_1,
  SUP_FAC_2, SUP_FAC_3, DETECTOR, DET_TYPE, DET_OPERAT, DET_EFFECT,
  DET_FAIL, AES_PRES, AES_TYPE, AES_OPER, AES_FAIL

All columns will be taken from nfirs_processed__incidents and the code
descriptions for the above fields/codes.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Code Lookup CTEs
inc_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'INC_TYPE'
),

act_tak1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK1'
),

act_tak2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK2'
),

act_tak3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK3'
),

sup_fac_1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'SUP_FAC_1'
),

sup_fac_2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'SUP_FAC_2'
),

sup_fac_3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'SUP_FAC_3'
),

detector_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DETECTOR'
),

det_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_TYPE'
),

det_power_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_POWER'
),

det_operat_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_OPERAT'
),

det_effect_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_EFFECT'
),

det_fail_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_FAIL'
),

aes_pres_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_PRES'
),

aes_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_TYPE'
),

aes_oper_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_OPER'
),

aes_fail_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_FAIL'
)

incidents_codelookup_final AS (
    SELECT
        inc.*,
        inc_type.code_descr AS inc_type_code_descr,
		act_tak1.code_descr AS act_tak1_code_descr,
		act_tak2.code_descr AS act_tak2_code_descr,
		act_tak3.code_descr AS act_tak3_code_descr,
		sup_fac_1.code_descr AS sup_fac_1_code_descr,
		sup_fac_2.code_descr AS sup_fac_2_code_descr,
		sup_fac_3.code_descr AS sup_fac_4_code_descr,
		det.code_descr AS detector_code_descr,
		det_type.code_descr AS det_type_code_descr,
		det_power.code_descr AS det_power_code_descr,
		det_operat.code_descr AS det_operat_code_descr,
		det_fail.code_descr AS det_fail_code_descr,
		aes_pres.code_descr AS aes_pres_code_descr,
		aes_type.code_descr AS aes_type_code_descr,
		aes_oper.code_descr AS aes_oper_code_descr,
		aes_fail.code_descr AS aes_fail_code_descr
    FROM incidents_source inc
    LEFT JOIN inc_type_code_lookup_source inc_type
        ON inc.inc_type = inc_type.code_value
    LEFT JOIN act_tak1_code_lookup_source act_tak1
        ON inc.act_tak1 = act_tak1.code_value
    LEFT JOIN act_tak2_code_lookup_source act_tak2
        ON inc.act_tak2 = act_tak2.code_value
    LEFT JOIN act_tak3_code_lookup_source act_tak3
        ON inc.act_tak3 = act_tak3.code_value
    LEFT JOIN sup_fac_1_code_lookup_source sup_fac_1
        ON inc.sup_fac_1 = sup_fac_1.code_value
    LEFT JOIN sup_fac_2_code_lookup_source sup_fac_2
        ON inc.sup_fac_2 = sup_fac_2.code_value
    LEFT JOIN sup_fac_3_code_lookup_source sup_fac_3
        ON inc.sup_fac_3 = sup_fac_3.code_value
    LEFT JOIN detector_code_lookup_source det
        ON inc.detector = det.code_value
    LEFT JOIN det_type_code_lookup_source det_type
        ON inc.det_type = det_type.code_value
    LEFT JOIN det_power_code_lookup_source det_power
        ON inc.det_power = det_power.code_value
    LEFT JOIN det_operat_code_lookup_source det_operat
        ON inc.det_operat = det_operat.code_value
    LEFT JOIN det_fail_code_lookup_source det_fail
        ON inc.det_fail = det_fail.code_value
    LEFT JOIN aes_pres_code_lookup_source aes_pres
        ON inc.aes_pres = aes_pres.code_value
    LEFT JOIN aes_type_code_lookup_source aes_type
        ON inc.aes_type = aes_type.code_value
    LEFT JOIN aes_oper_code_lookup_source aes_oper
        ON inc.aes_oper = aes_oper.code_value
    LEFT JOIN aes_fail_code_lookup_source aes_fail
        ON inc.aes_fail = aes_fail.code_value
)

SELECT * FROM incidents_codelookup_final
    );
  
  
[0m10:58:38.363298 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:58:38.363298 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: ROLLBACK
[0m10:58:38.379809 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup'
[0m10:58:38.379809 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: Close
[0m10:58:38.396452 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__incidents_codelookup (models\nfirs_processed\nfirs_processed__incidents_codelookup.sql)
  Parser Error: syntax error at or near "incidents_codelookup_final"
[0m10:58:38.396452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d9a2653-0cbc-482c-a58c-557c8fd73f28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177F74F79E0>]}
[0m10:58:38.396452 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__incidents_codelookup  [[31mERROR[0m in 0.10s]
[0m10:58:38.396452 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup
[0m10:58:38.396452 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:38.396452 [debug] [MainThread]: On master: BEGIN
[0m10:58:38.396452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:38.420878 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:58:38.420878 [debug] [MainThread]: On master: COMMIT
[0m10:58:38.420878 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:38.420878 [debug] [MainThread]: On master: COMMIT
[0m10:58:38.420878 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:58:38.420878 [debug] [MainThread]: On master: Close
[0m10:58:38.420878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:38.429252 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m10:58:38.429252 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m10:58:38.429252 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m10:58:38.429252 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m10:58:38.429252 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup' was properly closed.
[0m10:58:38.429252 [info ] [MainThread]: 
[0m10:58:38.429252 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m10:58:38.429252 [debug] [MainThread]: Command end result
[0m10:58:38.457355 [info ] [MainThread]: 
[0m10:58:38.457355 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:58:38.457355 [info ] [MainThread]: 
[0m10:58:38.457355 [error] [MainThread]:   Runtime Error in model nfirs_processed__incidents_codelookup (models\nfirs_processed\nfirs_processed__incidents_codelookup.sql)
  Parser Error: syntax error at or near "incidents_codelookup_final"
[0m10:58:38.457355 [info ] [MainThread]: 
[0m10:58:38.457355 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:58:38.457355 [debug] [MainThread]: Command `cli run` failed at 10:58:38.457355 after 1.07 seconds
[0m10:58:38.457355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177F8F88C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177F8F88B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000177F8E2A030>]}
[0m10:58:38.457355 [debug] [MainThread]: Flushing usage events
[0m10:59:40.104784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012FFF4AAC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F8D5EFD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F8D5EF080>]}


============================== 10:59:40.121367 | 639c1041-901c-4d23-88aa-0e3b0b593083 ==============================
[0m10:59:40.121367 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:59:40.121367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:59:40.354718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '639c1041-901c-4d23-88aa-0e3b0b593083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F8F834590>]}
[0m10:59:40.404891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '639c1041-901c-4d23-88aa-0e3b0b593083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F8F81D4F0>]}
[0m10:59:40.419161 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m10:59:40.421329 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:59:40.621360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:59:40.621360 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:59:40.671380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '639c1041-901c-4d23-88aa-0e3b0b593083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F8F9FF920>]}
[0m10:59:40.771308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '639c1041-901c-4d23-88aa-0e3b0b593083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F8FA9A180>]}
[0m10:59:40.771308 [info ] [MainThread]: Found 23 models, 4 data tests, 19 sources, 524 macros
[0m10:59:40.771308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '639c1041-901c-4d23-88aa-0e3b0b593083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F8F81CB90>]}
[0m10:59:40.785582 [info ] [MainThread]: 
[0m10:59:40.788068 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:59:40.788068 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m10:59:40.871752 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m10:59:40.871752 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m10:59:40.871752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:40.904735 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:59:40.904735 [debug] [ThreadPool]: On list_nfirs: Close
[0m10:59:40.921241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m10:59:40.921241 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m10:59:40.921241 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:59:40.921241 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m10:59:40.921241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:59:40.968885 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:59:40.971400 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:59:40.971400 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m10:59:40.971400 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:59:40.971400 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:59:40.971400 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m10:59:40.971400 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:59:40.971400 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m10:59:40.971400 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:59:40.971400 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m10:59:40.971400 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:59:40.971400 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m10:59:40.993495 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m10:59:40.993495 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m10:59:41.004631 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:59:41.004631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m10:59:41.004631 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:59:41.004631 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m10:59:41.004631 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:59:41.004631 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m10:59:41.004631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:41.004631 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m10:59:41.004631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:41.038133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:41.038133 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:59:41.038133 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:59:41.038133 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:59:41.038133 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:59:41.038133 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:59:41.038133 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:59:41.038133 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m10:59:41.038133 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m10:59:41.038133 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m10:59:41.088646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:59:41.088646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:59:41.088646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:59:41.088646 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m10:59:41.088646 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m10:59:41.102272 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m10:59:41.102272 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m10:59:41.104878 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m10:59:41.104878 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m10:59:41.104878 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m10:59:41.104878 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m10:59:41.104878 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m10:59:41.119016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '639c1041-901c-4d23-88aa-0e3b0b593083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F8D1905C0>]}
[0m10:59:41.119016 [debug] [MainThread]: Using duckdb connection "master"
[0m10:59:41.119016 [debug] [MainThread]: On master: BEGIN
[0m10:59:41.121653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:41.138297 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:59:41.138297 [debug] [MainThread]: On master: COMMIT
[0m10:59:41.138297 [debug] [MainThread]: Using duckdb connection "master"
[0m10:59:41.138297 [debug] [MainThread]: On master: COMMIT
[0m10:59:41.138297 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:59:41.138297 [debug] [MainThread]: On master: Close
[0m10:59:41.154623 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:59:41.154623 [info ] [MainThread]: 
[0m10:59:41.154623 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup
[0m10:59:41.154623 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents_codelookup  [RUN]
[0m10:59:41.154623 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup'
[0m10:59:41.154623 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup
[0m10:59:41.176615 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m10:59:41.176615 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup
[0m10:59:41.218936 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m10:59:41.218936 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m10:59:41.218936 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: BEGIN
[0m10:59:41.218936 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:59:41.243578 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:59:41.243578 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m10:59:41.252111 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_codelookup__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents with Code Descriptions Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)

The following logic will be applied:
- nfirs_processed__incidents served as the base table
- Create CTEs for INC_TYPE, ACT_TAK1, ACT_TAK2, ACT_TAK3, SUP_FAC_1,
  SUP_FAC_2, SUP_FAC_3, DETECTOR, DET_TYPE, DET_OPERAT, DET_EFFECT,
  DET_FAIL, AES_PRES, AES_TYPE, AES_OPER, AES_FAIL

All columns will be taken from nfirs_processed__incidents and the code
descriptions for the above fields/codes.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Code Lookup CTEs
inc_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'INC_TYPE'
),

act_tak1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK1'
),

act_tak2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK2'
),

act_tak3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK3'
),

sup_fac_1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'SUP_FAC_1'
),

sup_fac_2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'SUP_FAC_2'
),

sup_fac_3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'SUP_FAC_3'
),

detector_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DETECTOR'
),

det_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_TYPE'
),

det_power_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_POWER'
),

det_operat_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_OPERAT'
),

det_effect_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_EFFECT'
),

det_fail_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_FAIL'
),

aes_pres_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_PRES'
),

aes_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_TYPE'
),

aes_oper_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_OPER'
),

aes_fail_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_FAIL'
),

incidents_codelookup_final AS (
    SELECT
        inc.*,
        inc_type.code_descr AS inc_type_code_descr,
		act_tak1.code_descr AS act_tak1_code_descr,
		act_tak2.code_descr AS act_tak2_code_descr,
		act_tak3.code_descr AS act_tak3_code_descr,
		sup_fac_1.code_descr AS sup_fac_1_code_descr,
		sup_fac_2.code_descr AS sup_fac_2_code_descr,
		sup_fac_3.code_descr AS sup_fac_4_code_descr,
		det.code_descr AS detector_code_descr,
		det_type.code_descr AS det_type_code_descr,
		det_power.code_descr AS det_power_code_descr,
		det_operat.code_descr AS det_operat_code_descr,
		det_fail.code_descr AS det_fail_code_descr,
		aes_pres.code_descr AS aes_pres_code_descr,
		aes_type.code_descr AS aes_type_code_descr,
		aes_oper.code_descr AS aes_oper_code_descr,
		aes_fail.code_descr AS aes_fail_code_descr
    FROM incidents_source inc
    LEFT JOIN inc_type_code_lookup_source inc_type
        ON inc.inc_type = inc_type.code_value
    LEFT JOIN act_tak1_code_lookup_source act_tak1
        ON inc.act_tak1 = act_tak1.code_value
    LEFT JOIN act_tak2_code_lookup_source act_tak2
        ON inc.act_tak2 = act_tak2.code_value
    LEFT JOIN act_tak3_code_lookup_source act_tak3
        ON inc.act_tak3 = act_tak3.code_value
    LEFT JOIN sup_fac_1_code_lookup_source sup_fac_1
        ON inc.sup_fac_1 = sup_fac_1.code_value
    LEFT JOIN sup_fac_2_code_lookup_source sup_fac_2
        ON inc.sup_fac_2 = sup_fac_2.code_value
    LEFT JOIN sup_fac_3_code_lookup_source sup_fac_3
        ON inc.sup_fac_3 = sup_fac_3.code_value
    LEFT JOIN detector_code_lookup_source det
        ON inc.detector = det.code_value
    LEFT JOIN det_type_code_lookup_source det_type
        ON inc.det_type = det_type.code_value
    LEFT JOIN det_power_code_lookup_source det_power
        ON inc.det_power = det_power.code_value
    LEFT JOIN det_operat_code_lookup_source det_operat
        ON inc.det_operat = det_operat.code_value
    LEFT JOIN det_fail_code_lookup_source det_fail
        ON inc.det_fail = det_fail.code_value
    LEFT JOIN aes_pres_code_lookup_source aes_pres
        ON inc.aes_pres = aes_pres.code_value
    LEFT JOIN aes_type_code_lookup_source aes_type
        ON inc.aes_type = aes_type.code_value
    LEFT JOIN aes_oper_code_lookup_source aes_oper
        ON inc.aes_oper = aes_oper.code_value
    LEFT JOIN aes_fail_code_lookup_source aes_fail
        ON inc.aes_fail = aes_fail.code_value
)

SELECT * FROM incidents_codelookup_final
    );
  
  
[0m11:06:32.808093 [debug] [Thread-1 (]: SQL status: OK in 412.0 seconds
[0m11:06:32.808093 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m11:06:32.808093 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents_codelookup__dbt_tmp" rename to "nfirs_processed__incidents_codelookup"
[0m11:06:32.808093 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:06:32.824858 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: COMMIT
[0m11:06:32.824858 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m11:06:32.824858 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: COMMIT
[0m11:07:05.794666 [debug] [Thread-1 (]: SQL status: OK in 33.0 seconds
[0m11:07:05.810990 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m11:07:05.810990 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"} */
drop table if exists "nfirs"."nfirs_processed"."nfirs_processed__incidents_codelookup__dbt_backup" cascade
[0m11:07:05.810990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:07:05.810990 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: Close
[0m11:07:15.590707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '639c1041-901c-4d23-88aa-0e3b0b593083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F8D00F500>]}
[0m11:07:15.590707 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_processed.nfirs_processed__incidents_codelookup  [[32mOK[0m in 454.44s]
[0m11:07:15.590707 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup
[0m11:07:15.590707 [debug] [MainThread]: Using duckdb connection "master"
[0m11:07:15.601793 [debug] [MainThread]: On master: BEGIN
[0m11:07:15.601793 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:15.627928 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:07:15.628948 [debug] [MainThread]: On master: COMMIT
[0m11:07:15.628948 [debug] [MainThread]: Using duckdb connection "master"
[0m11:07:15.628948 [debug] [MainThread]: On master: COMMIT
[0m11:07:15.629937 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:07:15.630039 [debug] [MainThread]: On master: Close
[0m11:07:15.646324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:15.647323 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m11:07:15.648315 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m11:07:15.648315 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:07:15.648315 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:07:15.648315 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup' was properly closed.
[0m11:07:15.653970 [info ] [MainThread]: 
[0m11:07:15.653970 [info ] [MainThread]: Finished running 1 table model in 0 hours 7 minutes and 34.86 seconds (454.86s).
[0m11:07:15.654987 [debug] [MainThread]: Command end result
[0m11:07:15.677780 [info ] [MainThread]: 
[0m11:07:15.677780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:15.677780 [info ] [MainThread]: 
[0m11:07:15.677780 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:07:15.677780 [debug] [MainThread]: Command `cli run` succeeded at 11:07:15.677780 after 455.75 seconds
[0m11:07:15.677780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F8DA6F4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F8D8E8D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012F8D8EB140>]}
[0m11:07:15.677780 [debug] [MainThread]: Flushing usage events
[0m12:57:06.375540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F66EC9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F66EE900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F66ECAD0>]}


============================== 12:57:06.375540 | 1f955c14-fff4-4758-aaa7-443f3b307cc8 ==============================
[0m12:57:06.375540 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:57:06.375540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:57:06.541989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f955c14-fff4-4758-aaa7-443f3b307cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F40E4470>]}
[0m12:57:06.591354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f955c14-fff4-4758-aaa7-443f3b307cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F410F590>]}
[0m12:57:06.593426 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:57:06.594429 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:57:06.726271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:06.726271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:06.758495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f955c14-fff4-4758-aaa7-443f3b307cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F5263D70>]}
[0m12:57:06.839656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f955c14-fff4-4758-aaa7-443f3b307cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F4248740>]}
[0m12:57:06.839656 [info ] [MainThread]: Found 24 models, 4 data tests, 19 sources, 524 macros
[0m12:57:06.839656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f955c14-fff4-4758-aaa7-443f3b307cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F6BD5580>]}
[0m12:57:06.841900 [info ] [MainThread]: 
[0m12:57:06.841900 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:57:06.841900 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m12:57:07.042039 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m12:57:07.042039 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m12:57:07.042039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:07.074338 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:07.075379 [debug] [ThreadPool]: On list_nfirs: Close
[0m12:57:07.075379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m12:57:07.075379 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m12:57:07.075379 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:57:07.075379 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m12:57:07.075379 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:07.108614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:07.108614 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:57:07.108614 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m12:57:07.108614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:07.108614 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:57:07.108614 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m12:57:07.108614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:07.108614 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m12:57:07.108614 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:57:07.108614 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m12:57:07.108614 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:07.108614 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m12:57:07.125123 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m12:57:07.125123 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m12:57:07.125123 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m12:57:07.125123 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:57:07.125123 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:57:07.125123 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m12:57:07.125123 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m12:57:07.125123 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m12:57:07.125123 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m12:57:07.125123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:07.125123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:07.125123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:07.158437 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:07.158437 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:07.158437 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:07.158437 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:57:07.158437 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:57:07.158437 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m12:57:07.158437 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m12:57:07.158437 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m12:57:07.158437 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m12:57:07.188590 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:07.195121 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:07.196121 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m12:57:07.197121 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:07.198121 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m12:57:07.200121 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m12:57:07.201123 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m12:57:07.201123 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m12:57:07.202121 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m12:57:07.203156 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m12:57:07.205121 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m12:57:07.206121 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m12:57:07.208802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f955c14-fff4-4758-aaa7-443f3b307cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F410F500>]}
[0m12:57:07.208802 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:07.208802 [debug] [MainThread]: On master: BEGIN
[0m12:57:07.208802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:07.225504 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:57:07.225504 [debug] [MainThread]: On master: COMMIT
[0m12:57:07.225504 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:07.225504 [debug] [MainThread]: On master: COMMIT
[0m12:57:07.225504 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:57:07.225504 [debug] [MainThread]: On master: Close
[0m12:57:07.242113 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:57:07.242113 [info ] [MainThread]: 
[0m12:57:07.242113 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:57:07.242113 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__aid_casualty ..... [RUN]
[0m12:57:07.242113 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty'
[0m12:57:07.242113 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:57:07.260671 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:57:07.268152 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:57:07.295658 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:57:07.299894 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:57:07.300148 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: BEGIN
[0m12:57:07.300148 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:57:07.321914 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:57:07.321914 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:57:07.322837 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs-processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
WITH basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
WITH incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
WITH civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
WITH ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age ASage_cvl,
        cvl.race AS race_cvl,
        cvl.enthnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.sympton AS symption_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqt AS prot_eqt
    FROM incidents_basicaid_source
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m12:57:07.323834 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs-processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
WITH basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
WITH incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
WITH civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
WITH ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age ASage_cvl,
        cvl.race AS race_cvl,
        cvl.enthnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.sympton AS symption_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqt AS prot_eqt
    FROM incidents_basicaid_source
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m12:57:07.323834 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:07.324834 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: ROLLBACK
[0m12:57:07.328930 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty'
[0m12:57:07.328930 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: Close
[0m12:57:07.336004 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__aid_casualty (models\nfirs_processed\nfirs_processed__aid_casualty.sql)
  Parser Error: syntax error at or near "WITH"
[0m12:57:07.337007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f955c14-fff4-4758-aaa7-443f3b307cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F6AF93D0>]}
[0m12:57:07.337939 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__aid_casualty  [[31mERROR[0m in 0.09s]
[0m12:57:07.337939 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:57:07.339941 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:07.341010 [debug] [MainThread]: On master: BEGIN
[0m12:57:07.341010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:07.362639 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:57:07.362639 [debug] [MainThread]: On master: COMMIT
[0m12:57:07.362639 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:07.363822 [debug] [MainThread]: On master: COMMIT
[0m12:57:07.363822 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:57:07.363822 [debug] [MainThread]: On master: Close
[0m12:57:07.363822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:07.363822 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m12:57:07.363822 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m12:57:07.363822 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m12:57:07.363822 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m12:57:07.363822 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty' was properly closed.
[0m12:57:07.363822 [info ] [MainThread]: 
[0m12:57:07.363822 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m12:57:07.363822 [debug] [MainThread]: Command end result
[0m12:57:07.395934 [info ] [MainThread]: 
[0m12:57:07.395934 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:57:07.398044 [info ] [MainThread]: 
[0m12:57:07.398044 [error] [MainThread]:   Runtime Error in model nfirs_processed__aid_casualty (models\nfirs_processed\nfirs_processed__aid_casualty.sql)
  Parser Error: syntax error at or near "WITH"
[0m12:57:07.398044 [info ] [MainThread]: 
[0m12:57:07.398044 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:57:07.398044 [debug] [MainThread]: Command `cli run` failed at 12:57:07.398044 after 1.14 seconds
[0m12:57:07.400158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F68ED3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F52635C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232F5263290>]}
[0m12:57:07.400158 [debug] [MainThread]: Flushing usage events
[0m12:57:28.665763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2D0CF9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2DB6BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2DB6AD50>]}


============================== 12:57:28.681456 | 2041c804-eb00-4b6b-88b0-5127b60b6935 ==============================
[0m12:57:28.681456 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:57:28.681989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:57:28.829944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2041c804-eb00-4b6b-88b0-5127b60b6935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2FF20470>]}
[0m12:57:28.865935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2041c804-eb00-4b6b-88b0-5127b60b6935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2D5DF7D0>]}
[0m12:57:28.872222 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:57:28.874373 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:57:29.001672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:57:29.001672 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:57:29.032331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2041c804-eb00-4b6b-88b0-5127b60b6935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2FDE6270>]}
[0m12:57:29.106135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2041c804-eb00-4b6b-88b0-5127b60b6935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC30099A00>]}
[0m12:57:29.106135 [info ] [MainThread]: Found 24 models, 4 data tests, 19 sources, 524 macros
[0m12:57:29.106135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2041c804-eb00-4b6b-88b0-5127b60b6935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2E66B560>]}
[0m12:57:29.106135 [info ] [MainThread]: 
[0m12:57:29.106135 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:57:29.115018 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m12:57:29.167470 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m12:57:29.167470 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m12:57:29.167470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:29.198995 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:29.198995 [debug] [ThreadPool]: On list_nfirs: Close
[0m12:57:29.198995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m12:57:29.198995 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m12:57:29.215839 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:57:29.215839 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m12:57:29.215839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:29.235231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:29.235231 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:57:29.235231 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m12:57:29.235231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:29.235231 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:57:29.235231 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m12:57:29.235231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:29.235231 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m12:57:29.235231 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:57:29.235231 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m12:57:29.235231 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:29.248939 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m12:57:29.256011 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m12:57:29.256011 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m12:57:29.265692 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m12:57:29.265692 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m12:57:29.265692 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:57:29.265692 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m12:57:29.265692 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:57:29.265692 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m12:57:29.265692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:29.265692 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m12:57:29.265692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:29.299087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:29.299087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:29.299087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:29.299087 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m12:57:29.299087 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:29.299087 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:57:29.299087 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m12:57:29.299087 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:57:29.299087 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m12:57:29.299087 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m12:57:29.335245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:29.335245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:29.335245 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m12:57:29.335245 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:57:29.335245 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m12:57:29.335245 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m12:57:29.335245 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m12:57:29.335245 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m12:57:29.335245 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m12:57:29.335245 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m12:57:29.335245 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m12:57:29.335245 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m12:57:29.349552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2041c804-eb00-4b6b-88b0-5127b60b6935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2FF438C0>]}
[0m12:57:29.349552 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:29.349552 [debug] [MainThread]: On master: BEGIN
[0m12:57:29.349552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:57:29.382164 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:57:29.382164 [debug] [MainThread]: On master: COMMIT
[0m12:57:29.382164 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:29.382164 [debug] [MainThread]: On master: COMMIT
[0m12:57:29.382164 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:57:29.382164 [debug] [MainThread]: On master: Close
[0m12:57:29.382164 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:57:29.382164 [info ] [MainThread]: 
[0m12:57:29.382164 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:57:29.382164 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__aid_casualty ..... [RUN]
[0m12:57:29.382164 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty'
[0m12:57:29.382164 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:57:29.401154 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:57:29.402305 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:57:29.417362 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:57:29.417362 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:57:29.417362 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: BEGIN
[0m12:57:29.417362 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:57:29.448205 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:57:29.448614 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:57:29.448614 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs-processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age ASage_cvl,
        cvl.race AS race_cvl,
        cvl.enthnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.sympton AS symption_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqt AS prot_eqt
    FROM incidents_basicaid_source
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m12:57:29.448614 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs-processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age ASage_cvl,
        cvl.race AS race_cvl,
        cvl.enthnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.sympton AS symption_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqt AS prot_eqt
    FROM incidents_basicaid_source
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m12:57:29.448614 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:57:29.448614 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: ROLLBACK
[0m12:57:29.448614 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty'
[0m12:57:29.448614 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: Close
[0m12:57:29.466343 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__aid_casualty (models\nfirs_processed\nfirs_processed__aid_casualty.sql)
  Binder Error: Referenced table "inc" not found!
  Candidate tables: "incidents_source", "b"
  LINE 57:         ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
  ),
  
  -- Create Civilian Casualty CTE
  civiliancasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
  ),
  
  -- Create FF Casualty CTE
  ffcasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
  ),
  
  incidents_basicaid_casualty_final AS (
      SELECT
          inc.*,
          cvl.gender AS gender_cvl,
          cvl.age ASage_cvl,
          cvl.race AS race_cvl,
          cvl.enthnicity AS ethnicity_cvl,
          cvl.affiliat AS affiliat_cvl,
          cvl.inj_dt_tm AS inj_dt_tm_cvl,
          cvl.sev AS sev_cvl,
          cvl.cause_inj AS cause_inj_cvl,
          cvl.hum_fact1 AS hum_fact1_cvl,
          cvl.hum_fact2 AS hum_fact2_cvl,
          cvl.hum_fact3 AS hum_fact3_cvl,
          cvl.hum_fact4 AS hum_fact4_cvl,
          cvl.hum_fact5 AS hum_fact5_cvl,
          cvl.hum_fact6 AS hum_fact6_cvl,
          cvl.hum_fact7 AS hum_fact7_cvl,
          cvl.hum_fact8 AS hum_fact8_cvl,
          cvl.fact_inj1 AS fact_inj1_cvl,
          cvl.fact_inj2 AS fact_inj2_cvl,
          cvl.fact_inj3 AS fact_inj3_cvl,
          cvl.activ_inj AS activ_inj_cvl,
          cvl.loc_inc AS loc_inc_cvl,
          cvl.gen_loc_in AS gen_loc_in_cvl,
          cvl.story_inc AS story_inc_cvl,
          cvl.story_inj AS story_inj_cvl,
          cvl.spc_loc_in AS spc_loc_in_cvl,
          cvl.prim_symp AS prim_symp_cvl,
          cvl.body_part AS body_part_cvl,
          cvl.cc_dispos AS cc_dispos_cvl,
          ff.gender AS gender_ff,
          ff.career AS career_ff,
          ff.age AS age_ff,
          ff.inj_date AS inj_date_ff,
          ff.responses AS responses_ff,
          ff.assignment AS assignment_ff,
          ff.phys_cond AS phys_cond_ff,
          ff.severity AS severity_ff,
          ff.taken_to AS taken_to_ff,
          ff.activity AS activity_ff,
          ff.sympton AS symption_ff,
          ff.pabi AS pabi_ff,
          ff.cause AS cause_ff,
          ff.factor AS factor_ff,
          ff.object AS object_ff,
          ff.wio AS wio_ff,
          ff.relation AS relation_ff,
          ff.story AS story_ff,
          ff.location AS location_ff,
          ff.vehicle AS vehicle_ff,
          ff.prot_eqt AS prot_eqt
      FROM incidents_basicaid_source
      LEFT JOIN civiliancasualty_source cvl
          ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
      LEFT JOIN ffcasualty_source ff
          ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no
  
  )
  
  SELECT * FROM incidents_basicaid_casualty_final
      );
    
    ...
                      ^
[0m12:57:29.466343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2041c804-eb00-4b6b-88b0-5127b60b6935', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2FD14C80>]}
[0m12:57:29.466343 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__aid_casualty  [[31mERROR[0m in 0.08s]
[0m12:57:29.466343 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:57:29.466343 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:29.466343 [debug] [MainThread]: On master: BEGIN
[0m12:57:29.466343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:57:29.487608 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:57:29.487608 [debug] [MainThread]: On master: COMMIT
[0m12:57:29.487608 [debug] [MainThread]: Using duckdb connection "master"
[0m12:57:29.487608 [debug] [MainThread]: On master: COMMIT
[0m12:57:29.487608 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:57:29.487608 [debug] [MainThread]: On master: Close
[0m12:57:29.500220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:29.501264 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m12:57:29.501264 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m12:57:29.501264 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m12:57:29.502190 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m12:57:29.502190 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty' was properly closed.
[0m12:57:29.502973 [info ] [MainThread]: 
[0m12:57:29.502973 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m12:57:29.502973 [debug] [MainThread]: Command end result
[0m12:57:29.523197 [info ] [MainThread]: 
[0m12:57:29.523197 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:57:29.523197 [info ] [MainThread]: 
[0m12:57:29.523197 [error] [MainThread]:   Runtime Error in model nfirs_processed__aid_casualty (models\nfirs_processed\nfirs_processed__aid_casualty.sql)
  Binder Error: Referenced table "inc" not found!
  Candidate tables: "incidents_source", "b"
  LINE 57:         ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
  ),
  
  -- Create Civilian Casualty CTE
  civiliancasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
  ),
  
  -- Create FF Casualty CTE
  ffcasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
  ),
  
  incidents_basicaid_casualty_final AS (
      SELECT
          inc.*,
          cvl.gender AS gender_cvl,
          cvl.age ASage_cvl,
          cvl.race AS race_cvl,
          cvl.enthnicity AS ethnicity_cvl,
          cvl.affiliat AS affiliat_cvl,
          cvl.inj_dt_tm AS inj_dt_tm_cvl,
          cvl.sev AS sev_cvl,
          cvl.cause_inj AS cause_inj_cvl,
          cvl.hum_fact1 AS hum_fact1_cvl,
          cvl.hum_fact2 AS hum_fact2_cvl,
          cvl.hum_fact3 AS hum_fact3_cvl,
          cvl.hum_fact4 AS hum_fact4_cvl,
          cvl.hum_fact5 AS hum_fact5_cvl,
          cvl.hum_fact6 AS hum_fact6_cvl,
          cvl.hum_fact7 AS hum_fact7_cvl,
          cvl.hum_fact8 AS hum_fact8_cvl,
          cvl.fact_inj1 AS fact_inj1_cvl,
          cvl.fact_inj2 AS fact_inj2_cvl,
          cvl.fact_inj3 AS fact_inj3_cvl,
          cvl.activ_inj AS activ_inj_cvl,
          cvl.loc_inc AS loc_inc_cvl,
          cvl.gen_loc_in AS gen_loc_in_cvl,
          cvl.story_inc AS story_inc_cvl,
          cvl.story_inj AS story_inj_cvl,
          cvl.spc_loc_in AS spc_loc_in_cvl,
          cvl.prim_symp AS prim_symp_cvl,
          cvl.body_part AS body_part_cvl,
          cvl.cc_dispos AS cc_dispos_cvl,
          ff.gender AS gender_ff,
          ff.career AS career_ff,
          ff.age AS age_ff,
          ff.inj_date AS inj_date_ff,
          ff.responses AS responses_ff,
          ff.assignment AS assignment_ff,
          ff.phys_cond AS phys_cond_ff,
          ff.severity AS severity_ff,
          ff.taken_to AS taken_to_ff,
          ff.activity AS activity_ff,
          ff.sympton AS symption_ff,
          ff.pabi AS pabi_ff,
          ff.cause AS cause_ff,
          ff.factor AS factor_ff,
          ff.object AS object_ff,
          ff.wio AS wio_ff,
          ff.relation AS relation_ff,
          ff.story AS story_ff,
          ff.location AS location_ff,
          ff.vehicle AS vehicle_ff,
          ff.prot_eqt AS prot_eqt
      FROM incidents_basicaid_source
      LEFT JOIN civiliancasualty_source cvl
          ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
      LEFT JOIN ffcasualty_source ff
          ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no
  
  )
  
  SELECT * FROM incidents_basicaid_casualty_final
      );
    
    ...
                      ^
[0m12:57:29.523197 [info ] [MainThread]: 
[0m12:57:29.523197 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:57:29.531500 [debug] [MainThread]: Command `cli run` failed at 12:57:29.531500 after 0.96 seconds
[0m12:57:29.532781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2E6A2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2E6A0A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC2DE8AFC0>]}
[0m12:57:29.532936 [debug] [MainThread]: Flushing usage events
[0m12:58:21.577023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCE2CA6DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCE1E68EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCE3255D60>]}


============================== 12:58:21.577023 | 1d6679f3-8f2c-4910-a04b-91d734b9f2a3 ==============================
[0m12:58:21.577023 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:58:21.577023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:58:21.742883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d6679f3-8f2c-4910-a04b-91d734b9f2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCE25A0980>]}
[0m12:58:21.778084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d6679f3-8f2c-4910-a04b-91d734b9f2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCE37901D0>]}
[0m12:58:21.778084 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:58:21.795253 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:58:21.909650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:58:21.909650 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:58:21.942916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d6679f3-8f2c-4910-a04b-91d734b9f2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCE4FD4E90>]}
[0m12:58:22.026087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d6679f3-8f2c-4910-a04b-91d734b9f2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCE507A990>]}
[0m12:58:22.026087 [info ] [MainThread]: Found 24 models, 4 data tests, 19 sources, 524 macros
[0m12:58:22.026087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6679f3-8f2c-4910-a04b-91d734b9f2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCE297E810>]}
[0m12:58:22.026087 [info ] [MainThread]: 
[0m12:58:22.026087 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:58:22.026087 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m12:58:22.077668 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m12:58:22.092137 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m12:58:22.092137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:22.109363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:58:22.109363 [debug] [ThreadPool]: On list_nfirs: Close
[0m12:58:22.125950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m12:58:22.125950 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m12:58:22.125950 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:58:22.125950 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m12:58:22.125950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:22.142824 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:58:22.142824 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:58:22.142824 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m12:58:22.142824 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:58:22.142824 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:58:22.142824 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m12:58:22.142824 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:58:22.142824 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m12:58:22.158523 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:58:22.158874 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m12:58:22.158874 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:58:22.159549 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m12:58:22.159549 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m12:58:22.159549 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m12:58:22.175540 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:58:22.176180 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:58:22.176180 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m12:58:22.176180 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m12:58:22.176180 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m12:58:22.176180 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m12:58:22.176180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:22.176180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:22.176180 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m12:58:22.200901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:58:22.200901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:58:22.200901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:22.200901 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:58:22.200901 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:58:22.215797 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m12:58:22.200901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:58:22.215797 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m12:58:22.215797 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m12:58:22.215797 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m12:58:22.243467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:58:22.243467 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m12:58:22.243467 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m12:58:22.243467 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m12:58:22.243467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:58:22.243467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:58:22.243467 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m12:58:22.243467 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m12:58:22.243467 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m12:58:22.259288 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m12:58:22.259288 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m12:58:22.259288 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m12:58:22.259288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d6679f3-8f2c-4910-a04b-91d734b9f2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCE25CBC50>]}
[0m12:58:22.259288 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:22.259288 [debug] [MainThread]: On master: BEGIN
[0m12:58:22.259288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:22.275979 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:58:22.275979 [debug] [MainThread]: On master: COMMIT
[0m12:58:22.291945 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:22.291945 [debug] [MainThread]: On master: COMMIT
[0m12:58:22.291945 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:58:22.293010 [debug] [MainThread]: On master: Close
[0m12:58:22.298020 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:58:22.298020 [info ] [MainThread]: 
[0m12:58:22.302898 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:58:22.302898 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__aid_casualty ..... [RUN]
[0m12:58:22.303859 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty'
[0m12:58:22.303859 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:58:22.310860 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:58:22.311899 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:58:22.329542 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:58:22.329542 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:58:22.329542 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: BEGIN
[0m12:58:22.329542 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:58:22.343706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:58:22.358609 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:58:22.359143 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs-processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age ASage_cvl,
        cvl.race AS race_cvl,
        cvl.enthnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.sympton AS symption_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqt AS prot_eqt
    FROM incidents_basicaid_source inc
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m12:58:22.359143 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs-processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age ASage_cvl,
        cvl.race AS race_cvl,
        cvl.enthnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.sympton AS symption_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqt AS prot_eqt
    FROM incidents_basicaid_source inc
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m12:58:22.359143 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:58:22.359143 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: ROLLBACK
[0m12:58:22.359143 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty'
[0m12:58:22.359143 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: Close
[0m12:58:22.374767 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__aid_casualty (models\nfirs_processed\nfirs_processed__aid_casualty.sql)
  Binder Error: Referenced table "inc" not found!
  Candidate tables: "incidents_source", "b"
  LINE 57:         ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
  ),
  
  -- Create Civilian Casualty CTE
  civiliancasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
  ),
  
  -- Create FF Casualty CTE
  ffcasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
  ),
  
  incidents_basicaid_casualty_final AS (
      SELECT
          inc.*,
          cvl.gender AS gender_cvl,
          cvl.age ASage_cvl,
          cvl.race AS race_cvl,
          cvl.enthnicity AS ethnicity_cvl,
          cvl.affiliat AS affiliat_cvl,
          cvl.inj_dt_tm AS inj_dt_tm_cvl,
          cvl.sev AS sev_cvl,
          cvl.cause_inj AS cause_inj_cvl,
          cvl.hum_fact1 AS hum_fact1_cvl,
          cvl.hum_fact2 AS hum_fact2_cvl,
          cvl.hum_fact3 AS hum_fact3_cvl,
          cvl.hum_fact4 AS hum_fact4_cvl,
          cvl.hum_fact5 AS hum_fact5_cvl,
          cvl.hum_fact6 AS hum_fact6_cvl,
          cvl.hum_fact7 AS hum_fact7_cvl,
          cvl.hum_fact8 AS hum_fact8_cvl,
          cvl.fact_inj1 AS fact_inj1_cvl,
          cvl.fact_inj2 AS fact_inj2_cvl,
          cvl.fact_inj3 AS fact_inj3_cvl,
          cvl.activ_inj AS activ_inj_cvl,
          cvl.loc_inc AS loc_inc_cvl,
          cvl.gen_loc_in AS gen_loc_in_cvl,
          cvl.story_inc AS story_inc_cvl,
          cvl.story_inj AS story_inj_cvl,
          cvl.spc_loc_in AS spc_loc_in_cvl,
          cvl.prim_symp AS prim_symp_cvl,
          cvl.body_part AS body_part_cvl,
          cvl.cc_dispos AS cc_dispos_cvl,
          ff.gender AS gender_ff,
          ff.career AS career_ff,
          ff.age AS age_ff,
          ff.inj_date AS inj_date_ff,
          ff.responses AS responses_ff,
          ff.assignment AS assignment_ff,
          ff.phys_cond AS phys_cond_ff,
          ff.severity AS severity_ff,
          ff.taken_to AS taken_to_ff,
          ff.activity AS activity_ff,
          ff.sympton AS symption_ff,
          ff.pabi AS pabi_ff,
          ff.cause AS cause_ff,
          ff.factor AS factor_ff,
          ff.object AS object_ff,
          ff.wio AS wio_ff,
          ff.relation AS relation_ff,
          ff.story AS story_ff,
          ff.location AS location_ff,
          ff.vehicle AS vehicle_ff,
          ff.prot_eqt AS prot_eqt
      FROM incidents_basicaid_source inc
      LEFT JOIN civiliancasualty_source cvl
          ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
      LEFT JOIN ffcasualty_source ff
          ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no
  
  )
  
  SELECT * FROM incidents_basicaid_casualty_final
      );
    
    ...
                      ^
[0m12:58:22.375965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d6679f3-8f2c-4910-a04b-91d734b9f2a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCE55B6210>]}
[0m12:58:22.375965 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__aid_casualty  [[31mERROR[0m in 0.07s]
[0m12:58:22.375965 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:58:22.375965 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:22.375965 [debug] [MainThread]: On master: BEGIN
[0m12:58:22.375965 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:58:22.401348 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:58:22.401348 [debug] [MainThread]: On master: COMMIT
[0m12:58:22.401348 [debug] [MainThread]: Using duckdb connection "master"
[0m12:58:22.401348 [debug] [MainThread]: On master: COMMIT
[0m12:58:22.401348 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:58:22.401348 [debug] [MainThread]: On master: Close
[0m12:58:22.410518 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:22.410518 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m12:58:22.411518 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m12:58:22.411518 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m12:58:22.412518 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m12:58:22.413594 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty' was properly closed.
[0m12:58:22.413594 [info ] [MainThread]: 
[0m12:58:22.413594 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m12:58:22.413594 [debug] [MainThread]: Command end result
[0m12:58:22.433917 [info ] [MainThread]: 
[0m12:58:22.433917 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:58:22.433917 [info ] [MainThread]: 
[0m12:58:22.442030 [error] [MainThread]:   Runtime Error in model nfirs_processed__aid_casualty (models\nfirs_processed\nfirs_processed__aid_casualty.sql)
  Binder Error: Referenced table "inc" not found!
  Candidate tables: "incidents_source", "b"
  LINE 57:         ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
  ),
  
  -- Create Civilian Casualty CTE
  civiliancasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
  ),
  
  -- Create FF Casualty CTE
  ffcasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
  ),
  
  incidents_basicaid_casualty_final AS (
      SELECT
          inc.*,
          cvl.gender AS gender_cvl,
          cvl.age ASage_cvl,
          cvl.race AS race_cvl,
          cvl.enthnicity AS ethnicity_cvl,
          cvl.affiliat AS affiliat_cvl,
          cvl.inj_dt_tm AS inj_dt_tm_cvl,
          cvl.sev AS sev_cvl,
          cvl.cause_inj AS cause_inj_cvl,
          cvl.hum_fact1 AS hum_fact1_cvl,
          cvl.hum_fact2 AS hum_fact2_cvl,
          cvl.hum_fact3 AS hum_fact3_cvl,
          cvl.hum_fact4 AS hum_fact4_cvl,
          cvl.hum_fact5 AS hum_fact5_cvl,
          cvl.hum_fact6 AS hum_fact6_cvl,
          cvl.hum_fact7 AS hum_fact7_cvl,
          cvl.hum_fact8 AS hum_fact8_cvl,
          cvl.fact_inj1 AS fact_inj1_cvl,
          cvl.fact_inj2 AS fact_inj2_cvl,
          cvl.fact_inj3 AS fact_inj3_cvl,
          cvl.activ_inj AS activ_inj_cvl,
          cvl.loc_inc AS loc_inc_cvl,
          cvl.gen_loc_in AS gen_loc_in_cvl,
          cvl.story_inc AS story_inc_cvl,
          cvl.story_inj AS story_inj_cvl,
          cvl.spc_loc_in AS spc_loc_in_cvl,
          cvl.prim_symp AS prim_symp_cvl,
          cvl.body_part AS body_part_cvl,
          cvl.cc_dispos AS cc_dispos_cvl,
          ff.gender AS gender_ff,
          ff.career AS career_ff,
          ff.age AS age_ff,
          ff.inj_date AS inj_date_ff,
          ff.responses AS responses_ff,
          ff.assignment AS assignment_ff,
          ff.phys_cond AS phys_cond_ff,
          ff.severity AS severity_ff,
          ff.taken_to AS taken_to_ff,
          ff.activity AS activity_ff,
          ff.sympton AS symption_ff,
          ff.pabi AS pabi_ff,
          ff.cause AS cause_ff,
          ff.factor AS factor_ff,
          ff.object AS object_ff,
          ff.wio AS wio_ff,
          ff.relation AS relation_ff,
          ff.story AS story_ff,
          ff.location AS location_ff,
          ff.vehicle AS vehicle_ff,
          ff.prot_eqt AS prot_eqt
      FROM incidents_basicaid_source inc
      LEFT JOIN civiliancasualty_source cvl
          ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
      LEFT JOIN ffcasualty_source ff
          ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no
  
  )
  
  SELECT * FROM incidents_basicaid_casualty_final
      );
    
    ...
                      ^
[0m12:58:22.442030 [info ] [MainThread]: 
[0m12:58:22.442030 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:58:22.443104 [debug] [MainThread]: Command `cli run` failed at 12:58:22.443104 after 0.96 seconds
[0m12:58:22.443104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCE2CA6DB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCE2BA7F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BCE2BA4F50>]}
[0m12:58:22.444158 [debug] [MainThread]: Flushing usage events
[0m12:59:15.352960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D48DF920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D5EB5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D5EB6AE0>]}


============================== 12:59:15.352960 | 77bf48f5-f9b4-41d4-ad36-4ced355a9e2c ==============================
[0m12:59:15.352960 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:59:15.352960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:59:15.505187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77bf48f5-f9b4-41d4-ad36-4ced355a9e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D763AD20>]}
[0m12:59:15.553101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77bf48f5-f9b4-41d4-ad36-4ced355a9e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D5A0F1A0>]}
[0m12:59:15.553101 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:59:15.553101 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:59:15.686335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:59:15.686335 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:59:15.719558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77bf48f5-f9b4-41d4-ad36-4ced355a9e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D77EF920>]}
[0m12:59:15.805440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77bf48f5-f9b4-41d4-ad36-4ced355a9e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D788AE10>]}
[0m12:59:15.805440 [info ] [MainThread]: Found 24 models, 4 data tests, 19 sources, 524 macros
[0m12:59:15.805440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77bf48f5-f9b4-41d4-ad36-4ced355a9e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D776CEF0>]}
[0m12:59:15.805440 [info ] [MainThread]: 
[0m12:59:15.805440 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:59:15.805440 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m12:59:15.870876 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m12:59:15.870876 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m12:59:15.870876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:15.886313 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:59:15.902307 [debug] [ThreadPool]: On list_nfirs: Close
[0m12:59:15.905428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m12:59:15.905428 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m12:59:15.905428 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:59:15.905428 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m12:59:15.905428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:15.936140 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:59:15.936140 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:59:15.936140 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m12:59:15.936140 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:59:15.936140 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:59:15.936140 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m12:59:15.936140 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:59:15.936140 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m12:59:15.936140 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m12:59:15.936140 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m12:59:15.936140 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:59:15.936140 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m12:59:15.936140 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m12:59:15.936140 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m12:59:15.952671 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:59:15.952671 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m12:59:15.952671 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:59:15.952671 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m12:59:15.952671 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m12:59:15.952671 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m12:59:15.952671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:15.952671 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m12:59:15.952671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:15.969441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:15.969441 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:59:15.985065 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:59:15.985553 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:59:15.986049 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:59:15.986049 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:59:15.986049 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m12:59:15.986049 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m12:59:15.986049 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m12:59:15.986049 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m12:59:16.005414 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:59:16.005414 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:59:16.019480 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:59:16.019480 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m12:59:16.019480 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m12:59:16.019480 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m12:59:16.019480 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m12:59:16.019480 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m12:59:16.019480 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m12:59:16.019480 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m12:59:16.019480 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m12:59:16.019480 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m12:59:16.036036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77bf48f5-f9b4-41d4-ad36-4ced355a9e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D7B15580>]}
[0m12:59:16.036036 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:16.036036 [debug] [MainThread]: On master: BEGIN
[0m12:59:16.036036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:16.052606 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:59:16.052606 [debug] [MainThread]: On master: COMMIT
[0m12:59:16.052606 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:16.052606 [debug] [MainThread]: On master: COMMIT
[0m12:59:16.052606 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:59:16.052606 [debug] [MainThread]: On master: Close
[0m12:59:16.052606 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:59:16.052606 [info ] [MainThread]: 
[0m12:59:16.069191 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:59:16.069191 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__aid_casualty ..... [RUN]
[0m12:59:16.069191 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty'
[0m12:59:16.069191 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:59:16.076610 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:59:16.076610 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:59:16.089989 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:59:16.102149 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:59:16.102149 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: BEGIN
[0m12:59:16.102149 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:59:16.121105 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:59:16.121105 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m12:59:16.121105 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs-processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age ASage_cvl,
        cvl.race AS race_cvl,
        cvl.enthnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.sympton AS symption_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqt AS prot_eqt
    FROM incidents_basicaid_source inc
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m12:59:16.121105 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs-processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age ASage_cvl,
        cvl.race AS race_cvl,
        cvl.enthnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.sympton AS symption_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqt AS prot_eqt
    FROM incidents_basicaid_source inc
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m12:59:16.121105 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m12:59:16.121105 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: ROLLBACK
[0m12:59:16.121105 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty'
[0m12:59:16.121105 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: Close
[0m12:59:16.136056 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__aid_casualty (models\nfirs_processed\nfirs_processed__aid_casualty.sql)
  Binder Error: Referenced table "inc" not found!
  Candidate tables: "incidents_source", "b"
  LINE 57:         ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
  ),
  
  -- Create Civilian Casualty CTE
  civiliancasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
  ),
  
  -- Create FF Casualty CTE
  ffcasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
  ),
  
  incidents_basicaid_casualty_final AS (
      SELECT
          inc.*,
          cvl.gender AS gender_cvl,
          cvl.age ASage_cvl,
          cvl.race AS race_cvl,
          cvl.enthnicity AS ethnicity_cvl,
          cvl.affiliat AS affiliat_cvl,
          cvl.inj_dt_tm AS inj_dt_tm_cvl,
          cvl.sev AS sev_cvl,
          cvl.cause_inj AS cause_inj_cvl,
          cvl.hum_fact1 AS hum_fact1_cvl,
          cvl.hum_fact2 AS hum_fact2_cvl,
          cvl.hum_fact3 AS hum_fact3_cvl,
          cvl.hum_fact4 AS hum_fact4_cvl,
          cvl.hum_fact5 AS hum_fact5_cvl,
          cvl.hum_fact6 AS hum_fact6_cvl,
          cvl.hum_fact7 AS hum_fact7_cvl,
          cvl.hum_fact8 AS hum_fact8_cvl,
          cvl.fact_inj1 AS fact_inj1_cvl,
          cvl.fact_inj2 AS fact_inj2_cvl,
          cvl.fact_inj3 AS fact_inj3_cvl,
          cvl.activ_inj AS activ_inj_cvl,
          cvl.loc_inc AS loc_inc_cvl,
          cvl.gen_loc_in AS gen_loc_in_cvl,
          cvl.story_inc AS story_inc_cvl,
          cvl.story_inj AS story_inj_cvl,
          cvl.spc_loc_in AS spc_loc_in_cvl,
          cvl.prim_symp AS prim_symp_cvl,
          cvl.body_part AS body_part_cvl,
          cvl.cc_dispos AS cc_dispos_cvl,
          ff.gender AS gender_ff,
          ff.career AS career_ff,
          ff.age AS age_ff,
          ff.inj_date AS inj_date_ff,
          ff.responses AS responses_ff,
          ff.assignment AS assignment_ff,
          ff.phys_cond AS phys_cond_ff,
          ff.severity AS severity_ff,
          ff.taken_to AS taken_to_ff,
          ff.activity AS activity_ff,
          ff.sympton AS symption_ff,
          ff.pabi AS pabi_ff,
          ff.cause AS cause_ff,
          ff.factor AS factor_ff,
          ff.object AS object_ff,
          ff.wio AS wio_ff,
          ff.relation AS relation_ff,
          ff.story AS story_ff,
          ff.location AS location_ff,
          ff.vehicle AS vehicle_ff,
          ff.prot_eqt AS prot_eqt
      FROM incidents_basicaid_source inc
      LEFT JOIN civiliancasualty_source cvl
          ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
      LEFT JOIN ffcasualty_source ff
          ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no
  
  )
  
  SELECT * FROM incidents_basicaid_casualty_final
      );
    
    ...
                      ^
[0m12:59:16.136056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77bf48f5-f9b4-41d4-ad36-4ced355a9e2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D5A778C0>]}
[0m12:59:16.136056 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__aid_casualty  [[31mERROR[0m in 0.07s]
[0m12:59:16.136056 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m12:59:16.136056 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:16.136056 [debug] [MainThread]: On master: BEGIN
[0m12:59:16.136056 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:16.166190 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:59:16.166190 [debug] [MainThread]: On master: COMMIT
[0m12:59:16.167159 [debug] [MainThread]: Using duckdb connection "master"
[0m12:59:16.167159 [debug] [MainThread]: On master: COMMIT
[0m12:59:16.168157 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:59:16.168157 [debug] [MainThread]: On master: Close
[0m12:59:16.173814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:16.174865 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m12:59:16.174865 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m12:59:16.175784 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m12:59:16.175784 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m12:59:16.175784 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty' was properly closed.
[0m12:59:16.176821 [info ] [MainThread]: 
[0m12:59:16.176821 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m12:59:16.177792 [debug] [MainThread]: Command end result
[0m12:59:16.202197 [info ] [MainThread]: 
[0m12:59:16.202197 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:59:16.203197 [info ] [MainThread]: 
[0m12:59:16.203197 [error] [MainThread]:   Runtime Error in model nfirs_processed__aid_casualty (models\nfirs_processed\nfirs_processed__aid_casualty.sql)
  Binder Error: Referenced table "inc" not found!
  Candidate tables: "incidents_source", "b"
  LINE 57:         ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
  ),
  
  -- Create Civilian Casualty CTE
  civiliancasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
  ),
  
  -- Create FF Casualty CTE
  ffcasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
  ),
  
  incidents_basicaid_casualty_final AS (
      SELECT
          inc.*,
          cvl.gender AS gender_cvl,
          cvl.age ASage_cvl,
          cvl.race AS race_cvl,
          cvl.enthnicity AS ethnicity_cvl,
          cvl.affiliat AS affiliat_cvl,
          cvl.inj_dt_tm AS inj_dt_tm_cvl,
          cvl.sev AS sev_cvl,
          cvl.cause_inj AS cause_inj_cvl,
          cvl.hum_fact1 AS hum_fact1_cvl,
          cvl.hum_fact2 AS hum_fact2_cvl,
          cvl.hum_fact3 AS hum_fact3_cvl,
          cvl.hum_fact4 AS hum_fact4_cvl,
          cvl.hum_fact5 AS hum_fact5_cvl,
          cvl.hum_fact6 AS hum_fact6_cvl,
          cvl.hum_fact7 AS hum_fact7_cvl,
          cvl.hum_fact8 AS hum_fact8_cvl,
          cvl.fact_inj1 AS fact_inj1_cvl,
          cvl.fact_inj2 AS fact_inj2_cvl,
          cvl.fact_inj3 AS fact_inj3_cvl,
          cvl.activ_inj AS activ_inj_cvl,
          cvl.loc_inc AS loc_inc_cvl,
          cvl.gen_loc_in AS gen_loc_in_cvl,
          cvl.story_inc AS story_inc_cvl,
          cvl.story_inj AS story_inj_cvl,
          cvl.spc_loc_in AS spc_loc_in_cvl,
          cvl.prim_symp AS prim_symp_cvl,
          cvl.body_part AS body_part_cvl,
          cvl.cc_dispos AS cc_dispos_cvl,
          ff.gender AS gender_ff,
          ff.career AS career_ff,
          ff.age AS age_ff,
          ff.inj_date AS inj_date_ff,
          ff.responses AS responses_ff,
          ff.assignment AS assignment_ff,
          ff.phys_cond AS phys_cond_ff,
          ff.severity AS severity_ff,
          ff.taken_to AS taken_to_ff,
          ff.activity AS activity_ff,
          ff.sympton AS symption_ff,
          ff.pabi AS pabi_ff,
          ff.cause AS cause_ff,
          ff.factor AS factor_ff,
          ff.object AS object_ff,
          ff.wio AS wio_ff,
          ff.relation AS relation_ff,
          ff.story AS story_ff,
          ff.location AS location_ff,
          ff.vehicle AS vehicle_ff,
          ff.prot_eqt AS prot_eqt
      FROM incidents_basicaid_source inc
      LEFT JOIN civiliancasualty_source cvl
          ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
      LEFT JOIN ffcasualty_source ff
          ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no
  
  )
  
  SELECT * FROM incidents_basicaid_casualty_final
      );
    
    ...
                      ^
[0m12:59:16.204380 [info ] [MainThread]: 
[0m12:59:16.204380 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:59:16.206386 [debug] [MainThread]: Command `cli run` failed at 12:59:16.206386 after 0.96 seconds
[0m12:59:16.206386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D5EB4EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D5B01DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158D5B036E0>]}
[0m12:59:16.206386 [debug] [MainThread]: Flushing usage events
[0m13:04:11.892222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48903B020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48A999460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4893F14F0>]}


============================== 13:04:11.892222 | 53571335-75fb-43a9-8d53-85314001e986 ==============================
[0m13:04:11.892222 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:04:11.892222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:04:12.041585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53571335-75fb-43a9-8d53-85314001e986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48AB6F9B0>]}
[0m13:04:12.075057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53571335-75fb-43a9-8d53-85314001e986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C488CBBFE0>]}
[0m13:04:12.092013 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:04:12.092013 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:04:12.225061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:04:12.225061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:04:12.256612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53571335-75fb-43a9-8d53-85314001e986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48ADEF920>]}
[0m13:04:12.332890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53571335-75fb-43a9-8d53-85314001e986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48AE89E50>]}
[0m13:04:12.332890 [info ] [MainThread]: Found 24 models, 4 data tests, 19 sources, 524 macros
[0m13:04:12.332890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53571335-75fb-43a9-8d53-85314001e986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48ADE5E80>]}
[0m13:04:12.332890 [info ] [MainThread]: 
[0m13:04:12.332890 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:04:12.332890 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m13:04:12.393123 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m13:04:12.393123 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m13:04:12.393123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:12.416076 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:12.416076 [debug] [ThreadPool]: On list_nfirs: Close
[0m13:04:12.424740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m13:04:12.424740 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m13:04:12.424740 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:04:12.424740 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m13:04:12.424740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:12.441547 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:12.441547 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:04:12.441547 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m13:04:12.441547 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:12.441547 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:04:12.457246 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m13:04:12.457993 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:12.457993 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:04:12.457993 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:04:12.457993 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:04:12.457993 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:12.457993 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m13:04:12.457993 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m13:04:12.473689 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:04:12.474629 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m13:04:12.475340 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m13:04:12.480806 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m13:04:12.480806 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:04:12.480806 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:04:12.480806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:12.480806 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m13:04:12.480806 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m13:04:12.508041 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:12.508041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:12.508041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:12.508041 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:04:12.508041 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:12.508041 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:12.508041 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m13:04:12.508041 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:04:12.508041 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:04:12.508041 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m13:04:12.508041 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m13:04:12.541868 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:12.541868 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:12.541868 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m13:04:12.541868 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:12.541868 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m13:04:12.541868 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m13:04:12.541868 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m13:04:12.541868 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m13:04:12.541868 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m13:04:12.541868 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m13:04:12.541868 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m13:04:12.541868 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m13:04:12.558271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53571335-75fb-43a9-8d53-85314001e986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48ADD3F50>]}
[0m13:04:12.558271 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:12.558271 [debug] [MainThread]: On master: BEGIN
[0m13:04:12.558271 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:12.574515 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:04:12.574515 [debug] [MainThread]: On master: COMMIT
[0m13:04:12.574515 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:12.574515 [debug] [MainThread]: On master: COMMIT
[0m13:04:12.574515 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:04:12.574515 [debug] [MainThread]: On master: Close
[0m13:04:12.591290 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:04:12.591290 [info ] [MainThread]: 
[0m13:04:12.591290 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m13:04:12.591290 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__aid_casualty ..... [RUN]
[0m13:04:12.591290 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty'
[0m13:04:12.591290 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m13:04:12.607374 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:04:12.608408 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m13:04:12.626216 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:04:12.626216 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:04:12.626216 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: BEGIN
[0m13:04:12.626216 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:04:12.643026 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:04:12.643026 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:04:12.643026 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs-processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

-- Create final CTE
incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age AS age_cvl,
        cvl.race AS race_cvl,
        cvl.ethnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.symptom AS symptom_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqt AS prot_eqt
    FROM incidents_basicaid_source inc
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m13:04:12.658059 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs-processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

-- Create final CTE
incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age AS age_cvl,
        cvl.race AS race_cvl,
        cvl.ethnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.symptom AS symptom_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqt AS prot_eqt
    FROM incidents_basicaid_source inc
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m13:04:12.658059 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:04:12.658059 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: ROLLBACK
[0m13:04:12.658059 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty'
[0m13:04:12.658059 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: Close
[0m13:04:12.658059 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__aid_casualty (models\nfirs_processed\nfirs_processed__aid_casualty.sql)
  Binder Error: Referenced table "inc" not found!
  Candidate tables: "incidents_source", "b"
  LINE 57:         ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
  ),
  
  -- Create Civilian Casualty CTE
  civiliancasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
  ),
  
  -- Create FF Casualty CTE
  ffcasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
  ),
  
  -- Create final CTE
  incidents_basicaid_casualty_final AS (
      SELECT
          inc.*,
          cvl.gender AS gender_cvl,
          cvl.age AS age_cvl,
          cvl.race AS race_cvl,
          cvl.ethnicity AS ethnicity_cvl,
          cvl.affiliat AS affiliat_cvl,
          cvl.inj_dt_tm AS inj_dt_tm_cvl,
          cvl.sev AS sev_cvl,
          cvl.cause_inj AS cause_inj_cvl,
          cvl.hum_fact1 AS hum_fact1_cvl,
          cvl.hum_fact2 AS hum_fact2_cvl,
          cvl.hum_fact3 AS hum_fact3_cvl,
          cvl.hum_fact4 AS hum_fact4_cvl,
          cvl.hum_fact5 AS hum_fact5_cvl,
          cvl.hum_fact6 AS hum_fact6_cvl,
          cvl.hum_fact7 AS hum_fact7_cvl,
          cvl.hum_fact8 AS hum_fact8_cvl,
          cvl.fact_inj1 AS fact_inj1_cvl,
          cvl.fact_inj2 AS fact_inj2_cvl,
          cvl.fact_inj3 AS fact_inj3_cvl,
          cvl.activ_inj AS activ_inj_cvl,
          cvl.loc_inc AS loc_inc_cvl,
          cvl.gen_loc_in AS gen_loc_in_cvl,
          cvl.story_inc AS story_inc_cvl,
          cvl.story_inj AS story_inj_cvl,
          cvl.spc_loc_in AS spc_loc_in_cvl,
          cvl.prim_symp AS prim_symp_cvl,
          cvl.body_part AS body_part_cvl,
          cvl.cc_dispos AS cc_dispos_cvl,
          ff.gender AS gender_ff,
          ff.career AS career_ff,
          ff.age AS age_ff,
          ff.inj_date AS inj_date_ff,
          ff.responses AS responses_ff,
          ff.assignment AS assignment_ff,
          ff.phys_cond AS phys_cond_ff,
          ff.severity AS severity_ff,
          ff.taken_to AS taken_to_ff,
          ff.activity AS activity_ff,
          ff.symptom AS symptom_ff,
          ff.pabi AS pabi_ff,
          ff.cause AS cause_ff,
          ff.factor AS factor_ff,
          ff.object AS object_ff,
          ff.wio AS wio_ff,
          ff.relation AS relation_ff,
          ff.story AS story_ff,
          ff.location AS location_ff,
          ff.vehicle AS vehicle_ff,
          ff.prot_eqt AS prot_eqt
      FROM incidents_basicaid_source inc
      LEFT JOIN civiliancasualty_source cvl
          ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
      LEFT JOIN ffcasualty_source ff
          ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no
  
  )
  
  SELECT * FROM incidents_basicaid_casualty_final
      );
    
    ...
                      ^
[0m13:04:12.674071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53571335-75fb-43a9-8d53-85314001e986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48B3C7800>]}
[0m13:04:12.674652 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__aid_casualty  [[31mERROR[0m in 0.07s]
[0m13:04:12.674652 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m13:04:12.674652 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:12.674652 [debug] [MainThread]: On master: BEGIN
[0m13:04:12.674652 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:12.698571 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:04:12.698571 [debug] [MainThread]: On master: COMMIT
[0m13:04:12.698571 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:12.698571 [debug] [MainThread]: On master: COMMIT
[0m13:04:12.698571 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:04:12.698571 [debug] [MainThread]: On master: Close
[0m13:04:12.698571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:12.698571 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m13:04:12.698571 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m13:04:12.698571 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m13:04:12.698571 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m13:04:12.707340 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty' was properly closed.
[0m13:04:12.708373 [info ] [MainThread]: 
[0m13:04:12.708373 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m13:04:12.709346 [debug] [MainThread]: Command end result
[0m13:04:12.734012 [info ] [MainThread]: 
[0m13:04:12.734935 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:04:12.734935 [info ] [MainThread]: 
[0m13:04:12.734935 [error] [MainThread]:   Runtime Error in model nfirs_processed__aid_casualty (models\nfirs_processed\nfirs_processed__aid_casualty.sql)
  Binder Error: Referenced table "inc" not found!
  Candidate tables: "incidents_source", "b"
  LINE 57:         ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
  ),
  
  -- Create Civilian Casualty CTE
  civiliancasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
  ),
  
  -- Create FF Casualty CTE
  ffcasualty_source AS (
      SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
  ),
  
  -- Create final CTE
  incidents_basicaid_casualty_final AS (
      SELECT
          inc.*,
          cvl.gender AS gender_cvl,
          cvl.age AS age_cvl,
          cvl.race AS race_cvl,
          cvl.ethnicity AS ethnicity_cvl,
          cvl.affiliat AS affiliat_cvl,
          cvl.inj_dt_tm AS inj_dt_tm_cvl,
          cvl.sev AS sev_cvl,
          cvl.cause_inj AS cause_inj_cvl,
          cvl.hum_fact1 AS hum_fact1_cvl,
          cvl.hum_fact2 AS hum_fact2_cvl,
          cvl.hum_fact3 AS hum_fact3_cvl,
          cvl.hum_fact4 AS hum_fact4_cvl,
          cvl.hum_fact5 AS hum_fact5_cvl,
          cvl.hum_fact6 AS hum_fact6_cvl,
          cvl.hum_fact7 AS hum_fact7_cvl,
          cvl.hum_fact8 AS hum_fact8_cvl,
          cvl.fact_inj1 AS fact_inj1_cvl,
          cvl.fact_inj2 AS fact_inj2_cvl,
          cvl.fact_inj3 AS fact_inj3_cvl,
          cvl.activ_inj AS activ_inj_cvl,
          cvl.loc_inc AS loc_inc_cvl,
          cvl.gen_loc_in AS gen_loc_in_cvl,
          cvl.story_inc AS story_inc_cvl,
          cvl.story_inj AS story_inj_cvl,
          cvl.spc_loc_in AS spc_loc_in_cvl,
          cvl.prim_symp AS prim_symp_cvl,
          cvl.body_part AS body_part_cvl,
          cvl.cc_dispos AS cc_dispos_cvl,
          ff.gender AS gender_ff,
          ff.career AS career_ff,
          ff.age AS age_ff,
          ff.inj_date AS inj_date_ff,
          ff.responses AS responses_ff,
          ff.assignment AS assignment_ff,
          ff.phys_cond AS phys_cond_ff,
          ff.severity AS severity_ff,
          ff.taken_to AS taken_to_ff,
          ff.activity AS activity_ff,
          ff.symptom AS symptom_ff,
          ff.pabi AS pabi_ff,
          ff.cause AS cause_ff,
          ff.factor AS factor_ff,
          ff.object AS object_ff,
          ff.wio AS wio_ff,
          ff.relation AS relation_ff,
          ff.story AS story_ff,
          ff.location AS location_ff,
          ff.vehicle AS vehicle_ff,
          ff.prot_eqt AS prot_eqt
      FROM incidents_basicaid_source inc
      LEFT JOIN civiliancasualty_source cvl
          ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
      LEFT JOIN ffcasualty_source ff
          ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no
  
  )
  
  SELECT * FROM incidents_basicaid_casualty_final
      );
    
    ...
                      ^
[0m13:04:12.735974 [info ] [MainThread]: 
[0m13:04:12.735974 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:04:12.736969 [debug] [MainThread]: Command `cli run` failed at 13:04:12.736969 after 0.96 seconds
[0m13:04:12.736969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48A917980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4894C7D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C48965E3C0>]}
[0m13:04:12.738014 [debug] [MainThread]: Flushing usage events
[0m13:04:53.131280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF390BF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF3908B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF3908A10>]}


============================== 13:04:53.131280 | b5430dee-25d7-4f02-a871-e42a5564edd1 ==============================
[0m13:04:53.131280 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:04:53.131280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:04:53.290658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5430dee-25d7-4f02-a871-e42a5564edd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF3B8F320>]}
[0m13:04:53.323982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5430dee-25d7-4f02-a871-e42a5564edd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF397CCB0>]}
[0m13:04:53.323982 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:04:53.342840 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:04:53.473852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:04:53.473852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:04:53.506486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5430dee-25d7-4f02-a871-e42a5564edd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF3D18EF0>]}
[0m13:04:53.582150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5430dee-25d7-4f02-a871-e42a5564edd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF3D8B2F0>]}
[0m13:04:53.582150 [info ] [MainThread]: Found 24 models, 4 data tests, 19 sources, 524 macros
[0m13:04:53.582150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5430dee-25d7-4f02-a871-e42a5564edd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF3DC2E10>]}
[0m13:04:53.582150 [info ] [MainThread]: 
[0m13:04:53.582150 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:04:53.582150 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m13:04:53.641894 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m13:04:53.642430 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m13:04:53.642430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:53.665875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:53.665875 [debug] [ThreadPool]: On list_nfirs: Close
[0m13:04:53.673738 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m13:04:53.673738 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m13:04:53.673738 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:04:53.673738 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m13:04:53.673738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:04:53.696940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:53.696940 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:04:53.696940 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m13:04:53.705228 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:53.705228 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:04:53.705228 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m13:04:53.706256 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:53.706857 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:04:53.707448 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:04:53.707448 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:04:53.707448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:53.707448 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m13:04:53.715669 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m13:04:53.722922 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m13:04:53.723613 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:04:53.725652 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:04:53.725652 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m13:04:53.725652 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m13:04:53.725652 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m13:04:53.725652 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:04:53.725652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:53.725652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:53.725652 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m13:04:53.756895 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:53.756895 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:53.756895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:53.756895 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:04:53.756895 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:04:53.756895 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:53.756895 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m13:04:53.756895 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m13:04:53.756895 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:04:53.756895 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m13:04:53.789621 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:53.790233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:53.790233 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m13:04:53.790233 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m13:04:53.790233 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m13:04:53.790233 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m13:04:53.790233 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m13:04:53.790233 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m13:04:53.790233 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:04:53.790233 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m13:04:53.790233 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m13:04:53.790233 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m13:04:53.806716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5430dee-25d7-4f02-a871-e42a5564edd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF42732C0>]}
[0m13:04:53.806716 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:53.806716 [debug] [MainThread]: On master: BEGIN
[0m13:04:53.806716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:53.825783 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:04:53.839576 [debug] [MainThread]: On master: COMMIT
[0m13:04:53.840043 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:53.840043 [debug] [MainThread]: On master: COMMIT
[0m13:04:53.840043 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:04:53.840043 [debug] [MainThread]: On master: Close
[0m13:04:53.840043 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:04:53.840043 [info ] [MainThread]: 
[0m13:04:53.840043 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m13:04:53.840043 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__aid_casualty ..... [RUN]
[0m13:04:53.840043 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty'
[0m13:04:53.840043 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m13:04:53.858334 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:04:53.859305 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m13:04:53.874950 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:04:53.874950 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:04:53.874950 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: BEGIN
[0m13:04:53.874950 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:04:53.906867 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:04:53.906867 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:04:53.906867 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs-processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source inc
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

-- Create final CTE
incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age AS age_cvl,
        cvl.race AS race_cvl,
        cvl.ethnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.symptom AS symptom_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqt AS prot_eqt
    FROM incidents_basicaid_source inc
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m13:04:53.906867 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs-processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source inc
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

-- Create final CTE
incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age AS age_cvl,
        cvl.race AS race_cvl,
        cvl.ethnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.symptom AS symptom_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqt AS prot_eqt
    FROM incidents_basicaid_source inc
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m13:04:53.906867 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:04:53.906867 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: ROLLBACK
[0m13:04:53.906867 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty'
[0m13:04:53.906867 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: Close
[0m13:04:53.925957 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__aid_casualty (models\nfirs_processed\nfirs_processed__aid_casualty.sql)
  Binder Error: Values list "ff" does not have a column named "prot_eqt"
  LINE 122:         ff.prot_eqt AS prot_eqt
                    ^
[0m13:04:53.925957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5430dee-25d7-4f02-a871-e42a5564edd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF1FC7680>]}
[0m13:04:53.925957 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__aid_casualty  [[31mERROR[0m in 0.09s]
[0m13:04:53.925957 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m13:04:53.925957 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:53.925957 [debug] [MainThread]: On master: BEGIN
[0m13:04:53.925957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:53.946203 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:04:53.946203 [debug] [MainThread]: On master: COMMIT
[0m13:04:53.946203 [debug] [MainThread]: Using duckdb connection "master"
[0m13:04:53.946203 [debug] [MainThread]: On master: COMMIT
[0m13:04:53.946203 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:04:53.946203 [debug] [MainThread]: On master: Close
[0m13:04:53.959045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:53.959045 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m13:04:53.960045 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m13:04:53.960045 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m13:04:53.960045 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m13:04:53.961084 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty' was properly closed.
[0m13:04:53.961619 [info ] [MainThread]: 
[0m13:04:53.961619 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m13:04:53.961619 [debug] [MainThread]: Command end result
[0m13:04:53.990471 [info ] [MainThread]: 
[0m13:04:53.990471 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:04:53.991471 [info ] [MainThread]: 
[0m13:04:53.991471 [error] [MainThread]:   Runtime Error in model nfirs_processed__aid_casualty (models\nfirs_processed\nfirs_processed__aid_casualty.sql)
  Binder Error: Values list "ff" does not have a column named "prot_eqt"
  LINE 122:         ff.prot_eqt AS prot_eqt
                    ^
[0m13:04:53.991471 [info ] [MainThread]: 
[0m13:04:53.992470 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:04:53.993470 [debug] [MainThread]: Command `cli run` failed at 13:04:53.993470 after 0.97 seconds
[0m13:04:53.993470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF369C800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF393C260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF3C6CDA0>]}
[0m13:04:53.993470 [debug] [MainThread]: Flushing usage events
[0m13:05:44.401542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021025CF9D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210275B78C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210275B6A20>]}


============================== 13:05:44.401542 | 1ac41273-963f-4651-9f07-bce952199f62 ==============================
[0m13:05:44.401542 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:05:44.401542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:05:44.568385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ac41273-963f-4651-9f07-bce952199f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021025A8EF00>]}
[0m13:05:44.601417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ac41273-963f-4651-9f07-bce952199f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021026181A30>]}
[0m13:05:44.601417 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:05:44.618151 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:05:44.751522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:05:44.751522 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:05:44.784686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ac41273-963f-4651-9f07-bce952199f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210279D3650>]}
[0m13:05:44.851915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ac41273-963f-4651-9f07-bce952199f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021027D1DDF0>]}
[0m13:05:44.867461 [info ] [MainThread]: Found 24 models, 4 data tests, 19 sources, 524 macros
[0m13:05:44.868199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac41273-963f-4651-9f07-bce952199f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021027BE4AA0>]}
[0m13:05:44.868199 [info ] [MainThread]: 
[0m13:05:44.868199 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:05:44.868199 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m13:05:44.919934 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m13:05:44.919934 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m13:05:44.919934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:44.951600 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:05:44.951600 [debug] [ThreadPool]: On list_nfirs: Close
[0m13:05:44.951600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m13:05:44.951600 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m13:05:44.968274 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:05:44.968274 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m13:05:44.968274 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:44.984582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:05:44.984582 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:05:44.984582 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m13:05:44.984582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:05:44.984582 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:05:44.984582 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m13:05:44.984582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:05:44.984582 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:05:44.984582 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:05:44.984582 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:05:44.984582 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:05:44.984582 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m13:05:45.001343 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m13:05:45.001343 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:05:45.001343 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m13:05:45.001343 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m13:05:45.001343 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:05:45.001343 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m13:05:45.001343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:45.001343 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m13:05:45.001343 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:05:45.034661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:45.034661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:05:45.034661 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m13:05:45.034661 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:05:45.039667 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:05:45.039667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:45.039667 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:05:45.039667 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m13:05:45.039667 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:05:45.039667 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m13:05:45.039667 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:05:45.039667 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m13:05:45.067951 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:05:45.067951 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:05:45.067951 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m13:05:45.067951 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:05:45.067951 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m13:05:45.067951 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m13:05:45.067951 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m13:05:45.067951 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m13:05:45.067951 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m13:05:45.067951 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m13:05:45.067951 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m13:05:45.067951 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m13:05:45.084606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ac41273-963f-4651-9f07-bce952199f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210279D3740>]}
[0m13:05:45.084606 [debug] [MainThread]: Using duckdb connection "master"
[0m13:05:45.084606 [debug] [MainThread]: On master: BEGIN
[0m13:05:45.084606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:45.101367 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:05:45.101367 [debug] [MainThread]: On master: COMMIT
[0m13:05:45.101367 [debug] [MainThread]: Using duckdb connection "master"
[0m13:05:45.101367 [debug] [MainThread]: On master: COMMIT
[0m13:05:45.101367 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:05:45.101367 [debug] [MainThread]: On master: Close
[0m13:05:45.117915 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:05:45.117915 [info ] [MainThread]: 
[0m13:05:45.117915 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m13:05:45.117915 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__aid_casualty ..... [RUN]
[0m13:05:45.117915 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty'
[0m13:05:45.117915 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m13:05:45.134143 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:05:45.134143 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m13:05:45.157864 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:05:45.158783 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:05:45.158783 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: BEGIN
[0m13:05:45.158783 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:05:45.179605 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:05:45.180604 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:05:45.180604 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs-processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source inc
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

-- Create final CTE
incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age AS age_cvl,
        cvl.race AS race_cvl,
        cvl.ethnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.symptom AS symptom_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqp AS prot_eqp
    FROM incidents_basicaid_source inc
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m13:10:16.101218 [debug] [Thread-1 (]: SQL status: OK in 271.0 seconds
[0m13:10:16.101218 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:10:16.109368 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_tmp" rename to "nfirs_processed__aid_casualty"
[0m13:10:16.109569 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:10:16.124553 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: COMMIT
[0m13:10:16.124553 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:10:16.125554 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: COMMIT
[0m13:10:41.957235 [debug] [Thread-1 (]: SQL status: OK in 26.0 seconds
[0m13:10:41.963245 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"
[0m13:10:41.963245 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__aid_casualty"} */
drop table if exists "nfirs"."nfirs_processed"."nfirs_processed__aid_casualty__dbt_backup" cascade
[0m13:10:41.964246 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:10:41.965246 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__aid_casualty: Close
[0m13:10:48.386967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ac41273-963f-4651-9f07-bce952199f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102500B5C0>]}
[0m13:10:48.386967 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_processed.nfirs_processed__aid_casualty  [[32mOK[0m in 303.27s]
[0m13:10:48.386967 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__aid_casualty
[0m13:10:48.403528 [debug] [MainThread]: Using duckdb connection "master"
[0m13:10:48.403528 [debug] [MainThread]: On master: BEGIN
[0m13:10:48.403528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:10:48.438491 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:10:48.438491 [debug] [MainThread]: On master: COMMIT
[0m13:10:48.438491 [debug] [MainThread]: Using duckdb connection "master"
[0m13:10:48.439492 [debug] [MainThread]: On master: COMMIT
[0m13:10:48.440488 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:10:48.440488 [debug] [MainThread]: On master: Close
[0m13:10:48.455344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:48.455344 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m13:10:48.455344 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m13:10:48.455344 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m13:10:48.455344 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m13:10:48.455344 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__aid_casualty' was properly closed.
[0m13:10:48.455344 [info ] [MainThread]: 
[0m13:10:48.455344 [info ] [MainThread]: Finished running 1 table model in 0 hours 5 minutes and 3.59 seconds (303.59s).
[0m13:10:48.455344 [debug] [MainThread]: Command end result
[0m13:10:48.492792 [info ] [MainThread]: 
[0m13:10:48.492792 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:10:48.492792 [info ] [MainThread]: 
[0m13:10:48.492792 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:10:48.492792 [debug] [MainThread]: Command `cli run` succeeded at 13:10:48.492792 after 304.22 seconds
[0m13:10:48.492792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210277692B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021027768A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021027768BC0>]}
[0m13:10:48.492792 [debug] [MainThread]: Flushing usage events
[0m16:18:48.397948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB503C4A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB503C7D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB503C4E00>]}


============================== 16:18:48.408239 | f48fed02-70ec-4fd3-9113-2566eb0ec171 ==============================
[0m16:18:48.408239 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:18:48.408423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:18:48.576878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f48fed02-70ec-4fd3-9113-2566eb0ec171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB503C51C0>]}
[0m16:18:48.617391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f48fed02-70ec-4fd3-9113-2566eb0ec171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4E5047A0>]}
[0m16:18:48.627301 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:18:48.627301 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:18:48.767443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:18:48.767443 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:18:48.796821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f48fed02-70ec-4fd3-9113-2566eb0ec171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB503F1F40>]}
[0m16:18:48.945045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f48fed02-70ec-4fd3-9113-2566eb0ec171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB509499A0>]}
[0m16:18:48.945045 [info ] [MainThread]: Found 25 models, 4 data tests, 19 sources, 524 macros
[0m16:18:48.945045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f48fed02-70ec-4fd3-9113-2566eb0ec171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB503C6000>]}
[0m16:18:48.945045 [info ] [MainThread]: 
[0m16:18:48.945045 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:18:48.945045 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:18:49.197421 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:18:49.197421 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:18:49.197421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:49.267306 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:18:49.268521 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:18:49.276825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m16:18:49.277380 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m16:18:49.278964 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m16:18:49.278964 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:18:49.278964 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:18:49.467131 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:18:49.469048 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m16:18:49.469253 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m16:18:49.469253 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:18:49.469253 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m16:18:49.469253 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m16:18:49.512334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:18:49.512334 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m16:18:49.512334 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m16:18:49.512334 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m16:18:49.512334 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:18:49.512334 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m16:18:49.522586 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:18:49.522586 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m16:18:49.527846 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:18:49.527846 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m16:18:49.527846 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:18:49.527846 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:18:49.527846 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m16:18:49.527846 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:18:49.527846 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:18:49.527846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:49.536762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:49.536762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:18:49.556903 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:18:49.556903 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:18:49.556903 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:18:49.556903 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m16:18:49.556903 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:18:49.556903 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:18:49.564866 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m16:18:49.564866 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:18:49.564866 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:18:49.667670 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:18:49.667670 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:18:49.677629 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m16:18:49.677629 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:18:49.677629 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:18:49.677629 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:18:49.677629 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:18:49.677629 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m16:18:49.677629 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:18:49.677629 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:18:49.677629 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m16:18:49.687386 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:18:49.698707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f48fed02-70ec-4fd3-9113-2566eb0ec171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4DC8F950>]}
[0m16:18:49.698707 [debug] [MainThread]: Using duckdb connection "master"
[0m16:18:49.698707 [debug] [MainThread]: On master: BEGIN
[0m16:18:49.698707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:18:49.725788 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:18:49.726276 [debug] [MainThread]: On master: COMMIT
[0m16:18:49.726795 [debug] [MainThread]: Using duckdb connection "master"
[0m16:18:49.727386 [debug] [MainThread]: On master: COMMIT
[0m16:18:49.728140 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:18:49.728640 [debug] [MainThread]: On master: Close
[0m16:18:49.734716 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:18:49.735295 [info ] [MainThread]: 
[0m16:18:49.763463 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m16:18:49.763463 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents_wildlands  [RUN]
[0m16:18:49.763463 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands'
[0m16:18:49.763463 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m16:18:49.771449 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m16:18:49.779457 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m16:18:49.801499 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m16:18:49.801499 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m16:18:49.801499 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: BEGIN
[0m16:18:49.801499 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:18:49.832623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:18:49.832623 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m16:18:49.832623 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents and Wildlands Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__wildlands

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed__wildlands and join it to the prior CTE

All columns from nfirs_processed__incidents and all columns excluding duplicative columns from
nfirs_transformed_wildlands will be taken.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Wildlands CTE
wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands"
),

-- Incidents and Wildlands join
incidents_wildlands_final AS (
    SELECT
        inc.*,
        wld.* EXCLUDE(state, fdid, inc_date, inc_no, exp_no)
    FROM incidents_source inc
    LEFT JOIN wildlands_source wld
        ON inc.incident_key = wld.incident_key
)

SELECT * FROM incidents_wildlands_final
    );
  
  
[0m16:23:24.451070 [debug] [Thread-1 (]: SQL status: OK in 275.0 seconds
[0m16:23:24.451070 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m16:23:24.459154 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_tmp" rename to "nfirs_processed__incidents_wildlands"
[0m16:23:24.506451 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:23:24.522549 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: COMMIT
[0m16:23:24.522549 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m16:23:24.522549 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: COMMIT
[0m16:24:05.554628 [debug] [Thread-1 (]: SQL status: OK in 41.0 seconds
[0m16:24:05.562628 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m16:24:05.562628 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */
drop table if exists "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_backup" cascade
[0m16:24:05.562628 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:24:05.570627 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: Close
[0m16:24:13.615675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f48fed02-70ec-4fd3-9113-2566eb0ec171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4DC2B530>]}
[0m16:24:13.615675 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_processed.nfirs_processed__incidents_wildlands  [[32mOK[0m in 323.85s]
[0m16:24:13.623636 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m16:24:13.623636 [debug] [MainThread]: Using duckdb connection "master"
[0m16:24:13.623636 [debug] [MainThread]: On master: BEGIN
[0m16:24:13.623636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:13.663637 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:24:13.663637 [debug] [MainThread]: On master: COMMIT
[0m16:24:13.663637 [debug] [MainThread]: Using duckdb connection "master"
[0m16:24:13.663637 [debug] [MainThread]: On master: COMMIT
[0m16:24:13.663637 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:24:13.663637 [debug] [MainThread]: On master: Close
[0m16:24:13.679882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:13.679882 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m16:24:13.679882 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:24:13.687887 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m16:24:13.687887 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:24:13.687887 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands' was properly closed.
[0m16:24:13.687887 [info ] [MainThread]: 
[0m16:24:13.687887 [info ] [MainThread]: Finished running 1 table model in 0 hours 5 minutes and 24.74 seconds (324.74s).
[0m16:24:13.687887 [debug] [MainThread]: Command end result
[0m16:24:13.729691 [info ] [MainThread]: 
[0m16:24:13.729810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:13.730830 [info ] [MainThread]: 
[0m16:24:13.731888 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:24:13.733019 [debug] [MainThread]: Command `cli run` succeeded at 16:24:13.733019 after 325.45 seconds
[0m16:24:13.733019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB50437EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB50434FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB4E4E6E70>]}
[0m16:24:13.734258 [debug] [MainThread]: Flushing usage events
[0m16:48:30.971158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC0921670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC0922120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC0923D10>]}


============================== 16:48:30.974155 | c6837346-5d10-4f08-833a-86a8bb78bba1 ==============================
[0m16:48:30.974155 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:48:30.975114 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:48:31.174746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6837346-5d10-4f08-833a-86a8bb78bba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC1F4D1F0>]}
[0m16:48:31.215713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6837346-5d10-4f08-833a-86a8bb78bba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC00088F0>]}
[0m16:48:31.216715 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:48:31.226712 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:48:31.364596 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:48:31.364596 [debug] [MainThread]: Partial parsing: added file: nfirs_dbt_project_new://models\nfirs_processed\nfirs_processed__incidents_aid_casualty.sql
[0m16:48:31.365596 [debug] [MainThread]: Partial parsing: deleted file: nfirs_dbt_project_new://models\nfirs_processed\nfirs_processed__aid_casualty.sql
[0m16:48:31.541121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6837346-5d10-4f08-833a-86a8bb78bba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC2579310>]}
[0m16:48:31.625725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6837346-5d10-4f08-833a-86a8bb78bba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC21CBC50>]}
[0m16:48:31.625725 [info ] [MainThread]: Found 25 models, 4 data tests, 19 sources, 524 macros
[0m16:48:31.625725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6837346-5d10-4f08-833a-86a8bb78bba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CBF9044D0>]}
[0m16:48:31.625725 [info ] [MainThread]: 
[0m16:48:31.625725 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:48:31.625725 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:48:31.692490 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:48:31.692490 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:48:31.693665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:32.066147 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:48:32.067148 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:48:32.070270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:32.071375 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m16:48:32.071375 [info ] [MainThread]: 
[0m16:48:32.072414 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m16:48:32.073413 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 11320)
[0m16:48:32.074418 [debug] [MainThread]: Command `cli run` failed at 16:48:32.074418 after 1.21 seconds
[0m16:48:32.075486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC0923D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC246BF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC21CBC50>]}
[0m16:48:32.076414 [debug] [MainThread]: Flushing usage events
[0m16:49:02.978872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A65C3D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A65C3C0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A65C3FEC0>]}


============================== 16:49:02.978872 | 41e73f2f-369b-4b49-a8e1-889338e0a1f5 ==============================
[0m16:49:02.978872 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:49:02.978872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:49:03.135907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41e73f2f-369b-4b49-a8e1-889338e0a1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A65D690A0>]}
[0m16:49:03.184742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41e73f2f-369b-4b49-a8e1-889338e0a1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A65E8B4D0>]}
[0m16:49:03.185843 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:49:03.194186 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:49:03.319402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:03.319402 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:03.352538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41e73f2f-369b-4b49-a8e1-889338e0a1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A65FEF650>]}
[0m16:49:03.428103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41e73f2f-369b-4b49-a8e1-889338e0a1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A66089370>]}
[0m16:49:03.428103 [info ] [MainThread]: Found 25 models, 4 data tests, 19 sources, 524 macros
[0m16:49:03.428103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41e73f2f-369b-4b49-a8e1-889338e0a1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A660F6180>]}
[0m16:49:03.428103 [info ] [MainThread]: 
[0m16:49:03.436176 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:49:03.436176 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:49:03.494570 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:49:03.494570 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:49:03.494570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:03.527621 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:49:03.527621 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:49:03.538293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m16:49:03.538293 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m16:49:03.538293 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m16:49:03.538293 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:49:03.546340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:03.570901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:49:03.570901 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m16:49:03.570901 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m16:49:03.570901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:49:03.570901 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m16:49:03.570901 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m16:49:03.570901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:49:03.570901 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m16:49:03.570901 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m16:49:03.570901 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m16:49:03.570901 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:49:03.570901 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m16:49:03.585856 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:49:03.594181 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:49:03.594181 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:49:03.594181 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m16:49:03.594181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:03.594181 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:49:03.594181 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m16:49:03.619280 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:49:03.619280 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m16:49:03.627609 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:49:03.627609 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:49:03.627609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:03.627609 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:49:03.627609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:03.627609 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:49:03.627609 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:49:03.627609 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:49:03.627609 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m16:49:03.627609 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:49:03.627609 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m16:49:03.627609 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:49:03.652549 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:49:03.660629 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:49:03.669051 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:49:03.669051 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m16:49:03.669051 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:49:03.671083 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:49:03.671083 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:49:03.671083 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:49:03.671083 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m16:49:03.671083 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:49:03.671083 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m16:49:03.671083 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:49:03.679165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41e73f2f-369b-4b49-a8e1-889338e0a1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A65E8B260>]}
[0m16:49:03.679165 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:03.679165 [debug] [MainThread]: On master: BEGIN
[0m16:49:03.679165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:03.710361 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:49:03.710361 [debug] [MainThread]: On master: COMMIT
[0m16:49:03.710361 [debug] [MainThread]: Using duckdb connection "master"
[0m16:49:03.710361 [debug] [MainThread]: On master: COMMIT
[0m16:49:03.710361 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:49:03.710361 [debug] [MainThread]: On master: Close
[0m16:49:03.719003 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:49:03.719003 [info ] [MainThread]: 
[0m16:49:03.719003 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty
[0m16:49:03.719003 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents_aid_casualty  [RUN]
[0m16:49:03.719003 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty'
[0m16:49:03.719003 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty
[0m16:49:03.727009 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m16:49:03.735568 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty
[0m16:49:03.752163 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m16:49:03.760244 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m16:49:03.760244 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: BEGIN
[0m16:49:03.760244 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:49:03.785674 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:49:03.785674 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m16:49:03.785674 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs_processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source inc
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

-- Create final CTE
incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age AS age_cvl,
        cvl.race AS race_cvl,
        cvl.ethnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.symptom AS symptom_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqp AS prot_eqp
    FROM incidents_basicaid_source inc
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m16:52:59.720480 [debug] [Thread-1 (]: SQL status: OK in 236.0 seconds
[0m16:52:59.720480 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m16:52:59.720480 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents_aid_casualty__dbt_tmp" rename to "nfirs_processed__incidents_aid_casualty"
[0m16:52:59.720480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:52:59.743310 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: COMMIT
[0m16:52:59.743310 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m16:52:59.744344 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: COMMIT
[0m16:53:24.711492 [debug] [Thread-1 (]: SQL status: OK in 25.0 seconds
[0m16:53:24.721669 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m16:53:24.721669 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"} */
drop table if exists "nfirs"."nfirs_processed"."nfirs_processed__incidents_aid_casualty__dbt_backup" cascade
[0m16:53:24.721669 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:53:24.721669 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: Close
[0m16:53:30.717737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41e73f2f-369b-4b49-a8e1-889338e0a1f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A635DB770>]}
[0m16:53:30.718758 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_processed.nfirs_processed__incidents_aid_casualty  [[32mOK[0m in 267.00s]
[0m16:53:30.719756 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty
[0m16:53:30.720905 [debug] [MainThread]: Using duckdb connection "master"
[0m16:53:30.720905 [debug] [MainThread]: On master: BEGIN
[0m16:53:30.720905 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:53:30.757094 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:53:30.757094 [debug] [MainThread]: On master: COMMIT
[0m16:53:30.758062 [debug] [MainThread]: Using duckdb connection "master"
[0m16:53:30.758062 [debug] [MainThread]: On master: COMMIT
[0m16:53:30.759074 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:53:30.759074 [debug] [MainThread]: On master: Close
[0m16:53:30.772336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:30.773335 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m16:53:30.773335 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:53:30.773335 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m16:53:30.774330 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:53:30.774330 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty' was properly closed.
[0m16:53:30.779341 [info ] [MainThread]: 
[0m16:53:30.780339 [info ] [MainThread]: Finished running 1 table model in 0 hours 4 minutes and 27.35 seconds (267.35s).
[0m16:53:30.781303 [debug] [MainThread]: Command end result
[0m16:53:30.807303 [info ] [MainThread]: 
[0m16:53:30.807593 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:53:30.807593 [info ] [MainThread]: 
[0m16:53:30.808677 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:53:30.809632 [debug] [MainThread]: Command `cli run` succeeded at 16:53:30.809632 after 267.93 seconds
[0m16:53:30.809632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A63BCB980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A6608AB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A66089370>]}
[0m16:53:30.809632 [debug] [MainThread]: Flushing usage events
[0m10:56:19.027027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027896E810A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278969F9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027894198560>]}


============================== 10:56:19.041223 | 7f7b9da2-76b2-44ad-87fc-ed1c5aa8937e ==============================
[0m10:56:19.041223 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:56:19.041223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:56:19.191072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f7b9da2-76b2-44ad-87fc-ed1c5aa8937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278986E02C0>]}
[0m10:56:19.226134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f7b9da2-76b2-44ad-87fc-ed1c5aa8937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027895D6F470>]}
[0m10:56:19.240713 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m10:56:19.241189 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:56:19.374318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:56:19.374318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:56:19.407543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f7b9da2-76b2-44ad-87fc-ed1c5aa8937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789879FC50>]}
[0m10:56:19.490904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f7b9da2-76b2-44ad-87fc-ed1c5aa8937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789883B9B0>]}
[0m10:56:19.490904 [info ] [MainThread]: Found 25 models, 4 data tests, 19 sources, 524 macros
[0m10:56:19.490904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f7b9da2-76b2-44ad-87fc-ed1c5aa8937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278986C4EC0>]}
[0m10:56:19.490904 [info ] [MainThread]: 
[0m10:56:19.490904 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:56:19.490904 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m10:56:19.774305 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m10:56:19.774305 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m10:56:19.774305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:19.840290 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:19.841258 [debug] [ThreadPool]: On list_nfirs: Close
[0m10:56:19.857621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m10:56:19.857621 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m10:56:19.857621 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:56:19.857621 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m10:56:19.857621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:56:19.891024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:19.891024 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:56:19.891024 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m10:56:19.891024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:19.891024 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:56:19.891024 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m10:56:19.891024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:19.891024 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m10:56:19.891024 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:56:19.891024 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m10:56:19.891024 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:19.891024 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m10:56:19.907753 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m10:56:19.907753 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:56:19.907753 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m10:56:19.907753 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m10:56:19.907753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:19.907753 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m10:56:19.923965 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:56:19.940962 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:19.940962 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:56:19.940962 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m10:56:19.940962 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:56:19.940962 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m10:56:19.957249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:19.957249 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m10:56:19.957249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:56:19.957249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:19.957249 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:19.957249 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:56:19.957249 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:56:19.957249 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m10:56:19.957249 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m10:56:19.994283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:19.994283 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:20.007352 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m10:56:20.007352 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m10:56:20.007352 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:56:20.007352 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m10:56:20.007352 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m10:56:20.007352 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m10:56:20.007352 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m10:56:20.007352 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m10:56:20.007352 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m10:56:20.007352 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m10:56:20.026675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f7b9da2-76b2-44ad-87fc-ed1c5aa8937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027898A485F0>]}
[0m10:56:20.026675 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:20.026675 [debug] [MainThread]: On master: BEGIN
[0m10:56:20.026675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:56:20.057180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:20.057180 [debug] [MainThread]: On master: COMMIT
[0m10:56:20.057180 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:20.057180 [debug] [MainThread]: On master: COMMIT
[0m10:56:20.057180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:20.057180 [debug] [MainThread]: On master: Close
[0m10:56:20.057180 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:56:20.057180 [info ] [MainThread]: 
[0m10:56:20.075528 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m10:56:20.075528 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents ........ [RUN]
[0m10:56:20.076501 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents'
[0m10:56:20.076501 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m10:56:20.079559 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m10:56:20.079559 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m10:56:20.108937 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m10:56:20.111830 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m10:56:20.111830 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: BEGIN
[0m10:56:20.111830 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:56:20.141164 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:56:20.141164 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m10:56:20.142167 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents Table Creation *****/
/***
The below model will join the following tables together to for further analysis:
- nfirs_transformed__fdheader
- nfirs_transformed__basicincident
- nfirs_transformed__incidentaddress
- nfirs_transformed__fireincident

The following logic will be applied:
- FD Header CTE to aggregate numeric columns
- Basic Incident CTE to select all columns from the respective table
- Fire Incident CTE to select all columns from the respective table
- The Basic Incident CTE serves at the base table and the FD Header and
  Fire Incident table are left joined to basic incident

All columns will be written out to clearly specify what columns are included
***/



-- Create FD Header CTEs
WITH transformed_fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader"
),

fdheader_processed AS (
    SELECT
        state,
        fdid,
        fd_name,
        fd_str_no,
        fd_str_pre,
        fd_street,
        fd_str_typ,
        fd_str_suf,
        fd_city,
        fd_zip,
        fd_phone,
        fd_fax,
        fd_email,
        fd_fip_cty,
        SUM(no_station) AS no_station,
        SUM(no_pd_ff) AS no_pd_ff,
        SUM(no_vol_ff) AS no_vol_ff,
        SUM(no_vol_pdc) AS no_vol_pdc
    FROM transformed_fdheader_source
    GROUP BY ALL
),

-- Create Basic Incident CTEs
transformed_basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident"
),

basicincident_processed AS (
    SELECT * FROM transformed_basicincident_source
),

-- Create Fire Incident CTEs
transformed_fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident"
),

fireincident_processed AS (
    SELECT * FROM transformed_fireincident_source
),

-- Create Incident Address CTEs
transformed_incidentaddress_source AS (
	SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__incidentaddress"
),

incidentaddress_processed AS (
	SELECT * FROM transformed_incidentaddress_source
)

-- Join the three processed CTEs together
incidents_processed_final AS (
    SELECT
        fd.state,
        fd.fdid,
        fd.fd_name,
        fd.fd_str_no,
        fd.fd_str_pre,
        fd.fd_street,
        fd.fd_str_typ,
        fd.fd_str_suf,
        fd.fd_city,
        fd.fd_zip,
        fd.fd_phone,
        fd.fd_fax,
        fd.fd_email,
        fd.fd_fip_cty,
		ad.loc_type,
		ad.num_mile,
		ad.street_pre,
		ad.streetname,
		ad.streettype,
		ad.streetsuf,
		ad.apt_no,
		ad.city,
		ad.state_id,
		ad.zip5,
		ad.zip4,
		ad.x_street,
        b.incident_key,
	    b.inc_date,
	    b.inc_no,
        b.exp_no,
        b.dept_sta,
        b.inc_type,
        b.add_wild,
        b.aid,
        b.alarm,
        b.arrival,
        b.inc_cont,
        b.lu_clear,
        b.shift,
        b.alarms,
        b.district,
		b.act_tak1,
		b.act_tak2,
		b.act_tak3,
		b.app_mod,
		b.sup_app,
		b.ems_app,
		b.oth_app,
		b.sup_per,
		b.ems_per,
		b.oth_per,
		b.resou_aid,
		b.prop_loss,
		b.cont_loss,
		b.prop_val,
		b.cont_val,
		b.ff_death,
		b.oth_death,
		b.ff_inj,
		b.oth_inj,
		b.det_alert,
		b.haz_rel,
		b.mixed_use,
		b.prop_use,
		b.census,
        f.num_unit,
		f.not_res,
		f.bldg_invol,
		f.acres_burn,
		f.less_1acre,
		f.on_site_m1,
		f.mat_stor1,
		f.on_site_m2,
		f.mat_stor2,
		f.on_site_m3,
		f.mat_stor3,
		f.area_orig,
		f.heat_sourc,
		f.first_ign,
		f.conf_orig,
		f.type_mat,
		f.cause_ign,
		f.fact_ign_1,
		f.fact_ign_2,
		f.hum_fac_1,
		f.hum_fac_2,
		f.hum_fac_3,
		f.hum_fac_4,
		f.hum_fac_5,
		f.hum_fac_6,
		f.hum_fac_7,
		f.hum_fac_8,
		f.age,
		f.sex,
		f.equip_inv,
		f.sup_fac_1,
		f.sup_fac_2,
		f.sup_fac_3,
		f.mob_invol,
		f.mob_type,
		f.mob_make,
		f.mob_model,
		f.mob_year,
		f.mob_lic_pl,
		f.mob_state,
		f.mob_vin_no,
		f.eq_brand,
		f.eq_model,
		f.eq_ser_no,
		f.eq_year,
		f.eq_power,
		f.eq_port,
		f.fire_sprd,
		f.struc_type,
		f.struc_stat,
		f.bldg_above,
		f.bldg_below,
		f.bldg_lgth,
		f.bldg_width,
		f.tot_sq_ft,
		f.fire_orig,
		f.st_dm_min_update,
		f.st_dm_sig,
		f.st_dam_hvy,
		f.st_dam_xtr,
		f.flame_sprd,
		f.item_sprd,
		f.mat_sprd,
		f.detector,
		f.det_type,
		f.det_power,
		f.det_operat,
		f.det_effect,
		f.det_fail,
		f.aes_pres,
		f.aes_type,
		f.aes_oper,
		f.no_spr_op,
		f.aes_fail
    FROM basicincident_processed b
	LEFT JOIN incidentaddress_processed ad
		ON b.incident_key = ad.incident_key
    LEFT JOIN fdheader_processed fd
        ON b.fdid = fd.fdid AND b.state = fd.state
    LEFT JOIN fireincident_processed f
        ON b.incident_key = f.incident_key AND b.inc_no = f.inc_no
)


SELECT * FROM incidents_processed_final
    );
  
  
[0m10:56:20.147210 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents Table Creation *****/
/***
The below model will join the following tables together to for further analysis:
- nfirs_transformed__fdheader
- nfirs_transformed__basicincident
- nfirs_transformed__incidentaddress
- nfirs_transformed__fireincident

The following logic will be applied:
- FD Header CTE to aggregate numeric columns
- Basic Incident CTE to select all columns from the respective table
- Fire Incident CTE to select all columns from the respective table
- The Basic Incident CTE serves at the base table and the FD Header and
  Fire Incident table are left joined to basic incident

All columns will be written out to clearly specify what columns are included
***/



-- Create FD Header CTEs
WITH transformed_fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader"
),

fdheader_processed AS (
    SELECT
        state,
        fdid,
        fd_name,
        fd_str_no,
        fd_str_pre,
        fd_street,
        fd_str_typ,
        fd_str_suf,
        fd_city,
        fd_zip,
        fd_phone,
        fd_fax,
        fd_email,
        fd_fip_cty,
        SUM(no_station) AS no_station,
        SUM(no_pd_ff) AS no_pd_ff,
        SUM(no_vol_ff) AS no_vol_ff,
        SUM(no_vol_pdc) AS no_vol_pdc
    FROM transformed_fdheader_source
    GROUP BY ALL
),

-- Create Basic Incident CTEs
transformed_basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident"
),

basicincident_processed AS (
    SELECT * FROM transformed_basicincident_source
),

-- Create Fire Incident CTEs
transformed_fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident"
),

fireincident_processed AS (
    SELECT * FROM transformed_fireincident_source
),

-- Create Incident Address CTEs
transformed_incidentaddress_source AS (
	SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__incidentaddress"
),

incidentaddress_processed AS (
	SELECT * FROM transformed_incidentaddress_source
)

-- Join the three processed CTEs together
incidents_processed_final AS (
    SELECT
        fd.state,
        fd.fdid,
        fd.fd_name,
        fd.fd_str_no,
        fd.fd_str_pre,
        fd.fd_street,
        fd.fd_str_typ,
        fd.fd_str_suf,
        fd.fd_city,
        fd.fd_zip,
        fd.fd_phone,
        fd.fd_fax,
        fd.fd_email,
        fd.fd_fip_cty,
		ad.loc_type,
		ad.num_mile,
		ad.street_pre,
		ad.streetname,
		ad.streettype,
		ad.streetsuf,
		ad.apt_no,
		ad.city,
		ad.state_id,
		ad.zip5,
		ad.zip4,
		ad.x_street,
        b.incident_key,
	    b.inc_date,
	    b.inc_no,
        b.exp_no,
        b.dept_sta,
        b.inc_type,
        b.add_wild,
        b.aid,
        b.alarm,
        b.arrival,
        b.inc_cont,
        b.lu_clear,
        b.shift,
        b.alarms,
        b.district,
		b.act_tak1,
		b.act_tak2,
		b.act_tak3,
		b.app_mod,
		b.sup_app,
		b.ems_app,
		b.oth_app,
		b.sup_per,
		b.ems_per,
		b.oth_per,
		b.resou_aid,
		b.prop_loss,
		b.cont_loss,
		b.prop_val,
		b.cont_val,
		b.ff_death,
		b.oth_death,
		b.ff_inj,
		b.oth_inj,
		b.det_alert,
		b.haz_rel,
		b.mixed_use,
		b.prop_use,
		b.census,
        f.num_unit,
		f.not_res,
		f.bldg_invol,
		f.acres_burn,
		f.less_1acre,
		f.on_site_m1,
		f.mat_stor1,
		f.on_site_m2,
		f.mat_stor2,
		f.on_site_m3,
		f.mat_stor3,
		f.area_orig,
		f.heat_sourc,
		f.first_ign,
		f.conf_orig,
		f.type_mat,
		f.cause_ign,
		f.fact_ign_1,
		f.fact_ign_2,
		f.hum_fac_1,
		f.hum_fac_2,
		f.hum_fac_3,
		f.hum_fac_4,
		f.hum_fac_5,
		f.hum_fac_6,
		f.hum_fac_7,
		f.hum_fac_8,
		f.age,
		f.sex,
		f.equip_inv,
		f.sup_fac_1,
		f.sup_fac_2,
		f.sup_fac_3,
		f.mob_invol,
		f.mob_type,
		f.mob_make,
		f.mob_model,
		f.mob_year,
		f.mob_lic_pl,
		f.mob_state,
		f.mob_vin_no,
		f.eq_brand,
		f.eq_model,
		f.eq_ser_no,
		f.eq_year,
		f.eq_power,
		f.eq_port,
		f.fire_sprd,
		f.struc_type,
		f.struc_stat,
		f.bldg_above,
		f.bldg_below,
		f.bldg_lgth,
		f.bldg_width,
		f.tot_sq_ft,
		f.fire_orig,
		f.st_dm_min_update,
		f.st_dm_sig,
		f.st_dam_hvy,
		f.st_dam_xtr,
		f.flame_sprd,
		f.item_sprd,
		f.mat_sprd,
		f.detector,
		f.det_type,
		f.det_power,
		f.det_operat,
		f.det_effect,
		f.det_fail,
		f.aes_pres,
		f.aes_type,
		f.aes_oper,
		f.no_spr_op,
		f.aes_fail
    FROM basicincident_processed b
	LEFT JOIN incidentaddress_processed ad
		ON b.incident_key = ad.incident_key
    LEFT JOIN fdheader_processed fd
        ON b.fdid = fd.fdid AND b.state = fd.state
    LEFT JOIN fireincident_processed f
        ON b.incident_key = f.incident_key AND b.inc_no = f.inc_no
)


SELECT * FROM incidents_processed_final
    );
  
  
[0m10:56:20.147210 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m10:56:20.148213 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: ROLLBACK
[0m10:56:20.156276 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__incidents'
[0m10:56:20.156276 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: Close
[0m10:56:20.165165 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__incidents (models\nfirs_processed\nfirs_processed__incidents.sql)
  Parser Error: syntax error at or near "incidents_processed_final"
[0m10:56:20.166166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f7b9da2-76b2-44ad-87fc-ed1c5aa8937e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278969C33E0>]}
[0m10:56:20.166166 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__incidents  [[31mERROR[0m in 0.09s]
[0m10:56:20.167163 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m10:56:20.169824 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:20.169824 [debug] [MainThread]: On master: BEGIN
[0m10:56:20.169824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:56:20.191926 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:20.191926 [debug] [MainThread]: On master: COMMIT
[0m10:56:20.191926 [debug] [MainThread]: Using duckdb connection "master"
[0m10:56:20.191926 [debug] [MainThread]: On master: COMMIT
[0m10:56:20.191926 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:56:20.191926 [debug] [MainThread]: On master: Close
[0m10:56:20.207439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:56:20.207439 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m10:56:20.207439 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m10:56:20.207439 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m10:56:20.207439 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m10:56:20.207439 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents' was properly closed.
[0m10:56:20.207439 [info ] [MainThread]: 
[0m10:56:20.207439 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m10:56:20.207439 [debug] [MainThread]: Command end result
[0m10:56:20.229110 [info ] [MainThread]: 
[0m10:56:20.229110 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:56:20.229110 [info ] [MainThread]: 
[0m10:56:20.229110 [error] [MainThread]:   Runtime Error in model nfirs_processed__incidents (models\nfirs_processed\nfirs_processed__incidents.sql)
  Parser Error: syntax error at or near "incidents_processed_final"
[0m10:56:20.229110 [info ] [MainThread]: 
[0m10:56:20.229110 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:56:20.240108 [debug] [MainThread]: Command `cli run` failed at 10:56:20.229110 after 1.32 seconds
[0m10:56:20.240108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027896E55D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002789832D580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027896F49DF0>]}
[0m10:56:20.241108 [debug] [MainThread]: Flushing usage events
[0m10:57:15.500143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90D422D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90D4230B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90B987A40>]}


============================== 10:57:15.516804 | c55ea958-7643-40f4-a61b-83dfd064a05b ==============================
[0m10:57:15.516804 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:57:15.516804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:57:15.667456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c55ea958-7643-40f4-a61b-83dfd064a05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90D64E120>]}
[0m10:57:15.700928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c55ea958-7643-40f4-a61b-83dfd064a05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90D5AD010>]}
[0m10:57:15.700928 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m10:57:15.716609 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:57:15.849938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:15.849938 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:15.883308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c55ea958-7643-40f4-a61b-83dfd064a05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90D8C1250>]}
[0m10:57:15.966552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c55ea958-7643-40f4-a61b-83dfd064a05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90D95AEA0>]}
[0m10:57:15.966552 [info ] [MainThread]: Found 25 models, 4 data tests, 19 sources, 524 macros
[0m10:57:15.966552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c55ea958-7643-40f4-a61b-83dfd064a05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90D79C950>]}
[0m10:57:15.966552 [info ] [MainThread]: 
[0m10:57:15.966552 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:57:15.983269 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m10:57:16.043712 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m10:57:16.043712 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m10:57:16.044641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:16.066630 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:16.066630 [debug] [ThreadPool]: On list_nfirs: Close
[0m10:57:16.083284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m10:57:16.083284 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m10:57:16.083284 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:57:16.083284 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m10:57:16.083284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:16.116420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:16.116420 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:57:16.116420 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m10:57:16.116420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:16.116420 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:57:16.116420 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m10:57:16.116420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:16.116420 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m10:57:16.116420 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m10:57:16.116420 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m10:57:16.116420 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:16.116420 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m10:57:16.133229 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m10:57:16.133229 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:57:16.133229 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m10:57:16.133229 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m10:57:16.133229 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m10:57:16.133229 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:57:16.133229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:16.133229 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:57:16.133229 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m10:57:16.166448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:16.166448 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m10:57:16.166448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:16.166448 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:57:16.166448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:16.166448 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m10:57:16.166448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:16.166448 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:16.166448 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:57:16.166448 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:57:16.166448 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m10:57:16.166448 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m10:57:16.201383 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:16.201383 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m10:57:16.201383 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:16.201383 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:16.201383 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m10:57:16.215922 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m10:57:16.217106 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m10:57:16.217106 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m10:57:16.217106 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m10:57:16.217106 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m10:57:16.217106 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m10:57:16.217106 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m10:57:16.234836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c55ea958-7643-40f4-a61b-83dfd064a05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90DECEAB0>]}
[0m10:57:16.235376 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:16.235376 [debug] [MainThread]: On master: BEGIN
[0m10:57:16.236049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:16.250017 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:57:16.250017 [debug] [MainThread]: On master: COMMIT
[0m10:57:16.250017 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:16.250017 [debug] [MainThread]: On master: COMMIT
[0m10:57:16.250017 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:57:16.250017 [debug] [MainThread]: On master: Close
[0m10:57:16.266379 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:57:16.266379 [info ] [MainThread]: 
[0m10:57:16.266379 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m10:57:16.266379 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents ........ [RUN]
[0m10:57:16.266379 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents'
[0m10:57:16.266379 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m10:57:16.284285 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m10:57:16.285278 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m10:57:16.301358 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m10:57:16.301358 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m10:57:16.301358 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: BEGIN
[0m10:57:16.301358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:57:16.333372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m10:57:16.333372 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m10:57:16.333372 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents Table Creation *****/
/***
The below model will join the following tables together to for further analysis:
- nfirs_transformed__fdheader
- nfirs_transformed__basicincident
- nfirs_transformed__incidentaddress
- nfirs_transformed__fireincident

The following logic will be applied:
- FD Header CTE to aggregate numeric columns
- Basic Incident CTE to select all columns from the respective table
- Fire Incident CTE to select all columns from the respective table
- The Basic Incident CTE serves at the base table and the FD Header and
  Fire Incident table are left joined to basic incident

All columns will be written out to clearly specify what columns are included
***/



-- Create FD Header CTEs
WITH transformed_fdheader_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fdheader"
),

fdheader_processed AS (
    SELECT
        state,
        fdid,
        fd_name,
        fd_str_no,
        fd_str_pre,
        fd_street,
        fd_str_typ,
        fd_str_suf,
        fd_city,
        fd_zip,
        fd_phone,
        fd_fax,
        fd_email,
        fd_fip_cty,
        SUM(no_station) AS no_station,
        SUM(no_pd_ff) AS no_pd_ff,
        SUM(no_vol_ff) AS no_vol_ff,
        SUM(no_vol_pdc) AS no_vol_pdc
    FROM transformed_fdheader_source
    GROUP BY ALL
),

-- Create Basic Incident CTEs
transformed_basicincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicincident"
),

basicincident_processed AS (
    SELECT * FROM transformed_basicincident_source
),

-- Create Fire Incident CTEs
transformed_fireincident_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__fireincident"
),

fireincident_processed AS (
    SELECT * FROM transformed_fireincident_source
),

-- Create Incident Address CTEs
transformed_incidentaddress_source AS (
	SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__incidentaddress"
),

incidentaddress_processed AS (
	SELECT * FROM transformed_incidentaddress_source
),

-- Join the three processed CTEs together
incidents_processed_final AS (
    SELECT
        fd.state,
        fd.fdid,
        fd.fd_name,
        fd.fd_str_no,
        fd.fd_str_pre,
        fd.fd_street,
        fd.fd_str_typ,
        fd.fd_str_suf,
        fd.fd_city,
        fd.fd_zip,
        fd.fd_phone,
        fd.fd_fax,
        fd.fd_email,
        fd.fd_fip_cty,
		ad.loc_type,
		ad.num_mile,
		ad.street_pre,
		ad.streetname,
		ad.streettype,
		ad.streetsuf,
		ad.apt_no,
		ad.city,
		ad.state_id,
		ad.zip5,
		ad.zip4,
		ad.x_street,
        b.incident_key,
	    b.inc_date,
	    b.inc_no,
        b.exp_no,
        b.dept_sta,
        b.inc_type,
        b.add_wild,
        b.aid,
        b.alarm,
        b.arrival,
        b.inc_cont,
        b.lu_clear,
        b.shift,
        b.alarms,
        b.district,
		b.act_tak1,
		b.act_tak2,
		b.act_tak3,
		b.app_mod,
		b.sup_app,
		b.ems_app,
		b.oth_app,
		b.sup_per,
		b.ems_per,
		b.oth_per,
		b.resou_aid,
		b.prop_loss,
		b.cont_loss,
		b.prop_val,
		b.cont_val,
		b.ff_death,
		b.oth_death,
		b.ff_inj,
		b.oth_inj,
		b.det_alert,
		b.haz_rel,
		b.mixed_use,
		b.prop_use,
		b.census,
        f.num_unit,
		f.not_res,
		f.bldg_invol,
		f.acres_burn,
		f.less_1acre,
		f.on_site_m1,
		f.mat_stor1,
		f.on_site_m2,
		f.mat_stor2,
		f.on_site_m3,
		f.mat_stor3,
		f.area_orig,
		f.heat_sourc,
		f.first_ign,
		f.conf_orig,
		f.type_mat,
		f.cause_ign,
		f.fact_ign_1,
		f.fact_ign_2,
		f.hum_fac_1,
		f.hum_fac_2,
		f.hum_fac_3,
		f.hum_fac_4,
		f.hum_fac_5,
		f.hum_fac_6,
		f.hum_fac_7,
		f.hum_fac_8,
		f.age,
		f.sex,
		f.equip_inv,
		f.sup_fac_1,
		f.sup_fac_2,
		f.sup_fac_3,
		f.mob_invol,
		f.mob_type,
		f.mob_make,
		f.mob_model,
		f.mob_year,
		f.mob_lic_pl,
		f.mob_state,
		f.mob_vin_no,
		f.eq_brand,
		f.eq_model,
		f.eq_ser_no,
		f.eq_year,
		f.eq_power,
		f.eq_port,
		f.fire_sprd,
		f.struc_type,
		f.struc_stat,
		f.bldg_above,
		f.bldg_below,
		f.bldg_lgth,
		f.bldg_width,
		f.tot_sq_ft,
		f.fire_orig,
		f.st_dm_min_update,
		f.st_dm_sig,
		f.st_dam_hvy,
		f.st_dam_xtr,
		f.flame_sprd,
		f.item_sprd,
		f.mat_sprd,
		f.detector,
		f.det_type,
		f.det_power,
		f.det_operat,
		f.det_effect,
		f.det_fail,
		f.aes_pres,
		f.aes_type,
		f.aes_oper,
		f.no_spr_op,
		f.aes_fail
    FROM basicincident_processed b
	LEFT JOIN incidentaddress_processed ad
		ON b.incident_key = ad.incident_key
    LEFT JOIN fdheader_processed fd
        ON b.fdid = fd.fdid AND b.state = fd.state
    LEFT JOIN fireincident_processed f
        ON b.incident_key = f.incident_key AND b.inc_no = f.inc_no
)


SELECT * FROM incidents_processed_final
    );
  
  
[0m11:01:50.980758 [debug] [Thread-1 (]: SQL status: OK in 275.0 seconds
[0m11:01:50.997657 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m11:01:50.997657 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents" rename to "nfirs_processed__incidents__dbt_backup"
[0m11:01:51.014229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:01:51.014229 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m11:01:51.014229 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_tmp" rename to "nfirs_processed__incidents"
[0m11:01:51.014229 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:01:51.044631 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: COMMIT
[0m11:01:51.045590 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m11:01:51.045590 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: COMMIT
[0m11:02:20.951387 [debug] [Thread-1 (]: SQL status: OK in 30.0 seconds
[0m11:02:20.961471 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents"
[0m11:02:20.962459 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents"} */
drop table if exists "nfirs"."nfirs_processed"."nfirs_processed__incidents__dbt_backup" cascade
[0m11:02:21.067885 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:02:21.076000 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents: Close
[0m11:02:41.908860 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c55ea958-7643-40f4-a61b-83dfd064a05b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90DED9730>]}
[0m11:02:41.908860 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_processed.nfirs_processed__incidents ... [[32mOK[0m in 325.64s]
[0m11:02:41.908860 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents
[0m11:02:41.925185 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:41.925185 [debug] [MainThread]: On master: BEGIN
[0m11:02:41.925185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:41.977412 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:02:41.977412 [debug] [MainThread]: On master: COMMIT
[0m11:02:41.980048 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:41.980048 [debug] [MainThread]: On master: COMMIT
[0m11:02:41.980048 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:02:41.980048 [debug] [MainThread]: On master: Close
[0m11:02:41.993759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:41.993759 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m11:02:41.993759 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m11:02:41.993759 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:02:41.993759 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:02:41.993759 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents' was properly closed.
[0m11:02:41.993759 [info ] [MainThread]: 
[0m11:02:41.993759 [info ] [MainThread]: Finished running 1 table model in 0 hours 5 minutes and 26.03 seconds (326.03s).
[0m11:02:41.993759 [debug] [MainThread]: Command end result
[0m11:02:42.031247 [info ] [MainThread]: 
[0m11:02:42.031247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:02:42.031247 [info ] [MainThread]: 
[0m11:02:42.031247 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:02:42.031247 [debug] [MainThread]: Command `cli run` succeeded at 11:02:42.031247 after 326.64 seconds
[0m11:02:42.042033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90D422D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90BEF9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90BEF9580>]}
[0m11:02:42.042033 [debug] [MainThread]: Flushing usage events
[0m11:04:19.276768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210EEEA3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F094A450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F094BB00>]}


============================== 11:04:19.282848 | eee1209c-6614-4efa-aae4-b439fc424604 ==============================
[0m11:04:19.282848 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:04:19.283848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:04:19.493111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eee1209c-6614-4efa-aae4-b439fc424604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F0949220>]}
[0m11:04:19.536211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eee1209c-6614-4efa-aae4-b439fc424604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F09ED0A0>]}
[0m11:04:19.537211 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:04:19.549211 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:04:19.720024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:04:19.721058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:04:19.752239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eee1209c-6614-4efa-aae4-b439fc424604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F0BD3200>]}
[0m11:04:19.849784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eee1209c-6614-4efa-aae4-b439fc424604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F0BF4D70>]}
[0m11:04:19.849784 [info ] [MainThread]: Found 25 models, 4 data tests, 19 sources, 524 macros
[0m11:04:19.849784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eee1209c-6614-4efa-aae4-b439fc424604', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F0CD67E0>]}
[0m11:04:19.849784 [info ] [MainThread]: 
[0m11:04:19.849784 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:04:19.849784 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:04:19.928158 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:04:19.928158 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:04:19.928158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:20.041187 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:04:20.041187 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m11:04:20.042602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:20.042602 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m11:04:20.042602 [info ] [MainThread]: 
[0m11:04:20.043722 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m11:04:20.043722 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 6568)
[0m11:04:20.044671 [debug] [MainThread]: Command `cli run` failed at 11:04:20.044671 after 0.89 seconds
[0m11:04:20.044671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F0948EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210EF2615E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210F0BD06B0>]}
[0m11:04:20.045688 [debug] [MainThread]: Flushing usage events
[0m11:04:26.539550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258BE098980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258BC89FB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258BE13C8C0>]}


============================== 11:04:26.539550 | b4c9a975-791b-4942-b2d7-73ff6045a4bc ==============================
[0m11:04:26.539550 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:04:26.539550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m11:04:26.698609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4c9a975-791b-4942-b2d7-73ff6045a4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258BF57D4C0>]}
[0m11:04:26.749346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4c9a975-791b-4942-b2d7-73ff6045a4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258BF57D4C0>]}
[0m11:04:26.750390 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:04:26.760384 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:04:26.889701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:04:26.889701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:04:26.914792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4c9a975-791b-4942-b2d7-73ff6045a4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258BF7992B0>]}
[0m11:04:26.998416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4c9a975-791b-4942-b2d7-73ff6045a4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258BF8080B0>]}
[0m11:04:26.998416 [info ] [MainThread]: Found 25 models, 4 data tests, 19 sources, 524 macros
[0m11:04:26.998416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4c9a975-791b-4942-b2d7-73ff6045a4bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258BF74CC80>]}
[0m11:04:26.998416 [info ] [MainThread]: 
[0m11:04:26.998416 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:04:26.998416 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:04:27.071767 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:04:27.072733 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:04:27.072733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:27.164070 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:04:27.164070 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m11:04:27.165617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:27.166070 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m11:04:27.166070 [info ] [MainThread]: 
[0m11:04:27.166070 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m11:04:27.167070 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 6568)
[0m11:04:27.168070 [debug] [MainThread]: Command `cli run` failed at 11:04:27.168070 after 0.74 seconds
[0m11:04:27.168070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258BD33B0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258BF5D94F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258BF79A5D0>]}
[0m11:04:27.168070 [debug] [MainThread]: Flushing usage events
[0m11:05:41.021445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13B61FC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13B61C8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13B61C9B0>]}


============================== 11:05:41.024486 | 4565f88c-6877-48da-bfa0-f75ad2835278 ==============================
[0m11:05:41.024486 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:05:41.025496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:05:41.179359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4565f88c-6877-48da-bfa0-f75ad2835278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13B7A1130>]}
[0m11:05:41.228413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4565f88c-6877-48da-bfa0-f75ad2835278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13A312CC0>]}
[0m11:05:41.229415 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:05:41.240414 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:05:41.366977 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:05:41.366977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:05:41.406728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4565f88c-6877-48da-bfa0-f75ad2835278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13B829370>]}
[0m11:05:41.481149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4565f88c-6877-48da-bfa0-f75ad2835278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13BAFBCB0>]}
[0m11:05:41.481149 [info ] [MainThread]: Found 25 models, 4 data tests, 19 sources, 524 macros
[0m11:05:41.481149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4565f88c-6877-48da-bfa0-f75ad2835278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13BA47A40>]}
[0m11:05:41.481149 [info ] [MainThread]: 
[0m11:05:41.481149 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:05:41.481149 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:05:41.549275 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:05:41.549275 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:05:41.549275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:41.581078 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:05:41.581078 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:05:41.597755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m11:05:41.597755 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m11:05:41.597755 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m11:05:41.597755 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:05:41.597755 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:05:41.631170 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:05:41.631170 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m11:05:41.631170 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m11:05:41.631170 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:05:41.631170 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m11:05:41.631170 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m11:05:41.631170 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:05:41.631170 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m11:05:41.631170 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m11:05:41.631170 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m11:05:41.631170 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:05:41.631170 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m11:05:41.647516 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:05:41.647516 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:05:41.647516 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m11:05:41.647516 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:05:41.647516 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:05:41.647516 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m11:05:41.647516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:41.647516 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:05:41.647516 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m11:05:41.681009 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:05:41.681009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:05:41.681009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:41.681009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:41.681009 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:05:41.681009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:05:41.681009 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:05:41.681009 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:05:41.681009 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m11:05:41.681009 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:05:41.681009 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m11:05:41.696715 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:05:41.730981 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:05:41.730981 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:05:41.730981 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m11:05:41.730981 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:05:41.730981 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:05:41.746660 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:05:41.748100 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m11:05:41.748588 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:05:41.748588 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:05:41.748588 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m11:05:41.748588 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:05:41.748588 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:05:41.748588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4565f88c-6877-48da-bfa0-f75ad2835278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13B9A30E0>]}
[0m11:05:41.748588 [debug] [MainThread]: Using duckdb connection "master"
[0m11:05:41.748588 [debug] [MainThread]: On master: BEGIN
[0m11:05:41.748588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:05:41.781001 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:05:41.781001 [debug] [MainThread]: On master: COMMIT
[0m11:05:41.781001 [debug] [MainThread]: Using duckdb connection "master"
[0m11:05:41.781001 [debug] [MainThread]: On master: COMMIT
[0m11:05:41.781001 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:05:41.781001 [debug] [MainThread]: On master: Close
[0m11:05:41.797705 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:05:41.797705 [info ] [MainThread]: 
[0m11:05:41.797705 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup
[0m11:05:41.797705 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents_codelookup  [RUN]
[0m11:05:41.797705 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup'
[0m11:05:41.797705 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup
[0m11:05:41.817803 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m11:05:41.817803 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup
[0m11:05:41.832327 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m11:05:41.849012 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m11:05:41.849012 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: BEGIN
[0m11:05:41.849012 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:05:41.880936 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:05:41.880936 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m11:05:41.880936 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_codelookup__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents with Code Descriptions Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__codelookup with the below logic

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTEs for INC_TYPE, ACT_TAK1, ACT_TAK2, ACT_TAK3, SUP_FAC_1,
  SUP_FAC_2, SUP_FAC_3, DETECTOR, DET_TYPE, DET_OPERAT, DET_EFFECT,
  DET_FAIL, AES_PRES, AES_TYPE, AES_OPER, AES_FAIL

All columns will be taken from nfirs_processed__incidents and the code
descriptions for the above fields/codes.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Code Lookup CTEs
inc_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'INC_TYPE'
),

act_tak1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK1'
),

act_tak2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK2'
),

act_tak3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK3'
),

sup_fac_1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'SUP_FAC_1'
),

sup_fac_2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'SUP_FAC_2'
),

sup_fac_3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'SUP_FAC_3'
),

detector_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DETECTOR'
),

det_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_TYPE'
),

det_power_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_POWER'
),

det_operat_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_OPERAT'
),

det_effect_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_EFFECT'
),

det_fail_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'DET_FAIL'
),

aes_pres_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_PRES'
),

aes_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_TYPE'
),

aes_oper_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_OPER'
),

aes_fail_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'AES_FAIL'
),

incidents_codelookup_final AS (
    SELECT
        inc.*,
        inc_type.code_descr AS inc_type_code_descr,
		act_tak1.code_descr AS act_tak1_code_descr,
		act_tak2.code_descr AS act_tak2_code_descr,
		act_tak3.code_descr AS act_tak3_code_descr,
		sup_fac_1.code_descr AS sup_fac_1_code_descr,
		sup_fac_2.code_descr AS sup_fac_2_code_descr,
		sup_fac_3.code_descr AS sup_fac_4_code_descr,
		det.code_descr AS detector_code_descr,
		det_type.code_descr AS det_type_code_descr,
		det_power.code_descr AS det_power_code_descr,
		det_operat.code_descr AS det_operat_code_descr,
		det_fail.code_descr AS det_fail_code_descr,
		aes_pres.code_descr AS aes_pres_code_descr,
		aes_type.code_descr AS aes_type_code_descr,
		aes_oper.code_descr AS aes_oper_code_descr,
		aes_fail.code_descr AS aes_fail_code_descr
    FROM incidents_source inc
    LEFT JOIN inc_type_code_lookup_source inc_type
        ON inc.inc_type = inc_type.code_value
    LEFT JOIN act_tak1_code_lookup_source act_tak1
        ON inc.act_tak1 = act_tak1.code_value
    LEFT JOIN act_tak2_code_lookup_source act_tak2
        ON inc.act_tak2 = act_tak2.code_value
    LEFT JOIN act_tak3_code_lookup_source act_tak3
        ON inc.act_tak3 = act_tak3.code_value
    LEFT JOIN sup_fac_1_code_lookup_source sup_fac_1
        ON inc.sup_fac_1 = sup_fac_1.code_value
    LEFT JOIN sup_fac_2_code_lookup_source sup_fac_2
        ON inc.sup_fac_2 = sup_fac_2.code_value
    LEFT JOIN sup_fac_3_code_lookup_source sup_fac_3
        ON inc.sup_fac_3 = sup_fac_3.code_value
    LEFT JOIN detector_code_lookup_source det
        ON inc.detector = det.code_value
    LEFT JOIN det_type_code_lookup_source det_type
        ON inc.det_type = det_type.code_value
    LEFT JOIN det_power_code_lookup_source det_power
        ON inc.det_power = det_power.code_value
    LEFT JOIN det_operat_code_lookup_source det_operat
        ON inc.det_operat = det_operat.code_value
    LEFT JOIN det_fail_code_lookup_source det_fail
        ON inc.det_fail = det_fail.code_value
    LEFT JOIN aes_pres_code_lookup_source aes_pres
        ON inc.aes_pres = aes_pres.code_value
    LEFT JOIN aes_type_code_lookup_source aes_type
        ON inc.aes_type = aes_type.code_value
    LEFT JOIN aes_oper_code_lookup_source aes_oper
        ON inc.aes_oper = aes_oper.code_value
    LEFT JOIN aes_fail_code_lookup_source aes_fail
        ON inc.aes_fail = aes_fail.code_value
)

SELECT * FROM incidents_codelookup_final
    );
  
  
[0m11:13:39.265573 [debug] [Thread-1 (]: SQL status: OK in 477.0 seconds
[0m11:13:39.275576 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m11:13:39.276445 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents_codelookup" rename to "nfirs_processed__incidents_codelookup__dbt_backup"
[0m11:13:39.282029 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:13:39.285025 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m11:13:39.285025 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents_codelookup__dbt_tmp" rename to "nfirs_processed__incidents_codelookup"
[0m11:13:39.287024 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:13:39.304892 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: COMMIT
[0m11:13:39.305892 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m11:13:39.305892 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: COMMIT
[0m11:14:36.232883 [debug] [Thread-1 (]: SQL status: OK in 57.0 seconds
[0m11:14:36.232883 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"
[0m11:14:36.232883 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup"} */
drop table if exists "nfirs"."nfirs_processed"."nfirs_processed__incidents_codelookup__dbt_backup" cascade
[0m11:14:36.335387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:14:36.338380 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup: Close
[0m11:15:02.405136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4565f88c-6877-48da-bfa0-f75ad2835278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F138FEF2C0>]}
[0m11:15:02.405136 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_processed.nfirs_processed__incidents_codelookup  [[32mOK[0m in 560.61s]
[0m11:15:02.405136 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup
[0m11:15:02.405136 [debug] [MainThread]: Using duckdb connection "master"
[0m11:15:02.405136 [debug] [MainThread]: On master: BEGIN
[0m11:15:02.405136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:02.443481 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:15:02.443481 [debug] [MainThread]: On master: COMMIT
[0m11:15:02.443481 [debug] [MainThread]: Using duckdb connection "master"
[0m11:15:02.443481 [debug] [MainThread]: On master: COMMIT
[0m11:15:02.443481 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:15:02.443481 [debug] [MainThread]: On master: Close
[0m11:15:02.473275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:02.473275 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m11:15:02.473275 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:15:02.473275 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m11:15:02.473275 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:15:02.473275 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_codelookup' was properly closed.
[0m11:15:02.473275 [info ] [MainThread]: 
[0m11:15:02.473275 [info ] [MainThread]: Finished running 1 table model in 0 hours 9 minutes and 20.99 seconds (560.99s).
[0m11:15:02.473275 [debug] [MainThread]: Command end result
[0m11:15:02.516353 [info ] [MainThread]: 
[0m11:15:02.516353 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:02.517357 [info ] [MainThread]: 
[0m11:15:02.517357 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:02.519357 [debug] [MainThread]: Command `cli run` succeeded at 11:15:02.519357 after 561.61 seconds
[0m11:15:02.519357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13B64FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13B61C9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13B61CA40>]}
[0m11:15:02.519357 [debug] [MainThread]: Flushing usage events
[0m11:15:16.101595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF302A6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF302A6D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF302A6060>]}


============================== 11:15:16.105634 | 37ee1753-a903-4cf6-ab4f-020ad10865a4 ==============================
[0m11:15:16.105634 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:15:16.105634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:15:16.262536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37ee1753-a903-4cf6-ab4f-020ad10865a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF2F5B4530>]}
[0m11:15:16.305157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37ee1753-a903-4cf6-ab4f-020ad10865a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF31DB9FA0>]}
[0m11:15:16.307156 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:15:16.316850 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:15:16.444862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:16.444862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:16.465566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37ee1753-a903-4cf6-ab4f-020ad10865a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF32048EF0>]}
[0m11:15:16.558175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37ee1753-a903-4cf6-ab4f-020ad10865a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF320B9C10>]}
[0m11:15:16.559228 [info ] [MainThread]: Found 25 models, 4 data tests, 19 sources, 524 macros
[0m11:15:16.559228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37ee1753-a903-4cf6-ab4f-020ad10865a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF31F7CC80>]}
[0m11:15:16.561252 [info ] [MainThread]: 
[0m11:15:16.561252 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:15:16.562227 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:15:16.619697 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:15:16.619697 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:15:16.619697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:16.648930 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:15:16.648930 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:15:16.648930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m11:15:16.648930 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m11:15:16.665366 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m11:15:16.665366 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:15:16.665366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:16.682133 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:15:16.682133 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m11:15:16.682133 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m11:15:16.682133 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:15:16.682133 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m11:15:16.697917 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m11:15:16.698219 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:15:16.699256 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m11:15:16.699256 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m11:15:16.699256 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m11:15:16.700151 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:15:16.700151 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m11:15:16.700151 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:15:16.715554 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:15:16.715554 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:15:16.715554 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:15:16.715554 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m11:15:16.715554 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:15:16.715554 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:15:16.715554 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m11:15:16.715554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:16.715554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:16.715554 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m11:15:16.753559 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:15:16.754595 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:15:16.754595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:16.754595 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:15:16.755559 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:15:16.755559 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:15:16.755559 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:15:16.756597 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:15:16.756597 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m11:15:16.757522 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m11:15:16.784270 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:15:16.784270 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:15:16.789341 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:15:16.789341 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:15:16.790242 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m11:15:16.791345 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:15:16.792345 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:15:16.793347 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m11:15:16.793347 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:15:16.794349 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:15:16.794349 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m11:15:16.797349 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:15:16.806312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37ee1753-a903-4cf6-ab4f-020ad10865a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF31E2A030>]}
[0m11:15:16.807312 [debug] [MainThread]: Using duckdb connection "master"
[0m11:15:16.807312 [debug] [MainThread]: On master: BEGIN
[0m11:15:16.807312 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:16.836834 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:15:16.837823 [debug] [MainThread]: On master: COMMIT
[0m11:15:16.837823 [debug] [MainThread]: Using duckdb connection "master"
[0m11:15:16.837823 [debug] [MainThread]: On master: COMMIT
[0m11:15:16.838824 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:15:16.838824 [debug] [MainThread]: On master: Close
[0m11:15:16.845823 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:15:16.845823 [info ] [MainThread]: 
[0m11:15:16.851823 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty
[0m11:15:16.852823 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents_aid_casualty  [RUN]
[0m11:15:16.852823 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty'
[0m11:15:16.853750 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty
[0m11:15:16.860832 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m11:15:16.862825 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty
[0m11:15:16.886828 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m11:15:16.895933 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m11:15:16.895933 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: BEGIN
[0m11:15:16.895933 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:15:16.915372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:15:16.915372 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m11:15:16.915372 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_aid_casualty__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents, Basic Aid, and Casualties Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__basicaid
- nfirs_transformed__civiliancasualty
- nfirs_transformed__ffcasualty

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed_basicaid and join the data with nfirs_processed__incidents
- Create CTEs for nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty and
  join them to the prior CTE 
- Columns from nfirs_transformed__civiliancasualty and nfirs_transformed__ffcasualty will end in '_cvl' and '_ff' respectively as they have column headers
  with the same name

All columns will be taken from nfirs_processed__incidents and all columns from the three other
tables.

There will be duplication in data because there is a one to many relationship between the incidents
data and civilian casualty/ff casualty data.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Basic Aid CTE
basicaid_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__basicaid"
),

-- Create Incidents and Basic Aid Join CTE
incidents_basicaid_source AS (
    SELECT
        inc.*,
        b.fdidrecaid,
        b.fdidstrec,
        b.inc_nofdid
    FROM incidents_source inc
    LEFT JOIN basicaid_source b
        ON inc.incident_key = b.incident_key AND inc.inc_no = b.inc_no AND inc.exp_no = b.exp_no
),

-- Create Civilian Casualty CTE
civiliancasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__civiliancasualty"
),

-- Create FF Casualty CTE
ffcasualty_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__ffcasualty"
),

-- Create final CTE
incidents_basicaid_casualty_final AS (
    SELECT
        inc.*,
        cvl.gender AS gender_cvl,
        cvl.age AS age_cvl,
        cvl.race AS race_cvl,
        cvl.ethnicity AS ethnicity_cvl,
        cvl.affiliat AS affiliat_cvl,
        cvl.inj_dt_tm AS inj_dt_tm_cvl,
        cvl.sev AS sev_cvl,
        cvl.cause_inj AS cause_inj_cvl,
        cvl.hum_fact1 AS hum_fact1_cvl,
        cvl.hum_fact2 AS hum_fact2_cvl,
        cvl.hum_fact3 AS hum_fact3_cvl,
        cvl.hum_fact4 AS hum_fact4_cvl,
        cvl.hum_fact5 AS hum_fact5_cvl,
        cvl.hum_fact6 AS hum_fact6_cvl,
        cvl.hum_fact7 AS hum_fact7_cvl,
        cvl.hum_fact8 AS hum_fact8_cvl,
        cvl.fact_inj1 AS fact_inj1_cvl,
        cvl.fact_inj2 AS fact_inj2_cvl,
        cvl.fact_inj3 AS fact_inj3_cvl,
        cvl.activ_inj AS activ_inj_cvl,
        cvl.loc_inc AS loc_inc_cvl,
        cvl.gen_loc_in AS gen_loc_in_cvl,
        cvl.story_inc AS story_inc_cvl,
        cvl.story_inj AS story_inj_cvl,
        cvl.spc_loc_in AS spc_loc_in_cvl,
        cvl.prim_symp AS prim_symp_cvl,
        cvl.body_part AS body_part_cvl,
        cvl.cc_dispos AS cc_dispos_cvl,
        ff.gender AS gender_ff,
        ff.career AS career_ff,
        ff.age AS age_ff,
        ff.inj_date AS inj_date_ff,
        ff.responses AS responses_ff,
        ff.assignment AS assignment_ff,
        ff.phys_cond AS phys_cond_ff,
        ff.severity AS severity_ff,
        ff.taken_to AS taken_to_ff,
        ff.activity AS activity_ff,
        ff.symptom AS symptom_ff,
        ff.pabi AS pabi_ff,
        ff.cause AS cause_ff,
        ff.factor AS factor_ff,
        ff.object AS object_ff,
        ff.wio AS wio_ff,
        ff.relation AS relation_ff,
        ff.story AS story_ff,
        ff.location AS location_ff,
        ff.vehicle AS vehicle_ff,
        ff.prot_eqp AS prot_eqp
    FROM incidents_basicaid_source inc
    LEFT JOIN civiliancasualty_source cvl
        ON inc.incident_key = cvl.incident_key AND inc.inc_date = cvl.inc_date AND inc.inc_no = cvl.inc_no AND inc.exp_no = cvl.exp_no
    LEFT JOIN ffcasualty_source ff
        ON inc.incident_key = ff.incident_key AND inc.inc_date = ff.inc_date AND inc.inc_no = ff.inc_no AND inc.exp_no = ff.exp_no

)

SELECT * FROM incidents_basicaid_casualty_final
    );
  
  
[0m11:23:08.162382 [debug] [Thread-1 (]: SQL status: OK in 471.0 seconds
[0m11:23:08.171443 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m11:23:08.172462 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents_aid_casualty" rename to "nfirs_processed__incidents_aid_casualty__dbt_backup"
[0m11:23:08.176415 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:08.177709 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m11:23:08.179345 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents_aid_casualty__dbt_tmp" rename to "nfirs_processed__incidents_aid_casualty"
[0m11:23:08.181480 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:08.202376 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: COMMIT
[0m11:23:08.203358 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m11:23:08.203358 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: COMMIT
[0m11:23:59.748575 [debug] [Thread-1 (]: SQL status: OK in 52.0 seconds
[0m11:23:59.754845 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"
[0m11:23:59.754845 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty"} */
drop table if exists "nfirs"."nfirs_processed"."nfirs_processed__incidents_aid_casualty__dbt_backup" cascade
[0m11:23:59.872749 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:59.874795 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty: Close
[0m11:24:31.905835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37ee1753-a903-4cf6-ab4f-020ad10865a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF32125B80>]}
[0m11:24:31.906845 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_processed.nfirs_processed__incidents_aid_casualty  [[32mOK[0m in 555.05s]
[0m11:24:31.907832 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty
[0m11:24:31.914802 [debug] [MainThread]: Using duckdb connection "master"
[0m11:24:31.914802 [debug] [MainThread]: On master: BEGIN
[0m11:24:31.915796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:24:31.949467 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:24:31.949996 [debug] [MainThread]: On master: COMMIT
[0m11:24:31.949996 [debug] [MainThread]: Using duckdb connection "master"
[0m11:24:31.949996 [debug] [MainThread]: On master: COMMIT
[0m11:24:31.951040 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:24:31.951040 [debug] [MainThread]: On master: Close
[0m11:24:31.969748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:31.969748 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m11:24:31.969748 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:24:31.970759 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:24:31.971704 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m11:24:31.971704 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_aid_casualty' was properly closed.
[0m11:24:31.976353 [info ] [MainThread]: 
[0m11:24:31.977333 [info ] [MainThread]: Finished running 1 table model in 0 hours 9 minutes and 15.42 seconds (555.42s).
[0m11:24:31.978332 [debug] [MainThread]: Command end result
[0m11:24:32.017331 [info ] [MainThread]: 
[0m11:24:32.018331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:24:32.018331 [info ] [MainThread]: 
[0m11:24:32.019344 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:24:32.019344 [debug] [MainThread]: Command `cli run` succeeded at 11:24:32.019344 after 556.03 seconds
[0m11:24:32.020326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF3193C560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF302A6060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EF302A6D20>]}
[0m11:24:32.020326 [debug] [MainThread]: Flushing usage events
[0m11:24:45.695089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ACA2899A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ACA28B8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ACA289B20>]}


============================== 11:24:45.703477 | e0dbdd4c-e18b-4220-b7e8-057c8beb36ba ==============================
[0m11:24:45.703477 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:24:45.703477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:24:45.893786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0dbdd4c-e18b-4220-b7e8-057c8beb36ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ACBE25790>]}
[0m11:24:45.938995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0dbdd4c-e18b-4220-b7e8-057c8beb36ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ACBED1190>]}
[0m11:24:45.940994 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:24:45.951333 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:24:46.156018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:24:46.156018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:24:46.189809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0dbdd4c-e18b-4220-b7e8-057c8beb36ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ACBD97F20>]}
[0m11:24:46.290201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0dbdd4c-e18b-4220-b7e8-057c8beb36ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ACC083980>]}
[0m11:24:46.291185 [info ] [MainThread]: Found 25 models, 4 data tests, 19 sources, 524 macros
[0m11:24:46.291185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0dbdd4c-e18b-4220-b7e8-057c8beb36ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ACBC3CB00>]}
[0m11:24:46.292184 [info ] [MainThread]: 
[0m11:24:46.293235 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:24:46.294196 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:24:46.504302 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:24:46.504302 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:24:46.504302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:46.537299 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:24:46.539291 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:24:46.546839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m11:24:46.546839 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m11:24:46.551839 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m11:24:46.552839 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:24:46.552839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:24:46.581839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:24:46.582840 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m11:24:46.582840 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m11:24:46.583839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:24:46.583839 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m11:24:46.584839 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m11:24:46.584839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:24:46.585839 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m11:24:46.586839 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m11:24:46.586839 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m11:24:46.586839 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:24:46.587840 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m11:24:46.598843 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:24:46.603839 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:24:46.603839 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m11:24:46.604994 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:24:46.606006 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:24:46.607006 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m11:24:46.608006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:46.609006 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:24:46.609006 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m11:24:46.639005 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:24:46.640006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:24:46.640006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:46.640006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:46.641005 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:24:46.641005 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:24:46.642006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:24:46.642006 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:24:46.643006 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m11:24:46.643006 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:24:46.644006 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m11:24:46.644006 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:24:46.672006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:24:46.673005 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:24:46.680005 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:24:46.681005 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:24:46.681005 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m11:24:46.682006 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:24:46.686011 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:24:46.687011 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m11:24:46.687011 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:24:46.688011 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:24:46.688011 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m11:24:46.691011 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:24:46.699601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0dbdd4c-e18b-4220-b7e8-057c8beb36ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ACBF932C0>]}
[0m11:24:46.700642 [debug] [MainThread]: Using duckdb connection "master"
[0m11:24:46.700642 [debug] [MainThread]: On master: BEGIN
[0m11:24:46.701601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:24:46.729999 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:24:46.731486 [debug] [MainThread]: On master: COMMIT
[0m11:24:46.731486 [debug] [MainThread]: Using duckdb connection "master"
[0m11:24:46.732543 [debug] [MainThread]: On master: COMMIT
[0m11:24:46.732543 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:24:46.732543 [debug] [MainThread]: On master: Close
[0m11:24:46.739990 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:24:46.739990 [info ] [MainThread]: 
[0m11:24:46.747251 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m11:24:46.748304 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents_wildlands  [RUN]
[0m11:24:46.748304 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands'
[0m11:24:46.749226 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m11:24:46.755226 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m11:24:46.759226 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m11:24:46.784308 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m11:24:46.786312 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m11:24:46.786312 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: BEGIN
[0m11:24:46.786312 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:24:46.816210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:24:46.816210 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m11:24:46.816210 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents and Wildlands Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__wildlands

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed__wildlands and join it to the prior CTE

All columns from nfirs_processed__incidents and all columns excluding duplicative columns from
nfirs_transformed_wildlands will be taken.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Wildlands CTE
wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands"
),

-- Incidents and Wildlands join
incidents_wildlands_final AS (
    SELECT
        inc.*,
        wld.* EXCLUDE(state, fdid, inc_date, inc_no, exp_no)
    FROM incidents_source inc
    LEFT JOIN wildlands_source wld
        ON inc.incident_key = wld.incident_key
)

SELECT * FROM incidents_wildlands_final
    );
  
  
[0m11:32:11.443062 [debug] [Thread-1 (]: SQL status: OK in 445.0 seconds
[0m11:32:11.446175 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m11:32:11.446175 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands" rename to "nfirs_processed__incidents_wildlands__dbt_backup"
[0m11:32:11.446175 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:11.446175 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m11:32:11.446175 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_tmp" rename to "nfirs_processed__incidents_wildlands"
[0m11:32:11.459795 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:32:11.476414 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: COMMIT
[0m11:32:11.476414 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m11:32:11.476414 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: COMMIT
[0m11:33:04.303211 [debug] [Thread-1 (]: SQL status: OK in 53.0 seconds
[0m11:33:04.303211 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m11:33:04.303211 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */
drop table if exists "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_backup" cascade
[0m11:33:04.403192 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:04.403192 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: Close
[0m11:33:23.762348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0dbdd4c-e18b-4220-b7e8-057c8beb36ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012AC959F410>]}
[0m11:33:23.763437 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_processed.nfirs_processed__incidents_wildlands  [[32mOK[0m in 517.00s]
[0m11:33:23.763437 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m11:33:23.763437 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:23.763437 [debug] [MainThread]: On master: BEGIN
[0m11:33:23.763437 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:23.817148 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:23.817148 [debug] [MainThread]: On master: COMMIT
[0m11:33:23.818481 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:23.818481 [debug] [MainThread]: On master: COMMIT
[0m11:33:23.818481 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:23.818481 [debug] [MainThread]: On master: Close
[0m11:33:23.861807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:23.861807 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m11:33:23.861807 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:33:23.861807 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m11:33:23.861807 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:33:23.861807 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands' was properly closed.
[0m11:33:23.861807 [info ] [MainThread]: 
[0m11:33:23.861807 [info ] [MainThread]: Finished running 1 table model in 0 hours 8 minutes and 37.57 seconds (517.57s).
[0m11:33:23.861807 [debug] [MainThread]: Command end result
[0m11:33:23.923239 [info ] [MainThread]: 
[0m11:33:23.924239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:23.924739 [info ] [MainThread]: 
[0m11:33:23.925252 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:33:23.926752 [debug] [MainThread]: Command `cli run` succeeded at 11:33:23.926752 after 518.35 seconds
[0m11:33:23.927614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ACC0C7F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ACBD978C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ACBD94D10>]}
[0m11:33:23.928252 [debug] [MainThread]: Flushing usage events
[0m12:03:17.985032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C37F62A330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C30178E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C37F12C3B0>]}


============================== 12:03:18.001249 | b332eb1a-c2a5-480a-ba1e-f3707555b477 ==============================
[0m12:03:18.001249 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:03:18.001815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:03:18.151714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b332eb1a-c2a5-480a-ba1e-f3707555b477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C37FD64650>]}
[0m12:03:18.201772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b332eb1a-c2a5-480a-ba1e-f3707555b477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C301A18BC0>]}
[0m12:03:18.201772 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:03:18.201772 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m12:03:18.334735 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:03:18.334735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:03:18.368309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b332eb1a-c2a5-480a-ba1e-f3707555b477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C303705D60>]}
[0m12:03:18.468123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b332eb1a-c2a5-480a-ba1e-f3707555b477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C303744EC0>]}
[0m12:03:18.468123 [info ] [MainThread]: Found 26 models, 4 data tests, 19 sources, 524 macros
[0m12:03:18.468123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b332eb1a-c2a5-480a-ba1e-f3707555b477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C30398C350>]}
[0m12:03:18.468123 [info ] [MainThread]: 
[0m12:03:18.468123 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:03:18.468123 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m12:03:18.672661 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m12:03:18.672661 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m12:03:18.672661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:18.701467 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:18.701467 [debug] [ThreadPool]: On list_nfirs: Close
[0m12:03:18.717940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_analysis)
[0m12:03:18.717940 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_analysis"
"
[0m12:03:18.717940 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m12:03:18.717940 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m12:03:18.717940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:03:18.751370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:18.751370 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m12:03:18.751370 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: BEGIN
[0m12:03:18.751370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:18.751370 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m12:03:18.751370 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."nfirs_analysis"
    
[0m12:03:18.751370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:18.751370 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m12:03:18.751370 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m12:03:18.751370 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m12:03:18.751370 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:18.751370 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: Close
[0m12:03:20.134310 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m12:03:20.134310 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:03:20.134310 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m12:03:20.134310 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m12:03:20.150307 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m12:03:20.150884 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m12:03:20.150884 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m12:03:20.150884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:20.150884 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m12:03:20.150884 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:03:20.150884 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m12:03:20.184127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:20.184127 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m12:03:20.184127 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m12:03:20.184127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:20.184127 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m12:03:20.184127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:20.184127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:20.184127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:20.184127 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m12:03:20.184127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:20.184127 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m12:03:20.184127 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:20.184127 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m12:03:20.184127 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m12:03:20.184127 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m12:03:20.184127 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m12:03:20.184127 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m12:03:20.219925 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:20.226834 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:20.234088 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m12:03:20.234589 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:20.235440 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:03:20.238173 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m12:03:20.239237 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m12:03:20.241737 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m12:03:20.243237 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m12:03:20.243237 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m12:03:20.243237 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m12:03:20.243237 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m12:03:20.243237 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m12:03:20.243237 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m12:03:20.250718 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m12:03:20.251392 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m12:03:20.267384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b332eb1a-c2a5-480a-ba1e-f3707555b477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C37FD8F920>]}
[0m12:03:20.268371 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:20.268870 [debug] [MainThread]: On master: BEGIN
[0m12:03:20.269511 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:20.307899 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:03:20.308401 [debug] [MainThread]: On master: COMMIT
[0m12:03:20.308704 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:20.309426 [debug] [MainThread]: On master: COMMIT
[0m12:03:20.309426 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:03:20.309927 [debug] [MainThread]: On master: Close
[0m12:03:20.316849 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m12:03:20.317350 [info ] [MainThread]: 
[0m12:03:20.323904 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m12:03:20.323904 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_analysis.nfirs_analysis__muni_incidents_analysis  [RUN]
[0m12:03:20.325221 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis'
[0m12:03:20.325789 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m12:03:20.334921 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m12:03:20.339437 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m12:03:20.367608 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m12:03:20.367608 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m12:03:20.367608 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: BEGIN
[0m12:03:20.367608 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:03:20.401382 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:03:20.402390 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m12:03:20.402390 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */

  
    
    

    create  table
      "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis__dbt_tmp"
  
    as (
      /***** NFIRS Municipal Analysis Table Creation *****/
/*** 
The below model will select specific columns from 'nfirs_processed__incidents' to build visuals in Tableau
***/



WITH processed_incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

muni_incidents_final AS (
    SELECT
        incident_key,
        inc_date,
        DAYNAME(inc_date) AS week_day,
        CASE
            WHEN MONTH(inc_date) IN (12, 1, 2) THEN 'Winter'
            WHEN MONTH(inc_date) IN (3, 4, 5) THEN 'Spring'
            WHEN MONTH(inc_date) IN (6, 7, 8) THEN 'Summer'
            WHEN MONTH(inc_date) IN (9, 10, 11) THEN 'Fall'
        END AS season,
        inc_no,
        state,
        fd_name,
        fd_city,
        fd_zip,
        streetname,
        streettype,
        streetsuf,
        apt_no,
        city,
        state_id,
        zip5
    FROM processed_incidents_source
)

SELECT * FROM muni_incidents_final
    );
  
  
[0m12:03:28.230323 [debug] [Thread-1 (]: SQL status: OK in 8.0 seconds
[0m12:03:28.235318 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m12:03:28.235318 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */
alter table "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis__dbt_tmp" rename to "nfirs_analysis__muni_incidents_analysis"
[0m12:03:28.235318 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:03:28.251300 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: COMMIT
[0m12:03:28.251995 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m12:03:28.252535 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: COMMIT
[0m12:03:33.504721 [debug] [Thread-1 (]: SQL status: OK in 5.0 seconds
[0m12:03:33.511922 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m12:03:33.511922 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */
drop table if exists "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis__dbt_backup" cascade
[0m12:03:33.511922 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:03:33.511922 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: Close
[0m12:03:34.230839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b332eb1a-c2a5-480a-ba1e-f3707555b477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C37FD2B680>]}
[0m12:03:34.231733 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_analysis.nfirs_analysis__muni_incidents_analysis  [[32mOK[0m in 13.90s]
[0m12:03:34.232231 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m12:03:34.235174 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:34.235832 [debug] [MainThread]: On master: BEGIN
[0m12:03:34.236332 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:34.272008 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:03:34.272008 [debug] [MainThread]: On master: COMMIT
[0m12:03:34.272008 [debug] [MainThread]: Using duckdb connection "master"
[0m12:03:34.272008 [debug] [MainThread]: On master: COMMIT
[0m12:03:34.272008 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:03:34.272008 [debug] [MainThread]: On master: Close
[0m12:03:34.282145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:34.282145 [debug] [MainThread]: Connection 'create_nfirs_nfirs_analysis' was properly closed.
[0m12:03:34.282145 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m12:03:34.282145 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m12:03:34.282145 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m12:03:34.282145 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m12:03:34.282145 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis' was properly closed.
[0m12:03:34.282145 [info ] [MainThread]: 
[0m12:03:34.282145 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.81 seconds (15.81s).
[0m12:03:34.282145 [debug] [MainThread]: Command end result
[0m12:03:34.314800 [info ] [MainThread]: 
[0m12:03:34.315811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:34.316017 [info ] [MainThread]: 
[0m12:03:34.317017 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:03:34.318023 [debug] [MainThread]: Command `cli run` succeeded at 12:03:34.318023 after 16.43 seconds
[0m12:03:34.318356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3020235C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C30336FFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C303312F30>]}
[0m12:03:34.318856 [debug] [MainThread]: Flushing usage events
[0m15:57:50.368885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38D36B230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38A88F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38CEC3B60>]}


============================== 15:57:50.375968 | b692de6b-1a38-46f3-b38f-a6afb42c2513 ==============================
[0m15:57:50.375968 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:57:50.375968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:57:50.569463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b692de6b-1a38-46f3-b38f-a6afb42c2513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38D690B90>]}
[0m15:57:50.616462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b692de6b-1a38-46f3-b38f-a6afb42c2513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38B29FF20>]}
[0m15:57:50.617462 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:57:50.631458 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:57:50.820237 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:57:50.821237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:57:50.876890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b692de6b-1a38-46f3-b38f-a6afb42c2513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38D74C050>]}
[0m15:57:51.189050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b692de6b-1a38-46f3-b38f-a6afb42c2513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38D86EE40>]}
[0m15:57:51.190079 [info ] [MainThread]: Found 26 models, 4 data tests, 19 sources, 524 macros
[0m15:57:51.191038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b692de6b-1a38-46f3-b38f-a6afb42c2513', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38D9BC650>]}
[0m15:57:51.193041 [info ] [MainThread]: 
[0m15:57:51.194045 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:57:51.197055 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:57:52.098822 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:57:52.098822 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:57:52.099827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:52.265736 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:57:52.266736 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m15:57:52.267815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:52.268777 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m15:57:52.269821 [info ] [MainThread]: 
[0m15:57:52.269821 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m15:57:52.270818 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\dbeaver.exe (PID 23516)
[0m15:57:52.272736 [debug] [MainThread]: Command `cli run` failed at 15:57:52.272736 after 2.05 seconds
[0m15:57:52.273817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38B756900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38DA037A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B38DD61220>]}
[0m15:57:52.274825 [debug] [MainThread]: Flushing usage events
[0m15:59:25.121624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6F658EF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6F60A3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6F37DC2C0>]}


============================== 15:59:25.128605 | b8aefb76-2013-49fe-adf6-3032f805de21 ==============================
[0m15:59:25.128605 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:59:25.128605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:59:25.327621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8aefb76-2013-49fe-adf6-3032f805de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6F7E00290>]}
[0m15:59:25.394254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8aefb76-2013-49fe-adf6-3032f805de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6F53E43E0>]}
[0m15:59:25.394254 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m15:59:25.414529 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m15:59:25.604498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:25.604498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:25.637875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8aefb76-2013-49fe-adf6-3032f805de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6F7EE91F0>]}
[0m15:59:25.739405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8aefb76-2013-49fe-adf6-3032f805de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6F7F577D0>]}
[0m15:59:25.739405 [info ] [MainThread]: Found 26 models, 4 data tests, 19 sources, 524 macros
[0m15:59:25.739405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8aefb76-2013-49fe-adf6-3032f805de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6F79C3500>]}
[0m15:59:25.739405 [info ] [MainThread]: 
[0m15:59:25.739405 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:59:25.753157 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m15:59:25.836476 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m15:59:25.839108 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m15:59:25.840395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:25.889234 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:59:25.889234 [debug] [ThreadPool]: On list_nfirs: Close
[0m15:59:25.912856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_analysis)
[0m15:59:25.912856 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_analysis"
"
[0m15:59:25.919848 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m15:59:25.919848 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m15:59:25.919848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:25.964767 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:59:25.964767 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m15:59:25.964767 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: BEGIN
[0m15:59:25.964767 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:59:25.964767 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m15:59:25.964767 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."nfirs_analysis"
    
[0m15:59:25.970731 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:59:25.970731 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m15:59:25.970731 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m15:59:25.970731 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m15:59:25.970731 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:59:25.970731 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: Close
[0m15:59:25.987369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m15:59:25.987369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m15:59:25.987369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m15:59:25.987369 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:59:25.987369 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m15:59:25.987369 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:59:25.987369 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m15:59:25.987369 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m15:59:25.987369 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m15:59:25.987369 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m15:59:25.987369 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m15:59:25.987369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:25.987369 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m15:59:25.987369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:26.004142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:26.037645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:59:26.037645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:26.037645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:59:26.037645 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:59:26.037645 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m15:59:26.043802 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:59:26.043802 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m15:59:26.043802 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m15:59:26.043802 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m15:59:26.043802 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m15:59:26.043802 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m15:59:26.043802 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m15:59:26.043802 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m15:59:26.088045 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:59:26.088045 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:59:26.088045 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:59:26.104963 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m15:59:26.112346 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m15:59:26.112346 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m15:59:26.112346 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m15:59:26.112346 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m15:59:26.112346 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m15:59:26.112346 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m15:59:26.112346 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m15:59:26.112346 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m15:59:26.112346 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m15:59:26.120398 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m15:59:26.120844 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m15:59:26.124216 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m15:59:26.141163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8aefb76-2013-49fe-adf6-3032f805de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6F7C45F40>]}
[0m15:59:26.141747 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:26.144166 [debug] [MainThread]: On master: BEGIN
[0m15:59:26.144166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:26.187255 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:59:26.187255 [debug] [MainThread]: On master: COMMIT
[0m15:59:26.187255 [debug] [MainThread]: Using duckdb connection "master"
[0m15:59:26.187255 [debug] [MainThread]: On master: COMMIT
[0m15:59:26.187255 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m15:59:26.187255 [debug] [MainThread]: On master: Close
[0m15:59:26.204102 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m15:59:26.204102 [info ] [MainThread]: 
[0m15:59:26.204102 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m15:59:26.204102 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_analysis.nfirs_analysis__muni_incidents_analysis  [RUN]
[0m15:59:26.204102 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis'
[0m15:59:26.204102 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m15:59:26.220059 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m15:59:26.225300 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m15:59:26.253198 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m15:59:26.255786 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m15:59:26.255786 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: BEGIN
[0m15:59:26.255786 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:59:26.287365 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:59:26.287365 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m15:59:26.287365 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */

  
    
    

    create  table
      "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis__dbt_tmp"
  
    as (
      /***** NFIRS Municipal Analysis Table Creation *****/
/*** 
The below model will select specific columns from 'nfirs_processed__incidents' to build visuals in Tableau
***/



WITH processed_incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

muni_incidents_final AS (
    SELECT
        incident_key,
        inc_date,
        DAYNAME(inc_date) AS week_day,
        CASE
            WHEN MONTH(inc_date) IN (12, 1, 2) THEN 'Winter'
            WHEN MONTH(inc_date) IN (3, 4, 5) THEN 'Spring'
            WHEN MONTH(inc_date) IN (6, 7, 8) THEN 'Summer'
            WHEN MONTH(inc_date) IN (9, 10, 11) THEN 'Fall'
        END AS season,
        inc_no,
        CASE
            WHEN state IN ('ME', 'NH', 'VT', 'MA', 'CT', 'RI', 'NY', 'PJ', 'PA', 'MD', 'DE', 'DC') THEN 'Northest'
            WHEN state IN ('WV', 'VA', 'KY', 'TN', 'NC', 'SC', 'AR', 'LA', 'MS', 'AL', 'GA', 'FL') THEN 'Southeast'
            WHEN state IN ('OH', 'MI', 'IN', 'WI', 'IL', 'MN', 'IA', 'MO', 'ND', 'SD', 'NE', 'KS') THEN 'Midwest'
            WHEN state IN ('OK', 'TX', 'NM', 'AZ') THEN 'Southwest'
            WHEN state IN ('MT', 'WY', 'CO', 'ID', 'UT', 'WA', 'OR', 'NV', 'CA', 'AK', 'HI') THEN 'West'
            ELSE 'Other'
        END AS region,
        state,
        fd_name,
        fd_city,
        fd_zip,
        streetname,
        streettype,
        streetsuf,
        apt_no,
        city,
        state_id,
        zip5
    FROM processed_incidents_source
)

SELECT * FROM muni_incidents_final
    );
  
  
[0m15:59:48.113602 [debug] [Thread-1 (]: SQL status: OK in 22.0 seconds
[0m15:59:48.127475 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m15:59:48.127475 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */
alter table "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis" rename to "nfirs_analysis__muni_incidents_analysis__dbt_backup"
[0m15:59:48.127475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:59:48.127475 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m15:59:48.127475 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */
alter table "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis__dbt_tmp" rename to "nfirs_analysis__muni_incidents_analysis"
[0m15:59:48.127475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:59:48.152211 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: COMMIT
[0m15:59:48.152211 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m15:59:48.152211 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: COMMIT
[0m15:59:58.593919 [debug] [Thread-1 (]: SQL status: OK in 10.0 seconds
[0m15:59:58.605705 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m15:59:58.605705 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */
drop table if exists "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis__dbt_backup" cascade
[0m15:59:58.638845 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m15:59:58.643098 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: Close
[0m16:00:02.576247 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8aefb76-2013-49fe-adf6-3032f805de21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6F85EADE0>]}
[0m16:00:02.576247 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_analysis.nfirs_analysis__muni_incidents_analysis  [[32mOK[0m in 36.37s]
[0m16:00:02.576247 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m16:00:02.590715 [debug] [MainThread]: Using duckdb connection "master"
[0m16:00:02.592214 [debug] [MainThread]: On master: BEGIN
[0m16:00:02.594364 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:00:02.667254 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:00:02.668093 [debug] [MainThread]: On master: COMMIT
[0m16:00:02.668948 [debug] [MainThread]: Using duckdb connection "master"
[0m16:00:02.669543 [debug] [MainThread]: On master: COMMIT
[0m16:00:02.672069 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:00:02.673024 [debug] [MainThread]: On master: Close
[0m16:00:02.686719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:02.687470 [debug] [MainThread]: Connection 'create_nfirs_nfirs_analysis' was properly closed.
[0m16:00:02.688360 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:00:02.689299 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:00:02.690372 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m16:00:02.691859 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m16:00:02.692357 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis' was properly closed.
[0m16:00:02.694730 [info ] [MainThread]: 
[0m16:00:02.695283 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 36.95 seconds (36.95s).
[0m16:00:02.696852 [debug] [MainThread]: Command end result
[0m16:00:02.763327 [info ] [MainThread]: 
[0m16:00:02.764604 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:02.765662 [info ] [MainThread]: 
[0m16:00:02.766176 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:00:02.767676 [debug] [MainThread]: Command `cli run` succeeded at 16:00:02.767676 after 37.83 seconds
[0m16:00:02.767676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6F658EF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6F79EA4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6F7997E30>]}
[0m16:00:02.768890 [debug] [MainThread]: Flushing usage events
[0m16:17:00.404419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB303029F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB30432FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB3059F680>]}


============================== 16:17:00.408374 | 3488488c-712c-4a6c-a1ee-ee466ab66820 ==============================
[0m16:17:00.408374 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:17:00.408374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:17:00.564753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3488488c-712c-4a6c-a1ee-ee466ab66820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB31C03890>]}
[0m16:17:00.606725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3488488c-712c-4a6c-a1ee-ee466ab66820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB31A62990>]}
[0m16:17:00.607724 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:17:00.617723 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:17:00.746703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:17:00.746703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:17:00.777662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3488488c-712c-4a6c-a1ee-ee466ab66820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB31CBEC90>]}
[0m16:17:00.857459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3488488c-712c-4a6c-a1ee-ee466ab66820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB31D576E0>]}
[0m16:17:00.858434 [info ] [MainThread]: Found 26 models, 4 data tests, 19 sources, 524 macros
[0m16:17:00.858434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3488488c-712c-4a6c-a1ee-ee466ab66820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB31CE4D10>]}
[0m16:17:00.860439 [info ] [MainThread]: 
[0m16:17:00.861479 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:17:00.862401 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:17:00.923720 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:17:00.924720 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:17:00.924720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:00.958718 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:17:00.960718 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:17:00.968726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_analysis)
[0m16:17:00.969725 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_analysis"
"
[0m16:17:00.974725 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m16:17:00.975719 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:17:00.975719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:01.006724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:17:01.008725 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m16:17:01.008725 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: BEGIN
[0m16:17:01.009724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:17:01.009724 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m16:17:01.009724 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."nfirs_analysis"
    
[0m16:17:01.010724 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:17:01.010724 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m16:17:01.011725 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m16:17:01.011725 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m16:17:01.011725 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:17:01.012716 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: Close
[0m16:17:01.024695 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:17:01.029739 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:17:01.029739 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m16:17:01.030739 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:17:01.030739 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:17:01.032704 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m16:17:01.033695 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m16:17:01.033695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:01.035696 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:17:01.035696 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m16:17:01.038734 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:17:01.069693 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:17:01.069693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:17:01.069693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:01.070693 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m16:17:01.070693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:01.071693 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:17:01.071693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:01.071693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:17:01.072693 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:17:01.072693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:17:01.073693 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:17:01.073693 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m16:17:01.074692 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:17:01.074692 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:17:01.074692 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m16:17:01.075693 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:17:01.075693 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m16:17:01.104461 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:17:01.106396 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:17:01.108867 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:17:01.110084 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:17:01.111084 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:17:01.112084 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m16:17:01.113548 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:17:01.114695 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:17:01.115830 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m16:17:01.116843 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:17:01.118850 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m16:17:01.119843 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:17:01.119843 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m16:17:01.121843 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m16:17:01.121843 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:17:01.122842 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m16:17:01.138842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3488488c-712c-4a6c-a1ee-ee466ab66820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB32357A70>]}
[0m16:17:01.138842 [debug] [MainThread]: Using duckdb connection "master"
[0m16:17:01.139841 [debug] [MainThread]: On master: BEGIN
[0m16:17:01.139841 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:17:01.170840 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:17:01.170840 [debug] [MainThread]: On master: COMMIT
[0m16:17:01.171839 [debug] [MainThread]: Using duckdb connection "master"
[0m16:17:01.171839 [debug] [MainThread]: On master: COMMIT
[0m16:17:01.171839 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:17:01.172839 [debug] [MainThread]: On master: Close
[0m16:17:01.180657 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:17:01.180657 [info ] [MainThread]: 
[0m16:17:01.185655 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m16:17:01.185655 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_analysis.nfirs_analysis__muni_incidents_analysis  [RUN]
[0m16:17:01.186658 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis'
[0m16:17:01.186658 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m16:17:01.192656 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:17:01.193656 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m16:17:01.219654 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:17:01.220654 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:17:01.220654 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: BEGIN
[0m16:17:01.221654 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:17:01.252655 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:17:01.253654 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:17:01.253654 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */

  
    
    

    create  table
      "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis__dbt_tmp"
  
    as (
      /***** NFIRS Municipal Analysis Table Creation *****/
/*** 
The below model will select specific columns from 'nfirs_processed__incidents' to build visuals in Tableau
***/



WITH processed_incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

muni_incidents_final AS (
    SELECT
        incident_key,
        inc_date,
        DAYNAME(inc_date) AS week_day,
        CASE
            WHEN MONTH(inc_date) IN (12, 1, 2) THEN 'Winter'
            WHEN MONTH(inc_date) IN (3, 4, 5) THEN 'Spring'
            WHEN MONTH(inc_date) IN (6, 7, 8) THEN 'Summer'
            WHEN MONTH(inc_date) IN (9, 10, 11) THEN 'Fall'
        END AS season,
        inc_no,
        CASE
            WHEN state IN ('ME', 'NH', 'VT', 'MA', 'CT', 'RI', 'NY', 'NJ', 'PA', 'MD', 'DE', 'DC') THEN 'Northest'
            WHEN state IN ('WV', 'VA', 'KY', 'TN', 'NC', 'SC', 'AR', 'LA', 'MS', 'AL', 'GA', 'FL') THEN 'Southeast'
            WHEN state IN ('OH', 'MI', 'IN', 'WI', 'IL', 'MN', 'IA', 'MO', 'ND', 'SD', 'NE', 'KS') THEN 'Midwest'
            WHEN state IN ('OK', 'TX', 'NM', 'AZ') THEN 'Southwest'
            WHEN state IN ('MT', 'WY', 'CO', 'ID', 'UT', 'WA', 'OR', 'NV', 'CA', 'AK', 'HI') THEN 'West'
            ELSE 'Other'
        END AS region,
        state,
        fd_name,
        fd_city,
        fd_zip,
        streetname,
        streettype,
        streetsuf,
        apt_no,
        city,
        state_id,
        zip5
    FROM processed_incidents_source
)

SELECT * FROM muni_incidents_final
    );
  
  
[0m16:17:10.021339 [debug] [Thread-1 (]: SQL status: OK in 9.0 seconds
[0m16:17:10.026312 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:17:10.027373 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */
alter table "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis" rename to "nfirs_analysis__muni_incidents_analysis__dbt_backup"
[0m16:17:10.028369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:17:10.030332 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:17:10.030332 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */
alter table "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis__dbt_tmp" rename to "nfirs_analysis__muni_incidents_analysis"
[0m16:17:10.031334 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:17:10.045331 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: COMMIT
[0m16:17:10.045331 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:17:10.046297 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: COMMIT
[0m16:17:16.970874 [debug] [Thread-1 (]: SQL status: OK in 7.0 seconds
[0m16:17:16.976869 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:17:16.977885 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */
drop table if exists "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis__dbt_backup" cascade
[0m16:17:17.009037 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:17:17.013140 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: Close
[0m16:17:20.525575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3488488c-712c-4a6c-a1ee-ee466ab66820', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB3196F320>]}
[0m16:17:20.526575 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_analysis.nfirs_analysis__muni_incidents_analysis  [[32mOK[0m in 19.34s]
[0m16:17:20.527575 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m16:17:20.532081 [debug] [MainThread]: Using duckdb connection "master"
[0m16:17:20.533044 [debug] [MainThread]: On master: BEGIN
[0m16:17:20.533044 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:17:20.578317 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:17:20.579317 [debug] [MainThread]: On master: COMMIT
[0m16:17:20.580317 [debug] [MainThread]: Using duckdb connection "master"
[0m16:17:20.580317 [debug] [MainThread]: On master: COMMIT
[0m16:17:20.581317 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:17:20.582316 [debug] [MainThread]: On master: Close
[0m16:17:20.593843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:20.594844 [debug] [MainThread]: Connection 'create_nfirs_nfirs_analysis' was properly closed.
[0m16:17:20.594844 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:17:20.595844 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m16:17:20.595844 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:17:20.596873 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m16:17:20.596873 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis' was properly closed.
[0m16:17:20.598844 [info ] [MainThread]: 
[0m16:17:20.598844 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 19.74 seconds (19.74s).
[0m16:17:20.600844 [debug] [MainThread]: Command end result
[0m16:17:20.647374 [info ] [MainThread]: 
[0m16:17:20.648408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:20.649374 [info ] [MainThread]: 
[0m16:17:20.649374 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:17:20.651408 [debug] [MainThread]: Command `cli run` succeeded at 16:17:20.651408 after 20.36 seconds
[0m16:17:20.652374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB303029F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB30507E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EB319BD9A0>]}
[0m16:17:20.652374 [debug] [MainThread]: Flushing usage events
[0m16:29:54.087630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E38AA56660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E38A06E0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E38A669A30>]}


============================== 16:29:54.092639 | 0c8852ec-47b6-4890-838d-9d0ab9c45483 ==============================
[0m16:29:54.092639 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:29:54.093639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:29:54.250428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c8852ec-47b6-4890-838d-9d0ab9c45483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E389944530>]}
[0m16:29:54.291425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c8852ec-47b6-4890-838d-9d0ab9c45483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E38C1582C0>]}
[0m16:29:54.292418 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:29:54.302427 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:29:54.432175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:54.432175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:54.463175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c8852ec-47b6-4890-838d-9d0ab9c45483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E38C2EF230>]}
[0m16:29:54.550001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c8852ec-47b6-4890-838d-9d0ab9c45483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E38C4648F0>]}
[0m16:29:54.551001 [info ] [MainThread]: Found 26 models, 4 data tests, 19 sources, 524 macros
[0m16:29:54.551001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c8852ec-47b6-4890-838d-9d0ab9c45483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E38C318DD0>]}
[0m16:29:54.553001 [info ] [MainThread]: 
[0m16:29:54.553001 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:29:54.554001 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:29:54.620999 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:29:54.620999 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:29:54.621999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:54.653998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:54.655999 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:29:54.663998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_analysis)
[0m16:29:54.663998 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_analysis"
"
[0m16:29:54.668998 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m16:29:54.669998 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:29:54.669998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:54.699998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:54.700998 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m16:29:54.700998 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: BEGIN
[0m16:29:54.701998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:54.701998 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m16:29:54.701998 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."nfirs_analysis"
    
[0m16:29:54.702998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:54.703998 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m16:29:54.703998 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m16:29:54.703998 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m16:29:54.704998 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:54.704998 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: Close
[0m16:29:54.716999 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m16:29:54.717998 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m16:29:54.722001 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:29:54.722997 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:29:54.723998 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m16:29:54.724997 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:29:54.724997 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m16:29:54.725997 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:29:54.726997 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m16:29:54.728997 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:29:54.729997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:54.729997 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:29:54.729997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:54.730997 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:29:54.760997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:54.760997 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:54.761997 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:54.762591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:54.762591 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:54.762591 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:29:54.763594 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m16:29:54.764595 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:54.764595 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:29:54.764595 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m16:29:54.765594 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m16:29:54.765594 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:29:54.765594 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:29:54.766594 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:29:54.794593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:54.794593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:54.794593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:54.800593 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:29:54.801593 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m16:29:54.803593 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:29:54.804593 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m16:29:54.804593 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:29:54.805593 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m16:29:54.805593 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:29:54.806593 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m16:29:54.809593 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m16:29:54.810593 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:29:54.811593 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m16:29:54.812593 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:29:54.813593 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:29:54.822594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c8852ec-47b6-4890-838d-9d0ab9c45483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E38C900950>]}
[0m16:29:54.822594 [debug] [MainThread]: Using duckdb connection "master"
[0m16:29:54.822594 [debug] [MainThread]: On master: BEGIN
[0m16:29:54.823593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:54.852592 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.852592 [debug] [MainThread]: On master: COMMIT
[0m16:29:54.853593 [debug] [MainThread]: Using duckdb connection "master"
[0m16:29:54.853593 [debug] [MainThread]: On master: COMMIT
[0m16:29:54.853593 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:29:54.854593 [debug] [MainThread]: On master: Close
[0m16:29:54.861592 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:29:54.861592 [info ] [MainThread]: 
[0m16:29:54.866592 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m16:29:54.866592 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_analysis.nfirs_analysis__muni_incidents_analysis  [RUN]
[0m16:29:54.867592 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis'
[0m16:29:54.867592 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m16:29:54.873597 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:29:54.874592 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m16:29:54.898592 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:29:54.899596 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:29:54.900592 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: BEGIN
[0m16:29:54.900592 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:29:54.931596 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:29:54.931596 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:29:54.932591 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */

  
    
    

    create  table
      "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis__dbt_tmp"
  
    as (
      /***** NFIRS Municipal Analysis Table Creation *****/
/*** 
The below model will select specific columns from 'nfirs_processed__incidents' to build visuals in Tableau
***/



WITH processed_incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

muni_incidents_final AS (
    SELECT
        incident_key,
        inc_date,
        DAYNAME(inc_date) AS week_day,
        CASE
            WHEN MONTH(inc_date) IN (12, 1, 2) THEN 'Winter'
            WHEN MONTH(inc_date) IN (3, 4, 5) THEN 'Spring'
            WHEN MONTH(inc_date) IN (6, 7, 8) THEN 'Summer'
            WHEN MONTH(inc_date) IN (9, 10, 11) THEN 'Fall'
        END AS season,
        inc_no,
        CASE
            WHEN state IN ('ME', 'NH', 'VT', 'MA', 'CT', 'RI', 'NY', 'NJ', 'PA', 'MD', 'DE', 'DC') THEN 'Northeast'
            WHEN state IN ('WV', 'VA', 'KY', 'TN', 'NC', 'SC', 'AR', 'LA', 'MS', 'AL', 'GA', 'FL') THEN 'Southeast'
            WHEN state IN ('OH', 'MI', 'IN', 'WI', 'IL', 'MN', 'IA', 'MO', 'ND', 'SD', 'NE', 'KS') THEN 'Midwest'
            WHEN state IN ('OK', 'TX', 'NM', 'AZ') THEN 'Southwest'
            WHEN state IN ('MT', 'WY', 'CO', 'ID', 'UT', 'WA', 'OR', 'NV', 'CA', 'AK', 'HI') THEN 'West'
            ELSE 'Other'
        END AS region,
        state,
        fd_name,
        fd_city,
        fd_zip,
        streetname,
        streettype,
        streetsuf,
        apt_no,
        city,
        state_id,
        zip5
    FROM processed_incidents_source
)

SELECT * FROM muni_incidents_final
    );
  
  
[0m16:30:03.080051 [debug] [Thread-1 (]: SQL status: OK in 8.0 seconds
[0m16:30:03.085149 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:30:03.085149 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */
alter table "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis" rename to "nfirs_analysis__muni_incidents_analysis__dbt_backup"
[0m16:30:03.086149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:03.088149 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:30:03.089149 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */
alter table "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis__dbt_tmp" rename to "nfirs_analysis__muni_incidents_analysis"
[0m16:30:03.090149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:03.105148 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: COMMIT
[0m16:30:03.105148 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:30:03.106149 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: COMMIT
[0m16:30:08.099701 [debug] [Thread-1 (]: SQL status: OK in 5.0 seconds
[0m16:30:08.105714 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"
[0m16:30:08.106706 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis"} */
drop table if exists "nfirs"."nfirs_analysis"."nfirs_analysis__muni_incidents_analysis__dbt_backup" cascade
[0m16:30:08.221300 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:30:08.225298 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis: Close
[0m16:30:11.761250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c8852ec-47b6-4890-838d-9d0ab9c45483', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E38C923E00>]}
[0m16:30:11.763250 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_analysis.nfirs_analysis__muni_incidents_analysis  [[32mOK[0m in 16.89s]
[0m16:30:11.764250 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis
[0m16:30:11.766407 [debug] [MainThread]: Using duckdb connection "master"
[0m16:30:11.767406 [debug] [MainThread]: On master: BEGIN
[0m16:30:11.768532 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:30:11.818410 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:30:11.819411 [debug] [MainThread]: On master: COMMIT
[0m16:30:11.819411 [debug] [MainThread]: Using duckdb connection "master"
[0m16:30:11.820411 [debug] [MainThread]: On master: COMMIT
[0m16:30:11.821412 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:30:11.821412 [debug] [MainThread]: On master: Close
[0m16:30:11.830408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:11.830408 [debug] [MainThread]: Connection 'create_nfirs_nfirs_analysis' was properly closed.
[0m16:30:11.831409 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m16:30:11.831409 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m16:30:11.832408 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:30:11.832408 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:30:11.833408 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_analysis__muni_incidents_analysis' was properly closed.
[0m16:30:11.834408 [info ] [MainThread]: 
[0m16:30:11.835408 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 17.28 seconds (17.28s).
[0m16:30:11.836408 [debug] [MainThread]: Command end result
[0m16:30:11.881564 [info ] [MainThread]: 
[0m16:30:11.882567 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:30:11.883566 [info ] [MainThread]: 
[0m16:30:11.883566 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:30:11.885563 [debug] [MainThread]: Command `cli run` succeeded at 16:30:11.884564 after 17.91 seconds
[0m16:30:11.885563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E38A06E0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3FFC47EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E38AA56660>]}
[0m16:30:11.886564 [debug] [MainThread]: Flushing usage events
[0m17:01:40.985636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCCFE1D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCCFE3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCCFE0AD0>]}


============================== 17:01:40.990719 | 518858ef-22c6-4c85-b6cf-98ab3bf716b2 ==============================
[0m17:01:40.990719 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:01:40.990719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:01:41.142815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '518858ef-22c6-4c85-b6cf-98ab3bf716b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCC324620>]}
[0m17:01:41.183806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '518858ef-22c6-4c85-b6cf-98ab3bf716b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCCAD4EF0>]}
[0m17:01:41.185815 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:01:41.194809 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:01:41.321809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:01:41.322809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:01:41.352808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '518858ef-22c6-4c85-b6cf-98ab3bf716b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCEB89130>]}
[0m17:01:41.448687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '518858ef-22c6-4c85-b6cf-98ab3bf716b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCEE24440>]}
[0m17:01:41.448687 [info ] [MainThread]: Found 27 models, 4 data tests, 19 sources, 524 macros
[0m17:01:41.449589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '518858ef-22c6-4c85-b6cf-98ab3bf716b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCEFFC530>]}
[0m17:01:41.450625 [info ] [MainThread]: 
[0m17:01:41.451668 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:01:41.452637 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:01:41.675443 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:01:41.676443 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:01:41.676443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:41.723814 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:41.725854 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:01:41.733332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_analysis)
[0m17:01:41.734332 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_analysis"
"
[0m17:01:41.738336 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m17:01:41.739335 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:01:41.739335 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:41.770251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:41.771260 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m17:01:41.771260 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: BEGIN
[0m17:01:41.772260 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:41.772260 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m17:01:41.773265 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."nfirs_analysis"
    
[0m17:01:41.776400 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:41.776400 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m17:01:41.777402 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m17:01:41.777402 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m17:01:41.777402 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:41.778402 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: Close
[0m17:01:41.790627 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:01:41.794444 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:01:41.795446 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:01:41.795446 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:01:41.796538 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m17:01:41.798127 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:01:41.798469 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m17:01:41.798959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:41.800970 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:01:41.801970 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:01:41.803060 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m17:01:41.830970 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m17:01:41.832010 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:41.832010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:41.832970 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m17:01:41.832970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:41.833976 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:01:41.834970 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:41.834970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:41.835970 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:41.835970 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:01:41.835970 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:01:41.836970 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:41.836970 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:01:41.837970 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:01:41.837970 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m17:01:41.838970 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m17:01:41.838970 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m17:01:41.875116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:41.876116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:41.877116 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:41.882603 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:41.884603 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m17:01:41.885603 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m17:01:41.886604 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:01:41.887603 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:01:41.892645 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m17:01:41.892645 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m17:01:41.893645 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:01:41.893645 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:01:41.894689 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m17:01:41.895649 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:01:41.896603 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:01:41.896603 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m17:01:41.908878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '518858ef-22c6-4c85-b6cf-98ab3bf716b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCEBAA5A0>]}
[0m17:01:41.909970 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:41.909970 [debug] [MainThread]: On master: BEGIN
[0m17:01:41.909970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:41.939888 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:41.939888 [debug] [MainThread]: On master: COMMIT
[0m17:01:41.940888 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:41.940888 [debug] [MainThread]: On master: COMMIT
[0m17:01:41.940888 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:41.941888 [debug] [MainThread]: On master: Close
[0m17:01:41.947966 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:01:41.947966 [info ] [MainThread]: 
[0m17:01:41.957518 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis
[0m17:01:41.958791 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_analysis.nfirs_analysis__code_count_analysis  [RUN]
[0m17:01:41.959329 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis'
[0m17:01:41.959329 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis
[0m17:01:41.967623 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"
[0m17:01:41.969643 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis
[0m17:01:41.996441 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"
[0m17:01:41.998437 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"
[0m17:01:41.998437 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis: BEGIN
[0m17:01:41.999437 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:01:42.026442 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:01:42.026442 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"
[0m17:01:42.027437 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"} */

  
    
    

    create  table
      "nfirs"."nfirs_analysis"."nfirs_analysis__code_count_analysis__dbt_tmp"
  
    as (
      /***** NFIRS Code Type Count Table Creation *****/
/*** 
The below model will select specific columns from 'nfirs_processed__incidents_codelookup' to build visuals in Tableau
***/



WITH processed_incidents_codelookup_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents_codelookup"
),

inc_type_cte AS (
	SELECT
		state,
		city,
		fd_name,
		'inc_type' AS code_type,
		inc_type AS code_number,
		inc_type_code_descr AS code_description,
		count(inc_type) AS code_count
	FROM processed_incidents_codelookup_source
	GROUP BY ALL
	ORDER BY 7 DESC
),

act_tak1_cte AS (
	SELECT
		state,
		city,
		fd_name,
		'act_tak1' AS code_type,
		act_tak1 AS code,
		act_tak1_code_descr AS code_description,
		count(act_tak1) AS code_count
	FROM processed_incidents_codelookup_source
	GROUP BY ALL
	ORDER BY 7 DESC
),

act_tak2_cte AS (
	SELECT
		state,
		city,
		fd_name,
		'act_tak2' AS code_type,
		act_tak2 AS code,
		act_tak2_code_descr AS code_description,
		count(act_tak2) AS code_count
	FROM processed_incidents_codelookup_source
	GROUP BY ALL
	ORDER BY 7 DESC
),

act_tak3_cte AS (
	SELECT
		state,
		city,
		fd_name,
		'act_tak3' AS code_type,
		act_tak3 AS code,
		act_tak3_code_descr AS code_description,
		count(act_tak3) AS code_count
	FROM processed_incidents_codelookup_source
	GROUP BY ALL
	ORDER BY 7 DESC
)

union_cte_final AS (
    SELECT * FROM inc_type_cte
    UNION ALL
    SELECT * FROM act_tak1_cte
    UNION ALL
    SELECT * FROM act_tak2_cte
    UNION ALL
    SELECT * FROM act_tak3_cte
)

SELECT * FROM union_cte_final
    );
  
  
[0m17:01:42.032177 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"} */

  
    
    

    create  table
      "nfirs"."nfirs_analysis"."nfirs_analysis__code_count_analysis__dbt_tmp"
  
    as (
      /***** NFIRS Code Type Count Table Creation *****/
/*** 
The below model will select specific columns from 'nfirs_processed__incidents_codelookup' to build visuals in Tableau
***/



WITH processed_incidents_codelookup_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents_codelookup"
),

inc_type_cte AS (
	SELECT
		state,
		city,
		fd_name,
		'inc_type' AS code_type,
		inc_type AS code_number,
		inc_type_code_descr AS code_description,
		count(inc_type) AS code_count
	FROM processed_incidents_codelookup_source
	GROUP BY ALL
	ORDER BY 7 DESC
),

act_tak1_cte AS (
	SELECT
		state,
		city,
		fd_name,
		'act_tak1' AS code_type,
		act_tak1 AS code,
		act_tak1_code_descr AS code_description,
		count(act_tak1) AS code_count
	FROM processed_incidents_codelookup_source
	GROUP BY ALL
	ORDER BY 7 DESC
),

act_tak2_cte AS (
	SELECT
		state,
		city,
		fd_name,
		'act_tak2' AS code_type,
		act_tak2 AS code,
		act_tak2_code_descr AS code_description,
		count(act_tak2) AS code_count
	FROM processed_incidents_codelookup_source
	GROUP BY ALL
	ORDER BY 7 DESC
),

act_tak3_cte AS (
	SELECT
		state,
		city,
		fd_name,
		'act_tak3' AS code_type,
		act_tak3 AS code,
		act_tak3_code_descr AS code_description,
		count(act_tak3) AS code_count
	FROM processed_incidents_codelookup_source
	GROUP BY ALL
	ORDER BY 7 DESC
)

union_cte_final AS (
    SELECT * FROM inc_type_cte
    UNION ALL
    SELECT * FROM act_tak1_cte
    UNION ALL
    SELECT * FROM act_tak2_cte
    UNION ALL
    SELECT * FROM act_tak3_cte
)

SELECT * FROM union_cte_final
    );
  
  
[0m17:01:42.032177 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:01:42.033180 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis: ROLLBACK
[0m17:01:42.041161 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis'
[0m17:01:42.042173 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis: Close
[0m17:01:42.050383 [debug] [Thread-1 (]: Runtime Error in model nfirs_analysis__code_count_analysis (models\nfirs_analysis\nfirs_analysis__code_count_analysis.sql)
  Parser Error: syntax error at or near "union_cte_final"
[0m17:01:42.051436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '518858ef-22c6-4c85-b6cf-98ab3bf716b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCC34F950>]}
[0m17:01:42.052436 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_analysis.nfirs_analysis__code_count_analysis  [[31mERROR[0m in 0.09s]
[0m17:01:42.052436 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis
[0m17:01:42.055354 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:42.055354 [debug] [MainThread]: On master: BEGIN
[0m17:01:42.055354 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:01:42.083451 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:42.083451 [debug] [MainThread]: On master: COMMIT
[0m17:01:42.083451 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:42.084441 [debug] [MainThread]: On master: COMMIT
[0m17:01:42.084441 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:42.084441 [debug] [MainThread]: On master: Close
[0m17:01:42.091437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:42.092434 [debug] [MainThread]: Connection 'create_nfirs_nfirs_analysis' was properly closed.
[0m17:01:42.092434 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:01:42.092434 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:01:42.093429 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m17:01:42.093429 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m17:01:42.093429 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis' was properly closed.
[0m17:01:42.094431 [info ] [MainThread]: 
[0m17:01:42.094431 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.64 seconds (0.64s).
[0m17:01:42.095428 [debug] [MainThread]: Command end result
[0m17:01:42.124436 [info ] [MainThread]: 
[0m17:01:42.125447 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:01:42.125447 [info ] [MainThread]: 
[0m17:01:42.126441 [error] [MainThread]:   Runtime Error in model nfirs_analysis__code_count_analysis (models\nfirs_analysis\nfirs_analysis__code_count_analysis.sql)
  Parser Error: syntax error at or near "union_cte_final"
[0m17:01:42.126441 [info ] [MainThread]: 
[0m17:01:42.127459 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:01:42.127459 [debug] [MainThread]: Command `cli run` failed at 17:01:42.127459 after 1.26 seconds
[0m17:01:42.128445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCE92F9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCE8D7E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FCD0B8830>]}
[0m17:01:42.128445 [debug] [MainThread]: Flushing usage events
[0m17:01:56.975820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C917BCEF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96BCCAC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C915268FE0>]}


============================== 17:01:56.978862 | d6497e74-371f-407f-acf8-b5116a51e937 ==============================
[0m17:01:56.978862 [info ] [MainThread]: Running with dbt=1.8.3
[0m17:01:56.979816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:01:57.131485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6497e74-371f-407f-acf8-b5116a51e937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9197F3350>]}
[0m17:01:57.172518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6497e74-371f-407f-acf8-b5116a51e937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C919724590>]}
[0m17:01:57.174514 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m17:01:57.183519 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m17:01:57.309513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:01:57.309513 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:01:57.340515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6497e74-371f-407f-acf8-b5116a51e937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9198C58E0>]}
[0m17:01:57.429372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6497e74-371f-407f-acf8-b5116a51e937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9198CF7D0>]}
[0m17:01:57.430459 [info ] [MainThread]: Found 27 models, 4 data tests, 19 sources, 524 macros
[0m17:01:57.430459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6497e74-371f-407f-acf8-b5116a51e937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C919A7C860>]}
[0m17:01:57.431437 [info ] [MainThread]: 
[0m17:01:57.432389 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:01:57.433427 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m17:01:57.490467 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m17:01:57.491470 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m17:01:57.491470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:57.522459 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:57.523456 [debug] [ThreadPool]: On list_nfirs: Close
[0m17:01:57.530462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_analysis)
[0m17:01:57.531418 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_analysis"
"
[0m17:01:57.536463 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m17:01:57.536463 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m17:01:57.536463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:01:57.565606 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:57.567606 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m17:01:57.567606 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: BEGIN
[0m17:01:57.567606 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:57.568607 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m17:01:57.568607 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."nfirs_analysis"
    
[0m17:01:57.569463 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:57.570466 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m17:01:57.570466 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m17:01:57.570466 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m17:01:57.571465 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:57.572466 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: Close
[0m17:01:57.584219 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m17:01:57.588264 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:01:57.588264 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m17:01:57.589221 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m17:01:57.590219 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m17:01:57.591254 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m17:01:57.592212 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m17:01:57.592212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:57.595252 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:01:57.595252 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m17:01:57.597267 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:01:57.626212 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m17:01:57.626212 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:57.626212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:57.627218 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m17:01:57.628217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:57.628217 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m17:01:57.629220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:57.629220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:57.630225 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:57.630225 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m17:01:57.631351 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m17:01:57.631351 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:57.632397 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m17:01:57.633363 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m17:01:57.633363 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m17:01:57.634390 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m17:01:57.635363 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m17:01:57.660363 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:57.667362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:57.667362 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:57.671361 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m17:01:57.672392 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m17:01:57.672392 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m17:01:57.673398 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m17:01:57.676470 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m17:01:57.677472 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m17:01:57.678470 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m17:01:57.679368 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m17:01:57.680470 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m17:01:57.680470 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m17:01:57.681438 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m17:01:57.681438 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m17:01:57.682412 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m17:01:57.692935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6497e74-371f-407f-acf8-b5116a51e937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C919989550>]}
[0m17:01:57.692935 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:57.693982 [debug] [MainThread]: On master: BEGIN
[0m17:01:57.693982 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:01:57.722033 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:57.722977 [debug] [MainThread]: On master: COMMIT
[0m17:01:57.722977 [debug] [MainThread]: Using duckdb connection "master"
[0m17:01:57.724015 [debug] [MainThread]: On master: COMMIT
[0m17:01:57.724015 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:01:57.724015 [debug] [MainThread]: On master: Close
[0m17:01:57.731019 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:01:57.731019 [info ] [MainThread]: 
[0m17:01:57.735592 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis
[0m17:01:57.736675 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_analysis.nfirs_analysis__code_count_analysis  [RUN]
[0m17:01:57.736675 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis'
[0m17:01:57.737600 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis
[0m17:01:57.742634 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"
[0m17:01:57.743600 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis
[0m17:01:57.767677 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"
[0m17:01:57.768679 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"
[0m17:01:57.768679 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis: BEGIN
[0m17:01:57.768679 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:01:57.797607 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:01:57.798608 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"
[0m17:01:57.798608 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"} */

  
    
    

    create  table
      "nfirs"."nfirs_analysis"."nfirs_analysis__code_count_analysis__dbt_tmp"
  
    as (
      /***** NFIRS Code Type Count Table Creation *****/
/*** 
The below model will select specific columns from 'nfirs_processed__incidents_codelookup' to build visuals in Tableau
***/



WITH processed_incidents_codelookup_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents_codelookup"
),

inc_type_cte AS (
	SELECT
		state,
		city,
		fd_name,
		'inc_type' AS code_type,
		inc_type AS code_number,
		inc_type_code_descr AS code_description,
		count(inc_type) AS code_count
	FROM processed_incidents_codelookup_source
	GROUP BY ALL
	ORDER BY 7 DESC
),

act_tak1_cte AS (
	SELECT
		state,
		city,
		fd_name,
		'act_tak1' AS code_type,
		act_tak1 AS code,
		act_tak1_code_descr AS code_description,
		count(act_tak1) AS code_count
	FROM processed_incidents_codelookup_source
	GROUP BY ALL
	ORDER BY 7 DESC
),

act_tak2_cte AS (
	SELECT
		state,
		city,
		fd_name,
		'act_tak2' AS code_type,
		act_tak2 AS code,
		act_tak2_code_descr AS code_description,
		count(act_tak2) AS code_count
	FROM processed_incidents_codelookup_source
	GROUP BY ALL
	ORDER BY 7 DESC
),

act_tak3_cte AS (
	SELECT
		state,
		city,
		fd_name,
		'act_tak3' AS code_type,
		act_tak3 AS code,
		act_tak3_code_descr AS code_description,
		count(act_tak3) AS code_count
	FROM processed_incidents_codelookup_source
	GROUP BY ALL
	ORDER BY 7 DESC
),

union_cte_final AS (
    SELECT * FROM inc_type_cte
    UNION ALL
    SELECT * FROM act_tak1_cte
    UNION ALL
    SELECT * FROM act_tak2_cte
    UNION ALL
    SELECT * FROM act_tak3_cte
)

SELECT * FROM union_cte_final
    );
  
  
[0m17:02:01.509596 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m17:02:01.514627 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"
[0m17:02:01.515670 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"} */
alter table "nfirs"."nfirs_analysis"."nfirs_analysis__code_count_analysis__dbt_tmp" rename to "nfirs_analysis__code_count_analysis"
[0m17:02:01.516643 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:01.528669 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis: COMMIT
[0m17:02:01.529669 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"
[0m17:02:01.529669 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis: COMMIT
[0m17:02:03.797451 [debug] [Thread-1 (]: SQL status: OK in 2.0 seconds
[0m17:02:03.806448 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"
[0m17:02:03.807449 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis"} */
drop table if exists "nfirs"."nfirs_analysis"."nfirs_analysis__code_count_analysis__dbt_backup" cascade
[0m17:02:03.809449 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m17:02:03.812448 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis: Close
[0m17:02:04.091481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6497e74-371f-407f-acf8-b5116a51e937', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916ECF410>]}
[0m17:02:04.091481 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_analysis.nfirs_analysis__code_count_analysis  [[32mOK[0m in 6.35s]
[0m17:02:04.092447 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis
[0m17:02:04.094469 [debug] [MainThread]: Using duckdb connection "master"
[0m17:02:04.095477 [debug] [MainThread]: On master: BEGIN
[0m17:02:04.095477 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:02:04.131264 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:02:04.131264 [debug] [MainThread]: On master: COMMIT
[0m17:02:04.132292 [debug] [MainThread]: Using duckdb connection "master"
[0m17:02:04.132292 [debug] [MainThread]: On master: COMMIT
[0m17:02:04.133297 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m17:02:04.133297 [debug] [MainThread]: On master: Close
[0m17:02:04.139748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:04.140678 [debug] [MainThread]: Connection 'create_nfirs_nfirs_analysis' was properly closed.
[0m17:02:04.140678 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m17:02:04.140678 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m17:02:04.141715 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m17:02:04.141715 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m17:02:04.141715 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_analysis__code_count_analysis' was properly closed.
[0m17:02:04.142678 [info ] [MainThread]: 
[0m17:02:04.142678 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.71 seconds (6.71s).
[0m17:02:04.143678 [debug] [MainThread]: Command end result
[0m17:02:04.170748 [info ] [MainThread]: 
[0m17:02:04.171678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:02:04.171678 [info ] [MainThread]: 
[0m17:02:04.171678 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:02:04.172729 [debug] [MainThread]: Command `cli run` succeeded at 17:02:04.172729 after 7.31 seconds
[0m17:02:04.173733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9178BDDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C917F83710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C917F813D0>]}
[0m17:02:04.173733 [debug] [MainThread]: Flushing usage events
[0m10:53:45.860446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF190E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF1A5BBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF190F680>]}


============================== 10:53:45.865442 | 1d2cc757-bf6e-4f7d-b21e-f9ef4316f11c ==============================
[0m10:53:45.865442 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:53:45.866438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:53:46.032617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d2cc757-bf6e-4f7d-b21e-f9ef4316f11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEF6236B0>]}
[0m10:53:46.074106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d2cc757-bf6e-4f7d-b21e-f9ef4316f11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEF977470>]}
[0m10:53:46.076108 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m10:53:46.085173 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:53:46.212350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:53:46.213351 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:53:46.243355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d2cc757-bf6e-4f7d-b21e-f9ef4316f11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF1E3A600>]}
[0m10:53:46.337786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d2cc757-bf6e-4f7d-b21e-f9ef4316f11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF1DD52B0>]}
[0m10:53:46.337786 [info ] [MainThread]: Found 28 models, 4 data tests, 19 sources, 525 macros
[0m10:53:46.338786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d2cc757-bf6e-4f7d-b21e-f9ef4316f11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF2019C10>]}
[0m10:53:46.339787 [info ] [MainThread]: 
[0m10:53:46.340797 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:53:46.341786 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m10:53:46.575831 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m10:53:46.575831 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m10:53:46.575831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:46.632684 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:46.633686 [debug] [ThreadPool]: On list_nfirs: Close
[0m10:53:46.641757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_analysis)
[0m10:53:46.641757 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_analysis"
"
[0m10:53:46.646800 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m10:53:46.647771 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m10:53:46.647771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:53:46.678773 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:46.680773 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m10:53:46.680773 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: BEGIN
[0m10:53:46.681770 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:46.681770 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m10:53:46.681770 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."nfirs_analysis"
    
[0m10:53:46.684773 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:46.684773 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m10:53:46.685772 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m10:53:46.685772 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m10:53:46.685772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:46.686766 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: Close
[0m10:53:46.698771 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m10:53:46.699765 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m10:53:46.703873 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:53:46.704764 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m10:53:46.705799 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m10:53:46.706878 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m10:53:46.706878 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m10:53:46.708867 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:53:46.709867 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:53:46.710925 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m10:53:46.710925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:46.710925 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m10:53:46.711856 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m10:53:46.711856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:46.741854 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:46.742854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:46.742854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:46.743854 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:46.744854 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:53:46.744854 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:46.744854 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:46.745862 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m10:53:46.745862 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m10:53:46.746854 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:53:46.746854 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:53:46.746854 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m10:53:46.747853 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m10:53:46.747853 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m10:53:46.785265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:46.786265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:46.786265 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:46.793264 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:53:46.794265 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m10:53:46.796271 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m10:53:46.797264 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m10:53:46.798264 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m10:53:46.799263 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m10:53:46.800264 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m10:53:46.800264 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m10:53:46.801264 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m10:53:46.802263 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m10:53:46.802263 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m10:53:46.804267 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m10:53:46.805263 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m10:53:46.815262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d2cc757-bf6e-4f7d-b21e-f9ef4316f11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF1FE73E0>]}
[0m10:53:46.816262 [debug] [MainThread]: Using duckdb connection "master"
[0m10:53:46.816262 [debug] [MainThread]: On master: BEGIN
[0m10:53:46.817262 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:53:46.846266 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:53:46.846266 [debug] [MainThread]: On master: COMMIT
[0m10:53:46.847259 [debug] [MainThread]: Using duckdb connection "master"
[0m10:53:46.847259 [debug] [MainThread]: On master: COMMIT
[0m10:53:46.847259 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:53:46.848259 [debug] [MainThread]: On master: Close
[0m10:53:46.854264 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:53:46.854264 [info ] [MainThread]: 
[0m10:53:46.860542 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m10:53:46.861542 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_analysis.nfirs_analysis__wildlands_ca_analysis  [RUN]
[0m10:53:46.862543 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis'
[0m10:53:46.862543 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m10:53:46.878541 [debug] [Thread-1 (]: Compilation Error in model nfirs_analysis__wildlands_ca_analysis (models\nfirs_analysis\nfirs_analysis__wildlands_ca_analysis.sql)
  'nfirs_analysis__wildlands_select_state' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:53:46.879541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d2cc757-bf6e-4f7d-b21e-f9ef4316f11c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF04AEDB0>]}
[0m10:53:46.880541 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_analysis.nfirs_analysis__wildlands_ca_analysis  [[31mERROR[0m in 0.02s]
[0m10:53:46.880541 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m10:53:46.882540 [debug] [MainThread]: Using duckdb connection "master"
[0m10:53:46.883547 [debug] [MainThread]: On master: BEGIN
[0m10:53:46.883547 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:53:46.915994 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:53:46.916138 [debug] [MainThread]: On master: COMMIT
[0m10:53:46.916637 [debug] [MainThread]: Using duckdb connection "master"
[0m10:53:46.917137 [debug] [MainThread]: On master: COMMIT
[0m10:53:46.917637 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:53:46.917637 [debug] [MainThread]: On master: Close
[0m10:53:46.923757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:46.924765 [debug] [MainThread]: Connection 'create_nfirs_nfirs_analysis' was properly closed.
[0m10:53:46.925443 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m10:53:46.925443 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m10:53:46.925943 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m10:53:46.925943 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m10:53:46.926343 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis' was properly closed.
[0m10:53:46.926844 [info ] [MainThread]: 
[0m10:53:46.927176 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m10:53:46.927676 [debug] [MainThread]: Command end result
[0m10:53:46.999518 [info ] [MainThread]: 
[0m10:53:47.000519 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:53:47.000519 [info ] [MainThread]: 
[0m10:53:47.001519 [error] [MainThread]:   Compilation Error in model nfirs_analysis__wildlands_ca_analysis (models\nfirs_analysis\nfirs_analysis__wildlands_ca_analysis.sql)
  'nfirs_analysis__wildlands_select_state' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:53:47.001519 [info ] [MainThread]: 
[0m10:53:47.001519 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:53:47.002518 [debug] [MainThread]: Command `cli run` failed at 10:53:47.002518 after 1.27 seconds
[0m10:53:47.003518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF0478CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CEFA78CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CF1B88530>]}
[0m10:53:47.003518 [debug] [MainThread]: Flushing usage events
[0m10:57:29.906336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0790F50A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F077A261B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F078F98BF0>]}


============================== 10:57:29.909481 | e296a56f-7f57-476c-a89b-120271a690d4 ==============================
[0m10:57:29.909481 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:57:29.910799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:57:30.075384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e296a56f-7f57-476c-a89b-120271a690d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F079315040>]}
[0m10:57:30.117300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e296a56f-7f57-476c-a89b-120271a690d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F078E5A870>]}
[0m10:57:30.118495 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m10:57:30.128853 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:57:30.270217 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:57:30.270217 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:57:30.302213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e296a56f-7f57-476c-a89b-120271a690d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0794F1B20>]}
[0m10:57:30.385980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e296a56f-7f57-476c-a89b-120271a690d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07966A000>]}
[0m10:57:30.385980 [info ] [MainThread]: Found 28 models, 4 data tests, 19 sources, 525 macros
[0m10:57:30.386983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e296a56f-7f57-476c-a89b-120271a690d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07969C2F0>]}
[0m10:57:30.388020 [info ] [MainThread]: 
[0m10:57:30.389020 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:57:30.389984 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m10:57:30.450055 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m10:57:30.451044 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m10:57:30.451044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:30.482114 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:30.484110 [debug] [ThreadPool]: On list_nfirs: Close
[0m10:57:30.491072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_analysis)
[0m10:57:30.492110 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_analysis"
"
[0m10:57:30.497107 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m10:57:30.497107 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m10:57:30.497107 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:30.527194 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:30.528190 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m10:57:30.529152 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: BEGIN
[0m10:57:30.529152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:30.529152 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m10:57:30.530200 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."nfirs_analysis"
    
[0m10:57:30.530200 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:30.531200 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m10:57:30.531200 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m10:57:30.531200 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m10:57:30.532186 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:30.532186 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: Close
[0m10:57:30.544124 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m10:57:30.545116 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m10:57:30.549125 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m10:57:30.550116 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m10:57:30.551117 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:57:30.552186 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m10:57:30.553148 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m10:57:30.555213 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:57:30.555213 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m10:57:30.558149 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:57:30.558149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:30.559168 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m10:57:30.559168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:30.560226 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m10:57:30.591161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:30.592159 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:30.593163 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:30.593163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:30.594150 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:30.594150 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m10:57:30.594150 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:57:30.595181 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:57:30.595181 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:30.595181 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m10:57:30.596190 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m10:57:30.596190 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m10:57:30.596190 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:57:30.598183 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m10:57:30.627141 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:30.628156 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:30.629109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:30.629109 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:57:30.631141 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m10:57:30.632144 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m10:57:30.632144 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m10:57:30.634109 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m10:57:30.635192 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m10:57:30.636177 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m10:57:30.636177 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m10:57:30.637184 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m10:57:30.638185 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m10:57:30.638185 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m10:57:30.639140 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m10:57:30.639140 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m10:57:30.653139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e296a56f-7f57-476c-a89b-120271a690d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F079BF4980>]}
[0m10:57:30.653139 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:30.653139 [debug] [MainThread]: On master: BEGIN
[0m10:57:30.654153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:30.682874 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:57:30.683823 [debug] [MainThread]: On master: COMMIT
[0m10:57:30.683823 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:30.683823 [debug] [MainThread]: On master: COMMIT
[0m10:57:30.684856 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:57:30.684856 [debug] [MainThread]: On master: Close
[0m10:57:30.691858 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:57:30.692864 [info ] [MainThread]: 
[0m10:57:30.695860 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m10:57:30.696862 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_analysis.nfirs_analysis__wildlands_ca_analysis  [RUN]
[0m10:57:30.696862 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis'
[0m10:57:30.697817 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m10:57:30.719333 [debug] [Thread-1 (]: Compilation Error in model nfirs_analysis__wildlands_ca_analysis (models\nfirs_analysis\nfirs_analysis__wildlands_ca_analysis.sql)
  dbt was unable to infer all dependencies for the model "nfirs_analysis__wildlands_ca_analysis".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "nfirs_analysis__wildlands_ca_analysis":
  
  -- depends_on: {{ ref('nfirs_processed__incidents_wildlands') }}
  
  > in macro nfirs_analysis__wildlands_select_state (macros\nfirs_analysis__wildlands_select_state.sql)
  > called by model nfirs_analysis__wildlands_ca_analysis (models\nfirs_analysis\nfirs_analysis__wildlands_ca_analysis.sql)
[0m10:57:30.721377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e296a56f-7f57-476c-a89b-120271a690d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F079C964E0>]}
[0m10:57:30.721377 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_analysis.nfirs_analysis__wildlands_ca_analysis  [[31mERROR[0m in 0.02s]
[0m10:57:30.722353 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m10:57:30.725303 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:30.726312 [debug] [MainThread]: On master: BEGIN
[0m10:57:30.726312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:30.757336 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:57:30.758355 [debug] [MainThread]: On master: COMMIT
[0m10:57:30.759299 [debug] [MainThread]: Using duckdb connection "master"
[0m10:57:30.759299 [debug] [MainThread]: On master: COMMIT
[0m10:57:30.760342 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:57:30.760342 [debug] [MainThread]: On master: Close
[0m10:57:30.767370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:30.767370 [debug] [MainThread]: Connection 'create_nfirs_nfirs_analysis' was properly closed.
[0m10:57:30.768374 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m10:57:30.768374 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m10:57:30.768374 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m10:57:30.769383 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m10:57:30.769383 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis' was properly closed.
[0m10:57:30.770379 [info ] [MainThread]: 
[0m10:57:30.770379 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m10:57:30.771339 [debug] [MainThread]: Command end result
[0m10:57:30.843808 [info ] [MainThread]: 
[0m10:57:30.844802 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:57:30.844802 [info ] [MainThread]: 
[0m10:57:30.844802 [error] [MainThread]:   Compilation Error in model nfirs_analysis__wildlands_ca_analysis (models\nfirs_analysis\nfirs_analysis__wildlands_ca_analysis.sql)
  dbt was unable to infer all dependencies for the model "nfirs_analysis__wildlands_ca_analysis".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "nfirs_analysis__wildlands_ca_analysis":
  
  -- depends_on: {{ ref('nfirs_processed__incidents_wildlands') }}
  
  > in macro nfirs_analysis__wildlands_select_state (macros\nfirs_analysis__wildlands_select_state.sql)
  > called by model nfirs_analysis__wildlands_ca_analysis (models\nfirs_analysis\nfirs_analysis__wildlands_ca_analysis.sql)
[0m10:57:30.845763 [info ] [MainThread]: 
[0m10:57:30.845763 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:57:30.846805 [debug] [MainThread]: Command `cli run` failed at 10:57:30.846805 after 1.05 seconds
[0m10:57:30.846805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0790F50A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F078F98BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F078F9BFB0>]}
[0m10:57:30.847835 [debug] [MainThread]: Flushing usage events
[0m10:58:50.383185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164A56A7980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164A43DB440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164A56A5190>]}


============================== 10:58:50.386184 | 7fae3c51-21ca-47d2-9c89-f675c54e3f8a ==============================
[0m10:58:50.386184 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:58:50.386184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:58:50.552206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fae3c51-21ca-47d2-9c89-f675c54e3f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164A5A027E0>]}
[0m10:58:50.593242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fae3c51-21ca-47d2-9c89-f675c54e3f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164F7E7B080>]}
[0m10:58:50.594244 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m10:58:50.604292 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m10:58:50.732471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:58:50.733426 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:58:50.764977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fae3c51-21ca-47d2-9c89-f675c54e3f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164A381B920>]}
[0m10:58:50.846950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fae3c51-21ca-47d2-9c89-f675c54e3f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164A5BB4D70>]}
[0m10:58:50.846950 [info ] [MainThread]: Found 28 models, 4 data tests, 19 sources, 525 macros
[0m10:58:50.846950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fae3c51-21ca-47d2-9c89-f675c54e3f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164A5AF9100>]}
[0m10:58:50.848970 [info ] [MainThread]: 
[0m10:58:50.849940 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:58:50.850941 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m10:58:50.912009 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m10:58:50.913010 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m10:58:50.913010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:50.946648 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:50.947646 [debug] [ThreadPool]: On list_nfirs: Close
[0m10:58:50.954646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_analysis)
[0m10:58:50.955649 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_analysis"
"
[0m10:58:50.960646 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m10:58:50.960646 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m10:58:50.960646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:50.989639 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:50.991638 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m10:58:50.991638 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: BEGIN
[0m10:58:50.991638 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:50.992647 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m10:58:50.992647 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."nfirs_analysis"
    
[0m10:58:50.993639 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:50.994638 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m10:58:50.994638 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m10:58:50.994638 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m10:58:50.995642 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:50.995642 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: Close
[0m10:58:51.008637 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m10:58:51.012637 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:58:51.013638 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m10:58:51.013638 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m10:58:51.014638 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m10:58:51.016637 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m10:58:51.016637 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m10:58:51.018316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:51.020638 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:58:51.020638 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m10:58:51.023637 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:58:51.054636 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m10:58:51.054636 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:51.055704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:51.055704 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m10:58:51.056744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:51.056744 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m10:58:51.056744 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:51.057732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:51.057732 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:51.058683 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m10:58:51.058683 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m10:58:51.059738 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:51.059738 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m10:58:51.059738 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m10:58:51.060698 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m10:58:51.060698 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m10:58:51.061735 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m10:58:51.087643 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:51.088634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:51.089635 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:51.094634 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m10:58:51.095634 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m10:58:51.096634 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m10:58:51.097642 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m10:58:51.098641 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m10:58:51.099640 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m10:58:51.100633 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m10:58:51.101645 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m10:58:51.101645 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m10:58:51.102641 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m10:58:51.102641 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m10:58:51.102641 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m10:58:51.103643 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m10:58:51.115679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fae3c51-21ca-47d2-9c89-f675c54e3f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164A31A69C0>]}
[0m10:58:51.115679 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:51.116668 [debug] [MainThread]: On master: BEGIN
[0m10:58:51.116668 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:51.146705 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:58:51.146705 [debug] [MainThread]: On master: COMMIT
[0m10:58:51.146705 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:51.147701 [debug] [MainThread]: On master: COMMIT
[0m10:58:51.147701 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:58:51.148708 [debug] [MainThread]: On master: Close
[0m10:58:51.158347 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:58:51.159045 [info ] [MainThread]: 
[0m10:58:51.166274 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m10:58:51.167276 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_analysis.nfirs_analysis__wildlands_ca_analysis  [RUN]
[0m10:58:51.167775 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis'
[0m10:58:51.168010 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m10:58:51.181742 [debug] [Thread-1 (]: Compilation Error in model nfirs_analysis__wildlands_ca_analysis (models\nfirs_analysis\nfirs_analysis__wildlands_ca_analysis.sql)
  dbt was unable to infer all dependencies for the model "nfirs_analysis__wildlands_ca_analysis".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "nfirs_analysis__wildlands_ca_analysis":
  
  -- depends_on: {{ ref('nfirs_processed__incidents_wildlands') }}
  
  > in macro nfirs_analysis__wildlands_select_state (macros\nfirs_analysis__wildlands_select_state.sql)
  > called by model nfirs_analysis__wildlands_ca_analysis (models\nfirs_analysis\nfirs_analysis__wildlands_ca_analysis.sql)
[0m10:58:51.182744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fae3c51-21ca-47d2-9c89-f675c54e3f8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164A3FA2C60>]}
[0m10:58:51.183712 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_analysis.nfirs_analysis__wildlands_ca_analysis  [[31mERROR[0m in 0.01s]
[0m10:58:51.184746 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m10:58:51.186718 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:51.187715 [debug] [MainThread]: On master: BEGIN
[0m10:58:51.187715 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:51.217724 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:58:51.218726 [debug] [MainThread]: On master: COMMIT
[0m10:58:51.218726 [debug] [MainThread]: Using duckdb connection "master"
[0m10:58:51.219716 [debug] [MainThread]: On master: COMMIT
[0m10:58:51.220668 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m10:58:51.220668 [debug] [MainThread]: On master: Close
[0m10:58:51.227708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:51.227708 [debug] [MainThread]: Connection 'create_nfirs_nfirs_analysis' was properly closed.
[0m10:58:51.228706 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m10:58:51.228706 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m10:58:51.228706 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m10:58:51.229713 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m10:58:51.229713 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis' was properly closed.
[0m10:58:51.230708 [info ] [MainThread]: 
[0m10:58:51.230708 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m10:58:51.231734 [debug] [MainThread]: Command end result
[0m10:58:51.308928 [info ] [MainThread]: 
[0m10:58:51.309916 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:58:51.309916 [info ] [MainThread]: 
[0m10:58:51.309916 [error] [MainThread]:   Compilation Error in model nfirs_analysis__wildlands_ca_analysis (models\nfirs_analysis\nfirs_analysis__wildlands_ca_analysis.sql)
  dbt was unable to infer all dependencies for the model "nfirs_analysis__wildlands_ca_analysis".
  This typically happens when ref() is placed within a conditional block.
  
  To fix this, add the following hint to the top of the model "nfirs_analysis__wildlands_ca_analysis":
  
  -- depends_on: {{ ref('nfirs_processed__incidents_wildlands') }}
  
  > in macro nfirs_analysis__wildlands_select_state (macros\nfirs_analysis__wildlands_select_state.sql)
  > called by model nfirs_analysis__wildlands_ca_analysis (models\nfirs_analysis\nfirs_analysis__wildlands_ca_analysis.sql)
[0m10:58:51.310931 [info ] [MainThread]: 
[0m10:58:51.310931 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:58:51.311919 [debug] [MainThread]: Command `cli run` failed at 10:58:51.311919 after 1.04 seconds
[0m10:58:51.312975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164A3646B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164A386BA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164A386B500>]}
[0m10:58:51.312975 [debug] [MainThread]: Flushing usage events
[0m11:02:03.148167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013887149340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001388714A960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013887148BF0>]}


============================== 11:02:03.152173 | c5de9660-3d46-4a4f-9aaf-526832caf499 ==============================
[0m11:02:03.152173 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:02:03.153174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:02:03.316158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5de9660-3d46-4a4f-9aaf-526832caf499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013887549070>]}
[0m11:02:03.358150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5de9660-3d46-4a4f-9aaf-526832caf499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013887479F10>]}
[0m11:02:03.359161 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m11:02:03.369146 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m11:02:03.503694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:03.504766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:03.536793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5de9660-3d46-4a4f-9aaf-526832caf499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138874C4FE0>]}
[0m11:02:03.619784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5de9660-3d46-4a4f-9aaf-526832caf499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013887684B30>]}
[0m11:02:03.620796 [info ] [MainThread]: Found 28 models, 4 data tests, 19 sources, 525 macros
[0m11:02:03.620796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5de9660-3d46-4a4f-9aaf-526832caf499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013887739700>]}
[0m11:02:03.622793 [info ] [MainThread]: 
[0m11:02:03.622793 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:02:03.623793 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m11:02:03.686887 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m11:02:03.686887 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m11:02:03.687882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:03.719856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:03.720851 [debug] [ThreadPool]: On list_nfirs: Close
[0m11:02:03.727853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_analysis)
[0m11:02:03.728857 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_analysis"
"
[0m11:02:03.733851 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m11:02:03.734862 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m11:02:03.734862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:03.763493 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:03.765498 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m11:02:03.765498 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: BEGIN
[0m11:02:03.766503 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:03.766503 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m11:02:03.766503 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."nfirs_analysis"
    
[0m11:02:03.767489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:03.768419 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m11:02:03.768419 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m11:02:03.768419 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m11:02:03.769475 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:03.769475 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: Close
[0m11:02:03.782427 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m11:02:03.783420 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m11:02:03.787427 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m11:02:03.787427 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m11:02:03.789420 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m11:02:03.789420 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m11:02:03.790420 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m11:02:03.791428 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:02:03.792427 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m11:02:03.794418 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:02:03.794418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:03.795419 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m11:02:03.795419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:03.795419 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m11:02:03.825489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:03.825489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:03.826423 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:03.826423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:03.827416 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:03.827416 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m11:02:03.827416 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m11:02:03.828490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:03.828490 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m11:02:03.829476 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m11:02:03.830470 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m11:02:03.830470 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m11:02:03.830470 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m11:02:03.831494 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m11:02:03.861450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:03.861450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:03.861450 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:03.868093 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m11:02:03.868093 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:02:03.869995 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m11:02:03.871007 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m11:02:03.871007 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m11:02:03.872004 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m11:02:03.873005 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m11:02:03.875002 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m11:02:03.875002 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m11:02:03.876069 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m11:02:03.877043 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m11:02:03.880040 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m11:02:03.880040 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m11:02:03.891002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5de9660-3d46-4a4f-9aaf-526832caf499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138877F4260>]}
[0m11:02:03.892076 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:03.892076 [debug] [MainThread]: On master: BEGIN
[0m11:02:03.892076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:03.922070 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:02:03.923072 [debug] [MainThread]: On master: COMMIT
[0m11:02:03.923072 [debug] [MainThread]: Using duckdb connection "master"
[0m11:02:03.923072 [debug] [MainThread]: On master: COMMIT
[0m11:02:03.924062 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:02:03.924062 [debug] [MainThread]: On master: Close
[0m11:02:03.931061 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m11:02:03.932067 [info ] [MainThread]: 
[0m11:02:03.935065 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m11:02:03.936074 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_analysis.nfirs_analysis__wildlands_ca_analysis  [RUN]
[0m11:02:03.936074 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis'
[0m11:02:03.937037 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m11:02:03.944029 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m11:02:03.948069 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m11:02:03.972463 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m11:02:03.977140 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m11:02:03.977140 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: BEGIN
[0m11:02:03.978089 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:02:04.007149 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:02:04.007149 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m11:02:04.008146 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"} */

  
    
    

    create  table
      "nfirs"."nfirs_analysis"."nfirs_analysis__wildlands_ca_analysis__dbt_tmp"
  
    as (
      /***** NFIRS CA Wildlands Analysis Table Creation *****/
/*** 
The below model will select specific columns from 'nfirs_processed__incidents_wilds' for California to build visuals in Tableau
***/

-- depends_on: "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands"





    SELECT
        *
    FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands"
    WHERE state = 'CA'


    );
  
  
[0m11:03:16.089083 [debug] [Thread-1 (]: SQL status: OK in 72.0 seconds
[0m11:03:16.099083 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m11:03:16.100083 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"} */
alter table "nfirs"."nfirs_analysis"."nfirs_analysis__wildlands_ca_analysis__dbt_tmp" rename to "nfirs_analysis__wildlands_ca_analysis"
[0m11:03:16.107083 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:03:16.173419 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: COMMIT
[0m11:03:16.174418 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m11:03:16.174418 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: COMMIT
[0m11:03:23.908679 [debug] [Thread-1 (]: SQL status: OK in 8.0 seconds
[0m11:03:23.912680 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m11:03:23.912680 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"} */
drop table if exists "nfirs"."nfirs_analysis"."nfirs_analysis__wildlands_ca_analysis__dbt_backup" cascade
[0m11:03:23.914166 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:03:23.916168 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: Close
[0m11:03:25.714292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5de9660-3d46-4a4f-9aaf-526832caf499', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013885B9ED50>]}
[0m11:03:25.716293 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_analysis.nfirs_analysis__wildlands_ca_analysis  [[32mOK[0m in 81.78s]
[0m11:03:25.717293 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m11:03:25.721292 [debug] [MainThread]: Using duckdb connection "master"
[0m11:03:25.722288 [debug] [MainThread]: On master: BEGIN
[0m11:03:25.723293 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:03:25.772272 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:03:25.772272 [debug] [MainThread]: On master: COMMIT
[0m11:03:25.773272 [debug] [MainThread]: Using duckdb connection "master"
[0m11:03:25.774272 [debug] [MainThread]: On master: COMMIT
[0m11:03:25.775272 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:03:25.775272 [debug] [MainThread]: On master: Close
[0m11:03:25.793135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:25.793135 [debug] [MainThread]: Connection 'create_nfirs_nfirs_analysis' was properly closed.
[0m11:03:25.794146 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m11:03:25.794146 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m11:03:25.795106 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m11:03:25.796142 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m11:03:25.796142 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis' was properly closed.
[0m11:03:25.800143 [info ] [MainThread]: 
[0m11:03:25.801143 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 22.18 seconds (82.18s).
[0m11:03:25.802142 [debug] [MainThread]: Command end result
[0m11:03:25.848171 [info ] [MainThread]: 
[0m11:03:25.849172 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:03:25.849172 [info ] [MainThread]: 
[0m11:03:25.850142 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:03:25.852141 [debug] [MainThread]: Command `cli run` succeeded at 11:03:25.852141 after 82.81 seconds
[0m11:03:25.853142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013887318410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138852C2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013887D2EC60>]}
[0m11:03:25.853142 [debug] [MainThread]: Flushing usage events
[0m13:43:08.956260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970C4010D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970C401190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970C4A41A0>]}


============================== 13:43:08.961524 | 3faab44e-2dda-4f08-8675-f192f42dc494 ==============================
[0m13:43:08.961524 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:43:08.962535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m13:43:09.129076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3faab44e-2dda-4f08-8675-f192f42dc494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970BE8F980>]}
[0m13:43:09.171897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3faab44e-2dda-4f08-8675-f192f42dc494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970C454890>]}
[0m13:43:09.173897 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:43:09.183150 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:43:09.313659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:09.314652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:09.344678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3faab44e-2dda-4f08-8675-f192f42dc494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970E7820F0>]}
[0m13:43:09.433149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3faab44e-2dda-4f08-8675-f192f42dc494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970E8F90A0>]}
[0m13:43:09.433149 [info ] [MainThread]: Found 28 models, 4 data tests, 19 sources, 525 macros
[0m13:43:09.434055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3faab44e-2dda-4f08-8675-f192f42dc494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970E783B90>]}
[0m13:43:09.437055 [info ] [MainThread]: 
[0m13:43:09.438055 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:43:09.439055 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m13:43:09.633288 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m13:43:09.634288 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m13:43:09.634288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:09.697842 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:09.699842 [debug] [ThreadPool]: On list_nfirs: Close
[0m13:43:09.707450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m13:43:09.708450 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m13:43:09.713450 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:43:09.713450 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m13:43:09.713450 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:09.746875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:09.747874 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:43:09.747874 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m13:43:09.748875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:09.748875 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:43:09.748875 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m13:43:09.751874 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:09.752875 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:43:09.752875 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:43:09.753875 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:43:09.753875 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:09.754875 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m13:43:09.766119 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m13:43:09.767039 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m13:43:09.771126 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m13:43:09.771126 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m13:43:09.773039 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:43:09.773039 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m13:43:09.774040 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m13:43:09.775047 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:43:09.775047 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m13:43:09.776040 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:43:09.777128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:09.777128 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m13:43:09.778039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:09.778039 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m13:43:09.808950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:09.808950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:09.809950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:09.809950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:09.809950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:09.810950 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m13:43:09.810950 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:09.811950 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:43:09.811950 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:43:09.811950 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m13:43:09.812950 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:43:09.812950 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m13:43:09.812950 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m13:43:09.813950 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m13:43:09.850874 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:09.851873 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:09.851873 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:09.856191 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:09.856873 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m13:43:09.858874 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m13:43:09.858874 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m13:43:09.860874 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m13:43:09.860874 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m13:43:09.861874 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m13:43:09.863874 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m13:43:09.863874 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m13:43:09.864874 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m13:43:09.864874 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m13:43:09.865874 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m13:43:09.865874 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m13:43:09.877179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3faab44e-2dda-4f08-8675-f192f42dc494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970BEFEB40>]}
[0m13:43:09.878179 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:09.878179 [debug] [MainThread]: On master: BEGIN
[0m13:43:09.879180 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:09.910184 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:09.911183 [debug] [MainThread]: On master: COMMIT
[0m13:43:09.911183 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:09.912179 [debug] [MainThread]: On master: COMMIT
[0m13:43:09.912179 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:09.912179 [debug] [MainThread]: On master: Close
[0m13:43:09.919179 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:43:09.919179 [info ] [MainThread]: 
[0m13:43:09.927205 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:43:09.928205 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents_wildlands  [RUN]
[0m13:43:09.928205 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands'
[0m13:43:09.929205 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:43:09.935205 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:43:09.937204 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:43:09.961210 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:43:09.963212 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:43:09.964204 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: BEGIN
[0m13:43:09.964204 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:43:09.995207 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:43:09.995207 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:43:09.996204 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents and Wildlands Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__wildlands

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed__wildlands and join it to the prior CTE

All columns from nfirs_processed__incidents and all columns excluding duplicative columns from
nfirs_transformed_wildlands will be taken.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Wildlands CTE
wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands"
),

-- Code Lookup CTE
inc_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'INC_TYPE'
),

fire_cause_codelookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'FIRE_CAUSE'
),

act_tak1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK1'
),

act_tak2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK2'
),

act_tak3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK3'
),

-- Incidents and Wildlands JOIN
incidents_wildlands_join AS (
    SELECT
        inc.*,
        wld.* EXCLUDE(state, fdid, inc_date, inc_no, exp_no)
    FROM incidents_source inc
    LEFT JOIN wildlands_source wld
        ON inc.incident_key = wld.incident_key
),

-- Incidents, Wildlands, and Code Descriptions JOIN
incidents_wildlands_final AS (
    SELECT
        inc.*,
        inc_type.code_descr AS inc_type_code_descr,
		act_tak1.code_descr AS act_tak1_code_descr,
		act_tak2.code_descr AS act_tak2_code_descr,
		act_tak3.code_descr AS act_tak3_code_descr,
        fc.code_descr AS fire_cause_code_descr
    FROM incidents_wildlands_join inc
    LEFT JOIN inc_type_code_lookup_source inc_type
        ON inc.inc_type = inc_type.code_value
    LEFT JOIN fire_cause_codelookup_source fc
        ON inc.fire_cause
    LEFT JOIN act_tak1_code_lookup_source act_tak1
        ON inc.act_tak1 = act_tak1.code_value
    LEFT JOIN act_tak2_code_lookup_source act_tak2
        ON inc.act_tak2 = act_tak2.code_value
    LEFT JOIN act_tak3_code_lookup_source act_tak3
        ON inc.act_tak3 = act_tak3.code_value
    LEFT JOIN fire_cause_codelookup_source fc
        ON inc.fire_cause = fc.code_value
)

SELECT * FROM incidents_wildlands_final
    );
  
  
[0m13:43:10.003204 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents and Wildlands Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__wildlands

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed__wildlands and join it to the prior CTE

All columns from nfirs_processed__incidents and all columns excluding duplicative columns from
nfirs_transformed_wildlands will be taken.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Wildlands CTE
wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands"
),

-- Code Lookup CTE
inc_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'INC_TYPE'
),

fire_cause_codelookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'FIRE_CAUSE'
),

act_tak1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK1'
),

act_tak2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK2'
),

act_tak3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK3'
),

-- Incidents and Wildlands JOIN
incidents_wildlands_join AS (
    SELECT
        inc.*,
        wld.* EXCLUDE(state, fdid, inc_date, inc_no, exp_no)
    FROM incidents_source inc
    LEFT JOIN wildlands_source wld
        ON inc.incident_key = wld.incident_key
),

-- Incidents, Wildlands, and Code Descriptions JOIN
incidents_wildlands_final AS (
    SELECT
        inc.*,
        inc_type.code_descr AS inc_type_code_descr,
		act_tak1.code_descr AS act_tak1_code_descr,
		act_tak2.code_descr AS act_tak2_code_descr,
		act_tak3.code_descr AS act_tak3_code_descr,
        fc.code_descr AS fire_cause_code_descr
    FROM incidents_wildlands_join inc
    LEFT JOIN inc_type_code_lookup_source inc_type
        ON inc.inc_type = inc_type.code_value
    LEFT JOIN fire_cause_codelookup_source fc
        ON inc.fire_cause
    LEFT JOIN act_tak1_code_lookup_source act_tak1
        ON inc.act_tak1 = act_tak1.code_value
    LEFT JOIN act_tak2_code_lookup_source act_tak2
        ON inc.act_tak2 = act_tak2.code_value
    LEFT JOIN act_tak3_code_lookup_source act_tak3
        ON inc.act_tak3 = act_tak3.code_value
    LEFT JOIN fire_cause_codelookup_source fc
        ON inc.fire_cause = fc.code_value
)

SELECT * FROM incidents_wildlands_final
    );
  
  
[0m13:43:10.004204 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:43:10.004204 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: ROLLBACK
[0m13:43:10.014206 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands'
[0m13:43:10.015211 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: Close
[0m13:43:10.023204 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__incidents_wildlands (models\nfirs_processed\nfirs_processed__incidents_wildlands.sql)
  Binder Error: Duplicate alias "fc" in query!
[0m13:43:10.025213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3faab44e-2dda-4f08-8675-f192f42dc494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970CCE6BA0>]}
[0m13:43:10.025213 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__incidents_wildlands  [[31mERROR[0m in 0.10s]
[0m13:43:10.026204 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:43:10.028204 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:10.028204 [debug] [MainThread]: On master: BEGIN
[0m13:43:10.029204 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:10.058204 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:10.059211 [debug] [MainThread]: On master: COMMIT
[0m13:43:10.059211 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:10.059211 [debug] [MainThread]: On master: COMMIT
[0m13:43:10.060204 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:10.060204 [debug] [MainThread]: On master: Close
[0m13:43:10.067203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:10.067203 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m13:43:10.067203 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m13:43:10.068204 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m13:43:10.068204 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m13:43:10.068204 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m13:43:10.068204 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands' was properly closed.
[0m13:43:10.071276 [info ] [MainThread]: 
[0m13:43:10.071276 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m13:43:10.072204 [debug] [MainThread]: Command end result
[0m13:43:10.141203 [info ] [MainThread]: 
[0m13:43:10.142203 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:43:10.142203 [info ] [MainThread]: 
[0m13:43:10.142203 [error] [MainThread]:   Runtime Error in model nfirs_processed__incidents_wildlands (models\nfirs_processed\nfirs_processed__incidents_wildlands.sql)
  Binder Error: Duplicate alias "fc" in query!
[0m13:43:10.143203 [info ] [MainThread]: 
[0m13:43:10.143203 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:43:10.144203 [debug] [MainThread]: Command `cli run` failed at 13:43:10.144203 after 1.29 seconds
[0m13:43:10.145203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970E31B3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970E113B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970E113200>]}
[0m13:43:10.145203 [debug] [MainThread]: Flushing usage events
[0m13:43:35.345679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D927464860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D928200A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D928203290>]}


============================== 13:43:35.348678 | f1d998a3-2680-407c-9460-c84e8e06e7d0 ==============================
[0m13:43:35.348678 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:43:35.349678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:43:35.514676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1d998a3-2680-407c-9460-c84e8e06e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D92A4E0A70>]}
[0m13:43:35.556676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1d998a3-2680-407c-9460-c84e8e06e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D929F11310>]}
[0m13:43:35.557676 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:43:35.567676 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:43:35.703713 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:35.704713 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:35.735713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1d998a3-2680-407c-9460-c84e8e06e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D92A5C7650>]}
[0m13:43:35.815755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1d998a3-2680-407c-9460-c84e8e06e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D92A8F1130>]}
[0m13:43:35.815755 [info ] [MainThread]: Found 28 models, 4 data tests, 19 sources, 525 macros
[0m13:43:35.816755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1d998a3-2680-407c-9460-c84e8e06e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D92A7346B0>]}
[0m13:43:35.817755 [info ] [MainThread]: 
[0m13:43:35.818755 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:43:35.819755 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m13:43:35.878754 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m13:43:35.878754 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m13:43:35.879755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:35.912754 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:35.914498 [debug] [ThreadPool]: On list_nfirs: Close
[0m13:43:35.921514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m13:43:35.922515 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m13:43:35.926514 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:43:35.927871 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m13:43:35.928315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:35.959327 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:35.961328 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:43:35.961328 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m13:43:35.962328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:35.962328 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:43:35.962328 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m13:43:35.963328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:35.963328 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:43:35.964328 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:43:35.964328 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:43:35.964328 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:35.965328 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m13:43:35.975727 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m13:43:35.976723 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m13:43:35.980723 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:43:35.981723 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m13:43:35.981723 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m13:43:35.982723 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:43:35.983723 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m13:43:35.984723 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:43:35.985723 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m13:43:35.986723 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m13:43:35.986723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:35.986723 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m13:43:35.987723 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m13:43:35.987723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:36.018722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:36.018722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:36.019723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:36.019723 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:36.020722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:36.020722 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:43:36.020722 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:43:36.021722 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:36.021722 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:43:36.021722 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m13:43:36.022722 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m13:43:36.022722 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m13:43:36.022722 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m13:43:36.023722 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m13:43:36.049372 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:36.050373 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:36.053373 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:36.054510 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m13:43:36.056522 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m13:43:36.056522 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:36.057522 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m13:43:36.058528 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m13:43:36.059522 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m13:43:36.060522 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m13:43:36.060522 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m13:43:36.061521 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m13:43:36.061521 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m13:43:36.064521 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m13:43:36.066522 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m13:43:36.066522 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m13:43:36.075529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1d998a3-2680-407c-9460-c84e8e06e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D92A5731A0>]}
[0m13:43:36.075529 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:36.076521 [debug] [MainThread]: On master: BEGIN
[0m13:43:36.076521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:36.106092 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:36.107096 [debug] [MainThread]: On master: COMMIT
[0m13:43:36.107096 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:36.108091 [debug] [MainThread]: On master: COMMIT
[0m13:43:36.108091 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:36.108091 [debug] [MainThread]: On master: Close
[0m13:43:36.116092 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:43:36.116092 [info ] [MainThread]: 
[0m13:43:36.121092 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:43:36.121092 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents_wildlands  [RUN]
[0m13:43:36.122092 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands'
[0m13:43:36.122092 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:43:36.129092 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:43:36.130091 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:43:36.154092 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:43:36.154092 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:43:36.155092 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: BEGIN
[0m13:43:36.155092 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:43:36.185337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:43:36.186337 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:43:36.186337 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents and Wildlands Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__wildlands

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed__wildlands and join it to the prior CTE

All columns from nfirs_processed__incidents and all columns excluding duplicative columns from
nfirs_transformed_wildlands will be taken.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Wildlands CTE
wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands"
),

-- Code Lookup CTE
inc_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'INC_TYPE'
),

fire_cause_codelookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'FIRE_CAUSE'
),

act_tak1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK1'
),

act_tak2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK2'
),

act_tak3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK3'
),

-- Incidents and Wildlands JOIN
incidents_wildlands_join AS (
    SELECT
        inc.*,
        wld.* EXCLUDE(state, fdid, inc_date, inc_no, exp_no)
    FROM incidents_source inc
    LEFT JOIN wildlands_source wld
        ON inc.incident_key = wld.incident_key
),

-- Incidents, Wildlands, and Code Descriptions JOIN
incidents_wildlands_final AS (
    SELECT
        inc.*,
        inc_type.code_descr AS inc_type_code_descr
        fc.code_descr AS fire_cause_code_descr,
		act_tak1.code_descr AS act_tak1_code_descr,
		act_tak2.code_descr AS act_tak2_code_descr,
		act_tak3.code_descr AS act_tak3_code_descr
    FROM incidents_wildlands_join inc
    LEFT JOIN inc_type_code_lookup_source inc_type
        ON inc.inc_type = inc_type.code_value
    LEFT JOIN fire_cause_codelookup_source fc
        ON inc.fire_cause
    LEFT JOIN act_tak1_code_lookup_source act_tak1
        ON inc.act_tak1 = act_tak1.code_value
    LEFT JOIN act_tak2_code_lookup_source act_tak2
        ON inc.act_tak2 = act_tak2.code_value
    LEFT JOIN act_tak3_code_lookup_source act_tak3
        ON inc.act_tak3 = act_tak3.code_value
)

SELECT * FROM incidents_wildlands_final
    );
  
  
[0m13:43:36.195490 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents and Wildlands Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__wildlands

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed__wildlands and join it to the prior CTE

All columns from nfirs_processed__incidents and all columns excluding duplicative columns from
nfirs_transformed_wildlands will be taken.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Wildlands CTE
wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands"
),

-- Code Lookup CTE
inc_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'INC_TYPE'
),

fire_cause_codelookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'FIRE_CAUSE'
),

act_tak1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK1'
),

act_tak2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK2'
),

act_tak3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK3'
),

-- Incidents and Wildlands JOIN
incidents_wildlands_join AS (
    SELECT
        inc.*,
        wld.* EXCLUDE(state, fdid, inc_date, inc_no, exp_no)
    FROM incidents_source inc
    LEFT JOIN wildlands_source wld
        ON inc.incident_key = wld.incident_key
),

-- Incidents, Wildlands, and Code Descriptions JOIN
incidents_wildlands_final AS (
    SELECT
        inc.*,
        inc_type.code_descr AS inc_type_code_descr
        fc.code_descr AS fire_cause_code_descr,
		act_tak1.code_descr AS act_tak1_code_descr,
		act_tak2.code_descr AS act_tak2_code_descr,
		act_tak3.code_descr AS act_tak3_code_descr
    FROM incidents_wildlands_join inc
    LEFT JOIN inc_type_code_lookup_source inc_type
        ON inc.inc_type = inc_type.code_value
    LEFT JOIN fire_cause_codelookup_source fc
        ON inc.fire_cause
    LEFT JOIN act_tak1_code_lookup_source act_tak1
        ON inc.act_tak1 = act_tak1.code_value
    LEFT JOIN act_tak2_code_lookup_source act_tak2
        ON inc.act_tak2 = act_tak2.code_value
    LEFT JOIN act_tak3_code_lookup_source act_tak3
        ON inc.act_tak3 = act_tak3.code_value
)

SELECT * FROM incidents_wildlands_final
    );
  
  
[0m13:43:36.196496 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:43:36.196496 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: ROLLBACK
[0m13:43:36.200490 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands'
[0m13:43:36.201502 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: Close
[0m13:43:36.209202 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__incidents_wildlands (models\nfirs_processed\nfirs_processed__incidents_wildlands.sql)
  Parser Error: syntax error at or near "fc"
[0m13:43:36.211203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d998a3-2680-407c-9460-c84e8e06e7d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D928AE2C60>]}
[0m13:43:36.211203 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__incidents_wildlands  [[31mERROR[0m in 0.09s]
[0m13:43:36.212203 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:43:36.214202 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:36.214202 [debug] [MainThread]: On master: BEGIN
[0m13:43:36.215203 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:36.245202 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:36.246202 [debug] [MainThread]: On master: COMMIT
[0m13:43:36.246202 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:36.246202 [debug] [MainThread]: On master: COMMIT
[0m13:43:36.247202 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:36.247202 [debug] [MainThread]: On master: Close
[0m13:43:36.254202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:36.254202 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m13:43:36.254202 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m13:43:36.255202 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m13:43:36.255202 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m13:43:36.255202 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m13:43:36.255202 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands' was properly closed.
[0m13:43:36.256202 [info ] [MainThread]: 
[0m13:43:36.256202 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:43:36.257202 [debug] [MainThread]: Command end result
[0m13:43:36.324604 [info ] [MainThread]: 
[0m13:43:36.325604 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:43:36.325604 [info ] [MainThread]: 
[0m13:43:36.325604 [error] [MainThread]:   Runtime Error in model nfirs_processed__incidents_wildlands (models\nfirs_processed\nfirs_processed__incidents_wildlands.sql)
  Parser Error: syntax error at or near "fc"
[0m13:43:36.326605 [info ] [MainThread]: 
[0m13:43:36.326605 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:43:36.327488 [debug] [MainThread]: Command `cli run` failed at 13:43:36.327488 after 1.09 seconds
[0m13:43:36.327488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D927464860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D928757F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D92A76D730>]}
[0m13:43:36.328506 [debug] [MainThread]: Flushing usage events
[0m13:43:46.224884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D5FC1ECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D5EF54590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D61ACE1B0>]}


============================== 13:43:46.228884 | 899cab1a-01b8-4bdc-bae4-88f21a1bcb25 ==============================
[0m13:43:46.228884 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:43:46.228884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:43:46.393850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '899cab1a-01b8-4bdc-bae4-88f21a1bcb25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D5FCA0950>]}
[0m13:43:46.434848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '899cab1a-01b8-4bdc-bae4-88f21a1bcb25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D61E7CB00>]}
[0m13:43:46.435848 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:43:46.444848 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:43:46.572078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:46.572078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:46.602076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '899cab1a-01b8-4bdc-bae4-88f21a1bcb25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D61F9DCA0>]}
[0m13:43:46.686067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '899cab1a-01b8-4bdc-bae4-88f21a1bcb25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D6214C050>]}
[0m13:43:46.687067 [info ] [MainThread]: Found 28 models, 4 data tests, 19 sources, 525 macros
[0m13:43:46.687067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '899cab1a-01b8-4bdc-bae4-88f21a1bcb25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D62190620>]}
[0m13:43:46.689071 [info ] [MainThread]: 
[0m13:43:46.689071 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:43:46.690067 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m13:43:46.750074 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m13:43:46.750074 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m13:43:46.751067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:46.784066 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:46.785074 [debug] [ThreadPool]: On list_nfirs: Close
[0m13:43:46.792066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m13:43:46.793066 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m13:43:46.798066 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:43:46.798066 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m13:43:46.798066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:46.829075 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:46.831066 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:43:46.831066 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m13:43:46.832066 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:46.832066 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:43:46.832066 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m13:43:46.834065 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:46.834065 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:43:46.835074 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:43:46.835074 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:43:46.835074 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:46.836066 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m13:43:46.847166 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m13:43:46.847166 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m13:43:46.850721 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m13:43:46.851727 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m13:43:46.855691 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:43:46.856647 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m13:43:46.857646 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:43:46.859647 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:43:46.859647 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m13:43:46.860647 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m13:43:46.860647 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m13:43:46.860647 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m13:43:46.861647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:46.861647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:46.861647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:46.862646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:46.892652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:46.892652 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:46.893647 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:46.893647 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:46.894646 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:43:46.894646 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m13:43:46.894646 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:43:46.895647 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:43:46.895647 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m13:43:46.895647 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m13:43:46.896647 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m13:43:46.896647 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m13:43:46.924646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:46.925646 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:46.930646 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m13:43:46.931646 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m13:43:46.932688 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:46.932688 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:43:46.933646 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m13:43:46.934647 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m13:43:46.935646 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m13:43:46.936646 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m13:43:46.936646 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m13:43:46.937646 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m13:43:46.941691 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m13:43:46.942646 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m13:43:46.943646 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m13:43:46.944646 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m13:43:46.953646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '899cab1a-01b8-4bdc-bae4-88f21a1bcb25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D61EA65D0>]}
[0m13:43:46.954647 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:46.954647 [debug] [MainThread]: On master: BEGIN
[0m13:43:46.955645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:46.985646 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:46.985646 [debug] [MainThread]: On master: COMMIT
[0m13:43:46.986646 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:46.986646 [debug] [MainThread]: On master: COMMIT
[0m13:43:46.987646 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:46.987646 [debug] [MainThread]: On master: Close
[0m13:43:46.995254 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:43:46.995254 [info ] [MainThread]: 
[0m13:43:47.000254 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:43:47.000254 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents_wildlands  [RUN]
[0m13:43:47.001254 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands'
[0m13:43:47.001254 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:43:47.008254 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:43:47.009254 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:43:47.032254 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:43:47.033254 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:43:47.033254 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: BEGIN
[0m13:43:47.033254 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:43:47.063253 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:43:47.064254 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:43:47.064254 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents and Wildlands Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__wildlands

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed__wildlands and join it to the prior CTE

All columns from nfirs_processed__incidents and all columns excluding duplicative columns from
nfirs_transformed_wildlands will be taken.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Wildlands CTE
wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands"
),

-- Code Lookup CTE
inc_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'INC_TYPE'
),

fire_cause_codelookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'FIRE_CAUSE'
),

act_tak1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK1'
),

act_tak2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK2'
),

act_tak3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK3'
),

-- Incidents and Wildlands JOIN
incidents_wildlands_join AS (
    SELECT
        inc.*,
        wld.* EXCLUDE(state, fdid, inc_date, inc_no, exp_no)
    FROM incidents_source inc
    LEFT JOIN wildlands_source wld
        ON inc.incident_key = wld.incident_key
),

-- Incidents, Wildlands, and Code Descriptions JOIN
incidents_wildlands_final AS (
    SELECT
        inc.*,
        inc_type.code_descr AS inc_type_code_descr,
        fc.code_descr AS fire_cause_code_descr,
		act_tak1.code_descr AS act_tak1_code_descr,
		act_tak2.code_descr AS act_tak2_code_descr,
		act_tak3.code_descr AS act_tak3_code_descr
    FROM incidents_wildlands_join inc
    LEFT JOIN inc_type_code_lookup_source inc_type
        ON inc.inc_type = inc_type.code_value
    LEFT JOIN fire_cause_codelookup_source fc
        ON inc.fire_cause
    LEFT JOIN act_tak1_code_lookup_source act_tak1
        ON inc.act_tak1 = act_tak1.code_value
    LEFT JOIN act_tak2_code_lookup_source act_tak2
        ON inc.act_tak2 = act_tak2.code_value
    LEFT JOIN act_tak3_code_lookup_source act_tak3
        ON inc.act_tak3 = act_tak3.code_value
)

SELECT * FROM incidents_wildlands_final
    );
  
  
[0m13:43:57.669938 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents and Wildlands Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__wildlands

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed__wildlands and join it to the prior CTE

All columns from nfirs_processed__incidents and all columns excluding duplicative columns from
nfirs_transformed_wildlands will be taken.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Wildlands CTE
wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands"
),

-- Code Lookup CTE
inc_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'INC_TYPE'
),

fire_cause_codelookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'FIRE_CAUSE'
),

act_tak1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK1'
),

act_tak2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK2'
),

act_tak3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK3'
),

-- Incidents and Wildlands JOIN
incidents_wildlands_join AS (
    SELECT
        inc.*,
        wld.* EXCLUDE(state, fdid, inc_date, inc_no, exp_no)
    FROM incidents_source inc
    LEFT JOIN wildlands_source wld
        ON inc.incident_key = wld.incident_key
),

-- Incidents, Wildlands, and Code Descriptions JOIN
incidents_wildlands_final AS (
    SELECT
        inc.*,
        inc_type.code_descr AS inc_type_code_descr,
        fc.code_descr AS fire_cause_code_descr,
		act_tak1.code_descr AS act_tak1_code_descr,
		act_tak2.code_descr AS act_tak2_code_descr,
		act_tak3.code_descr AS act_tak3_code_descr
    FROM incidents_wildlands_join inc
    LEFT JOIN inc_type_code_lookup_source inc_type
        ON inc.inc_type = inc_type.code_value
    LEFT JOIN fire_cause_codelookup_source fc
        ON inc.fire_cause
    LEFT JOIN act_tak1_code_lookup_source act_tak1
        ON inc.act_tak1 = act_tak1.code_value
    LEFT JOIN act_tak2_code_lookup_source act_tak2
        ON inc.act_tak2 = act_tak2.code_value
    LEFT JOIN act_tak3_code_lookup_source act_tak3
        ON inc.act_tak3 = act_tak3.code_value
)

SELECT * FROM incidents_wildlands_final
    );
  
  
[0m13:43:57.669938 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:43:57.670952 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: ROLLBACK
[0m13:43:57.674952 [debug] [Thread-1 (]: Failed to rollback 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands'
[0m13:43:57.674952 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: Close
[0m13:43:57.821745 [debug] [Thread-1 (]: Runtime Error in model nfirs_processed__incidents_wildlands (models\nfirs_processed\nfirs_processed__incidents_wildlands.sql)
  Conversion Error: Could not convert string 'U' to BOOL
  LINE 88:         ON inc.fire_cause
                      ^
[0m13:43:57.822745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '899cab1a-01b8-4bdc-bae4-88f21a1bcb25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D6275F050>]}
[0m13:43:57.823744 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model nfirs_processed.nfirs_processed__incidents_wildlands  [[31mERROR[0m in 10.82s]
[0m13:43:57.824744 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:43:57.828744 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:57.828744 [debug] [MainThread]: On master: BEGIN
[0m13:43:57.829743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:57.869744 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:57.870744 [debug] [MainThread]: On master: COMMIT
[0m13:43:57.871744 [debug] [MainThread]: Using duckdb connection "master"
[0m13:43:57.871744 [debug] [MainThread]: On master: COMMIT
[0m13:43:57.872744 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:43:57.872744 [debug] [MainThread]: On master: Close
[0m13:43:57.882151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:57.883151 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m13:43:57.883151 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m13:43:57.883151 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m13:43:57.884152 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m13:43:57.884152 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m13:43:57.885151 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands' was properly closed.
[0m13:43:57.885151 [info ] [MainThread]: 
[0m13:43:57.886151 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.20 seconds (11.20s).
[0m13:43:57.887152 [debug] [MainThread]: Command end result
[0m13:43:57.963417 [info ] [MainThread]: 
[0m13:43:57.964417 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:43:57.964417 [info ] [MainThread]: 
[0m13:43:57.965417 [error] [MainThread]:   Runtime Error in model nfirs_processed__incidents_wildlands (models\nfirs_processed\nfirs_processed__incidents_wildlands.sql)
  Conversion Error: Could not convert string 'U' to BOOL
  LINE 88:         ON inc.fire_cause
                      ^
[0m13:43:57.966417 [info ] [MainThread]: 
[0m13:43:57.966417 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:43:57.968417 [debug] [MainThread]: Command `cli run` failed at 13:43:57.968417 after 11.85 seconds
[0m13:43:57.969416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D61C450A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D61C45160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D62193200>]}
[0m13:43:57.970416 [debug] [MainThread]: Flushing usage events
[0m13:44:21.951679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225A62E8F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225A479A270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225A223D370>]}


============================== 13:44:21.954679 | 83e591f6-93ef-433f-817a-c6a8c23e90ab ==============================
[0m13:44:21.954679 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:44:21.955679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:44:22.119971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83e591f6-93ef-433f-817a-c6a8c23e90ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225A6489AF0>]}
[0m13:44:22.160969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83e591f6-93ef-433f-817a-c6a8c23e90ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225A64BB3E0>]}
[0m13:44:22.161969 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:44:22.171752 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:44:22.299794 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:22.300794 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:22.331428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83e591f6-93ef-433f-817a-c6a8c23e90ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225A62EAD20>]}
[0m13:44:22.410008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83e591f6-93ef-433f-817a-c6a8c23e90ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225A67FBB60>]}
[0m13:44:22.410008 [info ] [MainThread]: Found 28 models, 4 data tests, 19 sources, 525 macros
[0m13:44:22.411008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83e591f6-93ef-433f-817a-c6a8c23e90ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225A62E8DD0>]}
[0m13:44:22.412021 [info ] [MainThread]: 
[0m13:44:22.413008 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:44:22.414008 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m13:44:22.471118 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m13:44:22.472065 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m13:44:22.472065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:22.505196 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:44:22.506188 [debug] [ThreadPool]: On list_nfirs: Close
[0m13:44:22.513962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_processed)
[0m13:44:22.514962 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_processed"
"
[0m13:44:22.519001 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:44:22.519998 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m13:44:22.519998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:22.552572 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:44:22.553572 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:44:22.554571 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: BEGIN
[0m13:44:22.554571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:44:22.554571 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:44:22.555571 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_processed"} */

    
    
        create schema if not exists "nfirs"."nfirs_processed"
    
[0m13:44:22.555571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:44:22.556571 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:44:22.556571 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_processed"
[0m13:44:22.557571 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: COMMIT
[0m13:44:22.557571 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:44:22.557571 [debug] [ThreadPool]: On create_nfirs_nfirs_processed: Close
[0m13:44:22.568883 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m13:44:22.572876 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:44:22.573886 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m13:44:22.573886 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m13:44:22.574875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m13:44:22.575875 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:44:22.575875 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m13:44:22.576875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:22.577884 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:44:22.577884 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m13:44:22.579875 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m13:44:22.609942 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m13:44:22.609942 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:44:22.610944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:22.610944 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m13:44:22.610944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:22.611921 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:44:22.611921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:22.612905 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:44:22.612905 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m13:44:22.613882 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:44:22.613882 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:44:22.613882 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:44:22.615033 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:44:22.615033 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m13:44:22.615033 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m13:44:22.616046 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m13:44:22.616046 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m13:44:22.641045 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:44:22.642044 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:44:22.646506 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:44:22.646887 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:44:22.648046 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m13:44:22.649046 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m13:44:22.650046 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m13:44:22.652046 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m13:44:22.652046 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m13:44:22.653046 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m13:44:22.653046 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m13:44:22.654053 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m13:44:22.654053 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m13:44:22.656048 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m13:44:22.656048 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m13:44:22.657057 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m13:44:22.668154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83e591f6-93ef-433f-817a-c6a8c23e90ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225A6759910>]}
[0m13:44:22.668671 [debug] [MainThread]: Using duckdb connection "master"
[0m13:44:22.668671 [debug] [MainThread]: On master: BEGIN
[0m13:44:22.669188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:22.701180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:44:22.701180 [debug] [MainThread]: On master: COMMIT
[0m13:44:22.701180 [debug] [MainThread]: Using duckdb connection "master"
[0m13:44:22.702180 [debug] [MainThread]: On master: COMMIT
[0m13:44:22.702180 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:44:22.703180 [debug] [MainThread]: On master: Close
[0m13:44:22.711124 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:44:22.712124 [info ] [MainThread]: 
[0m13:44:22.717946 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:44:22.718947 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_processed.nfirs_processed__incidents_wildlands  [RUN]
[0m13:44:22.720051 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands'
[0m13:44:22.720551 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:44:22.729929 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:44:22.731923 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:44:22.756929 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:44:22.757928 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:44:22.757928 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: BEGIN
[0m13:44:22.758928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:44:22.788030 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:44:22.789023 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:44:22.789023 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */

  
    
    

    create  table
      "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_tmp"
  
    as (
      /***** NFIRS Processed Incidents and Wildlands Data Table Creation *****/
/***
The below model will join the following tables together for further analysis:
- nfirs_transformed__fdheader (from nfirs_processed__incidents)
- nfirs_transformed__basicincident (from nfirs_processed__incidents)
- nfirs_transformed__fireincident (from nfirs_processed__incidents)
- nfirs_transformed__wildlands

The following logic will be applied:
- nfirs_processed__incidents serves as the base table
- Create CTE for nfirs_transformed__wildlands and join it to the prior CTE

All columns from nfirs_processed__incidents and all columns excluding duplicative columns from
nfirs_transformed_wildlands will be taken.
***/



-- Create Incidents CTE
WITH incidents_source AS (
    SELECT * FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents"
),

-- Create Wildlands CTE
wildlands_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__wildlands"
),

-- Code Lookup CTE
inc_type_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'INC_TYPE'
),

fire_cause_codelookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'FIRE_CAUSE'
),

act_tak1_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK1'
),

act_tak2_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK2'
),

act_tak3_code_lookup_source AS (
    SELECT * FROM "nfirs"."nfirs_transformed"."nfirs_transformed__codelookup"
    WHERE fieldid = 'ACT_TAK3'
),

-- Incidents and Wildlands JOIN
incidents_wildlands_join AS (
    SELECT
        inc.*,
        wld.* EXCLUDE(state, fdid, inc_date, inc_no, exp_no)
    FROM incidents_source inc
    LEFT JOIN wildlands_source wld
        ON inc.incident_key = wld.incident_key
),

-- Incidents, Wildlands, and Code Descriptions JOIN
incidents_wildlands_final AS (
    SELECT
        inc.*,
        inc_type.code_descr AS inc_type_code_descr,
        fc.code_descr AS fire_cause_code_descr,
		act_tak1.code_descr AS act_tak1_code_descr,
		act_tak2.code_descr AS act_tak2_code_descr,
		act_tak3.code_descr AS act_tak3_code_descr
    FROM incidents_wildlands_join inc
    LEFT JOIN inc_type_code_lookup_source inc_type
        ON inc.inc_type = inc_type.code_value
    LEFT JOIN fire_cause_codelookup_source fc
        ON inc.fire_cause = fc.code_value
    LEFT JOIN act_tak1_code_lookup_source act_tak1
        ON inc.act_tak1 = act_tak1.code_value
    LEFT JOIN act_tak2_code_lookup_source act_tak2
        ON inc.act_tak2 = act_tak2.code_value
    LEFT JOIN act_tak3_code_lookup_source act_tak3
        ON inc.act_tak3 = act_tak3.code_value
)

SELECT * FROM incidents_wildlands_final
    );
  
  
[0m13:53:30.783913 [debug] [Thread-1 (]: SQL status: OK in 548.0 seconds
[0m13:53:30.798243 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:53:30.798243 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands" rename to "nfirs_processed__incidents_wildlands__dbt_backup"
[0m13:53:30.805559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:53:30.848620 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:53:30.850002 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */
alter table "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_tmp" rename to "nfirs_processed__incidents_wildlands"
[0m13:53:30.855014 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:53:30.874014 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: COMMIT
[0m13:53:30.874014 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:53:30.875014 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: COMMIT
[0m13:54:55.816484 [debug] [Thread-1 (]: SQL status: OK in 85.0 seconds
[0m13:54:55.820485 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"
[0m13:54:55.820485 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands"} */
drop table if exists "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands__dbt_backup" cascade
[0m13:54:56.019068 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:54:56.021068 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands: Close
[0m13:55:24.972518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83e591f6-93ef-433f-817a-c6a8c23e90ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225A3D926C0>]}
[0m13:55:24.973519 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_processed.nfirs_processed__incidents_wildlands  [[32mOK[0m in 662.25s]
[0m13:55:24.974411 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands
[0m13:55:24.986576 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:24.987578 [debug] [MainThread]: On master: BEGIN
[0m13:55:24.988343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:25.033764 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:55:25.033764 [debug] [MainThread]: On master: COMMIT
[0m13:55:25.034764 [debug] [MainThread]: Using duckdb connection "master"
[0m13:55:25.034764 [debug] [MainThread]: On master: COMMIT
[0m13:55:25.034764 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:55:25.035764 [debug] [MainThread]: On master: Close
[0m13:55:25.053237 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:25.054235 [debug] [MainThread]: Connection 'create_nfirs_nfirs_processed' was properly closed.
[0m13:55:25.055236 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m13:55:25.055236 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m13:55:25.055236 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m13:55:25.056235 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m13:55:25.056235 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_processed__incidents_wildlands' was properly closed.
[0m13:55:25.061342 [info ] [MainThread]: 
[0m13:55:25.061342 [info ] [MainThread]: Finished running 1 table model in 0 hours 11 minutes and 2.65 seconds (662.65s).
[0m13:55:25.062236 [debug] [MainThread]: Command end result
[0m13:55:25.098466 [info ] [MainThread]: 
[0m13:55:25.099466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:25.101466 [info ] [MainThread]: 
[0m13:55:25.102466 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:55:25.103468 [debug] [MainThread]: Command `cli run` succeeded at 13:55:25.102466 after 663.28 seconds
[0m13:55:25.103468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225A6320EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225A60BD1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225A6830740>]}
[0m13:55:25.103468 [debug] [MainThread]: Flushing usage events
[0m13:56:05.705731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028582343500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285823423F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028582341E50>]}


============================== 13:56:05.712731 | 11ecbf97-5ce1-48ba-8bd3-a6150666b2a0 ==============================
[0m13:56:05.712731 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:56:05.712731 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m13:56:05.920985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11ecbf97-5ce1-48ba-8bd3-a6150666b2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028582867260>]}
[0m13:56:05.961953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11ecbf97-5ce1-48ba-8bd3-a6150666b2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028582A136B0>]}
[0m13:56:05.962953 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:56:05.972952 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m13:56:06.116949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:56:06.117949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:56:06.147948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11ecbf97-5ce1-48ba-8bd3-a6150666b2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028582B080B0>]}
[0m13:56:06.248458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11ecbf97-5ce1-48ba-8bd3-a6150666b2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028582B9C2C0>]}
[0m13:56:06.248458 [info ] [MainThread]: Found 28 models, 4 data tests, 19 sources, 525 macros
[0m13:56:06.248458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11ecbf97-5ce1-48ba-8bd3-a6150666b2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028582A4F890>]}
[0m13:56:06.250458 [info ] [MainThread]: 
[0m13:56:06.250458 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:56:06.251458 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m13:56:06.320456 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m13:56:06.321456 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m13:56:06.321456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:06.357455 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:06.358455 [debug] [ThreadPool]: On list_nfirs: Close
[0m13:56:06.367455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_analysis)
[0m13:56:06.368455 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_analysis"
"
[0m13:56:06.372455 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m13:56:06.373455 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m13:56:06.373455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:06.406454 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:06.407454 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m13:56:06.408454 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: BEGIN
[0m13:56:06.408454 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:06.409454 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m13:56:06.409454 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_analysis"} */

    
    
        create schema if not exists "nfirs"."nfirs_analysis"
    
[0m13:56:06.409454 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:06.410454 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m13:56:06.411460 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_analysis"
[0m13:56:06.411460 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: COMMIT
[0m13:56:06.411460 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:06.412454 [debug] [ThreadPool]: On create_nfirs_nfirs_analysis: Close
[0m13:56:06.425453 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m13:56:06.429453 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m13:56:06.430453 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m13:56:06.430453 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m13:56:06.431454 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m13:56:06.432453 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:56:06.433453 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m13:56:06.433453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:06.434453 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:56:06.435453 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m13:56:06.436453 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:56:06.468490 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m13:56:06.469490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:06.469490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:06.469490 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m13:56:06.470490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:06.470490 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m13:56:06.471490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:06.471490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:06.472490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:06.472490 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m13:56:06.473490 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m13:56:06.473490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:06.473490 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m13:56:06.474490 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m13:56:06.475491 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m13:56:06.475491 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m13:56:06.476490 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m13:56:06.501489 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:06.502490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:06.502490 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:06.509490 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m13:56:06.511494 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m13:56:06.512493 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m13:56:06.513493 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m13:56:06.514493 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m13:56:06.515493 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m13:56:06.515493 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m13:56:06.516495 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m13:56:06.517493 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m13:56:06.517493 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m13:56:06.518494 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m13:56:06.518494 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m13:56:06.519493 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m13:56:06.531962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11ecbf97-5ce1-48ba-8bd3-a6150666b2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002858310E3C0>]}
[0m13:56:06.532962 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:06.532962 [debug] [MainThread]: On master: BEGIN
[0m13:56:06.533962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:06.565486 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:06.565486 [debug] [MainThread]: On master: COMMIT
[0m13:56:06.566520 [debug] [MainThread]: Using duckdb connection "master"
[0m13:56:06.566520 [debug] [MainThread]: On master: COMMIT
[0m13:56:06.566520 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:56:06.567489 [debug] [MainThread]: On master: Close
[0m13:56:06.574486 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m13:56:06.575486 [info ] [MainThread]: 
[0m13:56:06.581486 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m13:56:06.581486 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_analysis.nfirs_analysis__wildlands_ca_analysis  [RUN]
[0m13:56:06.582540 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis'
[0m13:56:06.582540 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m13:56:06.588485 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m13:56:06.593486 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m13:56:06.624251 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m13:56:06.629373 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m13:56:06.629373 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: BEGIN
[0m13:56:06.630251 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:56:06.661249 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:56:06.662249 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m13:56:06.662249 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"} */

  
    
    

    create  table
      "nfirs"."nfirs_analysis"."nfirs_analysis__wildlands_ca_analysis__dbt_tmp"
  
    as (
      /***** NFIRS CA Wildlands Analysis Table Creation *****/
/*** 
The below model will select specific columns from 'nfirs_processed__incidents_wilds' for California to build visuals in Tableau
***/

-- depends_on: "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands"





    SELECT
        *
    FROM "nfirs"."nfirs_processed"."nfirs_processed__incidents_wildlands"
    WHERE state = 'CA'


    );
  
  
[0m13:57:40.280991 [debug] [Thread-1 (]: SQL status: OK in 94.0 seconds
[0m13:57:40.287991 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m13:57:40.287991 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"} */
alter table "nfirs"."nfirs_analysis"."nfirs_analysis__wildlands_ca_analysis" rename to "nfirs_analysis__wildlands_ca_analysis__dbt_backup"
[0m13:57:40.289990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:40.335207 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m13:57:40.335744 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"} */
alter table "nfirs"."nfirs_analysis"."nfirs_analysis__wildlands_ca_analysis__dbt_tmp" rename to "nfirs_analysis__wildlands_ca_analysis"
[0m13:57:40.337928 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:40.362144 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: COMMIT
[0m13:57:40.362676 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m13:57:40.363679 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: COMMIT
[0m13:57:43.995265 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m13:57:44.003827 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"
[0m13:57:44.005628 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis"} */
drop table if exists "nfirs"."nfirs_analysis"."nfirs_analysis__wildlands_ca_analysis__dbt_backup" cascade
[0m13:57:44.041288 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m13:57:44.043287 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis: Close
[0m13:57:52.057312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11ecbf97-5ce1-48ba-8bd3-a6150666b2a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285831ACF50>]}
[0m13:57:52.058311 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_analysis.nfirs_analysis__wildlands_ca_analysis  [[32mOK[0m in 105.47s]
[0m13:57:52.059311 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis
[0m13:57:52.061310 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:52.063311 [debug] [MainThread]: On master: BEGIN
[0m13:57:52.063311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:57:52.099310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:57:52.100309 [debug] [MainThread]: On master: COMMIT
[0m13:57:52.100309 [debug] [MainThread]: Using duckdb connection "master"
[0m13:57:52.101310 [debug] [MainThread]: On master: COMMIT
[0m13:57:52.101310 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m13:57:52.102309 [debug] [MainThread]: On master: Close
[0m13:57:52.113318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:52.114316 [debug] [MainThread]: Connection 'create_nfirs_nfirs_analysis' was properly closed.
[0m13:57:52.114316 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m13:57:52.115309 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m13:57:52.115309 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m13:57:52.115309 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m13:57:52.116309 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_analysis__wildlands_ca_analysis' was properly closed.
[0m13:57:52.118309 [info ] [MainThread]: 
[0m13:57:52.119317 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 45.87 seconds (105.87s).
[0m13:57:52.119317 [debug] [MainThread]: Command end result
[0m13:57:52.146308 [info ] [MainThread]: 
[0m13:57:52.147309 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:57:52.148308 [info ] [MainThread]: 
[0m13:57:52.148877 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:57:52.149921 [debug] [MainThread]: Command `cli run` succeeded at 13:57:52.149921 after 106.56 seconds
[0m13:57:52.150465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028582343C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000285823423F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028582341E50>]}
[0m13:57:52.150465 [debug] [MainThread]: Flushing usage events
[0m16:47:54.019323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601246FE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601246FC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601246FB60>]}


============================== 16:47:54.025405 | 0bba9979-521f-4f16-a0d7-13519d193aa6 ==============================
[0m16:47:54.025405 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:47:54.025405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'profiles_dir': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:47:54.277082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bba9979-521f-4f16-a0d7-13519d193aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601246FC50>]}
[0m16:47:54.327828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bba9979-521f-4f16-a0d7-13519d193aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026010CBA6C0>]}
[0m16:47:54.327828 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:47:54.340673 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:47:54.478755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:54.478755 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:54.511243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bba9979-521f-4f16-a0d7-13519d193aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026012785D60>]}
[0m16:47:54.679232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bba9979-521f-4f16-a0d7-13519d193aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260127A5E20>]}
[0m16:47:54.679232 [info ] [MainThread]: Found 28 models, 4 data tests, 19 sources, 525 macros
[0m16:47:54.679232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bba9979-521f-4f16-a0d7-13519d193aa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601283CD10>]}
[0m16:47:54.679232 [info ] [MainThread]: 
[0m16:47:54.679232 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:47:54.679232 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:47:54.935275 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:47:54.935275 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:47:54.935275 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:55.050647 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:47:55.050647 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:47:55.058745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:47:55.059097 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m16:47:55.059097 [info ] [MainThread]: 
[0m16:47:55.059097 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m16:47:55.059097 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\AppData\Local\Programs\Python\Python312\python.exe (PID 21488)
[0m16:47:55.059097 [debug] [MainThread]: Command `cli run` failed at 16:47:55.059097 after 1.17 seconds
[0m16:47:55.059097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601032A1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026012A3E750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002601283CEF0>]}
[0m16:47:55.059097 [debug] [MainThread]: Flushing usage events
[0m16:52:15.211037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E9E8D6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EB4DF1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E977AFF0>]}


============================== 16:52:15.211037 | 38e22f84-7bff-4514-8115-d01186bc6cd7 ==============================
[0m16:52:15.211037 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:52:15.211037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'fail_fast': 'False', 'profiles_dir': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:15.419784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38e22f84-7bff-4514-8115-d01186bc6cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E9AC3440>]}
[0m16:52:15.481631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38e22f84-7bff-4514-8115-d01186bc6cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EB7EEB70>]}
[0m16:52:15.482095 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:52:15.490340 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:52:15.626393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:15.626660 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:15.655549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38e22f84-7bff-4514-8115-d01186bc6cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EBA29700>]}
[0m16:52:15.738174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38e22f84-7bff-4514-8115-d01186bc6cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EBCEDD00>]}
[0m16:52:15.738174 [info ] [MainThread]: Found 28 models, 4 data tests, 19 sources, 525 macros
[0m16:52:15.738174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38e22f84-7bff-4514-8115-d01186bc6cd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EBA1ABA0>]}
[0m16:52:15.738174 [info ] [MainThread]: 
[0m16:52:15.746248 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:52:15.746534 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:52:15.809251 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:52:15.809251 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:52:15.809251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:15.913782 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:52:15.913782 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m16:52:15.913782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:15.913782 [debug] [MainThread]: Connection 'list_nfirs' was properly closed.
[0m16:52:15.913782 [info ] [MainThread]: 
[0m16:52:15.913782 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m16:52:15.913782 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: File is already open in 
  C:\Users\javier.flores\AppData\Local\Programs\Python\Python312\python.exe (PID 21488)
[0m16:52:15.913782 [debug] [MainThread]: Command `cli run` failed at 16:52:15.913782 after 0.83 seconds
[0m16:52:15.913782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4E9E8D6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EBAF3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4EBCED160>]}
[0m16:52:15.913782 [debug] [MainThread]: Flushing usage events
[0m16:52:56.924073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9378C1B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A800E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A800CE0>]}


============================== 16:52:56.924073 | d2aa6468-3595-43e1-aed4-138c32a88acf ==============================
[0m16:52:56.924073 [info ] [MainThread]: Running with dbt=1.8.3
[0m16:52:56.924073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\NFIRS Data Pipeline and Analysis\\nfirs_dbt_2\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:57.115941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2aa6468-3595-43e1-aed4-138c32a88acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E938CF82C0>]}
[0m16:52:57.175092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2aa6468-3595-43e1-aed4-138c32a88acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A8C66C0>]}
[0m16:52:57.175092 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m16:52:57.183037 [debug] [MainThread]: checksum: 30bd4080c2bc8dee5936f8f60083ffbe1c906859d0fd965607c2144031479456, vars: {}, profile: , target: , version: 1.8.3
[0m16:52:57.311129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:57.319394 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:57.352601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2aa6468-3595-43e1-aed4-138c32a88acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A8BBB00>]}
[0m16:52:57.431055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2aa6468-3595-43e1-aed4-138c32a88acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93AC1D0A0>]}
[0m16:52:57.431055 [info ] [MainThread]: Found 28 models, 4 data tests, 19 sources, 525 macros
[0m16:52:57.431055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2aa6468-3595-43e1-aed4-138c32a88acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93AB69A60>]}
[0m16:52:57.431055 [info ] [MainThread]: 
[0m16:52:57.431055 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:52:57.439242 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs'
[0m16:52:57.506046 [debug] [ThreadPool]: Using duckdb connection "list_nfirs"
[0m16:52:57.506230 [debug] [ThreadPool]: On list_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"nfirs"'
    
  
  
[0m16:52:57.506230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:25.414122 [debug] [ThreadPool]: SQL status: OK in 148.0 seconds
[0m16:55:25.418047 [debug] [ThreadPool]: On list_nfirs: Close
[0m16:55:28.377871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nfirs, now create_nfirs_nfirs_transformed)
[0m16:55:28.383761 [debug] [ThreadPool]: Creating schema "database: "nfirs"
schema: "nfirs_transformed"
"
[0m16:55:28.387988 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:55:28.387988 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
        select type from duckdb_databases()
        where database_name='nfirs'
        and type='sqlite'
    
  
[0m16:55:28.387988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:28.427773 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:28.427773 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:55:28.427773 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: BEGIN
[0m16:55:28.427773 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:28.427773 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:55:28.427773 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "create_nfirs_nfirs_transformed"} */

    
    
        create schema if not exists "nfirs"."nfirs_transformed"
    
[0m16:55:28.427773 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:28.427773 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:55:28.433468 [debug] [ThreadPool]: Using duckdb connection "create_nfirs_nfirs_transformed"
[0m16:55:28.433801 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: COMMIT
[0m16:55:28.434340 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:28.434340 [debug] [ThreadPool]: On create_nfirs_nfirs_transformed: Close
[0m16:55:28.447693 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_analysis'
[0m16:55:28.447693 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_processed'
[0m16:55:28.452616 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:55:28.454130 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs_transformed'
[0m16:55:28.454130 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_nfirs_nfirs'
[0m16:55:28.456193 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m16:55:28.456193 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: BEGIN
[0m16:55:28.457714 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:55:28.457714 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:55:28.457714 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: BEGIN
[0m16:55:28.457714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:28.457714 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: BEGIN
[0m16:55:28.457714 [debug] [ThreadPool]: On list_nfirs_nfirs: BEGIN
[0m16:55:28.457714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:28.488557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:28.488557 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:28.488557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:28.488557 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:28.488557 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:28.495709 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_analysis"
[0m16:55:28.496706 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:28.496861 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_processed"
[0m16:55:28.496861 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs_transformed"
[0m16:55:28.496861 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_analysis"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_analysis'
    and table_catalog = 'nfirs'
  
[0m16:55:28.497929 [debug] [ThreadPool]: Using duckdb connection "list_nfirs_nfirs"
[0m16:55:28.497929 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_processed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_processed'
    and table_catalog = 'nfirs'
  
[0m16:55:28.497929 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs_transformed"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs_transformed'
    and table_catalog = 'nfirs'
  
[0m16:55:28.497929 [debug] [ThreadPool]: On list_nfirs_nfirs: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "connection_name": "list_nfirs_nfirs"} */
select
      'nfirs' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'nfirs'
    and table_catalog = 'nfirs'
  
[0m16:55:28.557704 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:28.558211 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:28.558703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:28.559206 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m16:55:28.570744 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: ROLLBACK
[0m16:55:28.570744 [debug] [ThreadPool]: On list_nfirs_nfirs: ROLLBACK
[0m16:55:28.570744 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: ROLLBACK
[0m16:55:28.570744 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: ROLLBACK
[0m16:55:28.577326 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_transformed'
[0m16:55:28.578576 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs'
[0m16:55:28.579406 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_analysis'
[0m16:55:28.579956 [debug] [ThreadPool]: On list_nfirs_nfirs_transformed: Close
[0m16:55:28.580456 [debug] [ThreadPool]: Failed to rollback 'list_nfirs_nfirs_processed'
[0m16:55:28.580456 [debug] [ThreadPool]: On list_nfirs_nfirs: Close
[0m16:55:28.581356 [debug] [ThreadPool]: On list_nfirs_nfirs_analysis: Close
[0m16:55:28.585415 [debug] [ThreadPool]: On list_nfirs_nfirs_processed: Close
[0m16:55:28.606173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2aa6468-3595-43e1-aed4-138c32a88acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93AB69A60>]}
[0m16:55:28.607177 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:28.607794 [debug] [MainThread]: On master: BEGIN
[0m16:55:28.608294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:28.662126 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:55:28.663882 [debug] [MainThread]: On master: COMMIT
[0m16:55:28.664382 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:28.664887 [debug] [MainThread]: On master: COMMIT
[0m16:55:28.665477 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:55:28.665477 [debug] [MainThread]: On master: Close
[0m16:55:28.673829 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m16:55:28.675192 [info ] [MainThread]: 
[0m16:55:28.684019 [debug] [Thread-1 (]: Began running node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m16:55:28.685343 [info ] [Thread-1 (]: 1 of 1 START sql table model nfirs_transformed.nfirs_transformed__arson ........ [RUN]
[0m16:55:28.686635 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson'
[0m16:55:28.687705 [debug] [Thread-1 (]: Began compiling node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m16:55:28.701193 [debug] [Thread-1 (]: Writing injected SQL for node "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m16:55:28.707718 [debug] [Thread-1 (]: Began executing node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m16:55:28.822044 [debug] [Thread-1 (]: Writing runtime sql for node "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m16:55:28.826166 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m16:55:28.827166 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: BEGIN
[0m16:55:28.828166 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:55:28.868498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:28.869499 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m16:55:28.870000 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */

  
    
    

    create  table
      "nfirs"."nfirs_transformed"."nfirs_transformed__arson__dbt_tmp"
  
    as (
      /***** NFIRS Transformed Arson Table Creation *****/
/***
The below model will transform the 'INC_DATE' column to DATE data type.
***/



WITH arson_source AS (
    SELECT * FROM "nfirs"."nfirs_raw"."arson"
),

arson_col_data_type_update AS (
    SELECT
        *,
        CAST(STRPTIME(INC_DATE, '%m%d%Y') AS DATE) AS INC_DATE_UPDATE
    FROM arson_source
),

arson_final AS (
    SELECT
        INCIDENT_KEY,
        STATE,
        FDID,
        INC_DATE_UPDATE AS INC_DATE,
        INC_NO,
        EXP_NO,
        VERSION,
        CASE_STAT,
        AVAIL_MFI,
        MOT_FACTS1,
        MOT_FACTS2,
        MOT_FACTS3,
        GRP_INVOL1,
        GRP_INVOL2,
        GRP_INVOL3,
        ENTRY_METH,
        EXT_FIRE,
        DEVI_CONT,
        DEVI_IGNIT,
        DEVI_FUEL,
        INV_INFO1,
        INV_INFO2,
        INV_INFO3,
        INV_INFO4,
        INV_INFO5,
        INV_INFO6,
        INV_INFO7,
        INV_INFO8,
        PROP_OWNER,
        INIT_OB1,
        INIT_OB2,
        INIT_OB3,
        INIT_OB4,
        INIT_OB5,
        INIT_OB6,
        INIT_OB7,
        INIT_OB8,
        LAB_USED1,
        LAB_USED2,
        LAB_USED3,
        LAB_USED4,
        LAB_USED5,
        LAB_USED6
    FROM arson_col_data_type_update
)

SELECT * FROM arson_final
    );
  
  
[0m16:55:29.353967 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:29.362616 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m16:55:29.363616 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__arson" rename to "nfirs_transformed__arson__dbt_backup"
[0m16:55:29.364651 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:29.369269 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m16:55:29.370268 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */
alter table "nfirs"."nfirs_transformed"."nfirs_transformed__arson__dbt_tmp" rename to "nfirs_transformed__arson"
[0m16:55:29.372284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:29.401191 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: COMMIT
[0m16:55:29.402691 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m16:55:29.403807 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: COMMIT
[0m16:55:32.995314 [debug] [Thread-1 (]: SQL status: OK in 4.0 seconds
[0m16:55:33.007587 [debug] [Thread-1 (]: Using duckdb connection "model.nfirs_dbt_project_new.nfirs_transformed__arson"
[0m16:55:33.007587 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "nfirs_duckdb", "target_name": "dev", "node_id": "model.nfirs_dbt_project_new.nfirs_transformed__arson"} */
drop table if exists "nfirs"."nfirs_transformed"."nfirs_transformed__arson__dbt_backup" cascade
[0m16:55:33.018020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m16:55:33.022032 [debug] [Thread-1 (]: On model.nfirs_dbt_project_new.nfirs_transformed__arson: Close
[0m16:55:35.477890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2aa6468-3595-43e1-aed4-138c32a88acf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E938F9D280>]}
[0m16:55:35.477890 [info ] [Thread-1 (]: 1 of 1 OK created sql table model nfirs_transformed.nfirs_transformed__arson ... [[32mOK[0m in 6.79s]
[0m16:55:35.477890 [debug] [Thread-1 (]: Finished running node model.nfirs_dbt_project_new.nfirs_transformed__arson
[0m16:55:35.482935 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:35.482935 [debug] [MainThread]: On master: BEGIN
[0m16:55:35.482935 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:35.517734 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:55:35.517734 [debug] [MainThread]: On master: COMMIT
[0m16:55:35.517734 [debug] [MainThread]: Using duckdb connection "master"
[0m16:55:35.517734 [debug] [MainThread]: On master: COMMIT
[0m16:55:35.517734 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m16:55:35.517734 [debug] [MainThread]: On master: Close
[0m16:55:35.528421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:35.528421 [debug] [MainThread]: Connection 'create_nfirs_nfirs_transformed' was properly closed.
[0m16:55:35.528421 [debug] [MainThread]: Connection 'list_nfirs_nfirs_analysis' was properly closed.
[0m16:55:35.528421 [debug] [MainThread]: Connection 'list_nfirs_nfirs_processed' was properly closed.
[0m16:55:35.528421 [debug] [MainThread]: Connection 'list_nfirs_nfirs_transformed' was properly closed.
[0m16:55:35.528421 [debug] [MainThread]: Connection 'list_nfirs_nfirs' was properly closed.
[0m16:55:35.528421 [debug] [MainThread]: Connection 'model.nfirs_dbt_project_new.nfirs_transformed__arson' was properly closed.
[0m16:55:35.528421 [info ] [MainThread]: 
[0m16:55:35.528421 [info ] [MainThread]: Finished running 1 table model in 0 hours 2 minutes and 38.10 seconds (158.10s).
[0m16:55:35.528421 [debug] [MainThread]: Command end result
[0m16:55:35.558046 [info ] [MainThread]: 
[0m16:55:35.558046 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:35.558046 [info ] [MainThread]: 
[0m16:55:35.558046 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:55:35.558046 [debug] [MainThread]: Command `cli run` succeeded at 16:55:35.558046 after 158.76 seconds
[0m16:55:35.558046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A4A9F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A3B3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93A3B3380>]}
[0m16:55:35.558046 [debug] [MainThread]: Flushing usage events
